[
  {
    "id" : "2d181f8f-0021-42d3-a79c-8d9706755885",
    "prId" : 33466,
    "prUrl" : "https://github.com/apache/spark/pull/33466#pullrequestreview-715231770",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e6b78987-e438-4f76-8f94-f00aea17b829",
        "parentId" : null,
        "authorId" : "43998e22-6c2f-401d-9914-8cecf6fad929",
        "body" : "Don't we need to check `index_ops.hasnans` here?",
        "createdAt" : "2021-07-23T02:04:50Z",
        "updatedAt" : "2021-07-23T02:06:27Z",
        "lastEditedBy" : "43998e22-6c2f-401d-9914-8cecf6fad929",
        "tags" : [
        ]
      },
      {
        "id" : "0d1ce36a-9fe8-479e-b1ec-16146d3adb99",
        "parentId" : "e6b78987-e438-4f76-8f94-f00aea17b829",
        "authorId" : "8194e9fe-1d06-4199-937e-9633d15a18cb",
        "body" : "`hasnans` of Decimal may not work as expected as https://issues.apache.org/jira/browse/SPARK-36230.\r\nA TODO comment is added. How do you think about that?",
        "createdAt" : "2021-07-23T16:36:09Z",
        "updatedAt" : "2021-07-23T16:36:10Z",
        "lastEditedBy" : "8194e9fe-1d06-4199-937e-9633d15a18cb",
        "tags" : [
        ]
      },
      {
        "id" : "2f63bbf8-6764-47a4-ad0f-7dba235f3bed",
        "parentId" : "e6b78987-e438-4f76-8f94-f00aea17b829",
        "authorId" : "8194e9fe-1d06-4199-937e-9633d15a18cb",
        "body" : "I updated the PR/ticket title and description to make that clear.",
        "createdAt" : "2021-07-26T20:01:18Z",
        "updatedAt" : "2021-07-26T20:01:19Z",
        "lastEditedBy" : "8194e9fe-1d06-4199-937e-9633d15a18cb",
        "tags" : [
        ]
      }
    ],
    "commit" : "7d08e8bdb3c8ea2b568be4c73f949a7bb047d7b9",
    "line" : 79,
    "diffHunk" : "@@ -1,1 +389,393 @@        # TODO(SPARK-36230): check index_ops.hasnans after fixing SPARK-36230\n        dtype, spark_type = pandas_on_spark_type(dtype)\n        return _non_fractional_astype(index_ops, dtype, spark_type)\n\n"
  },
  {
    "id" : "644aaeff-6d0b-4a86-a268-0dbd76c36c0a",
    "prId" : 33466,
    "prUrl" : "https://github.com/apache/spark/pull/33466#pullrequestreview-713350509",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2f926bbf-2829-4810-aafa-d677f7c1c967",
        "parentId" : null,
        "authorId" : "43998e22-6c2f-401d-9914-8cecf6fad929",
        "body" : "Nice!",
        "createdAt" : "2021-07-23T02:05:56Z",
        "updatedAt" : "2021-07-23T02:06:27Z",
        "lastEditedBy" : "43998e22-6c2f-401d-9914-8cecf6fad929",
        "tags" : [
        ]
      }
    ],
    "commit" : "7d08e8bdb3c8ea2b568be4c73f949a7bb047d7b9",
    "line" : 20,
    "diffHunk" : "@@ -1,1 +47,51 @@def _non_fractional_astype(\n    index_ops: IndexOpsLike, dtype: Dtype, spark_type: DataType\n) -> IndexOpsLike:\n    if isinstance(dtype, CategoricalDtype):\n        return _as_categorical_type(index_ops, dtype, spark_type)"
  },
  {
    "id" : "ccbf2443-5a2b-4924-aca2-5e79ee916aad",
    "prId" : 32821,
    "prUrl" : "https://github.com/apache/spark/pull/32821#pullrequestreview-685429022",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "50f7e57f-5f78-4e3b-91d0-630634f842d6",
        "parentId" : null,
        "authorId" : "8194e9fe-1d06-4199-937e-9633d15a18cb",
        "body" : "A second thought, if `isnull` returns `pyspark.sql.column.Column` (`index_ops.spark.column.isNull() | F.isnan(index_ops.spark.column)` in this case), https://github.com/apache/spark/blob/master/python/pyspark/pandas/data_type_ops/num_ops.py#L386-L389 can leverage `isnull` as well. How do you think about that?",
        "createdAt" : "2021-06-15T16:34:39Z",
        "updatedAt" : "2021-06-15T16:34:39Z",
        "lastEditedBy" : "8194e9fe-1d06-4199-937e-9633d15a18cb",
        "tags" : [
        ]
      },
      {
        "id" : "fb5c4b79-a81d-477d-8e00-e2622d86a29f",
        "parentId" : "50f7e57f-5f78-4e3b-91d0-630634f842d6",
        "authorId" : "c13f1277-0254-494b-8e7a-bd7c261b2e9f",
        "body" : "I think this `isnull` is designed for IndexOpsMixinÂ to match the pandas's `isnull` API, so I think maybe it's not a good idea to make this `isnull` to cover col.isnull case.\r\n\r\nThe problem is that index_ops.spark.column is not datatype-based, if it's just for avoiding duplicated code, maybe we could add some utils function to address it.",
        "createdAt" : "2021-06-16T01:20:20Z",
        "updatedAt" : "2021-06-16T01:20:20Z",
        "lastEditedBy" : "c13f1277-0254-494b-8e7a-bd7c261b2e9f",
        "tags" : [
        ]
      },
      {
        "id" : "2432cec4-d68a-4713-a447-aa5446fb9ae7",
        "parentId" : "50f7e57f-5f78-4e3b-91d0-630634f842d6",
        "authorId" : "8194e9fe-1d06-4199-937e-9633d15a18cb",
        "body" : "Sounds good.",
        "createdAt" : "2021-06-16T16:58:51Z",
        "updatedAt" : "2021-06-16T16:58:51Z",
        "lastEditedBy" : "8194e9fe-1d06-4199-937e-9633d15a18cb",
        "tags" : [
        ]
      }
    ],
    "commit" : "d14d8252f2bfc12e5a1314d24eff42b7978a8f8c",
    "line" : 37,
    "diffHunk" : "@@ -1,1 +413,417 @@        return \"decimal\"\n\n    def isnull(self, index_ops: Union[\"Index\", \"Series\"]) -> Union[\"Series\", \"Index\"]:\n        return index_ops._with_new_scol(index_ops.spark.column.isNull())"
  }
]