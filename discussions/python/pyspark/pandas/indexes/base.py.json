[
  {
    "id" : "20c5f134-3836-4a91-b213-362dbe988afc",
    "prId" : 33634,
    "prUrl" : "https://github.com/apache/spark/pull/33634#pullrequestreview-723990320",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9e682214-fc75-4136-b914-8f62ef5f3b6c",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "@itholic, did you refer to this?\r\n\r\n> Bug in Index.union() and MultiIndex.union() dropping duplicate Index values when Index was not monotonic or sort was set to False (GH36289, GH31326, GH40862)\r\n\r\nIt sounds like now it drops duplicates but the codes above in Pr description look keeping the duplicates. Should we also at least check `sort` and drop duplicates?",
        "createdAt" : "2021-08-06T03:09:08Z",
        "updatedAt" : "2021-08-06T03:11:05Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "28d83854-8bfe-4974-88fe-eb5fb2125bf8",
        "parentId" : "9e682214-fc75-4136-b914-8f62ef5f3b6c",
        "authorId" : "2d8ced12-ada1-43e1-9240-bf1c11a01e4c",
        "body" : "Thanks, @HyukjinKwon !\r\n\r\nSeems like they said \"dropping duplicate Index values\" was a bug, and fixed in this release.\r\n\r\nRelated discussion was made at https://github.com/pandas-dev/pandas/issues/36289 and https://github.com/pandas-dev/pandas/issues/31326.\r\n\r\nAlso checked the `sort` and drop duplicates, works the same as pandas.",
        "createdAt" : "2021-08-06T05:21:59Z",
        "updatedAt" : "2021-08-06T05:27:11Z",
        "lastEditedBy" : "2d8ced12-ada1-43e1-9240-bf1c11a01e4c",
        "tags" : [
        ]
      }
    ],
    "commit" : "dc8f0e8719e1ae522cf0b6ecc03e913b105bfa20",
    "line" : 8,
    "diffHunk" : "@@ -1,1 +2294,2298 @@        sdf_other = other_idx._internal.spark_frame.select(other_idx._internal.index_spark_columns)\n        sdf = sdf_self.unionAll(sdf_other).exceptAll(sdf_self.intersectAll(sdf_other))\n        if sort:\n            sdf = sdf.sort(*self._internal.index_spark_column_names)\n"
  }
]