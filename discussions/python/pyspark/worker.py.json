[
  {
    "id" : "7c7878d1-092a-45a8-8bcc-4e20ab808733",
    "prId" : 31999,
    "prUrl" : "https://github.com/apache/spark/pull/31999#pullrequestreview-629048733",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "57d6b7cc-a1c7-4195-8fe7-5adcec2a64e0",
        "parentId" : null,
        "authorId" : "c13f1277-0254-494b-8e7a-bd7c261b2e9f",
        "body" : "```suggestion\r\n                \"Expected: {} Actual: {} \"\r\n```",
        "createdAt" : "2021-04-06T14:35:04Z",
        "updatedAt" : "2021-04-06T14:36:22Z",
        "lastEditedBy" : "c13f1277-0254-494b-8e7a-bd7c261b2e9f",
        "tags" : [
        ]
      }
    ],
    "commit" : "a25138ed82e938c0a5a7b328118d2a8a9b81ae33",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +142,146 @@                \"Number of columns of the returned pandas.DataFrame \"\n                \"doesn't match specified schema. \"\n                \"Expected: {} Actual: {}\"\n                \"Columns: {}\".format(len(return_type), len(result.columns), result.columns))\n        return result"
  },
  {
    "id" : "a2e0eb3f-37ec-4d4f-9d7d-4d3359387c18",
    "prId" : 31239,
    "prUrl" : "https://github.com/apache/spark/pull/31239#pullrequestreview-570882757",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "55b2b991-c882-4567-874f-51f884f5b1ad",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "I checked the regular warnings and matched it with that:\r\n\r\n```\r\nvi tmp.py\r\n```\r\n\r\n```python\r\nimport warnings\r\nwarnings.warn(\r\n    \"a\",\r\n    UserWarning)\r\n```\r\n\r\n```\r\npython tmp.py\r\n```\r\n\r\n```\r\n/.../tmp.py:2: UserWarning: a\r\n  warnings.warn(\r\n```",
        "createdAt" : "2021-01-19T03:32:13Z",
        "updatedAt" : "2021-01-19T03:32:13Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "bdf0a29f240bd840f61030c0f65243804e7fdab9",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +503,507 @@                # not all systems support resource limits, so warn instead of failing\n                lineno = getframeinfo(\n                    currentframe()).lineno + 1 if currentframe() is not None else 0\n                print(warnings.formatwarning(\n                    \"Failed to set memory limit: {0}\".format(e),"
  },
  {
    "id" : "0a961ab6-a75f-46da-8036-cee8b4b0b761",
    "prId" : 31239,
    "prUrl" : "https://github.com/apache/spark/pull/31239#pullrequestreview-570886597",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2a8aa90c-c09a-4171-9624-74ec0d1b4d06",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Frame's `lineno` should always be an integer :\r\n```python\r\n>>> import types\r\n>>> import inspect\r\n>>> types.TracebackType(None, inspect.currentframe(), 3, tb_lineno=None)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nTypeError: an integer is required (got type NoneType)\r\n```",
        "createdAt" : "2021-01-19T03:46:09Z",
        "updatedAt" : "2021-01-19T03:56:23Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "bdf0a29f240bd840f61030c0f65243804e7fdab9",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +503,507 @@                # not all systems support resource limits, so warn instead of failing\n                lineno = getframeinfo(\n                    currentframe()).lineno + 1 if currentframe() is not None else 0\n                print(warnings.formatwarning(\n                    \"Failed to set memory limit: {0}\".format(e),"
  },
  {
    "id" : "660d4563-7852-4e04-baec-e61138b746a7",
    "prId" : 30985,
    "prUrl" : "https://github.com/apache/spark/pull/30985#pullrequestreview-570053848",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "86f63340-d3d3-4485-b767-c4983ad2898b",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Ah, gotya. To be extremely conservative for the Python implementation concern, we could do something like:\r\n\r\n```python\r\ncur = currentframe()\r\ngetframeinfo(cur).lineno if cur is not None else -1  # or 0 ..?\r\n```\r\n\r\nlooks like it's implemented in Python as:\r\n\r\n```python\r\ndef currentframe():\r\n    \"\"\"Return the frame of the caller or None if this is not possible.\"\"\"\r\n    return sys._getframe(1) if hasattr(sys, \"_getframe\") else None\r\n```",
        "createdAt" : "2021-01-17T12:43:23Z",
        "updatedAt" : "2021-01-17T13:38:41Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "33db203f2a6364837ebe9851f0665e66fab0644d",
    "line" : 26,
    "diffHunk" : "@@ -1,1 +506,510 @@                    ResourceWarning,\n                    __file__,\n                    getframeinfo(currentframe()).lineno\n                ), file=sys.stderr)\n"
  },
  {
    "id" : "f03b3a80-c5d5-4139-935f-0e562a9b6b8b",
    "prId" : 30248,
    "prUrl" : "https://github.com/apache/spark/pull/30248#pullrequestreview-526965500",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e6bdded5-4616-44cf-a53f-aa791610a3c2",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Can you change `except Exception:` at 621 line to `except BaseException` too?",
        "createdAt" : "2020-11-10T03:41:20Z",
        "updatedAt" : "2020-11-10T08:53:29Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "59d5fac8-f929-49ac-9703-e7d55d835b87",
        "parentId" : "e6bdded5-4616-44cf-a53f-aa791610a3c2",
        "authorId" : "de37844d-d6ad-4742-9b26-373261f5169e",
        "body" : "updated",
        "createdAt" : "2020-11-10T08:37:01Z",
        "updatedAt" : "2020-11-10T08:53:29Z",
        "lastEditedBy" : "de37844d-d6ad-4742-9b26-373261f5169e",
        "tags" : [
        ]
      }
    ],
    "commit" : "e5c33f0b28e58110de04e9dbc6e1d75bc59d53f0",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +605,609 @@        TaskContext._setTaskContext(None)\n        BarrierTaskContext._setTaskContext(None)\n    except BaseException:\n        try:\n            exc_info = traceback.format_exc()"
  },
  {
    "id" : "ce0bdcee-667c-4a52-b77c-87238685fddc",
    "prId" : 26239,
    "prUrl" : "https://github.com/apache/spark/pull/26239#pullrequestreview-309210063",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5b0296cd-b958-4ed4-9030-cfefcd1535dd",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Hm, what happens if it fails with exceptions in the middle of execution in this worker?",
        "createdAt" : "2019-10-28T10:16:53Z",
        "updatedAt" : "2019-10-31T03:16:28Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "547a2671-b75c-4bea-a870-4b8154d8bc5b",
        "parentId" : "5b0296cd-b958-4ed4-9030-cfefcd1535dd",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Is it really needed? We always set the global TaskContext and never reset it previouslly.",
        "createdAt" : "2019-10-28T13:42:36Z",
        "updatedAt" : "2019-10-31T03:16:28Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "723f3438-9906-481b-bd2e-2503bf835f8c",
        "parentId" : "5b0296cd-b958-4ed4-9030-cfefcd1535dd",
        "authorId" : "28d581bb-a398-46f0-861f-a016fdb56186",
        "body" : "> Hm, what happens if it fails with exceptions in the middle of execution in this worker?\r\n\r\nIf exceptions occured, the worker will be closed with `sys.exit(-1)`. \r\n\r\n> Is it really needed? We always set the global TaskContext and never reset it previouslly.\r\n\r\nPreviously:\r\n```\r\nval rdd = ...\r\nval barriered = rdd.barrier().mapPartitions(...)\r\n\r\nbarriered.mapPartitions(...)  # here the BarrierTaskContext still existed.\r\n```\r\n\r\nThis code is just a guard program, it shouldn't increase extra overhead or behavior change.",
        "createdAt" : "2019-10-29T04:19:43Z",
        "updatedAt" : "2019-10-31T03:16:28Z",
        "lastEditedBy" : "28d581bb-a398-46f0-861f-a016fdb56186",
        "tags" : [
        ]
      },
      {
        "id" : "d68875a0-c13e-4ae3-8e43-340033d8d177",
        "parentId" : "5b0296cd-b958-4ed4-9030-cfefcd1535dd",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "> This code is just a guard program, it shouldn't increase extra overhead or behavior change.\r\n\r\nI guess that's only when the worker is reused. Can you clarify it with comments here?",
        "createdAt" : "2019-10-30T00:29:38Z",
        "updatedAt" : "2019-10-31T03:16:28Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "a992161a-0196-4b7d-bd6a-a735524b5460",
        "parentId" : "5b0296cd-b958-4ed4-9030-cfefcd1535dd",
        "authorId" : "28d581bb-a398-46f0-861f-a016fdb56186",
        "body" : "thanks for reviewing. updated.",
        "createdAt" : "2019-10-30T13:45:09Z",
        "updatedAt" : "2019-10-31T03:16:28Z",
        "lastEditedBy" : "28d581bb-a398-46f0-861f-a016fdb56186",
        "tags" : [
        ]
      }
    ],
    "commit" : "a3d14c83de89775e5bba7f5a94cc2101dacbe9bb",
    "line" : 18,
    "diffHunk" : "@@ -1,1 +604,608 @@        # reuse.\n        TaskContext._setTaskContext(None)\n        BarrierTaskContext._setTaskContext(None)\n    except Exception:\n        try:"
  }
]