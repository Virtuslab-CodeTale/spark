[
  {
    "id" : "aa8e871d-56a4-4037-bc13-341d757f868a",
    "prId" : 32026,
    "prUrl" : "https://github.com/apache/spark/pull/32026#pullrequestreview-626791568",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b71da49c-13c9-4334-8428-7134fa1b7cb2",
        "parentId" : null,
        "authorId" : "4a97d995-edb8-416d-ba1b-29e030885f7e",
        "body" : "In the original PR, there is a new UDT of which the sqlType is a structtype, instead of `ArrayType` here for `ExamplePoint`.   Should we also test that?\r\n\r\nAlso , is it possible a UDT's sqlTypes are primitive types? might want to add them in tests as well.",
        "createdAt" : "2021-04-01T16:12:39Z",
        "updatedAt" : "2021-04-24T07:13:10Z",
        "lastEditedBy" : "4a97d995-edb8-416d-ba1b-29e030885f7e",
        "tags" : [
        ]
      },
      {
        "id" : "adee968c-7555-44e3-be70-df1a4ca3fecc",
        "parentId" : "b71da49c-13c9-4334-8428-7134fa1b7cb2",
        "authorId" : "f6398a50-7f9b-4c64-9d3a-f384404338b3",
        "body" : "See `_deserialize_pandas_with_udt`, support for StructType is postponed in later PRs. ",
        "createdAt" : "2021-04-02T02:06:37Z",
        "updatedAt" : "2021-04-24T07:13:10Z",
        "lastEditedBy" : "f6398a50-7f9b-4c64-9d3a-f384404338b3",
        "tags" : [
        ]
      },
      {
        "id" : "b543ebcc-a201-4dce-b731-747f81d20ba8",
        "parentId" : "b71da49c-13c9-4334-8428-7134fa1b7cb2",
        "authorId" : "f6398a50-7f9b-4c64-9d3a-f384404338b3",
        "body" : "I thought udt is for complex datatype. For udt which is actually primitive typeï¼Œlet me add unit tests.",
        "createdAt" : "2021-04-02T02:20:30Z",
        "updatedAt" : "2021-04-24T07:13:10Z",
        "lastEditedBy" : "f6398a50-7f9b-4c64-9d3a-f384404338b3",
        "tags" : [
        ]
      },
      {
        "id" : "8a303310-7382-49ef-97c7-8effadfab444",
        "parentId" : "b71da49c-13c9-4334-8428-7134fa1b7cb2",
        "authorId" : "f6398a50-7f9b-4c64-9d3a-f384404338b3",
        "body" : "For primitive data type, it is not a good practice to wrap it in UDT. As a result, I do not think we should spend too much time on support UDT which is actually primitive data type. This part can be postponed.",
        "createdAt" : "2021-04-02T05:16:39Z",
        "updatedAt" : "2021-04-24T07:13:10Z",
        "lastEditedBy" : "f6398a50-7f9b-4c64-9d3a-f384404338b3",
        "tags" : [
        ]
      }
    ],
    "commit" : "5845ee2419515b9243ea4396005f731eb294b6a9",
    "line" : 28,
    "diffHunk" : "@@ -1,1 +212,216 @@    def test_array_udt_roundtrip(self):\n        pdf = pd.DataFrame({'points': pd.Series([\n            [ExamplePoint(1.0, 1.0), ExamplePoint(1.0, 2.0), ExamplePoint(1.0, 3.0)],\n            [ExamplePoint(2.0, 1.0), ExamplePoint(2.0, 2.0), ExamplePoint(2.0, 3.0)]\n        ])})"
  },
  {
    "id" : "55eb7f7c-308f-4cf3-9d1d-9f436c72fa79",
    "prId" : 29951,
    "prUrl" : "https://github.com/apache/spark/pull/29951#pullrequestreview-502641435",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f87b18d3-407c-443b-aad0-eb640cf03800",
        "parentId" : null,
        "authorId" : "0c293c45-22a6-4358-8a40-adbf7c470575",
        "body" : "The error here is a `TypeError`, but in case it gets changed to an `ArrowInvalid`, we do not want to have the original error chained because the assert does not include it when checking",
        "createdAt" : "2020-10-06T07:10:40Z",
        "updatedAt" : "2020-10-06T07:10:41Z",
        "lastEditedBy" : "0c293c45-22a6-4358-8a40-adbf7c470575",
        "tags" : [
        ]
      }
    ],
    "commit" : "e7a09e9dce49f6246957cb1965c26dbe846acbe8",
    "line" : 10,
    "diffHunk" : "@@ -1,1 +267,271 @@        fields[5], fields[6] = fields[6], fields[5]  # swap decimal with date\n        wrong_schema = StructType(fields)\n        with self.sql_conf({\"spark.sql.execution.pandas.convertToArrowArraySafely\": False}):\n            with QuietTest(self.sc):\n                with self.assertRaisesRegexp(Exception, \"[D|d]ecimal.*got.*date\"):"
  }
]