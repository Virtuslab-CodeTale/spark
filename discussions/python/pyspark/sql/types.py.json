[
  {
    "id" : "eb24461f-04d4-4d9f-80f2-bf5edc9da2b6",
    "prId" : 33214,
    "prUrl" : "https://github.com/apache/spark/pull/33214#pullrequestreview-700519288",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "bbe08729-7044-4bc1-99b3-f7de6cc3b20f",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Do we need to log warning if inferred value types are not inconsistent? We can recommend users to use the config.",
        "createdAt" : "2021-07-07T01:11:35Z",
        "updatedAt" : "2021-07-07T01:12:16Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "7b233d5e-2ce5-4f6a-b70a-92bb63e97531",
        "parentId" : "bbe08729-7044-4bc1-99b3-f7de6cc3b20f",
        "authorId" : "2d8ced12-ada1-43e1-9240-bf1c11a01e4c",
        "body" : "Thanks for the comment! :)\r\nActually PySpark merging one only handles null cases only (that's called out here) at \r\nhttps://github.com/apache/spark/blob/52a9a70fa3e5b720b41e2ff4e9177a5d201b471f/python/pyspark/sql/types.py#L1096-L1133\r\n\r\nIt actually fails for different types (unlike JSON or CSV type inference).\r\nI am not sure what's the ideal behavior for the null case pointed out here though.\r\nLet me separate it from this PR in any event if you're fine.",
        "createdAt" : "2021-07-07T02:20:47Z",
        "updatedAt" : "2021-07-07T02:20:47Z",
        "lastEditedBy" : "2d8ced12-ada1-43e1-9240-bf1c11a01e4c",
        "tags" : [
        ]
      }
    ],
    "commit" : "52a9a70fa3e5b720b41e2ff4e9177a5d201b471f",
    "line" : 28,
    "diffHunk" : "@@ -1,1 +1032,1036 @@                    return MapType(_infer_type(key, infer_dict_as_struct),\n                                   _infer_type(value, infer_dict_as_struct), True)\n            return MapType(NullType(), NullType(), True)\n    elif isinstance(obj, list):\n        for v in obj:"
  }
]