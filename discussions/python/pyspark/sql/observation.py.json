[
  {
    "id" : "128f0816-6f6b-405d-b1c5-e9db2314ccda",
    "prId" : 33545,
    "prUrl" : "https://github.com/apache/spark/pull/33545#pullrequestreview-718086151",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "93e5fa2f-4f31-4d42-90ef-69d163deb2de",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "can you actually directly return `self._jo.getAsJavaMap()`. That becomes a plain dictionary IIRC.",
        "createdAt" : "2021-07-29T10:31:43Z",
        "updatedAt" : "2021-07-29T10:39:02Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "e5fbf844-1ee6-4c44-bab3-7bb77b49c142",
        "parentId" : "93e5fa2f-4f31-4d42-90ef-69d163deb2de",
        "authorId" : "c4ecf4e4-1fda-4fed-9980-aed6c3b3e8e4",
        "body" : "no, that is a JavaMap, a py4j implementation of dict that syncs changes of the Python dict back to the Java map inside the jvm",
        "createdAt" : "2021-07-29T13:13:17Z",
        "updatedAt" : "2021-07-29T13:13:18Z",
        "lastEditedBy" : "c4ecf4e4-1fda-4fed-9980-aed6c3b3e8e4",
        "tags" : [
        ]
      },
      {
        "id" : "a27007cb-a19c-4ffb-908f-da0b0760c679",
        "parentId" : "93e5fa2f-4f31-4d42-90ef-69d163deb2de",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "ðŸ‘Œ ",
        "createdAt" : "2021-07-29T13:22:50Z",
        "updatedAt" : "2021-07-29T13:22:51Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "80e35d94c545dc1f03a70107467c3e92b3d19e29",
    "line" : 39,
    "diffHunk" : "@@ -1,1 +121,125 @@        jmap = self._jo.getAsJava()\n        # return a pure Python dict, not jmap which is a py4j JavaMap\n        return {k: v for k, v in jmap.items()}\n\n"
  },
  {
    "id" : "aa6a3e97-55a7-4180-b8e5-fd324541836f",
    "prId" : 33484,
    "prUrl" : "https://github.com/apache/spark/pull/33484#pullrequestreview-714382055",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "be5c68cc-5139-4a90-b564-5ab2059ca52e",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "can we keep the same signature as Scala side? e.g.) `_on(self, df, expr, *exprs)` to disallow empty expr",
        "createdAt" : "2021-07-25T01:56:47Z",
        "updatedAt" : "2021-07-25T01:56:47Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "fcee67df-0de2-4bab-8ceb-620a7f6f282a",
        "parentId" : "be5c68cc-5139-4a90-b564-5ab2059ca52e",
        "authorId" : "c4ecf4e4-1fda-4fed-9980-aed6c3b3e8e4",
        "body" : "The method tests for empty exprs, but the Scala signature checks this on compile time, which is better.\r\n\r\nI have aligned that with existing `agg` method, which has a single `exprs` and checks for non-emptiness.\r\n\r\nDo you still say to mimic the Scala signature? Would you even say DataFrame.agg should do the same? I could draft another PR to fix that for agg if you let me. That shouldn't break python user code, right?",
        "createdAt" : "2021-07-25T10:27:58Z",
        "updatedAt" : "2021-07-25T10:27:58Z",
        "lastEditedBy" : "c4ecf4e4-1fda-4fed-9980-aed6c3b3e8e4",
        "tags" : [
        ]
      },
      {
        "id" : "306f1478-505c-46b7-903d-275a93cb5fdb",
        "parentId" : "be5c68cc-5139-4a90-b564-5ab2059ca52e",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Hm, okay. let's leave it as is for now.",
        "createdAt" : "2021-07-26T01:31:55Z",
        "updatedAt" : "2021-07-26T01:31:55Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "90675b0d300a299a047f97274e9d0814b2366a37",
    "line" : 79,
    "diffHunk" : "@@ -1,1 +77,81 @@        self._jo = None\n\n    def _on(self, df, *exprs):\n        \"\"\"Attaches this observation to the given :class:`DataFrame` to observe aggregations.\n"
  },
  {
    "id" : "79ffcaa0-60a7-401a-9333-929c11ee12e4",
    "prId" : 33484,
    "prUrl" : "https://github.com/apache/spark/pull/33484#pullrequestreview-714477299",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "96d9dc82-5e53-4a34-924c-ceb576dbc4f4",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "@cloud-fan @EnricoMi @hvanhovell, shall we return a Map instead?",
        "createdAt" : "2021-07-25T01:59:19Z",
        "updatedAt" : "2021-07-25T01:59:19Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "a2a93cef-ac08-461e-b234-09261060e58a",
        "parentId" : "96d9dc82-5e53-4a34-924c-ceb576dbc4f4",
        "authorId" : "c4ecf4e4-1fda-4fed-9980-aed6c3b3e8e4",
        "body" : "I think if we move this to a Map, than it should be the same in Scala and Java. And there should be a getAsJavaMap then to avoid something like this in Java:\r\n\r\n    JavaConverters.mapAsJavaMap(observation.get());",
        "createdAt" : "2021-07-25T10:39:52Z",
        "updatedAt" : "2021-07-25T10:40:19Z",
        "lastEditedBy" : "c4ecf4e4-1fda-4fed-9980-aed6c3b3e8e4",
        "tags" : [
        ]
      },
      {
        "id" : "996795ba-9f0c-4676-92ae-17bd54d708bd",
        "parentId" : "96d9dc82-5e53-4a34-924c-ceb576dbc4f4",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Yeah, I think we might need to just return a map. I'll merge this PR as is for now but would you mind creating a followup PR to return a map please?",
        "createdAt" : "2021-07-26T01:32:35Z",
        "updatedAt" : "2021-07-26T01:32:35Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "f7d7f067-32b8-41e2-ad96-430a9a559b77",
        "parentId" : "96d9dc82-5e53-4a34-924c-ceb576dbc4f4",
        "authorId" : "c4ecf4e4-1fda-4fed-9980-aed6c3b3e8e4",
        "body" : "Yes, this would touch unrelated code and with a followup PR we can keep this possibly controversial change separated. Will do.",
        "createdAt" : "2021-07-26T06:18:44Z",
        "updatedAt" : "2021-07-26T06:18:44Z",
        "lastEditedBy" : "c4ecf4e4-1fda-4fed-9980-aed6c3b3e8e4",
        "tags" : [
        ]
      }
    ],
    "commit" : "90675b0d300a299a047f97274e9d0814b2366a37",
    "line" : 115,
    "diffHunk" : "@@ -1,1 +113,117 @@        Returns\n        -------\n        :class:`Row`\n            the observed metrics\n        \"\"\""
  }
]