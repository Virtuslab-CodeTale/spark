[
  {
    "id" : "4602215d-e65c-42ae-99d1-ff90ff25aa41",
    "prId" : 30248,
    "prUrl" : "https://github.com/apache/spark/pull/30248#pullrequestreview-526965650",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e587125e-9dc6-4b46-844d-91c833b66b74",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Can you add a short description with JIRA id? See \"Pull Request\" in http://spark.apache.org/contributing.html",
        "createdAt" : "2020-11-10T03:43:40Z",
        "updatedAt" : "2020-11-10T08:53:29Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "38ba2062-39b8-41c5-bc26-43d26b27fe4f",
        "parentId" : "e587125e-9dc6-4b46-844d-91c833b66b74",
        "authorId" : "de37844d-d6ad-4742-9b26-373261f5169e",
        "body" : "updated",
        "createdAt" : "2020-11-10T08:37:12Z",
        "updatedAt" : "2020-11-10T08:53:29Z",
        "lastEditedBy" : "de37844d-d6ad-4742-9b26-373261f5169e",
        "tags" : [
        ]
      }
    ],
    "commit" : "e5c33f0b28e58110de04e9dbc6e1d75bc59d53f0",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +96,100 @@        self.assertEqual(100, rdd.map(str).count())\n\n    def test_after_non_exception_error(self):\n        # SPARK-33339: Pyspark application will hang due to non Exception\n        def raise_system_exit(_):"
  },
  {
    "id" : "f4a28025-ab19-4292-8e5a-40914dabbede",
    "prId" : 27158,
    "prUrl" : "https://github.com/apache/spark/pull/27158#pullrequestreview-340923963",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2b92b0af-0630-4d10-b8d4-b198d6983d37",
        "parentId" : null,
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "The only other thing I can think of is that this toy memory limit is too low. What if it were 8m or something? if you feel like it you could try testing that too",
        "createdAt" : "2020-01-10T01:55:31Z",
        "updatedAt" : "2020-01-10T02:08:47Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "0993d5b7-24ca-4497-bb77-d698e581c6f2",
        "parentId" : "2b92b0af-0630-4d10-b8d4-b198d6983d37",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "The odd thing is that it passes with local dev. (MacOS, python3 - 3.7.4/python2 - 2.7.10/pypy - Python 2.7.13 & pypy 7.3.0 GCC 4.2.1) so not clear it would help, but if we suspect it we can try.",
        "createdAt" : "2020-01-10T01:57:51Z",
        "updatedAt" : "2020-01-10T02:08:47Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      },
      {
        "id" : "6713fba1-aadf-45db-b549-6c2e2e876889",
        "parentId" : "2b92b0af-0630-4d10-b8d4-b198d6983d37",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "It will pass on Mac OS because Mac doesn't actually limits the memory. it doesn't work on Windows either. So, this hypothesis could make sense. Can we increase to something like 8m?",
        "createdAt" : "2020-01-10T02:00:27Z",
        "updatedAt" : "2020-01-10T02:08:47Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "5e3c7a03-73bf-4031-87f6-aae210e83092",
        "parentId" : "2b92b0af-0630-4d10-b8d4-b198d6983d37",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "OK let me do it instead. Let's modify the PR title/description after confirming it works.",
        "createdAt" : "2020-01-10T02:02:43Z",
        "updatedAt" : "2020-01-10T02:08:47Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      },
      {
        "id" : "4f12432b-82b5-43c8-bac4-ce45121917e3",
        "parentId" : "2b92b0af-0630-4d10-b8d4-b198d6983d37",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Maybe it's best to file a JIRA btw.",
        "createdAt" : "2020-01-10T02:06:06Z",
        "updatedAt" : "2020-01-10T02:08:47Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "9455b63c-ffc7-4239-a264-414e16423281",
        "parentId" : "2b92b0af-0630-4d10-b8d4-b198d6983d37",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "What about filing an issue after confirming the trick doesn't work and we have to disable? We may be able to just treat this PR as MINOR but mentioning the new JIRA issue in \"reason\" which is expected to address this.",
        "createdAt" : "2020-01-10T02:12:48Z",
        "updatedAt" : "2020-01-10T02:12:48Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      },
      {
        "id" : "c174a069-d07a-4f83-96cc-c0192715c0f4",
        "parentId" : "2b92b0af-0630-4d10-b8d4-b198d6983d37",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Sure, that works too. FWIW, I doubt if it consistently fails in the master yet. If that's the case, it should better fix the test here.",
        "createdAt" : "2020-01-10T02:16:18Z",
        "updatedAt" : "2020-01-10T02:16:18Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "fb403cdf-4348-4895-9dd6-96f5a31af449",
        "parentId" : "2b92b0af-0630-4d10-b8d4-b198d6983d37",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "FYI #27159 is the patch increasing the value to 8m",
        "createdAt" : "2020-01-10T02:19:31Z",
        "updatedAt" : "2020-01-10T02:19:31Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      }
    ],
    "commit" : "23ad40bbe874fcd99e13a4911622a9d63e40ee0f",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +184,188 @@    @unittest.skip(\"disabled temporarily since it's failing consistently\")\n    def test_memory_limit(self):\n        self.sc._conf.set(\"spark.executor.pyspark.memory\", \"1m\")\n        rdd = self.sc.parallelize(xrange(1), 1)\n"
  },
  {
    "id" : "5224883e-fb8a-4793-9542-c851df8e0369",
    "prId" : 25847,
    "prUrl" : "https://github.com/apache/spark/pull/25847#pullrequestreview-290420481",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b67670d2-4954-442e-913f-ff57c6b8f1cc",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Can we actually just run this code, catch the exception and check the error message simply?",
        "createdAt" : "2019-09-19T08:17:30Z",
        "updatedAt" : "2019-09-20T15:17:44Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "7858b90b-a20d-476e-8bd9-cb9d40dc6e4d",
        "parentId" : "b67670d2-4954-442e-913f-ff57c6b8f1cc",
        "authorId" : "8e87861a-4202-49a2-baf7-6d51f6aaa5a2",
        "body" : "After the patch to worker, we may simply run this code in the main thread. But it will hanging \r\nforever without the patch. \r\n\r\nI am prefer this way to indicate that we actually fix the hanging. ",
        "createdAt" : "2019-09-19T08:39:43Z",
        "updatedAt" : "2019-09-20T15:17:44Z",
        "lastEditedBy" : "8e87861a-4202-49a2-baf7-6d51f6aaa5a2",
        "tags" : [
        ]
      },
      {
        "id" : "e3ab0388-14f6-4437-b286-f2d132144da6",
        "parentId" : "b67670d2-4954-442e-913f-ff57c6b8f1cc",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Let's just test directly without a thread. Actually indefinitely hanging is another issue that the exception thrown during exception handling is not dealt with.",
        "createdAt" : "2019-09-19T09:02:30Z",
        "updatedAt" : "2019-09-20T15:17:44Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "d6ec7aebcb0c1a2bda41a8b6a7b80ec670ff5bdb",
    "line" : 15,
    "diffHunk" : "@@ -1,1 +158,162 @@                raise Exception(\"exception with 中 and \\xd6\\xd0\")\n\n            self.sc.parallelize([1]).map(lambda x: f()).count()\n        except Py4JJavaError as e:\n            if sys.version_info.major < 3:"
  },
  {
    "id" : "8b2e2d19-626b-40af-9641-fc58c6513f90",
    "prId" : 25847,
    "prUrl" : "https://github.com/apache/spark/pull/25847#pullrequestreview-290909444",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d578a626-137f-456e-b3a6-c44844a38885",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "do not we need to do `unicode = str` in test_worker.py? ",
        "createdAt" : "2019-09-19T18:39:27Z",
        "updatedAt" : "2019-09-20T15:17:44Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "def24bb6-c26b-4b5f-aecc-015e624c167a",
        "parentId" : "d578a626-137f-456e-b3a6-c44844a38885",
        "authorId" : "8e87861a-4202-49a2-baf7-6d51f6aaa5a2",
        "body" : "I ran dev/lint-python on my local machine, check passes, flake8 doesn't complain this one.  Not sure how it works. \r\n\r\nLet me push a new one for add `unicode = str` in test_worker.py?",
        "createdAt" : "2019-09-19T23:44:47Z",
        "updatedAt" : "2019-09-20T15:17:44Z",
        "lastEditedBy" : "8e87861a-4202-49a2-baf7-6d51f6aaa5a2",
        "tags" : [
        ]
      },
      {
        "id" : "c801a3f9-635b-4530-b99b-1fc471bd08a5",
        "parentId" : "d578a626-137f-456e-b3a6-c44844a38885",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Are you sure your local flake8 runs with Python3?",
        "createdAt" : "2019-09-19T23:47:38Z",
        "updatedAt" : "2019-09-20T15:17:44Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "53d95468-290b-4e9a-a91b-455e7aed62d8",
        "parentId" : "d578a626-137f-456e-b3a6-c44844a38885",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "I just copied the change in test_worker.py and run dev/lint-python:\r\n\r\n```\r\ndev/lint-python \r\nstarting python compilation test...\r\npython compilation succeeded.\r\n\r\ndownloading pycodestyle from https://raw.githubusercontent.com/PyCQA/pycodestyle/2.4.0/pycodestyle.py...\r\nstarting pycodestyle test...\r\npycodestyle checks passed.\r\n\r\nstarting flake8 test...\r\nflake8 checks failed:\r\n./python/pyspark/sql/utils.py:31:60: F821 undefined name 'unicode'\r\n        if sys.version_info.major < 3 and isinstance(desc, unicode):\r\n                                                           ^\r\n1     F821 undefined name 'unicode'\r\n1\r\n1\r\n```",
        "createdAt" : "2019-09-19T23:53:20Z",
        "updatedAt" : "2019-09-20T15:17:44Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "bea7d19a-0fcc-43ba-b88e-ebe15e1962ed",
        "parentId" : "d578a626-137f-456e-b3a6-c44844a38885",
        "authorId" : "8e87861a-4202-49a2-baf7-6d51f6aaa5a2",
        "body" : "Yes it fails only at utils.py not test_worker.py",
        "createdAt" : "2019-09-20T00:11:37Z",
        "updatedAt" : "2019-09-20T15:17:44Z",
        "lastEditedBy" : "8e87861a-4202-49a2-baf7-6d51f6aaa5a2",
        "tags" : [
        ]
      },
      {
        "id" : "af3320b9-a348-4b3f-be49-fb0f07da1de7",
        "parentId" : "d578a626-137f-456e-b3a6-c44844a38885",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Oh, interesting.\r\n\r\nFor test_worker.py, it reports:\r\n\r\n```\r\npython/pyspark/tests/test_worker.py:162:73: F405 'unicode' may be undefined, or defined from star imports: pyspark.tests.test_worker\r\n```\r\nThat is just warning. So it is fine.",
        "createdAt" : "2019-09-20T00:45:54Z",
        "updatedAt" : "2019-09-20T15:17:44Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "d6ec7aebcb0c1a2bda41a8b6a7b80ec670ff5bdb",
    "line" : 19,
    "diffHunk" : "@@ -1,1 +162,166 @@            if sys.version_info.major < 3:\n                # we have to use unicode here to avoid UnicodeDecodeError\n                self.assertRegexpMatches(unicode(e).encode(\"utf-8\"), \"exception with 中\")\n            else:\n                self.assertRegexpMatches(str(e), \"exception with 中\")"
  }
]