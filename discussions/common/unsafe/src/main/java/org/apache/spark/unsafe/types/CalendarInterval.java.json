[
  {
    "id" : "4ad4eece-0e89-424f-8ff7-42d3bfb52a1d",
    "prId" : 27299,
    "prUrl" : "https://github.com/apache/spark/pull/27299#pullrequestreview-351331737",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a7766ec2-cdfb-4bc6-9c60-73b7e9706916",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "BTW, are we going to expose this as an API? Technically, this is under internal package which isn't documented:\r\nhttps://github.com/apache/spark/blob/master/project/SparkBuild.scala#L828",
        "createdAt" : "2020-01-31T06:27:04Z",
        "updatedAt" : "2020-01-31T06:27:04Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "ee75280b-f5c5-4ee8-a737-b584a83de3ef",
        "parentId" : "a7766ec2-cdfb-4bc6-9c60-73b7e9706916",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Let me open a PR after a quick test.",
        "createdAt" : "2020-01-31T06:31:39Z",
        "updatedAt" : "2020-01-31T06:31:40Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "1fbcda31-db30-4049-b25f-bd8dbff1e948",
        "parentId" : "a7766ec2-cdfb-4bc6-9c60-73b7e9706916",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "+1",
        "createdAt" : "2020-01-31T07:34:41Z",
        "updatedAt" : "2020-01-31T07:34:41Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "275f8e6c477fc6d75be61664fca574008d19ea72",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +44,48 @@ * @since 3.0.0\n */\n@Unstable\npublic final class CalendarInterval implements Serializable {\n  public final int months;"
  },
  {
    "id" : "94ebd754-f938-42e7-b7fd-ae251d391a36",
    "prId" : 27262,
    "prUrl" : "https://github.com/apache/spark/pull/27262#pullrequestreview-344578636",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "464ec91b-d6a8-4d5a-b64e-d74818f403ee",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "there is a `MAX_VALUE` and `MIN_VALUE` in this file, shall we remove them as well?",
        "createdAt" : "2020-01-17T12:03:12Z",
        "updatedAt" : "2020-01-17T15:37:54Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "7f465338-748f-4f0d-9095-f2ec3c2a4f8a",
        "parentId" : "464ec91b-d6a8-4d5a-b64e-d74818f403ee",
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "yes, remove them too",
        "createdAt" : "2020-01-17T13:33:07Z",
        "updatedAt" : "2020-01-17T15:37:54Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      }
    ],
    "commit" : "a44e1576b5ec794649d4a77f2d7e55d733bdcd70",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +30,34 @@ * The internal representation of interval type.\n */\npublic final class CalendarInterval implements Serializable {\n  public final int months;\n  public final int days;"
  },
  {
    "id" : "8e21fe23-f746-4f41-87a1-100bab5fd074",
    "prId" : 27258,
    "prUrl" : "https://github.com/apache/spark/pull/27258#pullrequestreview-345609377",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "82a58871-23a9-495c-81bf-2320a66770de",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Just a question: @cloud-fan .\r\nAlthough this is technically correct, if this is going to **public**  in `3.00`, `@since 3.0.0` is better?",
        "createdAt" : "2020-01-20T04:59:49Z",
        "updatedAt" : "2020-01-20T04:59:49Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "f1d77f37-7e41-4b6c-bb4c-df4eea4de4d0",
        "parentId" : "82a58871-23a9-495c-81bf-2320a66770de",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "If this is `1.5.0`, people will get confused and may try to use it 2.4.x.",
        "createdAt" : "2020-01-20T05:01:01Z",
        "updatedAt" : "2020-01-20T05:01:02Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "338a772e-fa7f-40fb-8e04-89eb4a01a283",
        "parentId" : "82a58871-23a9-495c-81bf-2320a66770de",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "cc @gatorsmile , too.",
        "createdAt" : "2020-01-20T05:01:12Z",
        "updatedAt" : "2020-01-20T05:01:13Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "81f94ed9-7170-477d-9b05-c7d10eee3102",
        "parentId" : "82a58871-23a9-495c-81bf-2320a66770de",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "this is a good point. Do we have a clear rule about how to decide the since version. To me 3.0 is better here, as we've changed this class a lot in 3.0.",
        "createdAt" : "2020-01-20T06:53:26Z",
        "updatedAt" : "2020-01-20T06:53:26Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "fee1c734-6d7b-4363-b494-02b6e1f5b690",
        "parentId" : "82a58871-23a9-495c-81bf-2320a66770de",
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "checked the java doc about since https://www.oracle.com/technetwork/java/javase/documentation/index-137868.html#@since\r\n\r\n>When a class (or interface) is introduced, specify one since tag in its class description and no since tags in the members. Add a since tag only to members added in a later version than the class. ...\r\n\r\n\r\n> If a member changes from protected to public in a later release, the since tag would not change, even though it is now usable by any caller, not just subclassers. \r\n\r\n`1.5.0` should be fine I guess",
        "createdAt" : "2020-01-20T11:36:19Z",
        "updatedAt" : "2020-01-20T11:36:19Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      },
      {
        "id" : "562c9f5e-1dfd-46ac-ae12-5e887b12e942",
        "parentId" : "82a58871-23a9-495c-81bf-2320a66770de",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "> ... the since tag would not change ...\r\n\r\nThis is different from what we are facing here. We are adding a since tag. not changing an existing one.",
        "createdAt" : "2020-01-20T13:48:27Z",
        "updatedAt" : "2020-01-20T13:48:28Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "0354c7af-244f-433e-8721-edc545843edb",
        "parentId" : "82a58871-23a9-495c-81bf-2320a66770de",
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "raise a followup to fix this https://github.com/apache/spark/pull/27299, thanks @dongjoon-hyun @cloud-fan ",
        "createdAt" : "2020-01-21T02:46:52Z",
        "updatedAt" : "2020-01-21T02:46:53Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      }
    ],
    "commit" : "d9b85ffee212da30d69115be9ad4f8933b39575b",
    "line" : 26,
    "diffHunk" : "@@ -1,1 +42,46 @@ * and one day may be equal to 23, 24 or 25 hours (daylight saving).\n *\n * @since 1.5.0\n */\n@Unstable"
  },
  {
    "id" : "df11d326-7d7d-4ce4-99a5-84efb0c8b264",
    "prId" : 26418,
    "prUrl" : "https://github.com/apache/spark/pull/26418#pullrequestreview-318179667",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5a273108-6dc3-4ff8-86ec-5bb043d039f9",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Why did we use such string representation now? Was it in order to put the same logics into `IntervalUtils`? If that's the case, we didn't have to move but use `toString` of this class until this case becomes completely exposed.",
        "createdAt" : "2019-11-18T09:06:13Z",
        "updatedAt" : "2019-11-18T09:06:13Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "0f54af89b8641ee7df80991dcca63e183a03d5ff",
    "line" : 46,
    "diffHunk" : "@@ -1,1 +81,85 @@  public String toString() {\n    return \"CalendarInterval(months= \" + months + \", days = \" + days + \", microsecond = \" +\n      microseconds + \")\";\n  }\n"
  },
  {
    "id" : "5cfe6e06-aae1-4e37-80aa-1444161933d5",
    "prId" : 26401,
    "prUrl" : "https://github.com/apache/spark/pull/26401#pullrequestreview-311953008",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7ad22b52-5b53-4fdd-925e-4c6f23ee07ce",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Not important but you could leave the code as is, and just do `trim()` on the result.",
        "createdAt" : "2019-11-05T18:40:34Z",
        "updatedAt" : "2019-11-07T04:55:24Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "c1f3473c4959bd6a686da11eb5cc92a32c9c7019",
    "line" : 39,
    "diffHunk" : "@@ -1,1 +111,115 @@\n    sb.setLength(sb.length() - 1);\n    return sb.toString();\n  }\n"
  },
  {
    "id" : "49b8348a-f38b-4ca5-8595-db53c94d42dc",
    "prId" : 26401,
    "prUrl" : "https://github.com/apache/spark/pull/26401#pullrequestreview-311953008",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "722c8cf1-63e1-4989-9251-20bc1dfdcdd1",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "If we always add \"s \" to the end of units, maybe just pass units with \"s \"? I mean `\"year \"`, `\"month \"`, `\"day \"` ...",
        "createdAt" : "2019-11-05T18:43:21Z",
        "updatedAt" : "2019-11-07T04:55:24Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "c1f3473c4959bd6a686da11eb5cc92a32c9c7019",
    "line" : 42,
    "diffHunk" : "@@ -1,1 +114,118 @@  }\n\n  private void appendUnit(StringBuilder sb, long value, String unit) {\n    if (value != 0) {\n      sb.append(value).append(' ').append(unit).append(' ');"
  },
  {
    "id" : "4a134e3d-c17f-4339-9047-53f620b5c9d8",
    "prId" : 26337,
    "prUrl" : "https://github.com/apache/spark/pull/26337#pullrequestreview-311479393",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "62287c6c-676b-48e4-9660-0b54ba788cf2",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "we can just return `daysDiff` if it's non-zero. The `Ordered` doesn't force us to return 1 or -1.",
        "createdAt" : "2019-11-05T02:52:43Z",
        "updatedAt" : "2019-11-08T11:06:56Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "d90f3ad2-e235-4aee-8f66-54bb7be6ca40",
        "parentId" : "62287c6c-676b-48e4-9660-0b54ba788cf2",
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "the adjusted days might be long here",
        "createdAt" : "2019-11-05T02:56:28Z",
        "updatedAt" : "2019-11-08T11:06:56Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      },
      {
        "id" : "4f7d9a2e-66d6-413e-a23f-136b7acd4db5",
        "parentId" : "62287c6c-676b-48e4-9660-0b54ba788cf2",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "ah i see",
        "createdAt" : "2019-11-05T02:58:34Z",
        "updatedAt" : "2019-11-08T11:06:56Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "5404d701d702e9308ca91f354aa5304d7beac789",
    "line" : 29,
    "diffHunk" : "@@ -1,1 +72,76 @@        return -1;\n      }\n    } else if (daysDiff > 0){\n      return 1;\n    } else {"
  },
  {
    "id" : "0c81d374-0cb5-4c71-af8a-21ab26dd5a5a",
    "prId" : 26337,
    "prUrl" : "https://github.com/apache/spark/pull/26337#pullrequestreview-311478149",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "1e8f53aa-2c3a-45e7-8db4-9716db9d92a3",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "ditto",
        "createdAt" : "2019-11-05T02:52:50Z",
        "updatedAt" : "2019-11-08T11:06:56Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "5404d701d702e9308ca91f354aa5304d7beac789",
    "line" : 24,
    "diffHunk" : "@@ -1,1 +67,71 @@      if (msDiff == 0) {\n        return 0;\n      } else if (msDiff > 0) {\n        return 1;\n      } else {"
  },
  {
    "id" : "ff2a2714-9a51-4e60-8bf8-8246ebbbb922",
    "prId" : 26190,
    "prUrl" : "https://github.com/apache/spark/pull/26190#pullrequestreview-304572735",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "febc7eec-75b6-4814-b900-8d63fc9b7e1c",
        "parentId" : null,
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "Does this end up changing the parsing logic at all? for example I note this doesn't match quotes anymore",
        "createdAt" : "2019-10-21T13:32:12Z",
        "updatedAt" : "2019-10-24T05:40:30Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "d7646687-438b-4e15-90ee-680d7215c26c",
        "parentId" : "febc7eec-75b6-4814-b900-8d63fc9b7e1c",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "It's simplified but not changed. Now antlr parser strips the quotes: https://github.com/apache/spark/pull/26190/files#diff-9847f5cef7cf7fbc5830fbc6b779ee10R1978",
        "createdAt" : "2019-10-21T13:46:25Z",
        "updatedAt" : "2019-10-24T05:40:30Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "48b7ef4c42c2bf98ffda16e77e2ef10bd78f5d9f",
    "line" : 94,
    "diffHunk" : "@@ -1,1 +37,41 @@\n  private static Pattern dayTimePattern = Pattern.compile(\n    \"^([+|-])?((\\\\d+) )?((\\\\d+):)?(\\\\d+):(\\\\d+)(\\\\.(\\\\d+))?$\");\n\n  public static long toLongWithRange(String fieldName,"
  },
  {
    "id" : "3d15f578-2f78-46d3-9fb6-675db7e04195",
    "prId" : 26190,
    "prUrl" : "https://github.com/apache/spark/pull/26190#pullrequestreview-305678175",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "46c92f5d-0181-4f9b-a7d6-8af413cf0f0b",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Maybe, throw an exception if `s == null` instead of to return `null`?",
        "createdAt" : "2019-10-23T06:33:02Z",
        "updatedAt" : "2019-10-24T05:40:30Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "f4f0c6cb-6907-4c25-ad4d-24e21be29e06",
        "parentId" : "46c92f5d-0181-4f9b-a7d6-8af413cf0f0b",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "maybe it's better, but I'd like to avoid changing unrelated code.",
        "createdAt" : "2019-10-23T07:22:54Z",
        "updatedAt" : "2019-10-24T05:40:30Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "48b7ef4c42c2bf98ffda16e77e2ef10bd78f5d9f",
    "line" : 96,
    "diffHunk" : "@@ -1,1 +39,43 @@    \"^([+|-])?((\\\\d+) )?((\\\\d+):)?(\\\\d+):(\\\\d+)(\\\\.(\\\\d+))?$\");\n\n  public static long toLongWithRange(String fieldName,\n      String s, long minValue, long maxValue) throws IllegalArgumentException {\n    long result = 0;"
  },
  {
    "id" : "012824c6-9668-43bd-b30d-d5842d663f03",
    "prId" : 26134,
    "prUrl" : "https://github.com/apache/spark/pull/26134#pullrequestreview-302388375",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0de7aee3-0137-4006-92be-bcefd2db3859",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "The method will return different values because you exclude days from microseconds",
        "createdAt" : "2019-10-16T08:14:10Z",
        "updatedAt" : "2019-11-01T05:44:12Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "2f901894eb24d7deec31947708b9afdaae2a4866",
    "line" : 15,
    "diffHunk" : "@@ -1,1 +36,40 @@  public final long microseconds;\n\n  public long milliseconds() {\n    return this.microseconds / MICROS_PER_MILLI;\n  }"
  },
  {
    "id" : "66ea683b-7769-4c1f-a45b-5a6a3cfb154c",
    "prId" : 26134,
    "prUrl" : "https://github.com/apache/spark/pull/26134#pullrequestreview-323390336",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c8574239-ae51-4ad2-a6da-129d21abce5a",
        "parentId" : null,
        "authorId" : "2d6b46ba-4100-4c4d-9341-fff5e39647ec",
        "body" : "@LinhongLiu Could you send out a follow up PR to document why we need `days` and how do we use it in this file? This is definitely worth to document. Otherwise, everyone reading this class may need to git blame and go through the long discussion in this PR.",
        "createdAt" : "2019-11-26T19:01:55Z",
        "updatedAt" : "2019-11-26T19:01:55Z",
        "lastEditedBy" : "2d6b46ba-4100-4c4d-9341-fff5e39647ec",
        "tags" : [
        ]
      },
      {
        "id" : "db729bb1-f43d-40da-832f-bd3660112016",
        "parentId" : "c8574239-ae51-4ad2-a6da-129d21abce5a",
        "authorId" : "58a5dec8-caad-405f-b8fe-9510071c1cb9",
        "body" : "> @LinhongLiu Could you send out a follow up PR to document why we need `days` and how do we use it in this file? This is definitely worth to document. Otherwise, everyone reading this class may need to git blame and go through the long discussion in this PR.\r\n\r\nSure, will do.",
        "createdAt" : "2019-11-27T02:00:35Z",
        "updatedAt" : "2019-11-27T02:00:35Z",
        "lastEditedBy" : "58a5dec8-caad-405f-b8fe-9510071c1cb9",
        "tags" : [
        ]
      }
    ],
    "commit" : "2f901894eb24d7deec31947708b9afdaae2a4866",
    "line" : 20,
    "diffHunk" : "@@ -1,1 +40,44 @@  }\n\n  public CalendarInterval(int months, int days, long microseconds) {\n    this.months = months;\n    this.days = days;"
  },
  {
    "id" : "41a8f42b-01b1-4a1d-8d67-2674d164f221",
    "prId" : 26079,
    "prUrl" : "https://github.com/apache/spark/pull/26079#pullrequestreview-300044883",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "24468f86-2ae2-4c07-8023-b5acc7e210e1",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Is it the only place we parse interval string? I thought we parse it with antlr parser.",
        "createdAt" : "2019-10-10T11:25:35Z",
        "updatedAt" : "2019-10-12T08:32:17Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "66a68f48-cc90-493b-8e3e-dd5df21754c8",
        "parentId" : "24468f86-2ae2-4c07-8023-b5acc7e210e1",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "antlr parser does this as well but [it parses sql elements](https://github.com/apache/spark/blob/f2ead4d0b50715e3dec79ce762c31f145d46a5b5/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/parser/AstBuilder.scala#L1907-L1961) like\r\n```sql\r\nspark-sql> select interval 10 days 1 second;\r\ninterval 1 weeks 3 days 1 seconds\r\n```\r\nhere is only the place where we parse string values:\r\n```sql\r\nspark-sql> select interval 'interval 10 days 1 second';\r\ninterval 1 weeks 3 days 1 seconds\r\n```",
        "createdAt" : "2019-10-10T11:36:43Z",
        "updatedAt" : "2019-10-12T08:32:17Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "5c04098b-7fd8-4685-aa75-cd641afb0beb",
        "parentId" : "24468f86-2ae2-4c07-8023-b5acc7e210e1",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "This looks duplicated. Shall we add a `parseInterval` method to the `ParserInterface` interface and call the parser here? ",
        "createdAt" : "2019-10-10T11:45:16Z",
        "updatedAt" : "2019-10-12T08:32:17Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "d6d00827-7e1e-49f1-8a39-d0d5f9aa1fc8",
        "parentId" : "24468f86-2ae2-4c07-8023-b5acc7e210e1",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Maybe something has been duplicated, and can be reused but this is heavy refactoring for this PR. \r\n\r\nFor instance, `AstBuilder.visitInterval` gets already split interval units but `CalendarInterval.fromString()` uses regular expression to parse & split: https://github.com/apache/spark/blob/b10344956d672fca495d0684b351ab5cf9f210d8/common/unsafe/src/main/java/org/apache/spark/unsafe/types/CalendarInterval.java#L50-L53\r\n\r\nIf you don't mind, I would try to do that in a separate PR.",
        "createdAt" : "2019-10-10T12:06:35Z",
        "updatedAt" : "2019-10-12T08:32:17Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "faedba3d-d0b6-4f78-8343-81374d1877da",
        "parentId" : "24468f86-2ae2-4c07-8023-b5acc7e210e1",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "This PR introduced code duplication https://github.com/apache/spark/pull/8034 for your code https://github.com/apache/spark/pull/7355 5 years ago.",
        "createdAt" : "2019-10-10T12:12:38Z",
        "updatedAt" : "2019-10-12T08:32:17Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "290ce90c-a13d-4291-b296-2a9a85c953d0",
        "parentId" : "24468f86-2ae2-4c07-8023-b5acc7e210e1",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "And your regexp is not tolerant to the order of interval units, see:\r\n```sql\r\nspark-sql> select interval 'interval 1 microsecond 2 months';\r\nNULL\r\nspark-sql> select interval 1 microsecond 2 months;\r\ninterval 2 months 1 microseconds\r\n```",
        "createdAt" : "2019-10-10T12:16:35Z",
        "updatedAt" : "2019-10-12T08:32:17Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "7c83a318-9f25-42b4-bf1b-a5b2f0748b15",
        "parentId" : "24468f86-2ae2-4c07-8023-b5acc7e210e1",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Let's keep them separate so far. And I will try to write flexible and common code in the near future for parsing string intervals that could handle other features found in https://github.com/apache/spark/pull/26055",
        "createdAt" : "2019-10-10T12:18:49Z",
        "updatedAt" : "2019-10-12T08:32:17Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "5a482db2-cf28-4137-9656-63ffb087dc26",
        "parentId" : "24468f86-2ae2-4c07-8023-b5acc7e210e1",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "SGTM",
        "createdAt" : "2019-10-10T12:57:53Z",
        "updatedAt" : "2019-10-12T08:32:17Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "e2c1352c66ca8a74d74e154513fe4b9546fc7537",
    "line" : 43,
    "diffHunk" : "@@ -1,1 +87,91 @@   * @throws IllegalArgumentException if the string is not a valid internal.\n   */\n  public static CalendarInterval fromCaseInsensitiveString(String s) {\n    if (s == null) {\n      throw new IllegalArgumentException(\"Interval cannot be null\");"
  },
  {
    "id" : "6cb2e97d-550c-474f-be35-79c17242325e",
    "prId" : 26079,
    "prUrl" : "https://github.com/apache/spark/pull/26079#pullrequestreview-300058793",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e3b7005d-7c5d-46e9-96dc-a7ba83a25ddf",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "what does this condition mean?",
        "createdAt" : "2019-10-10T12:59:59Z",
        "updatedAt" : "2019-10-12T08:32:17Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "b96ec7f0-3b03-4da4-b0fb-9fc07f7ba1eb",
        "parentId" : "e3b7005d-7c5d-46e9-96dc-a7ba83a25ddf",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "I added comments about this.",
        "createdAt" : "2019-10-10T13:18:48Z",
        "updatedAt" : "2019-10-12T08:32:17Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "e2c1352c66ca8a74d74e154513fe4b9546fc7537",
    "line" : 61,
    "diffHunk" : "@@ -1,1 +98,102 @@    String intervalStr = trimmed;\n    // Checks the given interval string does not start with the `interval` prefix\n    if (!intervalStr.regionMatches(true, 0, prefix, 0, prefix.length())) {\n      // Prepend `interval` if it does not present because\n      // the regular expression strictly require it."
  },
  {
    "id" : "0effddb3-4e13-46c2-8f12-e17386a9b064",
    "prId" : 26079,
    "prUrl" : "https://github.com/apache/spark/pull/26079#pullrequestreview-301394625",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "dc9f72d7-7585-45b0-8bbf-d0e0cbeac795",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "I have not figured out how to modify the regular expression to make the `interval` prefix optional.",
        "createdAt" : "2019-10-10T13:20:18Z",
        "updatedAt" : "2019-10-12T08:32:17Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "f855302d-44ce-470b-86c0-7f33dc948c94",
        "parentId" : "dc9f72d7-7585-45b0-8bbf-d0e0cbeac795",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Probably, this needs this feature https://www.regular-expressions.info/branchreset.html which Java's regexps doesn't have.",
        "createdAt" : "2019-10-10T13:23:58Z",
        "updatedAt" : "2019-10-12T08:32:17Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "04bde68f-6cdc-412e-aef1-2c1aaf5f5e78",
        "parentId" : "dc9f72d7-7585-45b0-8bbf-d0e0cbeac795",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "How about something like\r\n```\r\nString intervalStr = trimmed.toLowerCase();\r\nif (intervalStr.startsWith(\"interval\")) {\r\n  intervalStr = intervalStr.drop(8)\r\n}\r\n// parse the interval string assuming there is no leading \"interval\"\r\n```",
        "createdAt" : "2019-10-10T14:44:22Z",
        "updatedAt" : "2019-10-12T08:32:17Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "c97f98f1-52d3-4016-9c2c-bea7e1562052",
        "parentId" : "dc9f72d7-7585-45b0-8bbf-d0e0cbeac795",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "> String intervalStr = trimmed.toLowerCase();\r\n\r\nYour code is more expensive because you lower case whole input string.\r\n\r\n> // parse the interval string assuming there is no leading \"interval\"\r\n\r\nHere there is a problem with current regexp when you delete the anchor `\"interval\"`. Without this anchor, it cannot match to valid inputs:\r\n```scala\r\nscala> import java.util.regex._\r\nimport java.util.regex._\r\n\r\nscala> def unitRegex(unit: String) = \"(?:\\\\s+(-?\\\\d+)\\\\s+\" + unit + \"s?)?\"\r\nunitRegex: (unit: String)String\r\n\r\nscala> val p = Pattern.compile(unitRegex(\"year\") + unitRegex(\"month\") +\r\n     |     unitRegex(\"week\") + unitRegex(\"day\") + unitRegex(\"hour\") + unitRegex(\"minute\") +\r\n     |     unitRegex(\"second\") + unitRegex(\"millisecond\") + unitRegex(\"microsecond\"),\r\n     |     Pattern.CASE_INSENSITIVE)\r\np: java.util.regex.Pattern = (?:\\s+(-?\\d+)\\s+years?)?(?:\\s+(-?\\d+)\\s+months?)?(?:\\s+(-?\\d+)\\s+weeks?)?(?:\\s+(-?\\d+)\\s+days?)?(?:\\s+(-?\\d+)\\s+hours?)?(?:\\s+(-?\\d+)\\s+minutes?)?(?:\\s+(-?\\d+)\\s+seconds?)?(?:\\s+(-?\\d+)\\s+milliseconds?)?(?:\\s+(-?\\d+)\\s+microseconds?)?\r\n\r\nscala> val m = p.matcher(\"1 month 1 second\")\r\nm: java.util.regex.Matcher = java.util.regex.Matcher[pattern=(?:\\s+(-?\\d+)\\s+years?)?(?:\\s+(-?\\d+)\\s+months?)?(?:\\s+(-?\\d+)\\s+weeks?)?(?:\\s+(-?\\d+)\\s+days?)?(?:\\s+(-?\\d+)\\s+hours?)?(?:\\s+(-?\\d+)\\s+minutes?)?(?:\\s+(-?\\d+)\\s+seconds?)?(?:\\s+(-?\\d+)\\s+milliseconds?)?(?:\\s+(-?\\d+)\\s+microseconds?)? region=0,16 lastmatch=]\r\n\r\nscala> m.matches()\r\nres7: Boolean = false\r\n```\r\nIf we added it back:\r\n```scala\r\nscala> val p = Pattern.compile(\"interval\" + unitRegex(\"year\") + unitRegex(\"month\") +\r\n     |     unitRegex(\"week\") + unitRegex(\"day\") + unitRegex(\"hour\") + unitRegex(\"minute\") +\r\n     |     unitRegex(\"second\") + unitRegex(\"millisecond\") + unitRegex(\"microsecond\"),\r\n     |     Pattern.CASE_INSENSITIVE)\r\np: java.util.regex.Pattern = interval(?:\\s+(-?\\d+)\\s+years?)?(?:\\s+(-?\\d+)\\s+months?)?(?:\\s+(-?\\d+)\\s+weeks?)?(?:\\s+(-?\\d+)\\s+days?)?(?:\\s+(-?\\d+)\\s+hours?)?(?:\\s+(-?\\d+)\\s+minutes?)?(?:\\s+(-?\\d+)\\s+seconds?)?(?:\\s+(-?\\d+)\\s+milliseconds?)?(?:\\s+(-?\\d+)\\s+microseconds?)?\r\n\r\nscala> val m = p.matcher(\"interval 1 month 1 second\")\r\nm: java.util.regex.Matcher = java.util.regex.Matcher[pattern=interval(?:\\s+(-?\\d+)\\s+years?)?(?:\\s+(-?\\d+)\\s+months?)?(?:\\s+(-?\\d+)\\s+weeks?)?(?:\\s+(-?\\d+)\\s+days?)?(?:\\s+(-?\\d+)\\s+hours?)?(?:\\s+(-?\\d+)\\s+minutes?)?(?:\\s+(-?\\d+)\\s+seconds?)?(?:\\s+(-?\\d+)\\s+milliseconds?)?(?:\\s+(-?\\d+)\\s+microseconds?)? region=0,25 lastmatch=]\r\n\r\nscala> m.matches()\r\nres8: Boolean = true\r\n```\r\nit can match now. That's why I had to add the `interval` prefix instead of removing it.",
        "createdAt" : "2019-10-10T15:13:08Z",
        "updatedAt" : "2019-10-12T08:32:17Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "9522dfea-1740-48c5-9790-69023ee180d6",
        "parentId" : "dc9f72d7-7585-45b0-8bbf-d0e0cbeac795",
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "Can you just start the regex with `(interval)?`? then the first matching group is either null or \"interval\", and the rest should match the same way?",
        "createdAt" : "2019-10-14T15:37:23Z",
        "updatedAt" : "2019-10-14T15:37:23Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "778f5155-558f-49af-b4d1-d8bd673b7ab6",
        "parentId" : "dc9f72d7-7585-45b0-8bbf-d0e0cbeac795",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "As far as I remember I tried this regex, and it didn't work. Have you tried it?",
        "createdAt" : "2019-10-14T15:42:05Z",
        "updatedAt" : "2019-10-14T15:42:05Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "0a6d2c94-ba32-4aee-bc94-e672522af233",
        "parentId" : "dc9f72d7-7585-45b0-8bbf-d0e0cbeac795",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "I have checked, it doesn't work:\r\n```scala\r\nscala> def unitRegex(unit: String) = \"(?:\\\\s+(-?\\\\d+)\\\\s+\" + unit + \"s?)?\"\r\nunitRegex: (unit: String)String\r\n\r\nscala> val p = Pattern.compile(\"(interval)?\" + unitRegex(\"year\") + unitRegex(\"month\") +\r\n     |     unitRegex(\"week\") + unitRegex(\"day\") + unitRegex(\"hour\") + unitRegex(\"minute\") +\r\n     |     unitRegex(\"second\") + unitRegex(\"millisecond\") + unitRegex(\"microsecond\"),\r\n     |     Pattern.CASE_INSENSITIVE)\r\np: java.util.regex.Pattern = (interval)?(?:\\s+(-?\\d+)\\s+years?)?(?:\\s+(-?\\d+)\\s+months?)?(?:\\s+(-?\\d+)\\s+weeks?)?(?:\\s+(-?\\d+)\\s+days?)?(?:\\s+(-?\\d+)\\s+hours?)?(?:\\s+(-?\\d+)\\s+minutes?)?(?:\\s+(-?\\d+)\\s+seconds?)?(?:\\s+(-?\\d+)\\s+milliseconds?)?(?:\\s+(-?\\d+)\\s+microseconds?)?\r\n\r\nscala> val m = p.matcher(\"1 month 1 second\")\r\nm: java.util.regex.Matcher = java.util.regex.Matcher[pattern=(interval)?(?:\\s+(-?\\d+)\\s+years?)?(?:\\s+(-?\\d+)\\s+months?)?(?:\\s+(-?\\d+)\\s+weeks?)?(?:\\s+(-?\\d+)\\s+days?)?(?:\\s+(-?\\d+)\\s+hours?)?(?:\\s+(-?\\d+)\\s+minutes?)?(?:\\s+(-?\\d+)\\s+seconds?)?(?:\\s+(-?\\d+)\\s+milliseconds?)?(?:\\s+(-?\\d+)\\s+microseconds?)? region=0,16 lastmatch=]\r\n\r\nscala> m.matches()\r\nres0: Boolean = false\r\n```",
        "createdAt" : "2019-10-14T15:46:16Z",
        "updatedAt" : "2019-10-14T15:46:16Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "f822f690-9e42-4175-aefe-13661a886b21",
        "parentId" : "dc9f72d7-7585-45b0-8bbf-d0e0cbeac795",
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "I tried simply `\"(interval)?(.+)\".r` and it worked as expected on inputs like `\"abc\"` and `\"interval abc\"`. It's a toy example and not sure if it interacts unexpectedly with the rest of the matching. no big deal, just leave it.",
        "createdAt" : "2019-10-14T15:50:58Z",
        "updatedAt" : "2019-10-14T15:50:58Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      }
    ],
    "commit" : "e2c1352c66ca8a74d74e154513fe4b9546fc7537",
    "line" : 63,
    "diffHunk" : "@@ -1,1 +100,104 @@    if (!intervalStr.regionMatches(true, 0, prefix, 0, prefix.length())) {\n      // Prepend `interval` if it does not present because\n      // the regular expression strictly require it.\n      intervalStr = prefix + \" \" + trimmed;\n    } else if (intervalStr.length() == prefix.length()) {"
  },
  {
    "id" : "db28170b-8749-47c7-97a2-c88028209060",
    "prId" : 26079,
    "prUrl" : "https://github.com/apache/spark/pull/26079#pullrequestreview-301366614",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0e1902c3-5c20-43a7-84ef-b4207f418d22",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Why not just call `trimmed.toLowerCase.startsWith(\"interval\")`? For perf reasons?",
        "createdAt" : "2019-10-14T14:56:41Z",
        "updatedAt" : "2019-10-14T14:56:41Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "2b398f4d-a18c-41f8-8f45-e62d5e117c1e",
        "parentId" : "0e1902c3-5c20-43a7-84ef-b4207f418d22",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Yes, don't want to lower case the **entire string** and allocate memory for new one to only compare small prefix.",
        "createdAt" : "2019-10-14T15:05:06Z",
        "updatedAt" : "2019-10-14T15:05:07Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "e2c1352c66ca8a74d74e154513fe4b9546fc7537",
    "line" : 60,
    "diffHunk" : "@@ -1,1 +97,101 @@    String prefix = \"interval\";\n    String intervalStr = trimmed;\n    // Checks the given interval string does not start with the `interval` prefix\n    if (!intervalStr.regionMatches(true, 0, prefix, 0, prefix.length())) {\n      // Prepend `interval` if it does not present because"
  },
  {
    "id" : "cda5196d-a014-4ab1-be80-c0a309e16732",
    "prId" : 26010,
    "prUrl" : "https://github.com/apache/spark/pull/26010#pullrequestreview-297813640",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ca2acb9c-34a4-4e8f-8a31-a31574929afb",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "This change the description without changing the function body. This means the previous function descriptions wrong. However, for example, the function body still has case-sensitive function like `s.equals(\"interval\")`. For me, the previous function description is correct and new one is incorrect. ~Let's recover this comment change.~ Or, could you change the remaining part?\r\n\r\nBTW, this discussion means the lack of test coverage for this part. Could you add a test coverage for that code path?",
        "createdAt" : "2019-10-06T00:32:11Z",
        "updatedAt" : "2019-10-06T06:24:57Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "c7e09a150e37d4ecf26673a52e600b76a7199da9",
    "line" : 15,
    "diffHunk" : "@@ -1,1 +71,75 @@  /**\n   * Convert a string to CalendarInterval. Return null if the input string is not a valid interval.\n   * This method is case-insensitive.\n   */\n  public static CalendarInterval fromString(String s) {"
  }
]