[
  {
    "id" : "b217fb3e-8911-43ee-ae15-69391c10cfd2",
    "prId" : 33629,
    "prUrl" : "https://github.com/apache/spark/pull/33629#pullrequestreview-725968316",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d8761723-8247-4270-8590-469d6403f48d",
        "parentId" : null,
        "authorId" : "c7afbd1a-ab9f-4878-b837-32685ae783b0",
        "body" : "```\r\npublic static void skipFully(InputStream in, long n) throws IOException {\r\n...\r\n}\r\n```",
        "createdAt" : "2021-08-10T03:09:15Z",
        "updatedAt" : "2021-08-10T03:09:16Z",
        "lastEditedBy" : "c7afbd1a-ab9f-4878-b837-32685ae783b0",
        "tags" : [
        ]
      }
    ],
    "commit" : "9312660a8996619cc1cc6b722364c73fc658d940",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +82,86 @@  private static long readChecksumByReduceId(File checksumFile, int reduceId) throws IOException {\n    try (DataInputStream in = new DataInputStream(new FileInputStream(checksumFile))) {\n      ByteStreams.skipFully(in, reduceId * 8L);\n      return in.readLong();\n    }"
  },
  {
    "id" : "2eeaa671-8159-481a-a452-6764f60bcd17",
    "prId" : 33451,
    "prUrl" : "https://github.com/apache/spark/pull/33451#pullrequestreview-715017998",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8efd4122-1d9d-46e4-bfa6-e062fccbbb55",
        "parentId" : null,
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "cc @mridulm @otterc @tgravescs Who discussed the upgrade issue of ESS before.",
        "createdAt" : "2021-07-26T15:55:28Z",
        "updatedAt" : "2021-07-26T15:55:28Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      }
    ],
    "commit" : "ca1b058b6ccac9178859c56e2f7dd05f4ff68900",
    "line" : 147,
    "diffHunk" : "@@ -1,1 +145,149 @@      }\n    } catch (UnsupportedOperationException e) {\n      cause = Cause.UNSUPPORTED_CHECKSUM_ALGORITHM;\n    } catch (FileNotFoundException e) {\n      // Even if checksum is enabled, a checksum file may not exist if error throws during writing."
  },
  {
    "id" : "0bbb82b6-dc62-446a-91c1-b3e78df3afce",
    "prId" : 33451,
    "prUrl" : "https://github.com/apache/spark/pull/33451#pullrequestreview-716174222",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d33ded62-be83-4c09-bad5-c2add9318128",
        "parentId" : null,
        "authorId" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "body" : "I probably mentioned this before - can we move this to before we recompute checksum via `calculateChecksumForPartition` ?\r\nIt is a cheap check, and if network is the culprit, we immediately return.",
        "createdAt" : "2021-07-26T19:16:04Z",
        "updatedAt" : "2021-07-26T19:40:38Z",
        "lastEditedBy" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "tags" : [
        ]
      },
      {
        "id" : "3512cc8e-afb2-43c9-b8d4-bef8ff213e6a",
        "parentId" : "d33ded62-be83-4c09-bad5-c2add9318128",
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "Yeah, I also replied somewhere. Let me repeat here.\r\n\r\nI think it wouldn't work. Because there could be two reasons if we find `checksumByWriter != checksumByReader` at the beginning. As you know, `checksumByReader` is calculated base on the corrupted block at fetcher side. And the corruption can be caused by either network issue or disk issue. So we can't know the exact cause if we check this at the beginning. ",
        "createdAt" : "2021-07-27T13:38:29Z",
        "updatedAt" : "2021-07-27T13:38:30Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      },
      {
        "id" : "7a9416f9-6e65-4c08-9417-e59f9724a278",
        "parentId" : "d33ded62-be83-4c09-bad5-c2add9318128",
        "authorId" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "body" : "You are right, my mistake.",
        "createdAt" : "2021-07-27T17:09:27Z",
        "updatedAt" : "2021-07-27T17:09:27Z",
        "lastEditedBy" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "tags" : [
        ]
      }
    ],
    "commit" : "ca1b058b6ccac9178859c56e2f7dd05f4ff68900",
    "line" : 141,
    "diffHunk" : "@@ -1,1 +139,143 @@      if (checksumByWriter != checksumByReCalculation) {\n        cause = Cause.DISK_ISSUE;\n      } else if (checksumByWriter != checksumByReader) {\n        cause = Cause.NETWORK_ISSUE;\n      } else {"
  }
]