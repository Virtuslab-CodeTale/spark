[
  {
    "id" : "c6431415-22de-43b3-ab71-275b58cf060b",
    "prId" : 30548,
    "prUrl" : "https://github.com/apache/spark/pull/30548#pullrequestreview-545590122",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d275cd12-fa29-4640-8e5e-ad0457b5b51b",
        "parentId" : null,
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "At first glance this makes more sense. But, we can't call `bcModel.destroy()` at the end here anyway. So we have this broadcast we can't explicitly close no matter what. And now I guess, this would re-broadcast every time? that could be bad. What do you think? I know this is not consistent in the code either way.",
        "createdAt" : "2020-12-03T02:56:23Z",
        "updatedAt" : "2020-12-03T02:56:23Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "28c41d40-452f-4319-ae11-8bff782b8d80",
        "parentId" : "d275cd12-fa29-4640-8e5e-ad0457b5b51b",
        "authorId" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "body" : "> And now I guess, this would re-broadcast every time? that could be bad. What do you think?\r\n\r\nI agree. I perfer not using broadcasting in `transform`, but this may need more discussion. we can keep current behavior for now.\r\n\r\nGBT models are also broadcasted in this way for performance since [SPARK-7127](https://issues.apache.org/jira/browse/SPARK-7127).\r\n",
        "createdAt" : "2020-12-03T03:18:28Z",
        "updatedAt" : "2020-12-03T03:18:28Z",
        "lastEditedBy" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "tags" : [
        ]
      },
      {
        "id" : "066ff500-724e-4a24-aa9a-2bccd85ac610",
        "parentId" : "d275cd12-fa29-4640-8e5e-ad0457b5b51b",
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "Looks good but i'd back out this part of the change",
        "createdAt" : "2020-12-05T14:11:32Z",
        "updatedAt" : "2020-12-05T14:11:32Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      }
    ],
    "commit" : "3ba4fda47dd7627014b0aacfcbdc1b0a93fd924a",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +287,291 @@    val outputSchema = transformSchema(dataset.schema, logging = true)\n\n    val bcModel = dataset.sparkSession.sparkContext.broadcast(this.wordVectors)\n    val size = $(vectorSize)\n    val emptyVec = Vectors.sparse(size, Array.emptyIntArray, Array.emptyDoubleArray)"
  }
]