[
  {
    "id" : "2b006ac7-86cb-46ae-a45c-0f872f8f9c84",
    "prId" : 32648,
    "prUrl" : "https://github.com/apache/spark/pull/32648#pullrequestreview-667482608",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5adaf57e-13d2-4ff3-af8c-d166cc380ed6",
        "parentId" : null,
        "authorId" : "c7afbd1a-ab9f-4878-b837-32685ae783b0",
        "body" : "In Scala 2.13.5\r\n```\r\nWelcome to Scala 2.13.5 (OpenJDK 64-Bit Server VM, Java 1.8.0_232).\r\nType in expressions for evaluation. Or try :help.\r\n\r\nscala> Array.empty[Double].intersect(Array(0.0))\r\nval res0: Array[Double] = Array()\r\n\r\nscala> Array(0.0).intersect(Array.empty[Double])\r\nval res1: Array[Double] = Array()\r\n```\r\n\r\nbut in Scala 2.13.6\r\n\r\n```\r\nWelcome to Scala 2.13.6 (OpenJDK 64-Bit Server VM, Java 1.8.0_232).\r\nType in expressions for evaluation. Or try :help.\r\n\r\nscala> Array.empty[Double].intersect(Array(0.0))\r\njava.lang.ClassCastException: [Ljava.lang.Object; cannot be cast to [D\r\n  ... 32 elided\r\n\r\nscala> Array(0.0).intersect(Array.empty[Double])\r\njava.lang.ClassCastException: [Ljava.lang.Object; cannot be cast to [D\r\n  ... 32 elided\r\n```\r\n\r\n`Array()` is replaced by throw `ClassCastException`, this change is uncomfortable ... @dongjoon-hyun @maropu do you think this is a bug of Scala 2.13.6?\r\n\r\n\r\n",
        "createdAt" : "2021-05-25T03:29:26Z",
        "updatedAt" : "2021-05-25T03:29:26Z",
        "lastEditedBy" : "c7afbd1a-ab9f-4878-b837-32685ae783b0",
        "tags" : [
        ]
      },
      {
        "id" : "4a10861e-5c83-4bff-bead-f95a701b9a6c",
        "parentId" : "5adaf57e-13d2-4ff3-af8c-d166cc380ed6",
        "authorId" : "c7afbd1a-ab9f-4878-b837-32685ae783b0",
        "body" : "I submitted an issue to consult the Scala community  [https://github.com/scala/bug/issues/12403](https://github.com/scala/bug/issues/12403)",
        "createdAt" : "2021-05-25T03:43:54Z",
        "updatedAt" : "2021-05-25T03:43:55Z",
        "lastEditedBy" : "c7afbd1a-ab9f-4878-b837-32685ae783b0",
        "tags" : [
        ]
      },
      {
        "id" : "f3706982-f544-4bae-81f1-a2d319be7275",
        "parentId" : "5adaf57e-13d2-4ff3-af8c-d166cc380ed6",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Thank you for filing the upstream issue. Ya, it looks like a breaking behavior change.",
        "createdAt" : "2021-05-25T07:09:51Z",
        "updatedAt" : "2021-05-25T07:09:51Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "6de0ff34-d9f2-40ff-bd1d-70f5d2b8b4eb",
        "parentId" : "5adaf57e-13d2-4ff3-af8c-d166cc380ed6",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "As @LuciferYang mentioned at the Scala community, I also confirmed that only Scala 2.13.6 has this bug unlike Scala 2.13.5/3.0.0.\r\n\r\n```\r\nscala3-3.0.0:$ bin/scala\r\nscala> Array.empty[Double].intersect(Array(0.0))\r\nval res0: Array[Double] = Array()\r\n\r\nscala-2.13.6:$ bin/scala\r\nWelcome to Scala 2.13.6 (OpenJDK 64-Bit Server VM, Java 1.8.0_292).\r\nType in expressions for evaluation. Or try :help.\r\n\r\nscala> Array.empty[Double].intersect(Array(0.0))\r\njava.lang.ClassCastException: [Ljava.lang.Object; cannot be cast to [D\r\n  ... 32 elided\r\n```\r\n\r\n",
        "createdAt" : "2021-05-25T07:17:20Z",
        "updatedAt" : "2021-05-25T07:17:20Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "50c251d3-3c3c-4d7a-9923-f43ebc3ea97e",
        "parentId" : "5adaf57e-13d2-4ff3-af8c-d166cc380ed6",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "In this case, we had better skip Scala 2.13.6.",
        "createdAt" : "2021-05-25T07:18:25Z",
        "updatedAt" : "2021-05-25T07:18:25Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "d39fab3b-b143-4ff3-8dd1-5799d2d70889",
        "parentId" : "5adaf57e-13d2-4ff3-af8c-d166cc380ed6",
        "authorId" : "c7afbd1a-ab9f-4878-b837-32685ae783b0",
        "body" : "@dongjoon-hyun agree with you. we'd better skip this version",
        "createdAt" : "2021-05-25T07:31:02Z",
        "updatedAt" : "2021-05-25T07:31:02Z",
        "lastEditedBy" : "c7afbd1a-ab9f-4878-b837-32685ae783b0",
        "tags" : [
        ]
      }
    ],
    "commit" : "2a867a6277c1c6c4f1a6497973588304f907bede",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +179,183 @@   */\n  def add(predictions: Array[Double], labels: Array[Double]): this.type = {\n    val intersection = if (predictions.isEmpty || labels.isEmpty) {\n      Array.empty[Double]\n    } else {"
  }
]