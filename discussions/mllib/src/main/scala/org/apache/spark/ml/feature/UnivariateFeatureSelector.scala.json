[
  {
    "id" : "f005bf2e-b5e6-46b0-afa8-eacae9bc507c",
    "prId" : 31160,
    "prUrl" : "https://github.com/apache/spark/pull/31160#pullrequestreview-568076084",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7c1212a9-8e6f-4825-8a57-f8d9d009cd34",
        "parentId" : null,
        "authorId" : "7e665d8b-d739-4edf-88c8-7379ff8585c2",
        "body" : "Why not write this like\r\n```\r\nxxx.zipWithIndex.filter { case (pValue, index) =>\r\n     pValue <= f * (index + 1)\r\n}.map(_._2).max()\r\n```",
        "createdAt" : "2021-01-14T09:53:40Z",
        "updatedAt" : "2021-01-15T22:21:22Z",
        "lastEditedBy" : "7e665d8b-d739-4edf-88c8-7379ff8585c2",
        "tags" : [
        ]
      },
      {
        "id" : "57eafc8c-2944-4d4f-b19a-45b120b3f145",
        "parentId" : "7c1212a9-8e6f-4825-8a57-f8d9d009cd34",
        "authorId" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "body" : "this rdd maybe empty:\r\n```\r\nscala> sc.range(0, 0).max\r\njava.lang.UnsupportedOperationException: empty collection\r\n  at org.apache.spark.rdd.RDD.$anonfun$reduce$4(RDD.scala:1096)\r\n  at scala.Option.getOrElse(Option.scala:189)\r\n  at org.apache.spark.rdd.RDD.$anonfun$reduce$1(RDD.scala:1096)\r\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\r\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\r\n  at org.apache.spark.rdd.RDD.withScope(RDD.scala:388)\r\n  at org.apache.spark.rdd.RDD.reduce(RDD.scala:1076)\r\n  at org.apache.spark.rdd.RDD.$anonfun$max$1(RDD.scala:1511)\r\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\r\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\r\n  at org.apache.spark.rdd.RDD.withScope(RDD.scala:388)\r\n  at org.apache.spark.rdd.RDD.max(RDD.scala:1511)\r\n  ... 47 elided\r\n```",
        "createdAt" : "2021-01-14T09:55:50Z",
        "updatedAt" : "2021-01-15T22:21:22Z",
        "lastEditedBy" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "tags" : [
        ]
      }
    ],
    "commit" : "b5d5f49e2c9d2b35f11c8bc81f669683957c47e4",
    "line" : 263,
    "diffHunk" : "@@ -1,1 +261,265 @@              Iterator.single(index.toInt)\n            } else Iterator.empty\n          }.fold(-1)(math.max)\n        if (maxIndex >= 0) {\n          getTopIndices(resultDF, maxIndex + 1)"
  }
]