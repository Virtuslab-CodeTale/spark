[
  {
    "id" : "2fa411ec-4d4d-4306-8acf-05d512248882",
    "prId" : 27844,
    "prUrl" : "https://github.com/apache/spark/pull/27844#pullrequestreview-370781584",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f9b3b770-9673-4ebd-b20c-217e5a96e606",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "In any way, this is wrong due to the misunderstanding. \r\n\r\nWith the same reason why you add this back, @marmbrus 's suggestion was not removing this forever.",
        "createdAt" : "2020-03-07T18:31:32Z",
        "updatedAt" : "2020-03-07T18:31:32Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "72e00a58646e5c29227324d53977c42ffd6408c6",
    "line" : 28,
    "diffHunk" : "@@ -1,1 +204,208 @@   */\n  @deprecated(\"use `spark.read.format(\\\"image\\\").load(path)` and this `readImages` will be \" +\n    \"removed in 3.1.0.\", \"2.4.0\")\n  def readImages(path: String): DataFrame = readImages(path, null, false, -1, false, 1.0, 0)\n"
  },
  {
    "id" : "64ed3817-bf84-4d6d-9112-9745f2a9c119",
    "prId" : 27844,
    "prUrl" : "https://github.com/apache/spark/pull/27844#pullrequestreview-370781613",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "44a8c982-c616-4afd-89d3-b9dd93b735d1",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Ditto. Are you sure that we agree on `will be removed in 3.1.0`?",
        "createdAt" : "2020-03-07T18:32:07Z",
        "updatedAt" : "2020-03-07T18:32:07Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "72e00a58646e5c29227324d53977c42ffd6408c6",
    "line" : 50,
    "diffHunk" : "@@ -1,1 +226,230 @@   */\n  @deprecated(\"use `spark.read.format(\\\"image\\\").load(path)` and this `readImages` will be \" +\n    \"removed in 3.1.0.\", \"2.4.0\")\n  def readImages(\n      path: String,"
  },
  {
    "id" : "623bd9e1-7e14-4db8-b3fa-999f7fc550dc",
    "prId" : 24362,
    "prUrl" : "https://github.com/apache/spark/pull/24362#pullrequestreview-226783701",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a9a29b74-24c2-4308-964f-98ec3eba504c",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Shall we add a test? ",
        "createdAt" : "2019-04-13T13:02:44Z",
        "updatedAt" : "2019-04-13T13:03:23Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "f9b08283-6534-4962-9ca1-19b1a3adb794",
        "parentId" : "a9a29b74-24c2-4308-964f-98ec3eba504c",
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "A test would be nice, though this is a pretty straightforward 'continuation' of the logic that's already below; ImageIO also returns null for bad images already. In practice I find lots of the libraries it uses internally to parse images will throw RuntimeExceptions on bad data though, so this LGTM",
        "createdAt" : "2019-04-13T22:07:19Z",
        "updatedAt" : "2019-04-13T22:07:19Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "2799d802-fb4c-48ce-af91-d791cfa50d72",
        "parentId" : "a9a29b74-24c2-4308-964f-98ec3eba504c",
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "Yeah, at best I would log 1 or N failures and then stop logging. While we don't have to do it here, indeed it might be puzzling to read 1000 images and always keep getting 998 or something with no warning?",
        "createdAt" : "2019-04-15T13:43:44Z",
        "updatedAt" : "2019-04-15T13:43:45Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "7d0df3d1-086c-4e65-830d-b09eef4d0cc1",
        "parentId" : "a9a29b74-24c2-4308-964f-98ec3eba504c",
        "authorId" : "ae55b635-dd0e-41aa-9272-372de9a35f38",
        "body" : "What about using an accumulator to keep track of the approximate number of rejected images? That way if peoples data goes \"bad\" they can at least see what's going?",
        "createdAt" : "2019-04-15T17:25:58Z",
        "updatedAt" : "2019-04-15T17:25:58Z",
        "lastEditedBy" : "ae55b635-dd0e-41aa-9272-372de9a35f38",
        "tags" : [
        ]
      },
      {
        "id" : "269b98b9-42ee-463d-97e1-b19d1fde24ad",
        "parentId" : "a9a29b74-24c2-4308-964f-98ec3eba504c",
        "authorId" : "ae55b635-dd0e-41aa-9272-372de9a35f38",
        "body" : "It might make sense to put the accumulator down in `readImages` when skipping invalid records is turned on.",
        "createdAt" : "2019-04-15T17:28:53Z",
        "updatedAt" : "2019-04-15T17:28:53Z",
        "lastEditedBy" : "ae55b635-dd0e-41aa-9272-372de9a35f38",
        "tags" : [
        ]
      },
      {
        "id" : "55d24ba7-e5ba-4cb1-8598-1d8869220782",
        "parentId" : "a9a29b74-24c2-4308-964f-98ec3eba504c",
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "I suppose in other cases we have a new column for 'bad records' but not sure if that's overkill or what. I'm OK with just making this change here and doing more later as it already ignores some images that ImageIO doesn't read",
        "createdAt" : "2019-04-15T17:28:57Z",
        "updatedAt" : "2019-04-15T17:28:58Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "6b998311-1592-48be-b6ef-41691f93da84",
        "parentId" : "a9a29b74-24c2-4308-964f-98ec3eba504c",
        "authorId" : "7e665d8b-d739-4edf-88c8-7379ff8585c2",
        "body" : "Oh, So there's a \"dropInvalid\" option. When  \"dropInvalid\" option turn off, the image datasource will still return invalid image row (but only the \"origin\" column contains valid value). I think this feature is enough for user to debug something.",
        "createdAt" : "2019-04-15T17:33:59Z",
        "updatedAt" : "2019-04-15T17:34:22Z",
        "lastEditedBy" : "7e665d8b-d739-4edf-88c8-7379ff8585c2",
        "tags" : [
        ]
      }
    ],
    "commit" : "f51161541f749bc2136e600cdfda24a0062f3d73",
    "line" : 10,
    "diffHunk" : "@@ -1,1 +139,143 @@      // Catch runtime exception because `ImageIO` may throw unexcepted `RuntimeException`.\n      // But do not catch the declared `IOException` (regarded as FileSystem failure)\n      case _: RuntimeException => null\n    }\n"
  },
  {
    "id" : "89ef7422-ece9-476e-8605-12438be6fb27",
    "prId" : 24362,
    "prUrl" : "https://github.com/apache/spark/pull/24362#pullrequestreview-226457013",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b71868ed-f9da-4b96-8da2-8376783ac254",
        "parentId" : null,
        "authorId" : "67753c60-11ee-4434-aa73-ad8ea638a02a",
        "body" : "log the error message?  may help with debugging",
        "createdAt" : "2019-04-14T07:36:41Z",
        "updatedAt" : "2019-04-14T07:36:42Z",
        "lastEditedBy" : "67753c60-11ee-4434-aa73-ad8ea638a02a",
        "tags" : [
        ]
      },
      {
        "id" : "e070aeb0-6bf4-41d2-b148-1e1868d192b8",
        "parentId" : "b71868ed-f9da-4b96-8da2-8376783ac254",
        "authorId" : "7e665d8b-d739-4edf-88c8-7379ff8585c2",
        "body" : "I am afraid it will log too many things , suppose loading millions of images. (And when loading failed with `imageIO.read` normally return \"null\" we also do not log error.",
        "createdAt" : "2019-04-15T05:27:05Z",
        "updatedAt" : "2019-04-15T05:27:05Z",
        "lastEditedBy" : "7e665d8b-d739-4edf-88c8-7379ff8585c2",
        "tags" : [
        ]
      }
    ],
    "commit" : "f51161541f749bc2136e600cdfda24a0062f3d73",
    "line" : 10,
    "diffHunk" : "@@ -1,1 +139,143 @@      // Catch runtime exception because `ImageIO` may throw unexcepted `RuntimeException`.\n      // But do not catch the declared `IOException` (regarded as FileSystem failure)\n      case _: RuntimeException => null\n    }\n"
  }
]