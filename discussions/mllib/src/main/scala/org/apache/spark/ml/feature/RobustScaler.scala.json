[
  {
    "id" : "4d342b1d-79d1-4245-bd69-e9c2f3eaddd9",
    "prId" : 27947,
    "prUrl" : "https://github.com/apache/spark/pull/27947#pullrequestreview-376684584",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "15ddf2c2-2570-4bca-b051-8146d7af766a",
        "parentId" : null,
        "authorId" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "body" : "here we can trigger compression at the _map_ side",
        "createdAt" : "2020-03-18T09:20:39Z",
        "updatedAt" : "2020-03-18T09:20:59Z",
        "lastEditedBy" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "tags" : [
        ]
      }
    ],
    "commit" : "964b9f8c57eb11eac6326e49a1b42fe8e66dcab4",
    "line" : 20,
    "diffHunk" : "@@ -1,1 +213,217 @@      ).mapPartitionsWithIndex { case (pid, iter) =>\n        val p = pid % scale\n        iter.map { case (col, s) => ((p, col), s.compress) }\n      }.reduceByKey { case (s1, s2) => s1.merge(s2)\n      }.map { case ((_, col), s) => (col, s)"
  },
  {
    "id" : "93d28a6a-c871-4562-8cb4-78fbe59d9b98",
    "prId" : 27947,
    "prUrl" : "https://github.com/apache/spark/pull/27947#pullrequestreview-376688307",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "db9fdfa0-fd34-49a6-80ea-03c10da48bbf",
        "parentId" : null,
        "authorId" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "body" : "then no longer to confirm compression like `s1.compress.merge(s2.compress)`",
        "createdAt" : "2020-03-18T09:25:33Z",
        "updatedAt" : "2020-03-18T09:25:34Z",
        "lastEditedBy" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "tags" : [
        ]
      }
    ],
    "commit" : "964b9f8c57eb11eac6326e49a1b42fe8e66dcab4",
    "line" : 21,
    "diffHunk" : "@@ -1,1 +214,218 @@        val p = pid % scale\n        iter.map { case (col, s) => ((p, col), s.compress) }\n      }.reduceByKey { case (s1, s2) => s1.merge(s2)\n      }.map { case ((_, col), s) => (col, s)\n      }.reduceByKey { case (s1, s2) => s1.merge(s2) }"
  }
]