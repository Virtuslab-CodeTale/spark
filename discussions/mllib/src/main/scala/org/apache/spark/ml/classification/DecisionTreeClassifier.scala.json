[
  {
    "id" : "5fe1fd94-5d11-4c1a-a28f-99a9c3d461be",
    "prId" : 25383,
    "prUrl" : "https://github.com/apache/spark/pull/25383#pullrequestreview-277531141",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "195f3e91-f67e-4986-9807-4a0167169ad7",
        "parentId" : null,
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "Just curious, can you just write `udf { predictLeaf }`?",
        "createdAt" : "2019-08-20T14:03:32Z",
        "updatedAt" : "2019-08-21T02:51:20Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "a378df20-f7f2-4759-a88e-2114bf9ffd53",
        "parentId" : "195f3e91-f67e-4986-9807-4a0167169ad7",
        "authorId" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "body" : "It is very stranger that IDEA will warn if I write `udf { predictLeaf }` or `udf(predictLeaf)`:\r\n\r\n![图片](https://user-images.githubusercontent.com/7322292/63398142-341e7980-c3ff-11e9-8fe3-22b645504aa9.png)\r\n\r\nSo I leave it alone for now ",
        "createdAt" : "2019-08-21T02:34:26Z",
        "updatedAt" : "2019-08-21T02:51:20Z",
        "lastEditedBy" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "tags" : [
        ]
      }
    ],
    "commit" : "4eb97be97cc4e509e74181dbab428548e6da28e3",
    "line" : 31,
    "diffHunk" : "@@ -1,1 +216,220 @@    val outputData = super.transform(dataset)\n    if ($(leafCol).nonEmpty) {\n      val leafUDF = udf { features: Vector => predictLeaf(features) }\n      outputData.withColumn($(leafCol), leafUDF(col($(featuresCol))))\n    } else {"
  }
]