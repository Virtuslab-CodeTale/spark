[
  {
    "id" : "c8ef1132-eceb-424d-ab9f-ca3b16701428",
    "prId" : 27600,
    "prUrl" : "https://github.com/apache/spark/pull/27600#pullrequestreview-361509712",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "20ecba9d-4f6c-4993-8645-b09042ee3c86",
        "parentId" : null,
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "What's the warning BTW?  and does `ids.zip(factors)` not work here?",
        "createdAt" : "2020-02-17T14:53:16Z",
        "updatedAt" : "2020-02-17T14:54:19Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "b67baf70-af31-49f7-8203-de33ca068821",
        "parentId" : "20ecba9d-4f6c-4993-8645-b09042ee3c86",
        "authorId" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "body" : "I guess `.view` was used to avoid creating a new Array",
        "createdAt" : "2020-02-19T03:46:10Z",
        "updatedAt" : "2020-02-19T03:46:10Z",
        "lastEditedBy" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "tags" : [
        ]
      },
      {
        "id" : "198a0eff-b0dc-4e6c-8bc5-2e062644d8bb",
        "parentId" : "20ecba9d-4f6c-4993-8645-b09042ee3c86",
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "Hm, but it results in a new array already, so just removing .view seems to not change much here. Just in case @mengxr do you recall why? this was written 4 years ago, so may have been lost in time.\r\n\r\nThe result would now be an iterator, which seems OK; avoids allocating an array after the change, I believe.",
        "createdAt" : "2020-02-19T23:17:22Z",
        "updatedAt" : "2020-02-19T23:17:22Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      }
    ],
    "commit" : "c22b05b06cd85513f2516c2173fd8a32decf2ca0",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +1050,1054 @@      .mapPartitions({ items =>\n        items.flatMap { case (_, (ids, factors)) =>\n          ids.iterator.zip(factors.iterator)\n        }\n      // Preserve the partitioning because IDs are consistent with the partitioners in userInBlocks"
  },
  {
    "id" : "6104bcc3-e538-4c01-ae50-2fbce2cd085b",
    "prId" : 27389,
    "prUrl" : "https://github.com/apache/spark/pull/27389#pullrequestreview-350555083",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "93a18c7a-3e6b-49da-b92b-cbb148debdce",
        "parentId" : null,
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "Oh, I think this is about to be a default of 1024, after the very latest PR from @zhengruifeng is merged. I think it's probably good to go so will merge it.",
        "createdAt" : "2020-01-30T02:14:36Z",
        "updatedAt" : "2020-01-30T06:11:24Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "3608325c-4fd0-4e2c-93df-e5fb9c54177e",
        "parentId" : "93a18c7a-3e6b-49da-b92b-cbb148debdce",
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "https://github.com/apache/spark/pull/27374",
        "createdAt" : "2020-01-30T02:16:11Z",
        "updatedAt" : "2020-01-30T06:11:24Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "1a9c45e9-5d03-4683-a86a-1417f3087af9",
        "parentId" : "93a18c7a-3e6b-49da-b92b-cbb148debdce",
        "authorId" : "99765afe-8dbe-4d5f-9ad3-d5bc40f0462b",
        "body" : "Thanks for the comment. I actually saw the default changed to 1024 in that PR, but I want the default to be 4096, that's why I set it explicitly in line 675 in the Estimator\r\n```setDefault(blockSize -> 4096)```. \r\n\r\nI want the default to be 4096 because the ```blockify``` has 4096 as default. I don't want to change the current default value.\r\n```\r\n  private def blockify(\r\n      factors: Dataset[(Int, Array[Float])],\r\n      blockSize: Int = 4096): Dataset[Seq[(Int, Array[Float])]] = {\r\n    import factors.sparkSession.implicits._\r\n    factors.mapPartitions(_.grouped(blockSize))\r\n  }\r\n```\r\n",
        "createdAt" : "2020-01-30T02:48:31Z",
        "updatedAt" : "2020-01-30T06:11:24Z",
        "lastEditedBy" : "99765afe-8dbe-4d5f-9ad3-d5bc40f0462b",
        "tags" : [
        ]
      },
      {
        "id" : "fced92d0-e851-4bb3-9ecb-4c2b40acd491",
        "parentId" : "93a18c7a-3e6b-49da-b92b-cbb148debdce",
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "OK, sounds fine.",
        "createdAt" : "2020-01-30T02:49:20Z",
        "updatedAt" : "2020-01-30T06:11:24Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      }
    ],
    "commit" : "d5711e59588b3e7ff04accaece6808a976c8ef11",
    "line" : 25,
    "diffHunk" : "@@ -1,1 +294,298 @@  /**\n   * Set block size for stacking input data in matrices.\n   * Default is 4096.\n   *\n   * @group expertSetParam"
  },
  {
    "id" : "a5d8f895-2363-42a8-a90a-f92cd98c05b9",
    "prId" : 27389,
    "prUrl" : "https://github.com/apache/spark/pull/27389#pullrequestreview-350598733",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ae29acde-0b2f-4bdd-ac97-ca8567b6f1ff",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Do we still need default blockSize in this method? i.e.,`blockSize: Int = 4096`.",
        "createdAt" : "2020-01-30T05:33:57Z",
        "updatedAt" : "2020-01-30T06:11:24Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "17fa657f-1939-4e1a-8038-e43dad682b1c",
        "parentId" : "ae29acde-0b2f-4bdd-ac97-ca8567b6f1ff",
        "authorId" : "99765afe-8dbe-4d5f-9ad3-d5bc40f0462b",
        "body" : "You are right. No need to have the default blockSize any more. I will update the code. Thanks!",
        "createdAt" : "2020-01-30T06:10:00Z",
        "updatedAt" : "2020-01-30T06:11:24Z",
        "lastEditedBy" : "99765afe-8dbe-4d5f-9ad3-d5bc40f0462b",
        "tags" : [
        ]
      }
    ],
    "commit" : "d5711e59588b3e7ff04accaece6808a976c8ef11",
    "line" : 94,
    "diffHunk" : "@@ -1,1 +499,503 @@   */\n  private def blockify(\n      factors: Dataset[(Int, Array[Float])],\n      blockSize: Int): Dataset[Seq[(Int, Array[Float])]] = {\n    import factors.sparkSession.implicits._"
  },
  {
    "id" : "670f9c53-0d29-44d6-9b99-616e28ddcc55",
    "prId" : 27389,
    "prUrl" : "https://github.com/apache/spark/pull/27389#pullrequestreview-350599914",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b1f7260c-39a9-437a-8491-1f42361c9bf9",
        "parentId" : null,
        "authorId" : "99765afe-8dbe-4d5f-9ad3-d5bc40f0462b",
        "body" : "I just realized that I should set Default of ```blockSize``` in ```ALSModelParams```, so this will apply to both ```ALS``` and ```ALSModel```.",
        "createdAt" : "2020-01-30T06:14:31Z",
        "updatedAt" : "2020-01-30T06:14:32Z",
        "lastEditedBy" : "99765afe-8dbe-4d5f-9ad3-d5bc40f0462b",
        "tags" : [
        ]
      }
    ],
    "commit" : "d5711e59588b3e7ff04accaece6808a976c8ef11",
    "line" : 15,
    "diffHunk" : "@@ -1,1 +128,132 @@  def getColdStartStrategy: String = $(coldStartStrategy).toLowerCase(Locale.ROOT)\n\n  setDefault(blockSize -> 4096)\n}\n"
  }
]