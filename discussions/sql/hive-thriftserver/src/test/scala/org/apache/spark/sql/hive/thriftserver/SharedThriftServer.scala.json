[
  {
    "id" : "552e8dc9-6139-4445-856a-287869d48446",
    "prId" : 28797,
    "prUrl" : "https://github.com/apache/spark/pull/28797#pullrequestreview-428677916",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "50f69220-d911-4854-b47e-094dde137707",
        "parentId" : null,
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "This fix is added to `SharedThriftServer ` not `SharedThriftServer` for a lower scope in this PR, but I think most of hive and `SharedSparkSession` related tests that need a dedicated JVM may cause by this.",
        "createdAt" : "2020-06-11T07:58:48Z",
        "updatedAt" : "2020-06-11T08:04:35Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      }
    ],
    "commit" : "c00ac4eefeee7262f252e4cdb811502523c9b0e2",
    "line" : 21,
    "diffHunk" : "@@ -1,1 +54,58 @@    } finally {\n      super.afterAll()\n      SessionState.detachSession()\n    }\n  }"
  },
  {
    "id" : "ab70d487-2fc8-4af9-bca3-1db88c876579",
    "prId" : 28797,
    "prUrl" : "https://github.com/apache/spark/pull/28797#pullrequestreview-430746518",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "45e049a7-d7c2-4dd1-8a44-020605f41394",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "From some Jenkins jobs, NPE is reported here.\r\n```\r\nsbt.ForkMain$ForkError: java.lang.NullPointerException: null\r\n\tat org.apache.spark.sql.hive.thriftserver.SharedThriftServer.afterAll(SharedThriftServer.scala:53)\r\n```",
        "createdAt" : "2020-06-15T15:18:44Z",
        "updatedAt" : "2020-06-15T15:18:44Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "c00ac4eefeee7262f252e4cdb811502523c9b0e2",
    "line" : 18,
    "diffHunk" : "@@ -1,1 +51,55 @@  override def afterAll(): Unit = {\n    try {\n      hiveServer2.stop()\n    } finally {\n      super.afterAll()"
  },
  {
    "id" : "113c18a1-bd67-4132-bdf5-816d170e6756",
    "prId" : 28797,
    "prUrl" : "https://github.com/apache/spark/pull/28797#pullrequestreview-430750173",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "af787a75-6d89-4117-999e-5dd1ca1bb289",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Before NPE occurs, this failed.\r\n```\r\nThriftServerWithSparkContextInHttpSuite:\r\n05:42:37.405 WARN hive.metastore: Failed to connect to the MetaStore Server...\r\norg.apache.thrift.transport.TTransportException: java.net.ConnectException: Connection refused (Connection refused)\r\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:226)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.open(HiveMetaStoreClient.java:480)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:247)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:129)\r\n\tat org.apache.hive.service.cli.CLIService.start(CLIService.java:152)\r\n\tat org.apache.hive.service.CompositeService.start(CompositeService.java:70)\r\n\tat org.apache.hive.service.server.HiveServer2.start(HiveServer2.java:105)\r\n\tat org.apache.spark.sql.hive.thriftserver.HiveThriftServer2.start(HiveThriftServer2.scala:161)\r\n\tat org.apache.spark.sql.hive.thriftserver.HiveThriftServer2$.startWithContext(HiveThriftServer2.scala:62)\r\n\tat org.apache.spark.sql.hive.thriftserver.SharedThriftServer.startThriftServer(SharedThriftServer.scala:92)\r\n```",
        "createdAt" : "2020-06-15T15:22:40Z",
        "updatedAt" : "2020-06-15T15:22:40Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "c00ac4eefeee7262f252e4cdb811502523c9b0e2",
    "line" : 63,
    "diffHunk" : "@@ -1,1 +90,94 @@\n    try {\n      hiveServer2 = HiveThriftServer2.startWithContext(sqlContext)\n      hiveServer2.getServices.asScala.foreach {\n        case t: ThriftCLIService =>"
  }
]