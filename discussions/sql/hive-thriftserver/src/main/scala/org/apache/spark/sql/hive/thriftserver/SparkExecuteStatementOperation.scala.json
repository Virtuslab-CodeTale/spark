[
  {
    "id" : "66f1836f-c3d1-431d-99e7-fbc0c54487a4",
    "prId" : 32995,
    "prUrl" : "https://github.com/apache/spark/pull/32995#pullrequestreview-688658903",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6e681a88-5e05-4930-8413-6bac726cb435",
        "parentId" : null,
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "It seems that there is not better choice from: https://github.com/apache/hive/blob/master/serde/src/java/org/apache/hadoop/hive/serde2/thrift/Type.java#L230",
        "createdAt" : "2021-06-21T12:55:31Z",
        "updatedAt" : "2021-06-21T12:55:31Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      },
      {
        "id" : "2c8e4c50-954d-474a-b56d-25569a02a8ab",
        "parentId" : "6e681a88-5e05-4930-8413-6bac726cb435",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "We should probably map the existing timestamp to `TIMESTAMPLOCALTZ`, we can discuss this in an individual PR.",
        "createdAt" : "2021-06-21T16:41:17Z",
        "updatedAt" : "2021-06-21T16:41:38Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "88c59477-7252-4566-828c-6428a894adc7",
        "parentId" : "6e681a88-5e05-4930-8413-6bac726cb435",
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "+1",
        "createdAt" : "2021-06-21T16:45:24Z",
        "updatedAt" : "2021-06-21T16:45:24Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      }
    ],
    "commit" : "d5afd6abdb6eb56e91b2d95b0fecad6468d2a64b",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +380,384 @@        case _: YearMonthIntervalType => \"interval_year_month\"\n        case _: DayTimeIntervalType => \"interval_day_time\"\n        case _: TimestampWithoutTZType => \"timestamp\"\n        case other => other.catalogString\n      }"
  },
  {
    "id" : "c335a386-8a8a-4c75-8a2c-971830276d72",
    "prId" : 29933,
    "prUrl" : "https://github.com/apache/spark/pull/29933#pullrequestreview-507948419",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b33772a6-1964-44fd-bdf4-886f5bf27be0",
        "parentId" : null,
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "Maybe we need to call shutdown for this executor ?\r\n\r\nhttps://github.com/apache/hive/blob/940ee46d3a7a9300a47e5beae7c3ca6eb32fd759/service/src/java/org/apache/hive/service/cli/operation/SQLOperation.java#L170-L184",
        "createdAt" : "2020-10-14T02:20:39Z",
        "updatedAt" : "2020-10-14T23:22:41Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      }
    ],
    "commit" : "5e3c44060567d2234dd79d222f77bc58983bb805",
    "line" : 55,
    "diffHunk" : "@@ -1,1 +230,234 @@      }, timeout, TimeUnit.SECONDS)\n    }\n\n    if (!runInBackground) {\n      execute()"
  },
  {
    "id" : "4fb9aee1-be56-42c7-8c1c-9bea485d0fa8",
    "prId" : 29204,
    "prUrl" : "https://github.com/apache/spark/pull/29204#pullrequestreview-454606113",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "dffaa272-cd36-48cb-a365-a04d26cb6aec",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "is `log.info` and `logInfo` the same?",
        "createdAt" : "2020-07-23T14:15:01Z",
        "updatedAt" : "2020-07-27T08:47:59Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "7c599fc7-d0f1-4d14-9b61-82f5d686b56f",
        "parentId" : "dffaa272-cd36-48cb-a365-a04d26cb6aec",
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "`logInfo` will check `log.isInfoEnabled`",
        "createdAt" : "2020-07-24T02:31:19Z",
        "updatedAt" : "2020-07-27T08:47:59Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      }
    ],
    "commit" : "50113145de4d9c7247d2a8af6e1e4f1087d19548",
    "line" : 34,
    "diffHunk" : "@@ -1,1 +179,183 @@      }\n      previousFetchEndOffset = resultOffset\n      logInfo(s\"Returning result set with ${curRow} rows from offsets \" +\n        s\"[$previousFetchStartOffset, $previousFetchEndOffset) with $statementId\")\n      resultRowSet"
  },
  {
    "id" : "9713bcee-728d-416e-b039-128492689c4d",
    "prId" : 28991,
    "prUrl" : "https://github.com/apache/spark/pull/28991#pullrequestreview-442605674",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "11b598c4-8787-40e2-9bc9-b0e067cfcc16",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "nit: `logInfo` is located just before `HiveThriftServer2.eventManager.onXXX`?\r\n```\r\n        cleanup()\r\n        setState(OperationState.TIMEDOUT)\r\n        logInfo(s\"Timeout and Cancel query with $statementId \")\r\n        HiveThriftServer2.eventManager.onStatementCanceled(statementId)\r\n```\r\nhttps://github.com/apache/spark/blob/42f01e314b4874236544cc8b94bef766269385ee/sql/hive-thriftserver/src/main/scala/org/apache/spark/sql/hive/thriftserver/SparkOperation.scala#L51-L52",
        "createdAt" : "2020-07-03T08:22:15Z",
        "updatedAt" : "2020-08-11T02:48:03Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "bfd7ec1a-d1e0-4eef-94e1-5b705abb3992",
        "parentId" : "11b598c4-8787-40e2-9bc9-b0e067cfcc16",
        "authorId" : "7f1185d9-3900-4812-b576-80ba5f410d6b",
        "body" : "thanks, fixed",
        "createdAt" : "2020-07-03T09:17:18Z",
        "updatedAt" : "2020-08-11T02:48:03Z",
        "lastEditedBy" : "7f1185d9-3900-4812-b576-80ba5f410d6b",
        "tags" : [
        ]
      },
      {
        "id" : "75ac05d6-81ba-46c8-95fd-98eb937780f9",
        "parentId" : "11b598c4-8787-40e2-9bc9-b0e067cfcc16",
        "authorId" : "e5beb795-ac0e-4bd6-ad66-708215b8ae58",
        "body" : "Please setState before cleanup. It's an open bug, see https://github.com/apache/spark/pull/28912",
        "createdAt" : "2020-07-03T13:57:32Z",
        "updatedAt" : "2020-08-11T02:48:03Z",
        "lastEditedBy" : "e5beb795-ac0e-4bd6-ad66-708215b8ae58",
        "tags" : [
        ]
      },
      {
        "id" : "4facb138-f6a8-4db2-847a-5f7eebb6b578",
        "parentId" : "11b598c4-8787-40e2-9bc9-b0e067cfcc16",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "> Please setState before cleanup. It's an open bug, see #28912\r\n\r\nYea, nice suggestion! Might be better to add tests for that case, too.",
        "createdAt" : "2020-07-03T22:18:30Z",
        "updatedAt" : "2020-08-11T02:48:03Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "5038ec04-6819-4f2e-b2d0-42afb1ab69b3",
        "parentId" : "11b598c4-8787-40e2-9bc9-b0e067cfcc16",
        "authorId" : "7f1185d9-3900-4812-b576-80ba5f410d6b",
        "body" : "> Please setState before cleanup. It's an open bug, see #28912\r\n\r\nFixed, thanks for your review",
        "createdAt" : "2020-07-04T11:54:02Z",
        "updatedAt" : "2020-08-11T02:48:03Z",
        "lastEditedBy" : "7f1185d9-3900-4812-b576-80ba5f410d6b",
        "tags" : [
        ]
      }
    ],
    "commit" : "da76e1a7ba25ca96495cbb2ce56377983ee9f74f",
    "line" : 38,
    "diffHunk" : "@@ -1,1 +314,318 @@    synchronized {\n      if (!getStatus.getState.isTerminal) {\n        setState(OperationState.TIMEDOUT)\n        cleanup()\n        logInfo(s\"Timeout and Cancel query with $statementId \")"
  },
  {
    "id" : "a8b12201-6129-4660-9ef8-db0a5f10919e",
    "prId" : 27552,
    "prUrl" : "https://github.com/apache/spark/pull/27552#pullrequestreview-359489834",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "244743e4-2b19-4b24-9aac-df9bb8b104fc",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "I have to convert Java 8 classes to `java.sql.Timestamp`/`Date` for correct formatting. I cannot use `TimestampFormatter` here because the conversions to strings can be performed in `ColumnBuffer` in `hive-serde`.",
        "createdAt" : "2020-02-13T09:24:33Z",
        "updatedAt" : "2020-02-17T12:50:08Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "652f19c7-eebb-4eef-ac15-311391506674",
        "parentId" : "244743e4-2b19-4b24-9aac-df9bb8b104fc",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "can you add a code comment? Say that the results are passed to Hive and Hive only accepts  `Timestamp`/`Date`",
        "createdAt" : "2020-02-17T05:01:51Z",
        "updatedAt" : "2020-02-17T12:50:08Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "880b1dec95595b58688a3d5f7a2e0637a090cb47",
    "line" : 15,
    "diffHunk" : "@@ -1,1 +182,186 @@        // Convert date-time instances to types that are acceptable by Hive libs\n        // used in conversions to strings.\n        val resultRow = row.map {\n          case i: Instant => Timestamp.from(i)\n          case ld: LocalDate => Date.valueOf(ld)"
  },
  {
    "id" : "65d166a7-90ef-4c44-bb24-afc84c274f44",
    "prId" : 27552,
    "prUrl" : "https://github.com/apache/spark/pull/27552#pullrequestreview-366155848",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "1fa070e4-9e62-43c7-8f81-3a89cd1b5581",
        "parentId" : null,
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "There seems no java8 datetime values to be add to the `row` buffer here by `SparkExecuteStatementOperation#addNonNullColumnValue `\r\n\r\nhttps://github.com/apache/spark/pull/27552/files#diff-72dcd8f81a51c8a815159fdf0332acdcR84-R116",
        "createdAt" : "2020-02-28T03:38:18Z",
        "updatedAt" : "2020-02-28T03:38:33Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      },
      {
        "id" : "24979ec9-e45a-44d0-827b-adcd46bd53a4",
        "parentId" : "1fa070e4-9e62-43c7-8f81-3a89cd1b5581",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "can you help fix it? I think we should output java8 datetime values if the config is enabled.",
        "createdAt" : "2020-02-28T03:53:02Z",
        "updatedAt" : "2020-02-28T03:53:03Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "55c361bf-3e71-405a-baa6-f460d0447781",
        "parentId" : "1fa070e4-9e62-43c7-8f81-3a89cd1b5581",
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "We are limited by `hive-jdbc` module, see https://github.com/apache/hive/blob/a7e704c679a00db68db9b9f921d133d79a32cfcc/jdbc/src/java/org/apache/hive/jdbc/HiveBaseResultSet.java#L427-L457, we might need our own jdbc driver implementation to achieve this",
        "createdAt" : "2020-02-28T04:32:13Z",
        "updatedAt" : "2020-02-28T04:32:14Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      }
    ],
    "commit" : "880b1dec95595b58688a3d5f7a2e0637a090cb47",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +183,187 @@        // used in conversions to strings.\n        val resultRow = row.map {\n          case i: Instant => Timestamp.from(i)\n          case ld: LocalDate => Date.valueOf(ld)\n          case other => other"
  }
]