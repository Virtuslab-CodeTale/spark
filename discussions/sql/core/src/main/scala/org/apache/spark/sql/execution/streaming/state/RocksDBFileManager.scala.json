[
  {
    "id" : "50cec823-3ced-4571-8680-08fba445cc60",
    "prId" : 32933,
    "prUrl" : "https://github.com/apache/spark/pull/32933#pullrequestreview-692425879",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6d80c40d-e8da-4bea-97da-c86233b68320",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Is this the change for review in this PR?",
        "createdAt" : "2021-06-23T01:45:57Z",
        "updatedAt" : "2021-06-23T01:45:58Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "ab8545fb-f3b8-4810-a02d-9c753b8aadaa",
        "parentId" : "6d80c40d-e8da-4bea-97da-c86233b68320",
        "authorId" : "cd38bd5a-0fae-4d8e-8acd-36dc13753759",
        "body" : "That's right.",
        "createdAt" : "2021-06-25T03:44:39Z",
        "updatedAt" : "2021-06-25T03:44:39Z",
        "lastEditedBy" : "cd38bd5a-0fae-4d8e-8acd-36dc13753759",
        "tags" : [
        ]
      }
    ],
    "commit" : "ea949836c26be0124e37df0eb641be806628d94d",
    "line" : 35,
    "diffHunk" : "@@ -1,1 +223,227 @@   *   set of SST files.\n   */\n  def deleteOldVersions(numVersionsToRetain: Int): Unit = {\n    val path = new Path(dfsRootDir)\n"
  },
  {
    "id" : "c1506b51-9165-49cd-98cd-63d3ed83bbb1",
    "prId" : 32933,
    "prUrl" : "https://github.com/apache/spark/pull/32933#pullrequestreview-695921325",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8859dbe4-e175-4d4c-9bd7-ba3cd4902e55",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "What the second case for? When it will happen?",
        "createdAt" : "2021-06-23T01:50:13Z",
        "updatedAt" : "2021-06-23T01:50:13Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "1825e3d2-ae49-4022-957e-d3532b635bf8",
        "parentId" : "8859dbe4-e175-4d4c-9bd7-ba3cd4902e55",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "If I understand correctly, it would occur with reattempt of same micro-batch.",
        "createdAt" : "2021-06-28T09:36:58Z",
        "updatedAt" : "2021-06-28T12:04:27Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      },
      {
        "id" : "65d747e9-d791-43af-a6cd-9a5f2cf7d067",
        "parentId" : "8859dbe4-e175-4d4c-9bd7-ba3cd4902e55",
        "authorId" : "cd38bd5a-0fae-4d8e-8acd-36dc13753759",
        "body" : "Yep, that's right.",
        "createdAt" : "2021-06-30T09:49:22Z",
        "updatedAt" : "2021-06-30T09:49:22Z",
        "lastEditedBy" : "cd38bd5a-0fae-4d8e-8acd-36dc13753759",
        "tags" : [
        ]
      }
    ],
    "commit" : "ea949836c26be0124e37df0eb641be806628d94d",
    "line" : 33,
    "diffHunk" : "@@ -1,1 +221,225 @@   * - Partially written SST files\n   * - SST files that were used in a version, but that version got overwritten with a different\n   *   set of SST files.\n   */\n  def deleteOldVersions(numVersionsToRetain: Int): Unit = {"
  },
  {
    "id" : "2dcf4962-7cd1-4418-8849-d44aaad9b92a",
    "prId" : 32933,
    "prUrl" : "https://github.com/apache/spark/pull/32933#pullrequestreview-696193810",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "bb238ce0-c763-4228-bb04-e4793229407d",
        "parentId" : null,
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "Is localTempDir used only here? Just to make sure deleting the directory won't break anything.",
        "createdAt" : "2021-06-28T09:58:22Z",
        "updatedAt" : "2021-06-28T12:04:27Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      },
      {
        "id" : "fbe54132-4dc1-4b3d-9316-8b0c6157617c",
        "parentId" : "bb238ce0-c763-4228-bb04-e4793229407d",
        "authorId" : "cd38bd5a-0fae-4d8e-8acd-36dc13753759",
        "body" : "Yes, the `localTempDir` is only used for unzip files.",
        "createdAt" : "2021-06-30T13:54:14Z",
        "updatedAt" : "2021-06-30T13:54:15Z",
        "lastEditedBy" : "cd38bd5a-0fae-4d8e-8acd-36dc13753759",
        "tags" : [
        ]
      }
    ],
    "commit" : "ea949836c26be0124e37df0eb641be806628d94d",
    "line" : 114,
    "diffHunk" : "@@ -1,1 +392,396 @@  /** Get the SST files required for a version from the version zip file in DFS */\n  private def getImmutableFilesFromVersionZip(version: Long): Seq[RocksDBImmutableFile] = {\n    Utils.deleteRecursively(localTempDir)\n    localTempDir.mkdirs()\n    Utils.unzipFilesFromFile(fs, dfsBatchZipFile(version), localTempDir)"
  }
]