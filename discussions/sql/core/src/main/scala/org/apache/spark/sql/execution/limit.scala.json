[
  {
    "id" : "234a1aa5-13c4-4363-a416-f32feaf7e44f",
    "prId" : 31468,
    "prUrl" : "https://github.com/apache/spark/pull/31468#pullrequestreview-593887447",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "34f76067-a729-4fcd-bd8f-4250b1d0133c",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "EmptyRDD?",
        "createdAt" : "2021-02-10T18:53:08Z",
        "updatedAt" : "2021-02-10T18:53:08Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "68ab0ae2-54b3-4628-93c9-d985c434e22c",
        "parentId" : "34f76067-a729-4fcd-bd8f-4250b1d0133c",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "kindly ping @zhenglaizhang ",
        "createdAt" : "2021-02-18T01:51:44Z",
        "updatedAt" : "2021-02-18T01:51:44Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "ed7a4738-39b3-4a9c-bf49-2c1dee920205",
        "parentId" : "34f76067-a729-4fcd-bd8f-4250b1d0133c",
        "authorId" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "body" : "@viirya @maropu  we can not set the number of partitions in an `EmptyRDD`, it always has zero partitions.\r\n",
        "createdAt" : "2021-02-19T03:48:28Z",
        "updatedAt" : "2021-02-19T03:48:28Z",
        "lastEditedBy" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "tags" : [
        ]
      },
      {
        "id" : "ad353b15-6ca9-4cbf-aecf-55de45d1fe06",
        "parentId" : "34f76067-a729-4fcd-bd8f-4250b1d0133c",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Isn't the `childRDD` zero partitions?",
        "createdAt" : "2021-02-19T04:02:56Z",
        "updatedAt" : "2021-02-19T04:02:56Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "a4dfe101-eda8-41b7-946f-daca325055ec",
        "parentId" : "34f76067-a729-4fcd-bd8f-4250b1d0133c",
        "authorId" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "body" : "`new ParallelCollectionRDD(sparkContext, Seq.empty[InternalRow], 1, Map.empty)` is a empty rdd with single partition",
        "createdAt" : "2021-02-19T04:04:37Z",
        "updatedAt" : "2021-02-19T04:04:37Z",
        "lastEditedBy" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "tags" : [
        ]
      },
      {
        "id" : "39cb08f5-ca35-4f3e-8d6a-2f186d1e06cf",
        "parentId" : "34f76067-a729-4fcd-bd8f-4250b1d0133c",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Oh I see. I am not sure if `CollectLimitExec` must be single partition, but this looks minor. I'm okay with `ParallelCollectionRDD`. Thanks.",
        "createdAt" : "2021-02-19T04:17:39Z",
        "updatedAt" : "2021-02-19T04:17:40Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "455ba56b-135c-4c52-939e-1199ee8a0992",
        "parentId" : "34f76067-a729-4fcd-bd8f-4250b1d0133c",
        "authorId" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "body" : "@viirya the `outputPartitioning` of `CollectLimitExec` is  `SinglePartition`, so the output rdd should have single partition.",
        "createdAt" : "2021-02-19T05:36:59Z",
        "updatedAt" : "2021-02-19T05:36:59Z",
        "lastEditedBy" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "tags" : [
        ]
      },
      {
        "id" : "899b0ead-15d5-43db-84d4-653171aad2ab",
        "parentId" : "34f76067-a729-4fcd-bd8f-4250b1d0133c",
        "authorId" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "body" : "or we can use `EmptyRDDWithPartitions` defined in `CoalesceExec`?\r\nmaybe we can make `EmptyRDD` support number of partition, so we can use it in both `CollectLimitExec` and `CoalesceExec`. But I am not sure whether we should do this.",
        "createdAt" : "2021-02-19T05:44:58Z",
        "updatedAt" : "2021-02-19T05:44:59Z",
        "lastEditedBy" : "685f805b-e4fa-4f21-b066-58afcecf9ce6",
        "tags" : [
        ]
      },
      {
        "id" : "c1b05913-acf4-45e3-b94c-f39d4b4c5fd4",
        "parentId" : "34f76067-a729-4fcd-bd8f-4250b1d0133c",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "> @viirya the `outputPartitioning` of `CollectLimitExec` is `SinglePartition`, so the output rdd should have single partition.\r\n\r\nOh, my previous comment was confusing. I mean I am not sure if its `outputPartitioning` must be ` SinglePartition`.",
        "createdAt" : "2021-02-19T06:09:31Z",
        "updatedAt" : "2021-02-19T06:09:31Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "058a6810-0dee-41f3-9e4b-4170407ab11e",
        "parentId" : "34f76067-a729-4fcd-bd8f-4250b1d0133c",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "> or we can use `EmptyRDDWithPartitions` defined in `CoalesceExec`?\r\n> maybe we can make `EmptyRDD` support number of partition, so we can use it in both `CollectLimitExec` and `CoalesceExec`. But I am not sure whether we should do this.\r\n\r\nI think it sounds over-engineering. At least for now I don't think we need it.",
        "createdAt" : "2021-02-19T06:10:28Z",
        "updatedAt" : "2021-02-19T06:10:28Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "75c4d92dc7d24b6698b2eb7e5d103e95e925247a",
    "line" : 33,
    "diffHunk" : "@@ -1,1 +56,60 @@    val childRDD = child.execute()\n    if (childRDD.getNumPartitions == 0) {\n      new ParallelCollectionRDD(sparkContext, Seq.empty[InternalRow], 1, Map.empty)\n    } else {\n      val singlePartitionRDD = if (childRDD.getNumPartitions == 1) {"
  }
]