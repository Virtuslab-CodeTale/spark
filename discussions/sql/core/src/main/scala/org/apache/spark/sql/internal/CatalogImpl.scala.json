[
  {
    "id" : "b7ffcded-4ff9-4075-aa30-ea35cc6efdce",
    "prId" : 31403,
    "prUrl" : "https://github.com/apache/spark/pull/31403#pullrequestreview-580386951",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "05918c78-2a63-4571-abd9-a4361b085e53",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "It's probably time to figure out the public Scala API for multi-catalogs: Shall we have one single `CatalogImpl` instance, and all its methods support catalog? Or shall we have one `CatalogImpl` instance per catalog?\r\n\r\nThe change here makes `recoverPartitions` to support multi-catalogs.",
        "createdAt" : "2021-02-01T12:58:47Z",
        "updatedAt" : "2021-02-01T12:58:47Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "a8d5ddfc-e027-41cd-be42-18ae9773acf6",
        "parentId" : "05918c78-2a63-4571-abd9-a4361b085e53",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Currently, other methods in `CatalogImpl` can work with both v1 and v2 tables already. Look at `cacheTable()`, `isCached()`, `refreshTable()`. I don't see much difference between those methods and `recoverPartitions()`.\r\n\r\nAnd the focus of this PR is to re-use new resolution framework, and to have consistent error message. Not taking into account that recovering partition of v2 tables is not supported at the moment.\r\n\r\nIn general, `CatalogImpl` has a lot of pretty specific to v1 catalog implementation things. ",
        "createdAt" : "2021-02-01T13:43:05Z",
        "updatedAt" : "2021-02-01T13:43:05Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "6d1a9b69-b6ce-4245-8c40-b23278c5cd1e",
        "parentId" : "05918c78-2a63-4571-abd9-a4361b085e53",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "ah since it's already the case, let's move forward then.",
        "createdAt" : "2021-02-01T14:08:52Z",
        "updatedAt" : "2021-02-01T14:08:52Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "49a9455adf5e5c59e61d2ad6c413171802985b71",
    "line" : 17,
    "diffHunk" : "@@ -1,1 +446,450 @@   * @since 2.1.1\n   */\n  override def recoverPartitions(tableName: String): Unit = {\n    val multiPartIdent = sparkSession.sessionState.sqlParser.parseMultipartIdentifier(tableName)\n    sparkSession.sessionState.executePlan("
  }
]