[
  {
    "id" : "8b9084c2-aa70-4202-861f-a2414b1c14cd",
    "prId" : 29725,
    "prUrl" : "https://github.com/apache/spark/pull/29725#pullrequestreview-533142797",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4e215f70-82fe-4a28-ac57-56edc0ead617",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "nit: the file name: `SortExec.scala` -> `sorts.scala`?",
        "createdAt" : "2020-11-18T06:11:49Z",
        "updatedAt" : "2020-11-18T06:21:24Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "41223dca-4af1-4bea-94ab-0ab0e8d160a3",
        "parentId" : "4e215f70-82fe-4a28-ac57-56edc0ead617",
        "authorId" : "c9c61219-802f-49bf-82c3-2e4d14bf5f35",
        "body" : "Both WindowSortExec and SortExec are for sorting execution. So I want to keep the word suffix Exec to tell this is for a query execution.",
        "createdAt" : "2020-11-18T06:46:37Z",
        "updatedAt" : "2020-11-18T07:23:16Z",
        "lastEditedBy" : "c9c61219-802f-49bf-82c3-2e4d14bf5f35",
        "tags" : [
        ]
      }
    ],
    "commit" : "32a6714bd31fb86e3a2d057943c13ba812b6e28e",
    "line" : 3,
    "diffHunk" : "@@ -1,1 +28,32 @@import org.apache.spark.sql.catalyst.plans.physical._\nimport org.apache.spark.sql.catalyst.util.DateTimeConstants.NANOS_PER_MILLIS\nimport org.apache.spark.sql.execution.metric.SQLMetrics\nimport org.apache.spark.util.collection.unsafe.sort.PrefixComparator\n"
  },
  {
    "id" : "0f6c5593-909f-4b8f-bc3b-c6b61d908830",
    "prId" : 29725,
    "prUrl" : "https://github.com/apache/spark/pull/29725#pullrequestreview-533142797",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "72c1804a-6761-4638-b74d-2ade2ef35dba",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "We need `override` here.",
        "createdAt" : "2020-11-18T06:12:13Z",
        "updatedAt" : "2020-11-18T06:21:24Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "b9769d3c-3b06-4907-b57f-1a4a8e0ce86e",
        "parentId" : "72c1804a-6761-4638-b74d-2ade2ef35dba",
        "authorId" : "c9c61219-802f-49bf-82c3-2e4d14bf5f35",
        "body" : "Sure, will add.",
        "createdAt" : "2020-11-18T06:46:59Z",
        "updatedAt" : "2020-11-18T07:23:16Z",
        "lastEditedBy" : "c9c61219-802f-49bf-82c3-2e4d14bf5f35",
        "tags" : [
        ]
      }
    ],
    "commit" : "32a6714bd31fb86e3a2d057943c13ba812b6e28e",
    "line" : 18,
    "diffHunk" : "@@ -1,1 +50,54 @@    testSpillFrequency) {\n\n  def createSorter(): UnsafeExternalRowSorter = {\n    rowSorter = UnsafeExternalRowSorter.create(\n      schema, ordering, prefixComparator, prefixComputer, pageSize, canUseRadixSort)"
  },
  {
    "id" : "376cdb6b-34cd-4a75-a500-63a43dbff8ee",
    "prId" : 29725,
    "prUrl" : "https://github.com/apache/spark/pull/29725#pullrequestreview-533126853",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "58c3144a-7217-4812-b24d-1dab76698b0c",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "ditto: we need `override` here.",
        "createdAt" : "2020-11-18T06:13:08Z",
        "updatedAt" : "2020-11-18T06:21:24Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "32a6714bd31fb86e3a2d057943c13ba812b6e28e",
    "line" : 60,
    "diffHunk" : "@@ -1,1 +92,96 @@    testSpillFrequency) {\n\n  def createSorter(): UnsafeExternalRowWindowSorter = {\n    val partitionSpecGrouping = UnsafeProjection.create(partitionSpec, output)\n"
  },
  {
    "id" : "5b3957fe-a587-4eb9-910b-7bedcc7d0e4c",
    "prId" : 29725,
    "prUrl" : "https://github.com/apache/spark/pull/29725#pullrequestreview-533142797",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "06f64f3a-a97b-4f92-b1f0-75e423ca6e5f",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "It seems we don't need `global` for this node.",
        "createdAt" : "2020-11-18T06:13:30Z",
        "updatedAt" : "2020-11-18T06:21:24Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "734f0b65-90eb-40b0-ad49-32c38452b34d",
        "parentId" : "06f64f3a-a97b-4f92-b1f0-75e423ca6e5f",
        "authorId" : "c9c61219-802f-49bf-82c3-2e4d14bf5f35",
        "body" : "You are right, we can remove this parameter.",
        "createdAt" : "2020-11-18T06:47:20Z",
        "updatedAt" : "2020-11-18T07:23:16Z",
        "lastEditedBy" : "c9c61219-802f-49bf-82c3-2e4d14bf5f35",
        "tags" : [
        ]
      }
    ],
    "commit" : "32a6714bd31fb86e3a2d057943c13ba812b6e28e",
    "line" : 51,
    "diffHunk" : "@@ -1,1 +83,87 @@    sortOrderInWindow: Seq[SortOrder],\n    sortOrderAcrossWindows: Seq[SortOrder],\n    global: Boolean,\n    child: SparkPlan,\n    testSpillFrequency: Int = 0)"
  },
  {
    "id" : "5158d3d1-0925-4be3-8b8e-dd0a91b3c54a",
    "prId" : 29725,
    "prUrl" : "https://github.com/apache/spark/pull/29725#pullrequestreview-534137090",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b8365522-bcf3-4e60-8e1d-b81319601eb0",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "When `orderingInWindow == null` or `ortOrderInWindow.size == 0`, we need `WindowSortExec`?",
        "createdAt" : "2020-11-18T06:17:00Z",
        "updatedAt" : "2020-11-18T06:21:24Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "8f3e88ae-81fb-4818-af4c-fda40f5110b3",
        "parentId" : "b8365522-bcf3-4e60-8e1d-b81319601eb0",
        "authorId" : "c9c61219-802f-49bf-82c3-2e4d14bf5f35",
        "body" : "We don't run WindowSortExec when orderingInWindow == null or ortOrderInWindow.size == 0. We run the original SortExec if there is no need to sort within each group.",
        "createdAt" : "2020-11-18T06:44:46Z",
        "updatedAt" : "2020-11-18T07:23:16Z",
        "lastEditedBy" : "c9c61219-802f-49bf-82c3-2e4d14bf5f35",
        "tags" : [
        ]
      },
      {
        "id" : "c9a4da34-d2cd-4761-aad6-6f864c1e908e",
        "parentId" : "b8365522-bcf3-4e60-8e1d-b81319601eb0",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "If so, It seems we don't this `if` section?",
        "createdAt" : "2020-11-19T07:19:49Z",
        "updatedAt" : "2020-11-19T07:19:49Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "32a6714bd31fb86e3a2d057943c13ba812b6e28e",
    "line" : 78,
    "diffHunk" : "@@ -1,1 +110,114 @@    }\n\n    if (sortOrderInWindow == null || sortOrderInWindow.size == 0) {\n      rowSorter = UnsafeExternalRowWindowSorter.create(\n        schema,"
  },
  {
    "id" : "da218b98-a273-4854-a6c6-7b8f3a6bac9b",
    "prId" : 29725,
    "prUrl" : "https://github.com/apache/spark/pull/29725#pullrequestreview-533142797",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "eaa57370-7825-4f6e-94fd-987f4a8ec0fc",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Please add `protected` for the variables above.",
        "createdAt" : "2020-11-18T06:18:05Z",
        "updatedAt" : "2020-11-18T06:21:24Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "6127df94-0aa4-418a-a6af-340df69201ca",
        "parentId" : "eaa57370-7825-4f6e-94fd-987f4a8ec0fc",
        "authorId" : "c9c61219-802f-49bf-82c3-2e4d14bf5f35",
        "body" : "Sure, I will add it.",
        "createdAt" : "2020-11-18T06:44:59Z",
        "updatedAt" : "2020-11-18T07:23:16Z",
        "lastEditedBy" : "c9c61219-802f-49bf-82c3-2e4d14bf5f35",
        "tags" : [
        ]
      }
    ],
    "commit" : "32a6714bd31fb86e3a2d057943c13ba812b6e28e",
    "line" : 168,
    "diffHunk" : "@@ -1,1 +205,209 @@    SortPrefixUtils.canSortFullyWithPrefix(boundSortExpression)\n\n  lazy val pageSize = SparkEnv.get.memoryManager.pageSizeBytes\n\n  override lazy val metrics = Map("
  },
  {
    "id" : "45e8e7fe-4061-4048-966c-7d25bc6b5693",
    "prId" : 29725,
    "prUrl" : "https://github.com/apache/spark/pull/29725#pullrequestreview-533126853",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "fa161c88-ccd1-404f-8b77-5b28f92422e8",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Could you leave some comments about what's a difference from `SortExec`?",
        "createdAt" : "2020-11-18T06:20:25Z",
        "updatedAt" : "2020-11-18T06:21:24Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "32a6714bd31fb86e3a2d057943c13ba812b6e28e",
    "line" : 34,
    "diffHunk" : "@@ -1,1 +66,70 @@\n/**\n * Performs (external) sorting for multiple windows.\n *\n * @param partitionSpec a sequence of expressions that defines a partition key"
  },
  {
    "id" : "f09eeacb-b291-4c74-9896-3dc262cd2e6a",
    "prId" : 29725,
    "prUrl" : "https://github.com/apache/spark/pull/29725#pullrequestreview-533135049",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e5defd5c-1598-4c34-a4b7-ddbbc0d38380",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Could you add `assert(partitionSpec.nonEmpty && sortOrderInWindow.nonEmpty, \"XXX\")` here?",
        "createdAt" : "2020-11-18T06:26:11Z",
        "updatedAt" : "2020-11-18T06:26:11Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "32a6714bd31fb86e3a2d057943c13ba812b6e28e",
    "line" : 59,
    "diffHunk" : "@@ -1,1 +91,95 @@    child,\n    testSpillFrequency) {\n\n  def createSorter(): UnsafeExternalRowWindowSorter = {\n    val partitionSpecGrouping = UnsafeProjection.create(partitionSpec, output)"
  }
]