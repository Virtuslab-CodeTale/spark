[
  {
    "id" : "41f93f26-84a7-4434-81d0-2075672893ab",
    "prId" : 33624,
    "prUrl" : "https://github.com/apache/spark/pull/33624#pullrequestreview-723308539",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f5b89c24-9bb1-424c-a1e1-4a5ebddeb186",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "link to the previous discussion: https://github.com/apache/spark/pull/33624#discussion_r682088051",
        "createdAt" : "2021-08-04T08:37:00Z",
        "updatedAt" : "2021-08-04T08:37:00Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "46d659e0-e181-4364-9a48-054a67713387",
        "parentId" : "f5b89c24-9bb1-424c-a1e1-4a5ebddeb186",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "can we keep the docs of https://github.com/apache/spark/pull/33624/files#diff-ec42cd27662f3f528832c298a60fffa1d341feb04aa1d8c80044b70cbe0ebbfcL199-L203?",
        "createdAt" : "2021-08-05T00:57:28Z",
        "updatedAt" : "2021-08-05T00:57:29Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "db53c2c4-9333-45a9-a33f-a283cc6f6ae0",
        "parentId" : "f5b89c24-9bb1-424c-a1e1-4a5ebddeb186",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "that doc doesn't apply any more right now.",
        "createdAt" : "2021-08-05T12:46:02Z",
        "updatedAt" : "2021-08-05T12:46:03Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "f768a3f08c46edc8d4e85f1dc313ff9db539edea",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +67,71 @@    @transient preprocessingRules: Seq[Rule[SparkPlan]],\n    @transient isSubquery: Boolean,\n    @transient override val supportsColumnar: Boolean = false)\n  extends LeafExecNode {\n"
  },
  {
    "id" : "9eb7a868-7e3b-4f91-aed4-1dc179296d67",
    "prId" : 33624,
    "prUrl" : "https://github.com/apache/spark/pull/33624#pullrequestreview-722960096",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6eec92c2-8cab-4616-90a1-054e33f2b7b1",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "can we move this method back?",
        "createdAt" : "2021-08-05T00:51:29Z",
        "updatedAt" : "2021-08-05T00:51:29Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "6d05fc31-461b-4671-a25c-2dc6174c572c",
        "parentId" : "6eec92c2-8cab-4616-90a1-054e33f2b7b1",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "it's not just moving around, it follows the other methods to also call `withFinalPlanUpdate`.",
        "createdAt" : "2021-08-05T05:55:48Z",
        "updatedAt" : "2021-08-05T05:55:49Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "f768a3f08c46edc8d4e85f1dc313ff9db539edea",
    "line" : 80,
    "diffHunk" : "@@ -1,1 +349,353 @@  }\n\n  override def doExecuteBroadcast[T](): broadcast.Broadcast[T] = {\n    withFinalPlanUpdate { finalPlan =>\n      assert(finalPlan.isInstanceOf[BroadcastQueryStageExec])"
  },
  {
    "id" : "45dbfe4e-72c1-4e0c-aea3-bd844257cf7a",
    "prId" : 33541,
    "prUrl" : "https://github.com/apache/spark/pull/33541#pullrequestreview-716574738",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2c5fc7ac-9757-4221-8a16-c62b972d1601",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "If `requiredDistribution` is `None` (the case like `df.repartition(a, b).select(c)`), does the validation still work? If the user-specified distribution is removed, the validation seem not able to detect it?",
        "createdAt" : "2021-07-28T04:03:54Z",
        "updatedAt" : "2021-07-28T04:05:10Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "5d34c95d-4e11-4ac8-ae06-12e89926b7c7",
        "parentId" : "2c5fc7ac-9757-4221-8a16-c62b972d1601",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "If `requiredDistribution` is `None`, we don't need `ValidateRequirements` to check the distribution, as `EnsureRequirement` won't remove the effective user-specified repartition. I'll add more comments here.",
        "createdAt" : "2021-07-28T04:43:47Z",
        "updatedAt" : "2021-07-28T04:43:48Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "61cc6751e4baad96f0a8b251296c6e58ffbbf3a3",
    "line" : 72,
    "diffHunk" : "@@ -1,1 +141,145 @@            // out the user-specified repartition, thus we don't have a distribution requirement\n            // for the final plan.\n            requiredDistribution.getOrElse(UnspecifiedDistribution)\n          } else {\n            UnspecifiedDistribution"
  },
  {
    "id" : "666c578e-f4a8-4841-8b7e-3da5d3faffd1",
    "prId" : 33244,
    "prUrl" : "https://github.com/apache/spark/pull/33244#pullrequestreview-702612558",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "173307f4-eb14-4bd6-b21e-8a7222cbdd25",
        "parentId" : null,
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "I think it's a better place to fix this issue",
        "createdAt" : "2021-07-08T06:32:49Z",
        "updatedAt" : "2021-07-08T06:32:49Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      },
      {
        "id" : "7616278c-9943-4f0a-a1bf-0f21e282a420",
        "parentId" : "173307f4-eb14-4bd6-b21e-8a7222cbdd25",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Could you also add a simple comment mentioning why we use `inputPlan` instead of `currentPhysicalPlan` ?",
        "createdAt" : "2021-07-08T18:05:49Z",
        "updatedAt" : "2021-07-08T18:05:50Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "25f507c7-4121-4756-8a74-fd3b92751f08",
        "parentId" : "173307f4-eb14-4bd6-b21e-8a7222cbdd25",
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "sure, added",
        "createdAt" : "2021-07-09T01:24:55Z",
        "updatedAt" : "2021-07-09T01:24:55Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      }
    ],
    "commit" : "ed90d588467b668a1ef314907c2f5ef777bdb95e",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +189,193 @@      // Use inputPlan logicalLink here in case some top level physical nodes may be removed\n      // during `initialPlan`\n      var currentLogicalPlan = inputPlan.logicalLink.get\n      var result = createQueryStages(currentPhysicalPlan)\n      val events = new LinkedBlockingQueue[StageMaterializationEvent]()"
  }
]