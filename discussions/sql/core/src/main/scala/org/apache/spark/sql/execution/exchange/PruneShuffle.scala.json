[
  {
    "id" : "a731da6e-f374-445f-86a9-8bdf2e4868a3",
    "prId" : 29677,
    "prUrl" : "https://github.com/apache/spark/pull/29677#pullrequestreview-502575645",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d9398bdb-68a7-4015-bb39-cd6168c6eab4",
        "parentId" : null,
        "authorId" : "a8e23d47-3ae4-4385-848c-38a216d1bd08",
        "body" : "I'd propose a more concise way:\r\n\r\n```suggestion\r\ncase class PruneShuffle() extends Rule[SparkPlan] {\r\n\r\n  override def apply(plan: SparkPlan): SparkPlan = plan transformUp {\r\n    case op @ ShuffleExchangeExec(_, ShuffleExchangeExec(_, grandchild, _), _) =>\r\n      op.withNewChildren(grandchild :: Nil)\r\n  }\r\n}\r\n```",
        "createdAt" : "2020-10-05T03:18:13Z",
        "updatedAt" : "2020-10-28T01:59:17Z",
        "lastEditedBy" : "a8e23d47-3ae4-4385-848c-38a216d1bd08",
        "tags" : [
        ]
      },
      {
        "id" : "c6a3cde9-a667-4165-be8d-8bd192a5aa0a",
        "parentId" : "d9398bdb-68a7-4015-bb39-cd6168c6eab4",
        "authorId" : "3a227965-84e0-47cf-9974-11293764f028",
        "body" : "Hmm, in the current implementation, at most two `ShuffleExchangeExec` can be consecutive. But if it is more consecutive in the future, `transformUp` is not efficient. ",
        "createdAt" : "2020-10-06T02:47:08Z",
        "updatedAt" : "2020-10-28T01:59:17Z",
        "lastEditedBy" : "3a227965-84e0-47cf-9974-11293764f028",
        "tags" : [
        ]
      },
      {
        "id" : "509821bd-895f-4543-88c3-f57278f2911a",
        "parentId" : "d9398bdb-68a7-4015-bb39-cd6168c6eab4",
        "authorId" : "a8e23d47-3ae4-4385-848c-38a216d1bd08",
        "body" : "TBH performance wise we are talking about millisecond level optimization here. I would value readability over micro optimizations. ",
        "createdAt" : "2020-10-06T03:13:18Z",
        "updatedAt" : "2020-10-28T01:59:17Z",
        "lastEditedBy" : "a8e23d47-3ae4-4385-848c-38a216d1bd08",
        "tags" : [
        ]
      },
      {
        "id" : "58850774-685c-4e3d-879b-cd1e5d8fb01b",
        "parentId" : "d9398bdb-68a7-4015-bb39-cd6168c6eab4",
        "authorId" : "3a227965-84e0-47cf-9974-11293764f028",
        "body" : "Similar to what is discussed [here](https://github.com/apache/spark/pull/21072#discussion_r183392394), I'd like to avoid unnecessary transformation.",
        "createdAt" : "2020-10-06T04:31:03Z",
        "updatedAt" : "2020-10-28T01:59:17Z",
        "lastEditedBy" : "3a227965-84e0-47cf-9974-11293764f028",
        "tags" : [
        ]
      }
    ],
    "commit" : "95454a265a807d9ac3cb5714710a2afee9caaea5",
    "line" : 43,
    "diffHunk" : "@@ -1,1 +41,45 @@    }\n  }\n}"
  }
]