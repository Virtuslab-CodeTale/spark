[
  {
    "id" : "e5d661b9-87de-49f3-8c07-fe3e3d6717d4",
    "prId" : 31423,
    "prUrl" : "https://github.com/apache/spark/pull/31423#pullrequestreview-581033105",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d8fc5630-d535-4ca6-92e6-8420829a3f8e",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "New index re-uses the file statuses cache `fileStatusCache`, so, this should allow to avoid additional accesses to the file  system.",
        "createdAt" : "2021-02-02T06:58:13Z",
        "updatedAt" : "2021-02-03T08:19:07Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "eeda34a4dca66c9ae747c0f5fa1b963f877f6c87",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +420,424 @@            getOrInferFileFormatSchema(format, () => indexForSchemaInference)\n          val index = new InMemoryFileIndex(\n            sparkSession, globbedPaths, options, Some(resultPartitionSchema), fileStatusCache)\n          (index, resultDataSchema, resultPartitionSchema)\n        }"
  },
  {
    "id" : "9516b962-6a31-42d6-9168-828831fb6c89",
    "prId" : 31423,
    "prUrl" : "https://github.com/apache/spark/pull/31423#pullrequestreview-582099348",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e035c1e9-44bb-456e-851a-bc82d91970fc",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "What's diff from calling `createInMemoryFileIndex` here?",
        "createdAt" : "2021-02-03T08:02:06Z",
        "updatedAt" : "2021-02-03T08:19:07Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "075b03e6-bb57-4d59-bdba-d69547f99059",
        "parentId" : "e035c1e9-44bb-456e-851a-bc82d91970fc",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "`fileStatusCache`. I want to re-use it.",
        "createdAt" : "2021-02-03T08:16:31Z",
        "updatedAt" : "2021-02-03T08:19:07Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "eeda34a4dca66c9ae747c0f5fa1b963f877f6c87",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +416,420 @@          val fileStatusCache = FileStatusCache.getOrCreate(sparkSession)\n          val indexForSchemaInference = new InMemoryFileIndex(\n            sparkSession, globbedPaths, options, userSpecifiedSchema, fileStatusCache)\n          val (resultDataSchema, resultPartitionSchema) =\n            getOrInferFileFormatSchema(format, () => indexForSchemaInference)"
  },
  {
    "id" : "a38e6c68-fe3f-48ec-aea5-4ebc9e3b6156",
    "prId" : 29437,
    "prUrl" : "https://github.com/apache/spark/pull/29437#pullrequestreview-469009097",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7d4eaede-f4aa-416b-be8b-71f9bfe9f696",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Fixing at the caller seems good. But `inferSchema` is actually implemented by various format, we don't know if they will use `path` in the implementation. That's one concern.",
        "createdAt" : "2020-08-18T04:16:36Z",
        "updatedAt" : "2020-08-19T05:34:32Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "c9e36c4c-679a-4761-a4d1-0fe776d3e1ef",
        "parentId" : "7d4eaede-f4aa-416b-be8b-71f9bfe9f696",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "`FileFormat` is an internal API, I think it's natural to assume `paths` parameter will be used, and all builtin implementations do.",
        "createdAt" : "2020-08-18T05:51:41Z",
        "updatedAt" : "2020-08-19T05:34:32Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "6f147ee0ac20af8142a3dc715a9dbc7952f99265",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +196,200 @@      format.inferSchema(\n        sparkSession,\n        caseInsensitiveOptions - \"path\",\n        tempFileIndex.allFiles())\n    }.getOrElse {"
  }
]