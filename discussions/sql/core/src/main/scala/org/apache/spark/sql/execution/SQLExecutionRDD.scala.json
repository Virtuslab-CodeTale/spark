[
  {
    "id" : "cb64f582-f0e4-404b-a33f-4d08548309f9",
    "prId" : 25738,
    "prUrl" : "https://github.com/apache/spark/pull/25738#pullrequestreview-285975477",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "708a6ac4-3bcf-4b2b-8fad-abf1ac4f80d6",
        "parentId" : null,
        "authorId" : "80d631a6-73e8-46a6-a01b-a80d1f1cc6cc",
        "body" : "I know it is a bit late, but why are we not setting the configurations directly?",
        "createdAt" : "2019-09-10T07:27:03Z",
        "updatedAt" : "2019-09-10T07:27:03Z",
        "lastEditedBy" : "80d631a6-73e8-46a6-a01b-a80d1f1cc6cc",
        "tags" : [
        ]
      },
      {
        "id" : "098c716d-86e7-4457-9c48-707c3359e0d6",
        "parentId" : "708a6ac4-3bcf-4b2b-8fad-abf1ac4f80d6",
        "authorId" : "80d631a6-73e8-46a6-a01b-a80d1f1cc6cc",
        "body" : "@mgaido91 any idea?",
        "createdAt" : "2019-09-10T07:27:26Z",
        "updatedAt" : "2019-09-10T07:27:26Z",
        "lastEditedBy" : "80d631a6-73e8-46a6-a01b-a80d1f1cc6cc",
        "tags" : [
        ]
      },
      {
        "id" : "d904f1a1-f6e8-49a0-aa88-be0f04665b4b",
        "parentId" : "708a6ac4-3bcf-4b2b-8fad-abf1ac4f80d6",
        "authorId" : "24e1dd39-ae3f-4bbb-a391-f60afb62d075",
        "body" : "the reason why I created the properties object was to have it in a synchronized block, but since we are in a lazy val it is probably useless...",
        "createdAt" : "2019-09-10T08:00:53Z",
        "updatedAt" : "2019-09-10T08:00:53Z",
        "lastEditedBy" : "24e1dd39-ae3f-4bbb-a391-f60afb62d075",
        "tags" : [
        ]
      },
      {
        "id" : "8c3cf035-408c-4abd-89ec-2f726c357c1e",
        "parentId" : "708a6ac4-3bcf-4b2b-8fad-abf1ac4f80d6",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "@mgaido91 can you send a followup PR to clean it up? Now we can't set the SQL confs in a batch and I don't think it's useful to have this `Properties`.",
        "createdAt" : "2019-09-10T08:06:25Z",
        "updatedAt" : "2019-09-10T08:06:25Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "25b85a3d-813e-41b5-8ec9-39265e1a5e2b",
        "parentId" : "708a6ac4-3bcf-4b2b-8fad-abf1ac4f80d6",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "@hvanhovell and @mgaido91 . Feel free to make a follow-up if we need. Also, please apply that in the backporting PR, #25734, before merging for consistency.",
        "createdAt" : "2019-09-10T08:07:56Z",
        "updatedAt" : "2019-09-10T08:07:57Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "232ffb00-1192-4532-a052-0eb9164f3fc2",
        "parentId" : "708a6ac4-3bcf-4b2b-8fad-abf1ac4f80d6",
        "authorId" : "24e1dd39-ae3f-4bbb-a391-f60afb62d075",
        "body" : "sure @cloud-fan , I am doing that. Thanks for the remainder @dongjoon-hyun, I'll update the backport PR once this is stable. Thanks.",
        "createdAt" : "2019-09-10T08:13:15Z",
        "updatedAt" : "2019-09-10T08:13:15Z",
        "lastEditedBy" : "24e1dd39-ae3f-4bbb-a391-f60afb62d075",
        "tags" : [
        ]
      }
    ],
    "commit" : "54b44c7fe3df2fe7bb6cc03416e04c6247a68994",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +40,44 @@  private lazy val sqlConfExecutorSide = {\n    val props = new Properties()\n    sqlConfigs.foreach { case (k, v) => props.setProperty(k, v) }\n    val newConf = new SQLConf()\n    newConf.setConf(props)"
  },
  {
    "id" : "225d6368-8375-4814-b2b6-1aef8485d615",
    "prId" : 25734,
    "prUrl" : "https://github.com/apache/spark/pull/25734#pullrequestreview-287283204",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d73dd09e-25fb-4a5e-9db4-ec4e589d680f",
        "parentId" : null,
        "authorId" : "80d631a6-73e8-46a6-a01b-a80d1f1cc6cc",
        "body" : "Sorry for being late to the party here, why can't we use the `conf` in the constructor? Perhaps that one was supposed to be marked as transient?",
        "createdAt" : "2019-09-12T08:27:48Z",
        "updatedAt" : "2019-09-12T10:30:44Z",
        "lastEditedBy" : "80d631a6-73e8-46a6-a01b-a80d1f1cc6cc",
        "tags" : [
        ]
      },
      {
        "id" : "d420d36e-fc8b-4db6-ac88-43a4337672e7",
        "parentId" : "d73dd09e-25fb-4a5e-9db4-ec4e589d680f",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "`SQLConf` has marked all its member variables with `@transient`, so practically `SQLConf` is not serializable. This is from day 1: https://github.com/apache/spark/pull/956/files#diff-41ef65b9ef5b518f77e2a03559893f4dR35\r\n\r\nWe can also revisit it. ",
        "createdAt" : "2019-09-12T08:52:47Z",
        "updatedAt" : "2019-09-12T10:30:44Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "2db08a7e-c779-401e-b75d-b0683ddae66d",
        "parentId" : "d73dd09e-25fb-4a5e-9db4-ec4e589d680f",
        "authorId" : "80d631a6-73e8-46a6-a01b-a80d1f1cc6cc",
        "body" : "Ok, then it makes sense. Sorry for the fuss.",
        "createdAt" : "2019-09-12T08:56:28Z",
        "updatedAt" : "2019-09-12T10:30:44Z",
        "lastEditedBy" : "80d631a6-73e8-46a6-a01b-a80d1f1cc6cc",
        "tags" : [
        ]
      }
    ],
    "commit" : "1b145e2158679dc27fce07a8ddf17f6341175afe",
    "line" : 36,
    "diffHunk" : "@@ -1,1 +34,38 @@    var sqlRDD: RDD[InternalRow], conf: SQLConf) extends RDD[InternalRow](sqlRDD) {\n  private val sqlConfigs = conf.getAllConfs\n  private lazy val sqlConfExecutorSide = {\n    val newConf = new SQLConf()\n    sqlConfigs.foreach { case (k, v) => newConf.setConfString(k, v) }"
  },
  {
    "id" : "0fe80116-3b51-4589-920f-6cfb367aa49b",
    "prId" : 25643,
    "prUrl" : "https://github.com/apache/spark/pull/25643#pullrequestreview-284998062",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "237e9863-6277-4abb-9415-d47a0c861dd2",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Do we need to pass in a SQLConf? I think we just always capture current SQLConf, so just `private val sqlConfigs = SQLConf.get.getAllConfs`?",
        "createdAt" : "2019-09-05T21:07:19Z",
        "updatedAt" : "2019-09-09T07:43:51Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "1a197f1f-5e1f-42cd-b9cf-2b19a4c7738c",
        "parentId" : "237e9863-6277-4abb-9415-d47a0c861dd2",
        "authorId" : "24e1dd39-ae3f-4bbb-a391-f60afb62d075",
        "body" : "I prefer the current way, as the `SQLConf` it is passed directly from the spark session as per @cloud-fan 's comment: https://github.com/apache/spark/pull/25643#discussion_r319821106",
        "createdAt" : "2019-09-06T06:38:09Z",
        "updatedAt" : "2019-09-09T07:43:51Z",
        "lastEditedBy" : "24e1dd39-ae3f-4bbb-a391-f60afb62d075",
        "tags" : [
        ]
      },
      {
        "id" : "7b27aa7d-3c89-4436-8a23-9ad4f61e721c",
        "parentId" : "237e9863-6277-4abb-9415-d47a0c861dd2",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Ok. I'm fine with it.",
        "createdAt" : "2019-09-06T17:26:32Z",
        "updatedAt" : "2019-09-09T07:43:51Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "11848f59c6230d935127e0d939dcc89610b45c74",
    "line" : 38,
    "diffHunk" : "@@ -1,1 +36,40 @@ */\nclass SQLExecutionRDD(\n    var sqlRDD: RDD[InternalRow], @transient conf: SQLConf) extends RDD[InternalRow](sqlRDD) {\n  private val sqlConfigs = conf.getAllConfs\n  private lazy val sqlConfExecutorSide = {"
  },
  {
    "id" : "8a8750b1-ba88-4771-a129-bf83834e9761",
    "prId" : 25643,
    "prUrl" : "https://github.com/apache/spark/pull/25643#pullrequestreview-284591639",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5a6ce0fd-3109-4e2f-aa43-50df1e0baad7",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "oh, it got better.",
        "createdAt" : "2019-09-05T23:24:30Z",
        "updatedAt" : "2019-09-09T07:43:51Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "11848f59c6230d935127e0d939dcc89610b45c74",
    "line" : 57,
    "diffHunk" : "@@ -1,1 +55,59 @@    // this RDD.\n    if (context.getLocalProperty(SQLExecution.EXECUTION_ID_KEY) == null) {\n      SQLConf.withExistingConf(sqlConfExecutorSide) {\n        firstParent[InternalRow].iterator(split, context)\n      }"
  }
]