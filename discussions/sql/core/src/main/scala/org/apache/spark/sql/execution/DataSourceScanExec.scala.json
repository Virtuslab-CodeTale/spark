[
  {
    "id" : "e8bd9030-fefd-4674-a16a-b72ed5296e49",
    "prId" : 31413,
    "prUrl" : "https://github.com/apache/spark/pull/31413#pullrequestreview-623210655",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "dcd4d40a-b28d-4478-8234-4840bfd7d293",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "It's a bit odd that we call method name as `createNonBucketedReadRDD` but do something with buckets. I guess we could name `createNonBucketedReadRDD` like just `createReadRDD` or `createStandardReadRDD`",
        "createdAt" : "2021-03-29T13:11:32Z",
        "updatedAt" : "2021-03-29T13:11:32Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "03120af6b31af89dbc9fb9aad05045e98d52c699",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +591,595 @@      s\"open cost is considered as scanning $openCostInBytes bytes.\")\n\n    // Filter files with bucket pruning if possible\n    val bucketingEnabled = fsRelation.sparkSession.sessionState.conf.bucketingEnabled\n    val shouldProcess: Path => Boolean = optionalBucketSet match {"
  },
  {
    "id" : "de9777a3-fec5-4ba1-9725-1ffa6b61c36e",
    "prId" : 31413,
    "prUrl" : "https://github.com/apache/spark/pull/31413#pullrequestreview-623231689",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5f7b281e-4183-4bd2-b5a4-0d910d265067",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Hm, it could be one liner:\r\n\r\n```scala\r\n        filePath => BucketingUtils.getBucketId(filePath.getName).forall(bucketSet.get)\r\n```\r\n\r\nIf it looks less readable we could:\r\n\r\n```scala\r\n        filePath => BucketingUtils.getBucketId(filePath.getName).map(bucketSet.get).getOrElse\r\n```\r\n\r\nIf we worry about perf penalty from pattern matching, etc. we could do:\r\n\r\n```scala\r\n        filePath => {\r\n          val bucketId = BucketingUtils.getBucketId(filePath.getName)\r\n          if (bucketId.isEmpty) true else bucketSet.get(bucketId.get)\r\n        }\r\n``` \r\n",
        "createdAt" : "2021-03-29T13:31:51Z",
        "updatedAt" : "2021-03-29T13:31:51Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "03120af6b31af89dbc9fb9aad05045e98d52c699",
    "line" : 25,
    "diffHunk" : "@@ -1,1 +600,604 @@            case None =>\n              // Do not prune the file if bucket file name is invalid\n              true\n          }\n        }"
  }
]