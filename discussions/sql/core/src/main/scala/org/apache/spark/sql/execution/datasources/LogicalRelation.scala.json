[
  {
    "id" : "2400d52f-d0fd-4809-9454-6b8e93444651",
    "prId" : 31196,
    "prUrl" : "https://github.com/apache/spark/pull/31196#pullrequestreview-590880617",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e33c5234-9015-49f1-abe5-2b39d487d008",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Can we fix DSv2 code path too? cc @MaxGekk, @imback82, @cloud-fan too",
        "createdAt" : "2021-01-17T10:33:56Z",
        "updatedAt" : "2021-02-20T00:08:15Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "ffdc0b0f-86f0-4af1-9bf8-b603afff8c2d",
        "parentId" : "e33c5234-9015-49f1-abe5-2b39d487d008",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "It should already show the table name:\r\nhttps://github.com/apache/spark/blob/e857e06452c2cf478beb31367f76d6950b660ebb/sql/catalyst/src/main/scala/org/apache/spark/sql/execution/datasources/v2/DataSourceV2Relation.scala#L72\r\n\r\nThe question is should we show `identifier`.",
        "createdAt" : "2021-01-17T10:44:12Z",
        "updatedAt" : "2021-02-20T00:08:15Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "3761ced0-730f-42f2-96cc-01cdc232d2df",
        "parentId" : "e33c5234-9015-49f1-abe5-2b39d487d008",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "The problem is that it doesn't seem to show a table name: https://github.com/apache/spark/blob/e3058ba17cb4512537953eb4ded884e24ee93ba2/sql/core/src/main/scala/org/apache/spark/sql/execution/datasources/v2/FileDataSourceV2.scala#L66-L71\r\n\r\nIs it because `Table` API lets users to implement what name it returns, and Spark does not implement a catalog for its internal file sources? Seems like JDBC v2 supports its fully qualified name via `Identifier.toString`. If this is the case, I think it's fine.",
        "createdAt" : "2021-01-17T11:02:53Z",
        "updatedAt" : "2021-02-20T00:08:15Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "8ed0579b-ad6a-41d9-9b88-17c87f919956",
        "parentId" : "e33c5234-9015-49f1-abe5-2b39d487d008",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "There are 2 \"names\" for v2 tables: the name to look up it and the name `Table` instance returns. It's possible that people use `tbl` to look up a v2 table and `Table.name` returns a file path. I think we should show both.",
        "createdAt" : "2021-01-18T06:17:40Z",
        "updatedAt" : "2021-02-20T00:08:15Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "752ef960-74f3-4c3d-83c1-f23566d005c0",
        "parentId" : "e33c5234-9015-49f1-abe5-2b39d487d008",
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "Yes. It seems v2 already show the table name. for example: `ParquetTable.name()` is table name.\r\nhttps://github.com/apache/spark/blob/e857e06452c2cf478beb31367f76d6950b660ebb/sql/catalyst/src/main/scala/org/apache/spark/sql/execution/datasources/v2/DataSourceV2Relation.scala#L67\r\n\r\nhttps://github.com/apache/spark/blob/e857e06452c2cf478beb31367f76d6950b660ebb/sql/catalyst/src/main/scala/org/apache/spark/sql/execution/datasources/v2/DataSourceV2Relation.scala#L123\r\n\r\nhttps://github.com/apache/spark/blob/3d1dce75d96373130e27b3809c73d3796b5b77be/sql/core/src/main/scala/org/apache/spark/sql/execution/datasources/v2/parquet/ParquetDataSourceV2.scala#L34-L36\r\n\r\n",
        "createdAt" : "2021-02-13T14:07:00Z",
        "updatedAt" : "2021-02-20T04:44:45Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      },
      {
        "id" : "386780e7-fffb-465b-a5bf-888e464307b1",
        "parentId" : "e33c5234-9015-49f1-abe5-2b39d487d008",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Okay, I am fine.",
        "createdAt" : "2021-02-16T04:41:22Z",
        "updatedAt" : "2021-02-20T00:08:15Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "e95280f3b0da8c8465361e7703c1e691ddc4925a",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +66,70 @@  override def simpleString(maxFields: Int): String = {\n    s\"Relation ${catalogTable.map(_.identifier.unquotedString).getOrElse(\"\")}\" +\n      s\"[${truncatedString(output, \",\", maxFields)}] $relation\"\n  }\n}"
  }
]