[
  {
    "id" : "a151b88a-1f0a-415d-ba12-54d85ca97333",
    "prId" : 33531,
    "prUrl" : "https://github.com/apache/spark/pull/33531#pullrequestreview-716526437",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "63a1ea3c-dbeb-46ca-8ebd-d8b166e178e7",
        "parentId" : null,
        "authorId" : "99765afe-8dbe-4d5f-9ad3-d5bc40f0462b",
        "body" : "The change looks good. I just have a quick question: I saw your other PR refactor the code to unify the schema check for avro/parquet/orc in DDL. Should this setSchema and inner field check code be refactored and unified too for avro and ocr?",
        "createdAt" : "2021-07-27T22:51:42Z",
        "updatedAt" : "2021-07-27T22:51:43Z",
        "lastEditedBy" : "99765afe-8dbe-4d5f-9ad3-d5bc40f0462b",
        "tags" : [
        ]
      },
      {
        "id" : "f086343e-34a6-4b27-af14-9ecf4bd5061a",
        "parentId" : "63a1ea3c-dbeb-46ca-8ebd-d8b166e178e7",
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "> The change looks good. I just have a quick question: I saw your other PR refactor the code to unify the schema check for avro/parquet/orc in DDL. Should this setSchema and inner field check code be refactored and unified too for avro and ocr?\r\n\r\nWill do this in other pr for all v1 insert behavior.",
        "createdAt" : "2021-07-28T02:24:23Z",
        "updatedAt" : "2021-07-28T02:24:23Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      }
    ],
    "commit" : "eed72e1160a5d3a061e9c977230149453cee56d4",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +483,487 @@\n  def setSchema(schema: StructType, configuration: Configuration): Unit = {\n    ParquetSchemaConverter.checkFieldNames(schema)\n    configuration.set(SPARK_ROW_SCHEMA, schema.json)\n    configuration.setIfUnset("
  }
]