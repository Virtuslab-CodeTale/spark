[
  {
    "id" : "6bf1aa29-daad-4012-adf3-8e0be1ce03b4",
    "prId" : 29437,
    "prUrl" : "https://github.com/apache/spark/pull/29437#pullrequestreview-470136756",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7ce9ef7a-5bd6-4cfb-b99a-aa2d00f0b847",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "nit:\r\n```\r\nval withoutPath = options.asCaseSensitiveMap().asScala.filterKeys {\r\n  k => !k.equalsIgnoreCase(\"path\") && !k.equalsIgnoreCase(\"paths\")\r\n}\r\nnew CaseInsensitiveStringMap(withoutPath.asJava)\r\n```",
        "createdAt" : "2020-08-19T04:59:36Z",
        "updatedAt" : "2020-08-19T05:34:32Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "ac212d2c-30ad-467a-9c5d-6cd466ba4f10",
        "parentId" : "7ce9ef7a-5bd6-4cfb-b99a-aa2d00f0b847",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "Thanks!",
        "createdAt" : "2020-08-19T05:34:54Z",
        "updatedAt" : "2020-08-19T05:34:54Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "6f147ee0ac20af8142a3dc715a9dbc7952f99265",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +58,62 @@  }\n\n  protected def getOptionsWithoutPaths(map: CaseInsensitiveStringMap): CaseInsensitiveStringMap = {\n    val withoutPath = map.asCaseSensitiveMap().asScala.filterKeys { k =>\n      !k.equalsIgnoreCase(\"path\") && !k.equalsIgnoreCase(\"paths\")"
  },
  {
    "id" : "e090acc2-bbd8-4cb3-bf0f-ab85b15aff49",
    "prId" : 26750,
    "prUrl" : "https://github.com/apache/spark/pull/26750#pullrequestreview-328638416",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "feb6bb4c-8144-4615-bccb-0b1cca2b6110",
        "parentId" : null,
        "authorId" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "body" : "Nit: These methods should have a newline between them.",
        "createdAt" : "2019-12-08T22:48:47Z",
        "updatedAt" : "2019-12-08T22:48:47Z",
        "lastEditedBy" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "tags" : [
        ]
      }
    ],
    "commit" : "7fcee0cac5a093481a8740aabda9dd5083bbdaf4",
    "line" : 31,
    "diffHunk" : "@@ -1,1 +72,76 @@    getTable(new CaseInsensitiveStringMap(properties))\n  }\n  override def getTable(schema: StructType, properties: util.Map[String, String]): Table = {\n    getTable(new CaseInsensitiveStringMap(properties), schema)\n  }"
  },
  {
    "id" : "14add8dc-cb58-4de2-b5ea-480596f34a91",
    "prId" : 26297,
    "prUrl" : "https://github.com/apache/spark/pull/26297#pullrequestreview-310727727",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "109cb9c4-48f3-4c96-9d11-79d1c2740930",
        "parentId" : null,
        "authorId" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "body" : "This is the only one I see that uses schema, and that is just to create the file index.",
        "createdAt" : "2019-11-01T22:49:26Z",
        "updatedAt" : "2019-11-27T16:28:24Z",
        "lastEditedBy" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "tags" : [
        ]
      }
    ],
    "commit" : "95b62b6dd5a0c58b001f3faddd8527858bbc792c",
    "line" : 76,
    "diffHunk" : "@@ -1,1 +85,89 @@  }\n\n  override def inferPartitioning(\n      schema: StructType,\n      options: CaseInsensitiveStringMap): Array[Transform] = {"
  },
  {
    "id" : "87b22989-4414-43ae-a28b-daf80c4de01a",
    "prId" : 25833,
    "prUrl" : "https://github.com/apache/spark/pull/25833#pullrequestreview-290242564",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c1ffca36-7c0c-46f4-9ea7-fa53c62b1803",
        "parentId" : null,
        "authorId" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "body" : "This should be a different class, `PathIdentifier`, so that we can easily identify these and handle them separately.",
        "createdAt" : "2019-09-18T22:47:30Z",
        "updatedAt" : "2019-09-18T22:47:31Z",
        "lastEditedBy" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "tags" : [
        ]
      }
    ],
    "commit" : "e48a5c490334a33f3edade649d1ed8cefaf672d0",
    "line" : 39,
    "diffHunk" : "@@ -1,1 +71,75 @@      throw new IllegalArgumentException(\"Didn't specify the 'path' for file based table\")\n    }\n    Identifier.of(Array.empty, paths.head)\n  }\n"
  },
  {
    "id" : "245e9791-606a-418a-97c7-e3661ec79c50",
    "prId" : 25473,
    "prUrl" : "https://github.com/apache/spark/pull/25473#pullrequestreview-275927197",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2c65a7c0-07d2-4567-9341-0f682dcaceb0",
        "parentId" : null,
        "authorId" : "80d631a6-73e8-46a6-a01b-a80d1f1cc6cc",
        "body" : "NIT: you can convert the option to a Seq, so you don't need to the getOrElse call.",
        "createdAt" : "2019-08-16T12:33:54Z",
        "updatedAt" : "2019-08-16T12:33:54Z",
        "lastEditedBy" : "80d631a6-73e8-46a6-a01b-a80d1f1cc6cc",
        "tags" : [
        ]
      },
      {
        "id" : "1d3a91a4-c55d-4f32-9cf5-cc2ef1b1cc5c",
        "parentId" : "2c65a7c0-07d2-4567-9341-0f682dcaceb0",
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "The result of `.map { pathStr => objectMapper.readValue(pathStr, classOf[Array[String]]).toSeq` is Option[Seq[String]].  I think the getOrElse is fine here.",
        "createdAt" : "2019-08-16T12:40:25Z",
        "updatedAt" : "2019-08-16T12:40:35Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      }
    ],
    "commit" : "47854e8681564750af4efbe93722a218c5638729",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +44,48 @@  protected def getPaths(map: CaseInsensitiveStringMap): Seq[String] = {\n    val objectMapper = new ObjectMapper()\n    val paths = Option(map.get(\"paths\")).map { pathStr =>\n      objectMapper.readValue(pathStr, classOf[Array[String]]).toSeq\n    }.getOrElse(Seq.empty)"
  },
  {
    "id" : "5f9ce949-5f49-49b6-a991-f943d435f662",
    "prId" : 24719,
    "prUrl" : "https://github.com/apache/spark/pull/24719#pullrequestreview-243374684",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0571c6ba-2194-4ce2-97e6-c08210aed95c",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Sorry, it seems that I missed this last night. `\",\"` -> `\";\"`?",
        "createdAt" : "2019-05-29T15:51:51Z",
        "updatedAt" : "2019-05-29T16:32:24Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "c8f66479-8ac1-4351-923c-054d1ccecb8e",
        "parentId" : "0571c6ba-2194-4ce2-97e6-c08210aed95c",
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "Oh, this is following the output of V1. I am actually fine with either way. WDYT?",
        "createdAt" : "2019-05-29T15:59:17Z",
        "updatedAt" : "2019-05-29T16:32:24Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      },
      {
        "id" : "b04f9c04-a469-4991-8874-6fc0853487d2",
        "parentId" : "0571c6ba-2194-4ce2-97e6-c08210aed95c",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Maybe, I missed the context. Which part are you referring? It seems that we replaced \":\" to \" \", too. Are both of them changed to be consistent with the output of V1?",
        "createdAt" : "2019-05-29T16:16:59Z",
        "updatedAt" : "2019-05-29T16:32:24Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "ac15fb3d-d195-444c-be5a-c1bfa7c9cddb",
        "parentId" : "0571c6ba-2194-4ce2-97e6-c08210aed95c",
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "Yes, I think so.\r\nWe have to change the \":\" to \" \", otherwise the output will be like \"orc:file:/path..\"\r\n",
        "createdAt" : "2019-05-29T16:23:07Z",
        "updatedAt" : "2019-05-29T16:32:24Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      }
    ],
    "commit" : "cbd3236e0bee37809beac4d61071e933b0119494",
    "line" : 20,
    "diffHunk" : "@@ -1,1 +52,56 @@\n  protected def getTableName(paths: Seq[String]): String = {\n    val name = shortName() + \" \" + paths.map(qualifiedPathName).mkString(\",\")\n    Utils.redact(sparkSession.sessionState.conf.stringRedactionPattern, name)\n  }"
  }
]