[
  {
    "id" : "22db4c87-75ea-4ab0-b512-a5c8d0c0dfab",
    "prId" : 30974,
    "prUrl" : "https://github.com/apache/spark/pull/30974#pullrequestreview-568825410",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "84a8f313-1e02-466f-9461-db7b9f499d56",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "can we just do `case c: Cast => UnresolvedAlias(c, Some(Column.generateAlias))`?",
        "createdAt" : "2021-01-15T03:36:38Z",
        "updatedAt" : "2021-01-19T03:57:19Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "64b14279-1585-405f-a6de-6e81af62c58c",
        "parentId" : "84a8f313-1e02-466f-9461-db7b9f499d56",
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "Seems we can't. This code will strip the `attribute` which is below the `Cast` so I leave it.\r\n\r\nA example, with the code, `spark.range(1).selectExpr(\"CAST(CAST(id as int) as double)\").columns` will return the `c1` instead of `CAST(CAST(c1 as INT) as DOUBLE)`.",
        "createdAt" : "2021-01-15T05:26:49Z",
        "updatedAt" : "2021-01-19T03:57:19Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      }
    ],
    "commit" : "1b00b8537cd4c2be4ad7715f4106947c3dc9a53a",
    "line" : 21,
    "diffHunk" : "@@ -1,1 +178,182 @@    // If we have a top level Cast, there is a chance to give it a better alias, if there is a\n    // NamedExpression under this Cast.\n    case c: Cast =>\n      c.transformUp {\n        case c @ Cast(_: NamedExpression, _, _) => UnresolvedAlias(c)"
  },
  {
    "id" : "fbcc83e6-8abd-484f-a36d-fde0552082f1",
    "prId" : 30488,
    "prUrl" : "https://github.com/apache/spark/pull/30488#pullrequestreview-541808504",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "06fb0534-01e3-4496-a11d-5997f958e789",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "add some comments to explain the reason.",
        "createdAt" : "2020-12-01T11:34:19Z",
        "updatedAt" : "2020-12-02T15:39:45Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "d13b88c25a10022be0ff0190fd6fa8d158b24560",
    "line" : 8,
    "diffHunk" : "@@ -1,1 +1168,1172 @@    // These denied metadata keys are used to strip the column reference related metadata for\n    // the Alias. So it won't be caught as a column reference in DetectAmbiguousSelfJoin.\n    Alias(expr, alias)(deniedMetadataKeys = Seq(Dataset.DATASET_ID_KEY, Dataset.COL_POS_KEY))\n  }\n"
  }
]