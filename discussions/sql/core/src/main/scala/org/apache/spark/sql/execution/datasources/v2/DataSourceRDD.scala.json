[
  {
    "id" : "661c7dbc-12a4-42fc-abbc-73f34c16d2c7",
    "prId" : 31619,
    "prUrl" : "https://github.com/apache/spark/pull/31619#pullrequestreview-601451697",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "13434c21-0da2-4787-83b1-bb09616a8ae0",
        "parentId" : null,
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "`NoSuchElementException` is generated during execute and should be placed in `QueryExecutionErrors`.",
        "createdAt" : "2021-02-25T10:12:38Z",
        "updatedAt" : "2021-03-18T17:50:37Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      },
      {
        "id" : "b98b67eb-f2f2-4c64-95c5-959a6e95fdda",
        "parentId" : "13434c21-0da2-4787-83b1-bb09616a8ae0",
        "authorId" : "ada71464-b8c9-4d7b-9020-d49c27251fdb",
        "body" : "I believe this is already located in `QueryExecutionErrors`.",
        "createdAt" : "2021-03-01T21:20:01Z",
        "updatedAt" : "2021-03-18T17:50:37Z",
        "lastEditedBy" : "ada71464-b8c9-4d7b-9020-d49c27251fdb",
        "tags" : [
        ]
      },
      {
        "id" : "e297f912-33f1-4e40-a763-ba5eeada7e3c",
        "parentId" : "13434c21-0da2-4787-83b1-bb09616a8ae0",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "> I believe this is already located in `QueryExecutionErrors`.\r\n\r\nOh. I see. But fix the other comments please.",
        "createdAt" : "2021-03-02T05:59:49Z",
        "updatedAt" : "2021-03-18T17:50:37Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "d7a0f06a563af83c0166cef736541cdfd6105324",
    "line" : 22,
    "diffHunk" : "@@ -1,1 +85,89 @@  override def next(): T = {\n    if (!hasNext) {\n      throw QueryExecutionErrors.endOfStreamError()\n    }\n    valuePrepared = false"
  },
  {
    "id" : "b8c41c40-8fc5-4c86-bfc1-7e13e4667082",
    "prId" : 31451,
    "prUrl" : "https://github.com/apache/spark/pull/31451#pullrequestreview-636929559",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "24f52488-047b-475f-985d-752c21702ef5",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "it's still per-row update?",
        "createdAt" : "2021-04-15T10:25:54Z",
        "updatedAt" : "2021-04-20T06:45:33Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "2b791b66-fb78-4770-8af4-23d93a737cc6",
        "parentId" : "24f52488-047b-475f-985d-752c21702ef5",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "yea, will do \"update metrics per some rows\" in a followup.",
        "createdAt" : "2021-04-15T17:04:52Z",
        "updatedAt" : "2021-04-20T06:45:33Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "06eb9c79a3fdd807ec08540deb2234939396325a",
    "line" : 49,
    "diffHunk" : "@@ -1,1 +93,97 @@      throw QueryExecutionErrors.endOfStreamError()\n    }\n    reader.currentMetricsValues.foreach { metric =>\n      assert(customMetrics.contains(metric.name()),\n        s\"Custom metrics ${customMetrics.keys.mkString(\", \")} do not contain the metric \" +"
  },
  {
    "id" : "57a3ad81-e9e1-4b3c-9e49-4e9d368d80ae",
    "prId" : 31451,
    "prUrl" : "https://github.com/apache/spark/pull/31451#pullrequestreview-639089738",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d7e45258-ca76-4838-9624-3e51a869f340",
        "parentId" : null,
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "Do we need to check whether `customMetrics` contains `metric.name()`?",
        "createdAt" : "2021-04-19T16:43:17Z",
        "updatedAt" : "2021-04-20T06:45:33Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      },
      {
        "id" : "ba548a27-9aa7-4ce2-803b-44c55985e8ca",
        "parentId" : "d7e45258-ca76-4838-9624-3e51a869f340",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "We can throw a user-friendly message if it doesn't.",
        "createdAt" : "2021-04-19T16:46:13Z",
        "updatedAt" : "2021-04-20T06:45:33Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "06eb9c79a3fdd807ec08540deb2234939396325a",
    "line" : 53,
    "diffHunk" : "@@ -1,1 +97,101 @@        s\"Custom metrics ${customMetrics.keys.mkString(\", \")} do not contain the metric \" +\n          s\"${metric.name()}\")\n      customMetrics(metric.name()).set(metric.value())\n    }\n    valuePrepared = false"
  },
  {
    "id" : "c89e4cb8-5c6b-441b-8b65-1e6b9a39e792",
    "prId" : 27021,
    "prUrl" : "https://github.com/apache/spark/pull/27021#pullrequestreview-350810768",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ce0fdc41-c303-4a51-ab88-d63b735cc20f",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "nit: to be consistent, let's have a `MetricsRowIterator`, and the base class `MetricsIterator` doesn't need to implement `next`",
        "createdAt" : "2020-01-30T13:11:51Z",
        "updatedAt" : "2020-01-30T13:59:07Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "067eb27a-2598-44f9-a2d2-ce45d437870d",
        "parentId" : "ce0fdc41-c303-4a51-ab88-d63b735cc20f",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "or the base class can implement `next` as\r\n```\r\nprotected def numRecords(element: T): Int\r\n\r\noverride def next(): I = {\r\n  val item = iter.next\r\n  metricsHandler.updateMetrics(numRecords(item))\r\n  item\r\n}\r\n```",
        "createdAt" : "2020-01-30T13:13:23Z",
        "updatedAt" : "2020-01-30T13:59:07Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "34425ad1eae32fe1ca177ad359685c410a467760",
    "line" : 116,
    "diffHunk" : "@@ -1,1 +128,132 @@}\n\nprivate class MetricsBatchIterator(\n    iter: Iterator[ColumnarBatch]) extends MetricsIterator[ColumnarBatch](iter) {\n  override def next(): ColumnarBatch = {"
  }
]