[
  {
    "id" : "f275828c-f449-414e-8dc9-371dbedfd1a0",
    "prId" : 31881,
    "prUrl" : "https://github.com/apache/spark/pull/31881#pullrequestreview-616048202",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8b088be2-ac46-4e98-9fd2-15ab28deaa44",
        "parentId" : null,
        "authorId" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "body" : "Manage this within `ExecutionListenerBus` instead of pulling it out ?\r\nMake `sessionUUID` an instance variable - and use `session` only in constructor (so it is not a field in the class)",
        "createdAt" : "2021-03-19T02:43:35Z",
        "updatedAt" : "2021-03-19T02:47:38Z",
        "lastEditedBy" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "tags" : [
        ]
      },
      {
        "id" : "3c5ea4f9-fae8-4514-a27b-ddedb2cf0bbf",
        "parentId" : "8b088be2-ac46-4e98-9fd2-15ab28deaa44",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Oh, this is a backporting PR. @Ngone51 can we address the comment in a separate PR so that followup can also be ported back?",
        "createdAt" : "2021-03-19T02:58:52Z",
        "updatedAt" : "2021-03-19T02:58:52Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "cc3f8e3a-7e51-4289-b8e5-a638f44bdd5b",
        "parentId" : "8b088be2-ac46-4e98-9fd2-15ab28deaa44",
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "Sure, I'll do a follow-up. Thanks @mridulm ",
        "createdAt" : "2021-03-19T03:09:38Z",
        "updatedAt" : "2021-03-19T03:09:38Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      },
      {
        "id" : "3fee011a-5869-4990-be9d-fd6e1fd7695a",
        "parentId" : "8b088be2-ac46-4e98-9fd2-15ab28deaa44",
        "authorId" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "body" : "Sorry, missed the original PR !",
        "createdAt" : "2021-03-19T04:11:13Z",
        "updatedAt" : "2021-03-19T04:11:13Z",
        "lastEditedBy" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "tags" : [
        ]
      }
    ],
    "commit" : "0d364cc5f6ca8b966b9b16e6aa8308cae66250c5",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +81,85 @@  session.sparkContext.cleaner.foreach { cleaner =>\n    cleaner.registerSparkListenerForCleanup(this, listenerBus)\n  }\n\n  if (loadExtensions) {"
  },
  {
    "id" : "b375dea3-495e-48f2-9d06-12417e553869",
    "prId" : 31839,
    "prUrl" : "https://github.com/apache/spark/pull/31839#pullrequestreview-613935754",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "54e91d41-a50a-45f4-86f1-7bc71c31a61a",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "So, this fix is designed to be disabled when `spark.cleaner.referenceTracking=false`?",
        "createdAt" : "2021-03-15T17:56:47Z",
        "updatedAt" : "2021-03-17T14:31:40Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "8d835d64-473c-4773-98e9-2d77f3c01abf",
        "parentId" : "54e91d41-a50a-45f4-86f1-7bc71c31a61a",
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "To be honest, no. It fixes the memory leak so we generally always want it takes effect. And the `ContextCleaner` is an experienced framework that we can leverage to fix this issue elegantly without aggressive changes.\r\n\r\nThe config is introduced since Spark 1.0.0 and enabled by default. So I personally think it's acceptable to assume users run applications with cleaner enabled in most cases.",
        "createdAt" : "2021-03-16T03:38:58Z",
        "updatedAt" : "2021-03-17T14:31:40Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      },
      {
        "id" : "2a9d20c2-594c-4f55-a368-c59d6b67839b",
        "parentId" : "54e91d41-a50a-45f4-86f1-7bc71c31a61a",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "I'm not against having that assumption. But, this doesn't fix memory leaks at all if `spark.cleaner.referenceTracking=false` technically, does it? We should be clear about the limitation of the PR.",
        "createdAt" : "2021-03-16T18:23:11Z",
        "updatedAt" : "2021-03-17T14:31:40Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "3ddda0bb-d3d4-4e28-8f54-4135164eaa07",
        "parentId" : "54e91d41-a50a-45f4-86f1-7bc71c31a61a",
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "> But, this doesn't fix memory leaks at all if spark.cleaner.referenceTracking=false technically, does it? \r\n\r\nYes, it doesn't.",
        "createdAt" : "2021-03-17T01:47:35Z",
        "updatedAt" : "2021-03-17T14:31:40Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      },
      {
        "id" : "a59f49a2-b047-408a-9390-c1a4d1e254c9",
        "parentId" : "54e91d41-a50a-45f4-86f1-7bc71c31a61a",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Let's mention it in the PR description to be clear.",
        "createdAt" : "2021-03-17T03:10:16Z",
        "updatedAt" : "2021-03-17T14:31:40Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "85943503-b139-4a28-a8ff-6c5fc40c5055",
        "parentId" : "54e91d41-a50a-45f4-86f1-7bc71c31a61a",
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "Updated.",
        "createdAt" : "2021-03-17T05:38:29Z",
        "updatedAt" : "2021-03-17T14:31:40Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      }
    ],
    "commit" : "9e81427eb7ac351d7511c0abec6d189eb7b9fbff",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +79,83 @@  private val listenerBus = new ExecutionListenerBus(session.sessionUUID)\n  session.sparkContext.listenerBus.addToSharedQueue(listenerBus)\n  session.sparkContext.cleaner.foreach { cleaner =>\n    cleaner.registerSparkListenerForCleanup(this, listenerBus)\n  }"
  }
]