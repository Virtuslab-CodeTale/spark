[
  {
    "id" : "c943405c-c923-44e7-8dec-1fb1449feeeb",
    "prId" : 28745,
    "prUrl" : "https://github.com/apache/spark/pull/28745#pullrequestreview-426049687",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e8df8ea5-f0e0-4fa2-9199-d8bb83981526",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "One disadvantage I can think of is, previously we evaluate grouping expressions in underlying projection. Now we move the grouping expression evaluation inside `FlatMapCoGroupsInPandasExec` execution.\r\n\r\nAs we requires specified child distribution `leftGroupingExprs` and `rightGroupingExprs` in `requiredChildDistribution`. We would possibly add shuffle below `FlatMapCoGroupsInPandasExec`. That's said we evaluate grouping expressions twice and if any non-deterministic expressions inside, we probably get incorrect results.\r\n\r\n",
        "createdAt" : "2020-06-08T03:06:32Z",
        "updatedAt" : "2020-06-09T13:14:46Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "47404c87-5aea-4187-9982-deac04527f7d",
        "parentId" : "e8df8ea5-f0e0-4fa2-9199-d8bb83981526",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Oh that's actually a very good point. Let me check how other grouping expressions work and update or bring some answers.",
        "createdAt" : "2020-06-08T09:16:21Z",
        "updatedAt" : "2020-06-09T13:14:46Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "2bf09c0b2b009ddea5d9fe1b08c52bcee705e2f7",
    "line" : 56,
    "diffHunk" : "@@ -1,1 +93,97 @@\n        val leftGrouped = groupAndProject(leftData, leftGroupingExprs, left.output, leftDedup)\n        val rightGrouped = groupAndProject(rightData, rightGroupingExprs, right.output, rightDedup)\n        val data = new CoGroupedIterator(\n          leftGrouped, rightGrouped, leftGroupingExprs.map(_.toAttribute))"
  }
]