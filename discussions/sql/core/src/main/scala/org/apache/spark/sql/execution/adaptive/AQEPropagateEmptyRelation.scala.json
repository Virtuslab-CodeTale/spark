[
  {
    "id" : "8ceebd65-8607-4611-9dac-362337eec53b",
    "prId" : 32742,
    "prUrl" : "https://github.com/apache/spark/pull/32742#pullrequestreview-687077182",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f6acc0f2-555a-4cdc-8567-f154bd06ada1",
        "parentId" : null,
        "authorId" : "8b518862-583d-43a2-a10e-b33ef1b6d824",
        "body" : "This looks correct, but may not have good pruning power?  How about:\r\n\r\nt = > t.containsAllPatterns(LOGICAL_QUERY_STAGE, JOIN, AND_OR, NULL_CHECK)\r\n      || t.containsAnyPatterns(LOCAL_RELATION, TRUE_OR_FALSE_LITERAL)\r\n\r\nThe first condition covers eliminateSingleColumnNullAwareAntiJoin while the second covers commonApplyFunc.",
        "createdAt" : "2021-06-18T06:47:39Z",
        "updatedAt" : "2021-06-18T06:49:54Z",
        "lastEditedBy" : "8b518862-583d-43a2-a10e-b33ef1b6d824",
        "tags" : [
        ]
      }
    ],
    "commit" : "1e28a8fa65a016dc4c7aa64b601e3ed3a6a6b0b7",
    "line" : 20,
    "diffHunk" : "@@ -1,1 +61,65 @@    // and `AQEPropagateEmptyRelation.eliminateSingleColumnNullAwareAntiJoin`\n    // Note that, We can not specify ruleId here since the LogicalQueryStage is not immutable.\n    _.containsAnyPattern(LOGICAL_QUERY_STAGE, LOCAL_RELATION, TRUE_OR_FALSE_LITERAL)) {\n    eliminateSingleColumnNullAwareAntiJoin.orElse(commonApplyFunc)\n  }"
  },
  {
    "id" : "a2e7134b-816d-444f-85ab-434185e2182e",
    "prId" : 32602,
    "prUrl" : "https://github.com/apache/spark/pull/32602#pullrequestreview-667708009",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9475e71d-a82a-4804-8790-dcd216fcd540",
        "parentId" : null,
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "@cloud-fan , if we want to use `transformUpWithPruning ` at AQE optimizer side, we need to some more work like add pattern at `LogicalQueryStage`. So this PR does not do the change, just use `transformUp`. Do you think it's OK ?",
        "createdAt" : "2021-05-21T10:31:18Z",
        "updatedAt" : "2021-05-21T10:31:18Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      },
      {
        "id" : "5eefeae5-75f5-40a3-9528-fc24d7ae7f86",
        "parentId" : "9475e71d-a82a-4804-8790-dcd216fcd540",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "yea it's OK as it's not a regression. cc @sigmod ",
        "createdAt" : "2021-05-21T13:11:36Z",
        "updatedAt" : "2021-05-21T13:11:36Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "5831b8f5-6405-49dc-8ea5-1d46b7779f6b",
        "parentId" : "9475e71d-a82a-4804-8790-dcd216fcd540",
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "@cloud-fan seems we don't need to use `transformUpWithPruning` here since the AQE Optimizer always run once rather than fixed point ?",
        "createdAt" : "2021-05-25T11:27:18Z",
        "updatedAt" : "2021-05-25T11:27:18Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      }
    ],
    "commit" : "624e45e27513933e9fe5615601d0dddac341a258",
    "line" : 58,
    "diffHunk" : "@@ -1,1 +56,60 @@\n  // TODO we need use transformUpWithPruning instead of transformUp\n  def apply(plan: LogicalPlan): LogicalPlan = plan.transformUp {\n    eliminateSingleColumnNullAwareAntiJoin.orElse(commonApplyFunc)\n  }"
  }
]