[
  {
    "id" : "459db4eb-f306-4e12-8649-bed2a80ee472",
    "prId" : 33655,
    "prUrl" : "https://github.com/apache/spark/pull/33655#pullrequestreview-723532662",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4eb25cc3-e751-4e46-b80a-dc288dc33e46",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "a small cleanup",
        "createdAt" : "2021-08-05T15:57:02Z",
        "updatedAt" : "2021-08-05T15:57:02Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "eeeff3ae6bb62eedeb09011cc99514d240a8b7d0",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +58,62 @@    val totalPostShuffleInputSize = mapOutputStatistics.flatMap(_.map(_.bytesByPartitionId.sum)).sum\n    val maxTargetSize = math.ceil(totalPostShuffleInputSize / minNumPartitions.toDouble).toLong\n    // It's meaningless to make target size smaller than minPartitionSize.\n    val targetSize = maxTargetSize.min(advisoryTargetSize).max(minPartitionSize)\n"
  },
  {
    "id" : "d1ae489a-0d38-43bc-831c-1bc4729cbc96",
    "prId" : 33172,
    "prUrl" : "https://github.com/apache/spark/pull/33172#pullrequestreview-697052590",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4af63f40-c370-4b0e-9098-fca00bcb8ef0",
        "parentId" : null,
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "shall we mention the minPartitionSize here?",
        "createdAt" : "2021-07-01T09:39:46Z",
        "updatedAt" : "2021-07-01T09:39:47Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      },
      {
        "id" : "ea467fdc-22f9-405c-956e-781d8df6b9bb",
        "parentId" : "4af63f40-c370-4b0e-9098-fca00bcb8ef0",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "sure",
        "createdAt" : "2021-07-01T09:56:05Z",
        "updatedAt" : "2021-07-01T09:56:05Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "51546e87c33064c80f902d4eecff1f640222dfb2",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +66,70 @@\n    val shuffleIds = mapOutputStatistics.flatMap(_.map(_.shuffleId)).mkString(\", \")\n    logInfo(s\"For shuffle($shuffleIds), advisory target size: $advisoryTargetSize, \" +\n      s\"actual target size $targetSize, minimum partition size: $minPartitionSize\")\n"
  },
  {
    "id" : "4cc9b1cb-fed4-44a4-b28f-a12f3825cb74",
    "prId" : 33123,
    "prUrl" : "https://github.com/apache/spark/pull/33123#pullrequestreview-695129146",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "07c83502-aa8d-4bf4-87bd-c6fff2037e3f",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "How do we make sure we return at least one partition spec if there is no skew partition spec?",
        "createdAt" : "2021-06-29T14:10:30Z",
        "updatedAt" : "2021-06-29T14:10:30Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "50f5eb73-8d57-48b2-9aa0-180035c27102",
        "parentId" : "07c83502-aa8d-4bf4-87bd-c6fff2037e3f",
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "this code is under `coalescePartitionsWithSkew` which must have some skew partition specs",
        "createdAt" : "2021-06-29T14:40:23Z",
        "updatedAt" : "2021-06-29T14:40:23Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      }
    ],
    "commit" : "ed4e07f85655443f800b20995fbf6237cd719552",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +175,179 @@        partitionIndices(start), partitionIndices.last + 1, validMetrics, targetSize, true)\n      newPartitionSpecsSeq.zip(partitionSpecs).foreach(spec => spec._1 ++= spec._2)\n    }\n    // only return coalesced result if any coalescing has happened.\n    if (newPartitionSpecsSeq.head.length < numPartitions) {"
  }
]