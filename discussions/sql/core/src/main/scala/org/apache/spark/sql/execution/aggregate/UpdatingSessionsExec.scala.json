[
  {
    "id" : "8b2115dc-cd91-416a-bc3d-ef54de17a06e",
    "prId" : 31986,
    "prUrl" : "https://github.com/apache/spark/pull/31986#pullrequestreview-644210233",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "dc309178-50af-41d4-b7ed-e33da8604ec2",
        "parentId" : null,
        "authorId" : "cd38bd5a-0fae-4d8e-8acd-36dc13753759",
        "body" : "So we allow the case that session window as the only grouping key?",
        "createdAt" : "2021-04-21T13:19:11Z",
        "updatedAt" : "2021-05-11T04:07:22Z",
        "lastEditedBy" : "cd38bd5a-0fae-4d8e-8acd-36dc13753759",
        "tags" : [
        ]
      },
      {
        "id" : "5bde52b4-8adc-48c4-997a-9bdc955cd95e",
        "parentId" : "dc309178-50af-41d4-b7ed-e33da8604ec2",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "Yes, for batch query. The limitation comes from state format of session window and shouldn't limit to batch query as well.",
        "createdAt" : "2021-04-26T01:28:44Z",
        "updatedAt" : "2021-05-11T04:07:22Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      }
    ],
    "commit" : "8c2eed82d553ddacb36088954232ae704a855094",
    "line" : 64,
    "diffHunk" : "@@ -1,1 +62,66 @@  override def requiredChildDistribution: Seq[Distribution] = {\n    if (groupingWithoutSessionExpression.isEmpty) {\n      AllTuples :: Nil\n    } else {\n      ClusteredDistribution(groupingWithoutSessionExpression) :: Nil"
  },
  {
    "id" : "294c75d9-5768-49c6-b7d3-7aa5918aaf85",
    "prId" : 31986,
    "prUrl" : "https://github.com/apache/spark/pull/31986#pullrequestreview-656351702",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3e5bde7a-92f5-45fd-838f-bd7423c4d1cf",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Isn't this just `keyExpressions`?",
        "createdAt" : "2021-05-11T00:57:36Z",
        "updatedAt" : "2021-05-11T04:07:22Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "a4ac4fe1-a212-4fd5-9e99-157f6f010b47",
        "parentId" : "3e5bde7a-92f5-45fd-838f-bd7423c4d1cf",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "Nice finding. Will update.",
        "createdAt" : "2021-05-11T02:00:23Z",
        "updatedAt" : "2021-05-11T04:07:22Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      },
      {
        "id" : "410e0e93-1e79-4270-94f7-d1c9b8e0f638",
        "parentId" : "3e5bde7a-92f5-45fd-838f-bd7423c4d1cf",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "Ah I remembered the reason. We can't safely assume session expression is placed at the end of grouping. Let me revert back.",
        "createdAt" : "2021-05-11T04:05:14Z",
        "updatedAt" : "2021-05-11T04:07:39Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      },
      {
        "id" : "4694b595-9831-4465-92e9-385b71f38bc2",
        "parentId" : "3e5bde7a-92f5-45fd-838f-bd7423c4d1cf",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Oh, I thought the caller side always append session expression at the end of grouping keys.",
        "createdAt" : "2021-05-11T06:21:34Z",
        "updatedAt" : "2021-05-11T06:21:34Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "953c4898-640e-43a9-b889-0878f44bf1f1",
        "parentId" : "3e5bde7a-92f5-45fd-838f-bd7423c4d1cf",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "We don't reorder the columns if I remember correctly, but I might be wrong as the overall code is quite ancient even for me. At least it's more natural not to reorder - if we reorder the columns in whole picture, I'd rather want to fix that.",
        "createdAt" : "2021-05-11T07:05:18Z",
        "updatedAt" : "2021-05-11T07:05:18Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      },
      {
        "id" : "7a11254d-aa11-45c4-a3b5-0b5fd0306f1a",
        "parentId" : "3e5bde7a-92f5-45fd-838f-bd7423c4d1cf",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "That said, other parts should be checked as well - probably they might have some logic relying on this.\r\n\r\nEDIT: probably it might be OK to reorder at first, and leverage the fact, and reorder back later. My preference is still not to reorder, but if it brings some benefits then we could do.",
        "createdAt" : "2021-05-11T07:06:34Z",
        "updatedAt" : "2021-05-11T07:10:56Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      }
    ],
    "commit" : "8c2eed82d553ddacb36088954232ae704a855094",
    "line" : 71,
    "diffHunk" : "@@ -1,1 +69,73 @@\n  override def requiredChildOrdering: Seq[Seq[SortOrder]] = {\n    Seq((groupingWithoutSessionAttributes ++ Seq(sessionExpression))\n      .map(SortOrder(_, Ascending)))\n  }"
  },
  {
    "id" : "78199690-9738-491a-96a0-c443728703b3",
    "prId" : 31986,
    "prUrl" : "https://github.com/apache/spark/pull/31986#pullrequestreview-656213644",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "268284c4-5d0f-4bbe-b09a-d060d611477b",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "where do we have listed the possible cases we cannot apply both them altogher?",
        "createdAt" : "2021-05-11T00:59:01Z",
        "updatedAt" : "2021-05-11T04:07:22Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "4f0fcef1-fd33-4782-8628-20eb4ea83532",
        "parentId" : "268284c4-5d0f-4bbe-b09a-d060d611477b",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "I don't list the case explicitly as we use UpdatingSessionsExec whenever needed; you can find the case in original PR, but please let me know if we'd like to explicitly specify some cases here as well.",
        "createdAt" : "2021-05-11T01:40:51Z",
        "updatedAt" : "2021-05-11T04:07:22Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      }
    ],
    "commit" : "8c2eed82d553ddacb36088954232ae704a855094",
    "line" : 33,
    "diffHunk" : "@@ -1,1 +31,35 @@ * There are lots of overhead compared to [[MergingSessionsExec]]. Use [[MergingSessionsExec]]\n * instead whenever possible. Use this node only when we cannot apply both calculations\n * determining session windows and aggregating rows in session window altogether.\n *\n * Refer [[UpdatingSessionsIterator]] for more details."
  }
]