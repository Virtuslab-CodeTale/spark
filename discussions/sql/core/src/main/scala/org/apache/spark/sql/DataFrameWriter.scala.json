[
  {
    "id" : "e03fe885-55e3-43a2-b072-4775e22ce1ef",
    "prId" : 32546,
    "prUrl" : "https://github.com/apache/spark/pull/32546#pullrequestreview-664206352",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3841e95c-ea94-4811-877c-be9e0ed7fae8",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Here you didn't link generic options but you did for Parquet. What's diff?",
        "createdAt" : "2021-05-20T06:19:42Z",
        "updatedAt" : "2021-05-20T06:19:43Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "005f4271-b79e-405b-a8ea-f73d5637040e",
        "parentId" : "3841e95c-ea94-4811-877c-be9e0ed7fae8",
        "authorId" : "2d8ced12-ada1-43e1-9240-bf1c11a01e4c",
        "body" : "@HyukjinKwon , this is because the options I removed doesn't include generic options. (For example it has only one option, `compression` in this case)\r\n\r\nWould it be better to just add the link to the Generic options no matter what we removed ??",
        "createdAt" : "2021-05-20T08:33:54Z",
        "updatedAt" : "2021-05-20T08:34:43Z",
        "lastEditedBy" : "2d8ced12-ada1-43e1-9240-bf1c11a01e4c",
        "tags" : [
        ]
      },
      {
        "id" : "70a426e8-95be-4d92-96ce-2b14435c1a2d",
        "parentId" : "3841e95c-ea94-4811-877c-be9e0ed7fae8",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Either way is fine. The point is that we should keep it consistent",
        "createdAt" : "2021-05-20T10:23:44Z",
        "updatedAt" : "2021-05-20T10:23:44Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "1737a103-d03e-4969-93c2-b3eeff2fde62",
        "parentId" : "3841e95c-ea94-4811-877c-be9e0ed7fae8",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "I would just add it for simplicity, and in case we have write generic options in the future",
        "createdAt" : "2021-05-20T10:24:25Z",
        "updatedAt" : "2021-05-20T10:24:26Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "043d3087c838c2f6439d798bdc8e889d6a728ff7",
    "line" : 15,
    "diffHunk" : "@@ -1,1 +885,889 @@   * <a href=\n   *   \"https://spark.apache.org/docs/latest/sql-data-sources-orc.html#data-source-option\">\n   *   Data Source Option</a> in the version you use.\n   *\n   * @since 1.5.0"
  },
  {
    "id" : "c0bff79f-cda2-401b-bb5d-669471ac5333",
    "prId" : 29885,
    "prUrl" : "https://github.com/apache/spark/pull/29885#pullrequestreview-504107320",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7caa7ab2-879c-426d-b16e-840b7d7b64df",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Returned catalog is always a `TableCatalog`?",
        "createdAt" : "2020-10-06T23:31:35Z",
        "updatedAt" : "2020-10-06T23:36:41Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "2ea1f583-888e-4570-8201-ab77ad36e1e7",
        "parentId" : "7caa7ab2-879c-426d-b16e-840b7d7b64df",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Or do we need to check if `catalog` is `JDBCTableCatalog`?",
        "createdAt" : "2020-10-06T23:36:15Z",
        "updatedAt" : "2020-10-06T23:36:41Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "298d2dc7-9d82-43c2-b89c-9f14d6bcd560",
        "parentId" : "7caa7ab2-879c-426d-b16e-840b7d7b64df",
        "authorId" : "99765afe-8dbe-4d5f-9ad3-d5bc40f0462b",
        "body" : "Seems to me that the catalog in `NonSessionCatalogAndIdentifier` is always a `TableCatalog`.",
        "createdAt" : "2020-10-07T17:25:43Z",
        "updatedAt" : "2020-10-07T17:25:43Z",
        "lastEditedBy" : "99765afe-8dbe-4d5f-9ad3-d5bc40f0462b",
        "tags" : [
        ]
      }
    ],
    "commit" : "9ff43135256f7c3ad3922f6772186634d69633a1",
    "line" : 18,
    "diffHunk" : "@@ -1,1 +820,824 @@    session.sessionState.sqlParser.parseMultipartIdentifier(table) match {\n      case nameParts @ NonSessionCatalogAndIdentifier(catalog, tableIdentifier) =>\n        saveAsTable(catalog.asTableCatalog, tableIdentifier, nameParts)\n\n      case _ =>"
  },
  {
    "id" : "d75fd2ee-c4ff-43e8-a545-4715c1e88230",
    "prId" : 29543,
    "prUrl" : "https://github.com/apache/spark/pull/29543#pullrequestreview-485298760",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "abbe2e61-b70b-4773-a2ef-84382efaa391",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "The `path` here is a String, do we really need to check `path.nonEmpty`?",
        "createdAt" : "2020-09-09T07:51:43Z",
        "updatedAt" : "2020-09-09T07:51:44Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "13c4cf30-0892-4cfd-bde1-a02ae2cda3e6",
        "parentId" : "abbe2e61-b70b-4773-a2ef-84382efaa391",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "Good catch. I think we need to remove the check. The output is more confusing since `path` option is also set:\r\n```scala\r\nscala> Seq(1).toDF.write.option(\"path\", \"/tmp/path1\").parquet(\"\")\r\njava.lang.IllegalArgumentException: Can not create a Path from an empty string\r\n  at org.apache.hadoop.fs.Path.checkPathArg(Path.java:168)\r\n```\r\n\r\nI will create a PR for this.",
        "createdAt" : "2020-09-09T17:46:45Z",
        "updatedAt" : "2020-09-09T17:46:46Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      },
      {
        "id" : "16fcb7dc-55d5-453a-924b-074af2cbb5f5",
        "parentId" : "abbe2e61-b70b-4773-a2ef-84382efaa391",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "Created https://github.com/apache/spark/pull/29697",
        "createdAt" : "2020-09-09T18:43:40Z",
        "updatedAt" : "2020-09-09T18:43:40Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "261b6097907097a77b3c85606510e19c85a648d0",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +287,291 @@  def save(path: String): Unit = {\n    if (!df.sparkSession.sessionState.conf.legacyPathOptionBehavior &&\n        extraOptions.contains(\"path\") && path.nonEmpty) {\n      throw new AnalysisException(\"There is a 'path' option set and save() is called with a path \" +\n        \"parameter. Either remove the path option, or call save() without the parameter. \" +"
  },
  {
    "id" : "014edaa5-65ad-43c6-be67-fd948130f09c",
    "prId" : 29191,
    "prUrl" : "https://github.com/apache/spark/pull/29191#pullrequestreview-453502481",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a912c5eb-8676-4329-b8d7-ae71af27bb98",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "I missed that `dsOptions.asCaseSensitiveMap()` is used later at line 303, `extraOptions.originalMap` will preserve the key case-sensitivity.",
        "createdAt" : "2020-07-22T16:47:26Z",
        "updatedAt" : "2020-07-23T06:10:34Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "81ac6c614c16e8d3c43ff14888216a797df04275",
    "line" : 66,
    "diffHunk" : "@@ -1,1 +308,312 @@        provider, df.sparkSession.sessionState.conf)\n      val options = sessionOptions.filterKeys(!extraOptions.contains(_)) ++ extraOptions.toMap\n      val dsOptions = new CaseInsensitiveStringMap(options.asJava)\n\n      def getTable: Table = {"
  }
]