[
  {
    "id" : "978e1342-6d2d-47fa-bf4d-8174a68724e2",
    "prId" : 33006,
    "prUrl" : "https://github.com/apache/spark/pull/33006#pullrequestreview-690233633",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d6769cba-1cb6-4229-bb6d-5c82ba82cdda",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "To avoid boxing, we can assign the valueCount to a local variale and return it, e.g.\r\n```\r\nint pageValueCount = 0;\r\npage.accept(new DataPage.Visitor<Integer>() {\r\n  ...\r\n  pageValueCount = readPageV1(dataPageV1);\r\n  return null;\r\n  ...\r\n}\r\nreturn pageValueCount;\r\n```",
        "createdAt" : "2021-06-22T07:45:58Z",
        "updatedAt" : "2021-06-22T07:45:59Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "24cd5b23-907f-447b-a66b-73d55f53a758",
        "parentId" : "d6769cba-1cb6-4229-bb6d-5c82ba82cdda",
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "I'm not sure you can do that, since the variable has to be final in order to be accessed within inner class.\r\n\r\nAlso it probably doesn't matter that much since this is not the hot path (I'm very tempted to remove the visitor pattern here though...)",
        "createdAt" : "2021-06-22T17:08:15Z",
        "updatedAt" : "2021-06-22T17:08:15Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      },
      {
        "id" : "fe0cd474-6a1c-4bbc-8fa4-9e10e6960c4e",
        "parentId" : "d6769cba-1cb6-4229-bb6d-5c82ba82cdda",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "ah I see, let's leave it then.",
        "createdAt" : "2021-06-23T05:48:00Z",
        "updatedAt" : "2021-06-23T05:48:00Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "f5e97b77005456894cce6e01bc54160ee0cf1d01",
    "line" : 154,
    "diffHunk" : "@@ -1,1 +216,220 @@    return page.accept(new DataPage.Visitor<Integer>() {\n      @Override\n      public Integer visit(DataPageV1 dataPageV1) {\n        try {\n          return readPageV1(dataPageV1);"
  },
  {
    "id" : "50eb80ec-3fd3-4054-841c-f00f2d9ae481",
    "prId" : 32753,
    "prUrl" : "https://github.com/apache/spark/pull/32753#pullrequestreview-694469249",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "fbdff462-7b1c-4072-818a-99c531673ae0",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Hmm, based on the comment (`rowId != 0`) below, do we need to update it? ",
        "createdAt" : "2021-06-28T23:22:31Z",
        "updatedAt" : "2021-06-28T23:22:31Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "556e7e25-2322-40bc-853b-6e65463b19f2",
        "parentId" : "fbdff462-7b1c-4072-818a-99c531673ae0",
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "Oh yeah, I need to update the comment too",
        "createdAt" : "2021-06-28T23:25:35Z",
        "updatedAt" : "2021-06-28T23:25:35Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      }
    ],
    "commit" : "6541d99bd6788ae7ee3da1ccc76d30e9b39b9cb5",
    "line" : 64,
    "diffHunk" : "@@ -1,1 +180,184 @@        // TIMESTAMP_MILLIS encoded as INT64 can't be lazily decoded as we need to post process\n        // the values to add microseconds precision.\n        if (column.hasDictionary() || (startRowId == pageFirstRowIndex &&\n            isLazyDecodingSupported(typeName))) {\n          // Column vector supports lazy decoding of dictionary values so just set the dictionary."
  },
  {
    "id" : "0369eccb-8766-4eb1-b191-1df5453546b2",
    "prId" : 31921,
    "prUrl" : "https://github.com/apache/spark/pull/31921#pullrequestreview-617212893",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8a782ff8-78df-4e8b-83d3-a57f0463d148",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "where do we handle uint8 and unit16?",
        "createdAt" : "2021-03-22T07:27:02Z",
        "updatedAt" : "2021-03-25T04:16:05Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "6c468fbd-97d5-44b5-90f8-536b5bccd417",
        "parentId" : "8a782ff8-78df-4e8b-83d3-a57f0463d148",
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "These values fix signed int32 well. Parquet will not convert them forth and back, so it's fine for us to read the raw data",
        "createdAt" : "2021-03-22T07:32:38Z",
        "updatedAt" : "2021-03-25T04:16:05Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      }
    ],
    "commit" : "71496bdc4d5c8081139e5a26fa9bddfa1ddc38ed",
    "line" : 62,
    "diffHunk" : "@@ -1,1 +581,585 @@      defColumn.readIntegers(\n          num, column, rowId, maxDefLevel, (VectorizedValuesReader) dataColumn);\n    } else if (column.dataType() == DataTypes.LongType) {\n      // In `ParquetToSparkSchemaConverter`, we map parquet UINT32 to our LongType.\n      // For unsigned int32, it stores as plain signed int32 in Parquet when dictionary fall backs."
  },
  {
    "id" : "e919ce19-e5d7-48e9-9239-15a59c610584",
    "prId" : 31921,
    "prUrl" : "https://github.com/apache/spark/pull/31921#pullrequestreview-619900494",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9443e884-5833-4331-8c13-20938ddcb7ba",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "when will we hit this branch? it's `case INT32` not unsigned.",
        "createdAt" : "2021-03-24T15:23:43Z",
        "updatedAt" : "2021-03-25T04:16:05Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "63feebba-609f-4a2c-80de-6bf2041a0c58",
        "parentId" : "9443e884-5833-4331-8c13-20938ddcb7ba",
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "On Parquet side, for signed and unsigned int (<=32)  types they share the same `PrimitiveType` - `INT32`. The Unsigned ones are just logical types.",
        "createdAt" : "2021-03-24T15:49:25Z",
        "updatedAt" : "2021-03-25T04:16:05Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      }
    ],
    "commit" : "71496bdc4d5c8081139e5a26fa9bddfa1ddc38ed",
    "line" : 43,
    "diffHunk" : "@@ -1,1 +374,378 @@            }\n          }\n        } else if (column.dataType() == DataTypes.LongType) {\n          // In `ParquetToSparkSchemaConverter`, we map parquet UINT32 to our LongType.\n          // For unsigned int32, it stores as dictionary encoded signed int32 in Parquet"
  },
  {
    "id" : "8d3edb8b-dd04-491d-b159-b82da8aa5eb9",
    "prId" : 31921,
    "prUrl" : "https://github.com/apache/spark/pull/31921#pullrequestreview-619903305",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "81e042a2-3e81-4898-a158-626cca89dd0f",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "shall we add an extra check to make sure we are reading unsigned values?",
        "createdAt" : "2021-03-24T15:24:35Z",
        "updatedAt" : "2021-03-25T04:16:05Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "75cb83f0-5996-4f8b-b49e-58c37ee5e0d9",
        "parentId" : "81e042a2-3e81-4898-a158-626cca89dd0f",
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "This is deterministic and controlled by our own, which seems not necessary. see https://github.com/apache/spark/pull/31921/files#diff-3730a913c4b95edf09fb78f8739c538bae53f7269555b6226efe7ccee1901b39R137",
        "createdAt" : "2021-03-24T15:51:39Z",
        "updatedAt" : "2021-03-25T04:16:05Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      }
    ],
    "commit" : "71496bdc4d5c8081139e5a26fa9bddfa1ddc38ed",
    "line" : 62,
    "diffHunk" : "@@ -1,1 +581,585 @@      defColumn.readIntegers(\n          num, column, rowId, maxDefLevel, (VectorizedValuesReader) dataColumn);\n    } else if (column.dataType() == DataTypes.LongType) {\n      // In `ParquetToSparkSchemaConverter`, we map parquet UINT32 to our LongType.\n      // For unsigned int32, it stores as plain signed int32 in Parquet when dictionary fall backs."
  },
  {
    "id" : "42a3e141-de8e-48f1-bc8d-9a8eeecf75fc",
    "prId" : 31776,
    "prUrl" : "https://github.com/apache/spark/pull/31776#pullrequestreview-625514011",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "480c1ac4-1180-454b-a382-4bfe4ae252a9",
        "parentId" : null,
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "nit: these can be static methods",
        "createdAt" : "2021-03-30T16:25:18Z",
        "updatedAt" : "2021-05-10T06:28:22Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      },
      {
        "id" : "39cda97d-8b1f-4cb5-b48a-036f4f2b6c0a",
        "parentId" : "480c1ac4-1180-454b-a382-4bfe4ae252a9",
        "authorId" : "c7afbd1a-ab9f-4878-b837-32685ae783b0",
        "body" : "Should we extract these methods into util class?",
        "createdAt" : "2021-03-31T02:32:22Z",
        "updatedAt" : "2021-05-10T06:28:22Z",
        "lastEditedBy" : "c7afbd1a-ab9f-4878-b837-32685ae783b0",
        "tags" : [
        ]
      },
      {
        "id" : "a23dfe52-9f29-4f8c-8195-443802bcdf52",
        "parentId" : "480c1ac4-1180-454b-a382-4bfe4ae252a9",
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "I mean we can just change `private boolean` to `private static boolean` since they are not depending on any of the state from the class, but it's a really minor thing :)",
        "createdAt" : "2021-03-31T16:52:48Z",
        "updatedAt" : "2021-05-10T06:28:22Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      }
    ],
    "commit" : "2bc0391a879c009f5a1b43bb5ddd1d6c78af6c22",
    "line" : 168,
    "diffHunk" : "@@ -1,1 +883,887 @@  }\n\n  private boolean isTimestampTypeMatched(TimeUnit unit) {\n    return logicalTypeAnnotation instanceof TimestampLogicalTypeAnnotation &&\n      ((TimestampLogicalTypeAnnotation) logicalTypeAnnotation).getUnit() == unit;"
  },
  {
    "id" : "ce95a370-50da-449b-9a85-3057d63d96db",
    "prId" : 28477,
    "prUrl" : "https://github.com/apache/spark/pull/28477#pullrequestreview-408047799",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "577451bd-bb27-4a51-bc07-9fef8e0b75c6",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "it's very hard to use Scala enum in Java, so I use string instead.",
        "createdAt" : "2020-05-07T14:56:45Z",
        "updatedAt" : "2020-05-12T14:35:21Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "44569aba-8745-4e99-80e7-697305a9ab2e",
        "parentId" : "577451bd-bb27-4a51-bc07-9fef8e0b75c6",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Did you consider to pass enum's id? Like `LegacyBehaviorPolicy.EXCEPTION.id`. This could be less expensive.",
        "createdAt" : "2020-05-07T19:25:45Z",
        "updatedAt" : "2020-05-12T14:35:21Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "98e9fa0f-f810-4170-b774-d5ee6d157279",
        "parentId" : "577451bd-bb27-4a51-bc07-9fef8e0b75c6",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "I don't think it affects perf, and the code will be less readable if we see `mode == 0` instead of `\"LEGACY\".equals(mode)`",
        "createdAt" : "2020-05-08T07:17:08Z",
        "updatedAt" : "2020-05-12T14:35:21Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "eb61edb3058653d40ac35e3e92d4314e7011cc01",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +104,108 @@  private final ZoneId convertTz;\n  private static final ZoneId UTC = ZoneOffset.UTC;\n  private final String datetimeRebaseMode;\n\n  public VectorizedColumnReader("
  },
  {
    "id" : "99dd1537-61b5-40e6-8633-599c976d0691",
    "prId" : 28477,
    "prUrl" : "https://github.com/apache/spark/pull/28477#pullrequestreview-407738091",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3134080b-77aa-4e00-bb4f-1d4e0f8836e2",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Should we add an assert to be sure that datetimeRebaseMode is either `CORRECTED` or `EXCEPTION` or `LEGACY` (in upper case)?",
        "createdAt" : "2020-05-07T19:23:04Z",
        "updatedAt" : "2020-05-12T14:35:21Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "eb61edb3058653d40ac35e3e92d4314e7011cc01",
    "line" : 32,
    "diffHunk" : "@@ -1,1 +136,140 @@    assert \"LEGACY\".equals(datetimeRebaseMode) || \"EXCEPTION\".equals(datetimeRebaseMode) ||\n      \"CORRECTED\".equals(datetimeRebaseMode);\n    this.datetimeRebaseMode = datetimeRebaseMode;\n  }\n"
  },
  {
    "id" : "f3f2f4b5-69dd-4fbe-848f-d98abcf7b360",
    "prId" : 28477,
    "prUrl" : "https://github.com/apache/spark/pull/28477#pullrequestreview-409726448",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2684ce84-6286-47c7-9e05-f0b6e85e7c16",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "nit but `failIfRebase` -> `shouldFailIfRebase`?",
        "createdAt" : "2020-05-12T01:50:53Z",
        "updatedAt" : "2020-05-12T14:35:21Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "5e576797-d3e2-4996-ac23-8f31242e32f3",
        "parentId" : "2684ce84-6286-47c7-9e05-f0b6e85e7c16",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "it doesn't make a big difference... and shorter names are better.",
        "createdAt" : "2020-05-12T06:15:43Z",
        "updatedAt" : "2020-05-12T14:35:21Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "eb61edb3058653d40ac35e3e92d4314e7011cc01",
    "line" : 54,
    "diffHunk" : "@@ -1,1 +178,182 @@  }\n\n  static int rebaseDays(int julianDays, final boolean failIfRebase) {\n    if (failIfRebase) {\n      if (julianDays < RebaseDateTime.lastSwitchJulianDay()) {"
  },
  {
    "id" : "a1cb1563-0b60-4316-a8a0-9615694304f9",
    "prId" : 27973,
    "prUrl" : "https://github.com/apache/spark/pull/27973#pullrequestreview-379457084",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0ea16e4a-dfce-480c-b7d6-d519338b1bb0",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "I am kind of neutral but a bit of dups vs a bit of perf :-). I guess it's fine.",
        "createdAt" : "2020-03-23T14:02:21Z",
        "updatedAt" : "2020-03-23T14:02:21Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "50120608897b22fb13ed05f975941e492d215af3",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +463,467 @@      }\n    } else if (originalType == OriginalType.TIMESTAMP_MILLIS) {\n      if (rebaseDateTime) {\n        for (int i = 0; i < num; i++) {\n          if (defColumn.readInteger() == maxDefLevel) {"
  }
]