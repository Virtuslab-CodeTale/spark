[
  {
    "id" : "b240a6ca-8af1-4e80-9c69-c587ae028814",
    "prId" : 27316,
    "prUrl" : "https://github.com/apache/spark/pull/27316#pullrequestreview-352739928",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "753c3bbe-3e75-452a-8140-0234bfef3a1d",
        "parentId" : null,
        "authorId" : "99e31844-a5b3-48a2-af71-412edb607a13",
        "body" : "Can we reuse DeltaBinaryPackingValuesReader multiple times while I am not familiar with Parquet?\r\n\r\nWhen `DeltaBinaryPackinginitFromPage.initFromPage` is called, `valuesBuffer` is allocated every time at [here](https://github.com/apache/parquet-mr/blob/master/parquet-column/src/main/java/org/apache/parquet/column/values/delta/DeltaBinaryPackingValuesReader.java#L84). On the other hand, `valuesBuffer` is not initialized at [DeltaBinaryPackinginitFromPage.initFromPage](https://github.com/apache/parquet-mr/blob/master/parquet-column/src/main/java/org/apache/parquet/column/values/delta/DeltaBinaryPackingValuesReader.java#L60-75).\r\n\r\nI am curious about what happens if `initFromPage` is called multiple times. ",
        "createdAt" : "2020-02-02T16:09:25Z",
        "updatedAt" : "2020-02-02T19:28:39Z",
        "lastEditedBy" : "99e31844-a5b3-48a2-af71-412edb607a13",
        "tags" : [
        ]
      },
      {
        "id" : "9e5101bc-0c0f-40ef-9c0b-700f98ccdd70",
        "parentId" : "753c3bbe-3e75-452a-8140-0234bfef3a1d",
        "authorId" : "cd38bd5a-0fae-4d8e-8acd-36dc13753759",
        "body" : "Thanks for the comment.\r\nThe current usage keeps the same pattern with parquet inside, `DeltaBinaryPackingValuesReader` is also reused in the encoding `DeltaByteArrayReader` and `DeltaLengthByteArrayValuesReader`.",
        "createdAt" : "2020-02-04T06:02:16Z",
        "updatedAt" : "2020-02-04T06:02:16Z",
        "lastEditedBy" : "cd38bd5a-0fae-4d8e-8acd-36dc13753759",
        "tags" : [
        ]
      }
    ],
    "commit" : "947c6f732ea127d6f60f0371138127bda6e78770",
    "line" : 33,
    "diffHunk" : "@@ -1,1 +31,35 @@public class VectorizedDeltaBinaryPackedReader extends ValuesReader\n    implements VectorizedValuesReader {\n  private final DeltaBinaryPackingValuesReader valuesReader = new DeltaBinaryPackingValuesReader();\n\n  @Override"
  }
]