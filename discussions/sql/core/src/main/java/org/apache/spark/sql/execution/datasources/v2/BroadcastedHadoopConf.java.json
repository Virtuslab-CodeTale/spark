[
  {
    "id" : "a4d66119-ed92-4cc6-8cab-a921e29e4b3a",
    "prId" : 26005,
    "prUrl" : "https://github.com/apache/spark/pull/26005#pullrequestreview-316643459",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9da2b24f-d2a7-4372-bc80-02890b7d196c",
        "parentId" : null,
        "authorId" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "body" : "I don't think that the data source should be responsible for providing a SparkSession. Spark has a session and configures the data source.\r\n\r\nI think this interface should allow Spark to pass a broadcasted Hadoop Configuration to the source instead.",
        "createdAt" : "2019-11-13T22:39:45Z",
        "updatedAt" : "2019-11-13T22:39:45Z",
        "lastEditedBy" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "tags" : [
        ]
      },
      {
        "id" : "c20acb59-9a91-480c-a316-dbdb2049c7a1",
        "parentId" : "9da2b24f-d2a7-4372-bc80-02890b7d196c",
        "authorId" : "ae55b635-dd0e-41aa-9272-372de9a35f38",
        "body" : "I don't think I understand what you mean here, could you try and rephrase it? Sorry.",
        "createdAt" : "2019-11-13T22:50:04Z",
        "updatedAt" : "2019-11-13T22:50:05Z",
        "lastEditedBy" : "ae55b635-dd0e-41aa-9272-372de9a35f38",
        "tags" : [
        ]
      },
      {
        "id" : "1cd92ec0-e7bd-4cf9-b43c-6cb705987ac4",
        "parentId" : "9da2b24f-d2a7-4372-bc80-02890b7d196c",
        "authorId" : "ae55b635-dd0e-41aa-9272-372de9a35f38",
        "body" : "To clarify: do you mean you want us to use reflection for something implementing this interface inside of the DSv2 code path? Or do you mean something else?",
        "createdAt" : "2019-11-13T23:08:19Z",
        "updatedAt" : "2019-11-13T23:08:19Z",
        "lastEditedBy" : "ae55b635-dd0e-41aa-9272-372de9a35f38",
        "tags" : [
        ]
      },
      {
        "id" : "07fa6dd9-2aee-48ac-9971-f3abbf291e01",
        "parentId" : "9da2b24f-d2a7-4372-bc80-02890b7d196c",
        "authorId" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "body" : "Data sources aren't passed a Spark session, so it doesn't make sense that this interface requires the source to provide one. If we think sources need access to a Spark session, then we should add an interface that sets the session directly. (I know the built-in sources have one, but that's because those are v1 sources that have been slightly modified to fit into v2.)\r\n\r\nThe benefit of having an interface like this is to avoid needing the Spark session. That's  currently done by accessing the Spark session from the environment (e.g. `SparkSession.builder.getOrCreate()`) and we want to avoid making sources do that.\r\n\r\nThat's why I think the way this works should be to set a broadcasted configuration on a `Table` implementation that extends this interface using a method like `setBroadcastedConf`.\r\n\r\nI'm on ASF slack if you'd like to talk about this more directly.",
        "createdAt" : "2019-11-13T23:43:29Z",
        "updatedAt" : "2019-11-13T23:43:29Z",
        "lastEditedBy" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "tags" : [
        ]
      },
      {
        "id" : "8e098935-aaf6-4638-80de-c1cb4a0c9d9a",
        "parentId" : "9da2b24f-d2a7-4372-bc80-02890b7d196c",
        "authorId" : "ae55b635-dd0e-41aa-9272-372de9a35f38",
        "body" : "Ok so we did a quick chat. It’s possible that this and one other small use case are the only reasons the sources currently have a Spark Session inside of them and the design goal\r\nof DSv2 was to get rid of that. So I’ll see if this can be avoided, but if it’s more than broadcasting the Hadoop conf and case sensitive options then I’ll switch the API to just pass in a Spark session and we can stick with this API. Does that sound like a reasonable summary @rdblue?",
        "createdAt" : "2019-11-14T00:16:32Z",
        "updatedAt" : "2019-11-14T00:16:33Z",
        "lastEditedBy" : "ae55b635-dd0e-41aa-9272-372de9a35f38",
        "tags" : [
        ]
      }
    ],
    "commit" : "aadd185a3d98d1ed056c0a8498c254db19298b81",
    "line" : 38,
    "diffHunk" : "@@ -1,1 +36,40 @@public interface BroadcastedHadoopConf {\n  SparkSession sparkSession();\n  CaseInsensitiveStringMap options();\n\n  /**"
  }
]