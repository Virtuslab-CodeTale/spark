[
  {
    "id" : "25f21a19-79bf-4cbb-aaa6-0c7608b1a869",
    "prId" : 33629,
    "prUrl" : "https://github.com/apache/spark/pull/33629#pullrequestreview-725968597",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c259efc1-38d3-4857-91a4-31c51d6be374",
        "parentId" : null,
        "authorId" : "c7afbd1a-ab9f-4878-b837-32685ae783b0",
        "body" : "```\r\npublic long encodePageNumberAndOffset(MemoryBlock page, long offsetInPage) {\r\n....\r\n}\r\n```",
        "createdAt" : "2021-08-10T03:10:06Z",
        "updatedAt" : "2021-08-10T03:10:06Z",
        "lastEditedBy" : "c7afbd1a-ab9f-4878-b837-32685ae783b0",
        "tags" : [
        ]
      }
    ],
    "commit" : "9312660a8996619cc1cc6b722364c73fc658d940",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +146,150 @@        MemoryBlock page = loc.getMemoryPage();\n        long address = taskMemoryManager.encodePageNumberAndOffset(page,\n            baseOffset - 2L * UnsafeAlignedOffset.getUaoSize());\n\n        // Compute prefix"
  },
  {
    "id" : "dc0afbe6-fed2-4620-8904-1c3da4cd440c",
    "prId" : 28195,
    "prUrl" : "https://github.com/apache/spark/pull/28195#pullrequestreview-393510868",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5a994879-ae92-406e-84c9-60ffc3e3807d",
        "parentId" : null,
        "authorId" : "bc001dd4-5224-4ca1-afdd-49d69783d7f2",
        "body" : "sorry I don't get it here why the address is related to uaoSize?",
        "createdAt" : "2020-04-15T06:35:02Z",
        "updatedAt" : "2020-04-16T14:24:58Z",
        "lastEditedBy" : "bc001dd4-5224-4ca1-afdd-49d69783d7f2",
        "tags" : [
        ]
      },
      {
        "id" : "346793d9-2922-4cec-bd7e-065724b517fa",
        "parentId" : "5a994879-ae92-406e-84c9-60ffc3e3807d",
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "The record format is:\r\n\r\n ```\r\n(total length) (key length) (key) (value) (8 byte pointer to next value)\r\n       |             |\r\n    uaoSize       uaoSize\r\n```\r\n\r\nAnd we now get keyOffset, so we need back walk for 2 usao sizes to get the address of the record.",
        "createdAt" : "2020-04-15T06:44:04Z",
        "updatedAt" : "2020-04-16T14:24:58Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      },
      {
        "id" : "9506b325-8bd0-479f-bb31-c432fadf466a",
        "parentId" : "5a994879-ae92-406e-84c9-60ffc3e3807d",
        "authorId" : "bc001dd4-5224-4ca1-afdd-49d69783d7f2",
        "body" : "so you mean we need to add back 2 * uaoSize to cover the space of storing total length and key length? If that's the case then it makes sense.",
        "createdAt" : "2020-04-15T06:52:21Z",
        "updatedAt" : "2020-04-16T14:24:58Z",
        "lastEditedBy" : "bc001dd4-5224-4ca1-afdd-49d69783d7f2",
        "tags" : [
        ]
      },
      {
        "id" : "d6215d8f-ae54-4767-a28f-f76086b84726",
        "parentId" : "5a994879-ae92-406e-84c9-60ffc3e3807d",
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "yes.",
        "createdAt" : "2020-04-15T07:14:20Z",
        "updatedAt" : "2020-04-16T14:24:58Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      }
    ],
    "commit" : "c6f39b5a25e1e92c7f5a71ca541e9ce501850000",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +143,147 @@        // Get encoded memory address\n        // baseObject + baseOffset point to the beginning of the key data in the map, but that\n        // the KV-pair's length data is stored at 2 * uaoSize bytes immediately before that address\n        MemoryBlock page = loc.getMemoryPage();\n        long address = taskMemoryManager.encodePageNumberAndOffset(page,"
  }
]