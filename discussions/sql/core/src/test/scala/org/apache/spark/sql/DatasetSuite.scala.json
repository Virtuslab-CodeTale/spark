[
  {
    "id" : "e9dd261a-7fd8-4365-af63-85ffe6ce8999",
    "prId" : 33545,
    "prUrl" : "https://github.com/apache/spark/pull/33545#pullrequestreview-719816987",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ab050058-e24a-499f-82df-f3fa025d8d8b",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "one minor comment: what happens if there are duplicated names like `min(...).as(\"a\"), max(...).as(\"a\")`? Do we silently drop one value or do we fail at runtime?",
        "createdAt" : "2021-08-02T04:35:16Z",
        "updatedAt" : "2021-08-02T04:35:16Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "60b189c6-996c-4e06-bcb2-25d879f6affc",
        "parentId" : "ab050058-e24a-499f-82df-f3fa025d8d8b",
        "authorId" : "c4ecf4e4-1fda-4fed-9980-aed6c3b3e8e4",
        "body" : "Yes, It behaves identical to `Row.getValuesMap(Row.schema.fieldNames)`, which drops all but the last occurrence of a column name.",
        "createdAt" : "2021-08-02T05:58:50Z",
        "updatedAt" : "2021-08-02T05:58:50Z",
        "lastEditedBy" : "c4ecf4e4-1fda-4fed-9980-aed6c3b3e8e4",
        "tags" : [
        ]
      }
    ],
    "commit" : "80e35d94c545dc1f03a70107467c3e92b3d19e29",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +712,716 @@        min($\"id\").as(\"min_val\"),\n        max($\"id\").as(\"max_val\"),\n        sum($\"id\").as(\"sum_val\"),\n        count(when($\"id\" % 2 === 0, 1)).as(\"num_even\")\n      )"
  },
  {
    "id" : "34f32192-c887-438e-a421-d4710e66e132",
    "prId" : 33423,
    "prUrl" : "https://github.com/apache/spark/pull/33423#pullrequestreview-710313177",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "75c47c1b-889a-414c-bdc3-2469a32cafc4",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "can we add a test with a duplicate column names?",
        "createdAt" : "2021-07-20T08:20:30Z",
        "updatedAt" : "2021-07-20T08:20:30Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "14102dc1-44ed-4449-84ca-04197945c2ce",
        "parentId" : "75c47c1b-889a-414c-bdc3-2469a32cafc4",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "I think `withColumns`  doesn't allow duplicate column names.",
        "createdAt" : "2021-07-20T08:28:06Z",
        "updatedAt" : "2021-07-20T08:28:06Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "1b7571d2-eb31-4772-ad95-54921cfc6653",
        "parentId" : "75c47c1b-889a-414c-bdc3-2469a32cafc4",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "There is one test in `DataFrameSuite`.",
        "createdAt" : "2021-07-20T08:28:27Z",
        "updatedAt" : "2021-07-20T08:28:27Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "3b69021044bdcbab59e9767039e2a290a8e488b6",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +2043,2047 @@\n  test(\"SPARK-36210: withColumns preserve insertion ordering\") {\n    val df = Seq(1, 2, 3).toDS()\n\n    val colNames = (1 to 10).map(i => s\"value${i}\")"
  }
]