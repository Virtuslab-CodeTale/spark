[
  {
    "id" : "ace066a5-c29a-47e1-8ccd-ba08d47932fc",
    "prId" : 33564,
    "prUrl" : "https://github.com/apache/spark/pull/33564#pullrequestreview-718572582",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "21cfbe4d-027b-4e0b-a077-c9f9e4563f4a",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "why need to add `coalesce`?",
        "createdAt" : "2021-07-29T19:34:52Z",
        "updatedAt" : "2021-07-29T19:34:53Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "505a3354-8dd0-49b3-ba68-92bca0a83967",
        "parentId" : "21cfbe4d-027b-4e0b-a077-c9f9e4563f4a",
        "authorId" : "99765afe-8dbe-4d5f-9ad3-d5bc40f0462b",
        "body" : "Same question here. Looks good otherwise.",
        "createdAt" : "2021-07-29T20:20:48Z",
        "updatedAt" : "2021-07-29T20:20:49Z",
        "lastEditedBy" : "99765afe-8dbe-4d5f-9ad3-d5bc40f0462b",
        "tags" : [
        ]
      },
      {
        "id" : "d1eee8d7-083d-4905-b0ad-971158870cc7",
        "parentId" : "21cfbe4d-027b-4e0b-a077-c9f9e4563f4a",
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "@viirya @huaxingao this is because `TestHiveSingleton` uses `local[1]` while `SharedSparkSession` uses `local[2]` so it will generate 2 Parquet files. As result, `ParquetScan` will generate 2 input splits which makes the test fail since the provided value for `expectedPartitionCount` is 1.",
        "createdAt" : "2021-07-29T22:06:13Z",
        "updatedAt" : "2021-07-29T22:06:13Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      }
    ],
    "commit" : "4663ab4098f4e439f35c804d88a36ff5d4f14ea9",
    "line" : 94,
    "diffHunk" : "@@ -1,1 +108,112 @@    withSQLConf((SQLConf.USE_V1_SOURCE_LIST.key, \"\")) {\n      withTempPath { dir =>\n        spark.range(10).coalesce(1).selectExpr(\"id\", \"id % 3 as p\")\n            .write.partitionBy(\"p\").parquet(dir.getCanonicalPath)\n        withTempView(\"tmp\") {"
  }
]