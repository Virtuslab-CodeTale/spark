[
  {
    "id" : "a3b440b2-2659-4dd3-921a-7bfffd8be41e",
    "prId" : 33341,
    "prUrl" : "https://github.com/apache/spark/pull/33341#pullrequestreview-707992367",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "360a73a2-bba8-4463-9ac6-3178812831e0",
        "parentId" : null,
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "We should have a test case for checking the result data type since it is not always TimestampType now.",
        "createdAt" : "2021-07-15T14:05:37Z",
        "updatedAt" : "2021-07-15T14:05:37Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      },
      {
        "id" : "0a233ae9-7f40-4aa0-abc7-cf79f4a74bb8",
        "parentId" : "360a73a2-bba8-4463-9ac6-3178812831e0",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "OK",
        "createdAt" : "2021-07-16T04:21:20Z",
        "updatedAt" : "2021-07-16T04:21:21Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "cc3543e29cc29c72d1fece7d5104e0c02f87ebd7",
    "line" : 37,
    "diffHunk" : "@@ -1,1 +39,43 @@          .agg(count(\"*\").as(\"counts\"))\n          .orderBy($\"window.start\".asc)\n          .select($\"window.start\".cast(\"string\"), $\"window.end\".cast(\"string\"), $\"counts\"),\n        Seq(\n          Row(\"2016-03-27 19:39:30\", \"2016-03-27 19:39:40\", 1)"
  },
  {
    "id" : "0b0d7286-c4ff-44ba-a2e7-7ee193150293",
    "prId" : 33341,
    "prUrl" : "https://github.com/apache/spark/pull/33341#pullrequestreview-708220583",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ee5a6732-42d7-44a8-a54e-755ada24e88f",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "if the column is string type, we now always cast it to the old timestamp type? or it depends on the config?",
        "createdAt" : "2021-07-16T05:39:53Z",
        "updatedAt" : "2021-07-16T05:39:54Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "8343e396-ac19-4b5b-8dd3-dce231136d87",
        "parentId" : "ee5a6732-42d7-44a8-a54e-755ada24e88f",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "Yes.  The string type will implict cast to the old timestamp type first.",
        "createdAt" : "2021-07-16T06:00:59Z",
        "updatedAt" : "2021-07-16T06:00:59Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      },
      {
        "id" : "5300d1f2-c4c7-46b8-ba9f-ec964a608654",
        "parentId" : "ee5a6732-42d7-44a8-a54e-755ada24e88f",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "is it expected? cc @gengliangwang ",
        "createdAt" : "2021-07-16T06:13:51Z",
        "updatedAt" : "2021-07-16T06:13:51Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "5ae050f4-d39c-401c-8d4d-f9368eec18f9",
        "parentId" : "ee5a6732-42d7-44a8-a54e-755ada24e88f",
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "@cloud-fan from the current Type Coercion rules, when it comes to String and AnyTimestamp, we always cast as `AnyTimestampType.defaultConcreteType`. This is out of the scope of this PR. Let's revisit that later.",
        "createdAt" : "2021-07-16T10:15:43Z",
        "updatedAt" : "2021-07-16T10:15:44Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      }
    ],
    "commit" : "cc3543e29cc29c72d1fece7d5104e0c02f87ebd7",
    "line" : 29,
    "diffHunk" : "@@ -1,1 +31,35 @@\n  test(\"simple tumbling window with record at window start\") {\n    val df1 = Seq((\"2016-03-27 19:39:30\", 1, \"a\")).toDF(\"time\", \"value\", \"id\")\n    val df2 = Seq((LocalDateTime.parse(\"2016-03-27T19:39:30\"), 1, \"a\")).toDF(\"time\", \"value\", \"id\")\n"
  }
]