[
  {
    "id" : "1d207490-d9a6-4856-a088-de7905728980",
    "prId" : 28796,
    "prUrl" : "https://github.com/apache/spark/pull/28796#pullrequestreview-428568615",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "47cc46d8-3bd9-48e1-8f5b-235cdea900a7",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "We need to remove `:` at line 539, too.",
        "createdAt" : "2020-06-11T03:30:09Z",
        "updatedAt" : "2020-06-11T03:49:36Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "e3bb417220c3d77e0cba0715fe31438f853e546b",
    "line" : 10,
    "diffHunk" : "@@ -1,1 +541,545 @@        spark.readStream.option(\"fs.defaultFS\", defaultFs).text(path)\n      }.getMessage\n      assert(message.filterNot(Set(':', '\"').contains) == expectMessage)\n    }\n  }"
  },
  {
    "id" : "492c0e21-5933-4da7-b993-8c9cbf64dc48",
    "prId" : 27620,
    "prUrl" : "https://github.com/apache/spark/pull/27620#pullrequestreview-463938425",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e3c16fed-951b-4d36-aeda-cb81fa04935e",
        "parentId" : null,
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "The code regarding FileSystem I add here is very similar with what I add in #27664. When either one gets merged, I'll rebase and deduplicate it.",
        "createdAt" : "2020-02-21T08:29:26Z",
        "updatedAt" : "2020-06-29T06:41:19Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      },
      {
        "id" : "1ad40a5b-ba08-48a6-8183-c54d19b6e9b6",
        "parentId" : "e3c16fed-951b-4d36-aeda-cb81fa04935e",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Could you close this comment?",
        "createdAt" : "2020-08-10T03:07:22Z",
        "updatedAt" : "2020-08-10T03:07:22Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "0e972fc20fb1a77fee90200b26a824bb19a91879",
    "line" : 189,
    "diffHunk" : "@@ -1,1 +2100,2104 @@}\n\nclass CountListingLocalFileSystem extends RawLocalFileSystem {\n  import CountListingLocalFileSystem._\n"
  },
  {
    "id" : "d2a02df8-d9d4-42ef-beac-08a703249ca9",
    "prId" : 27620,
    "prUrl" : "https://github.com/apache/spark/pull/27620#pullrequestreview-397067360",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "fa75c03d-c988-48c8-8a0c-2808faa4acec",
        "parentId" : null,
        "authorId" : "e6f86365-3ac2-48b4-94f9-21ce737cf1ac",
        "body" : "Maybe it worth to check nothing not relevant is inside. This probably indicate the need of some reset functionality for `pathToNumListStatusCalled`...",
        "createdAt" : "2020-04-15T12:54:20Z",
        "updatedAt" : "2020-06-29T06:41:19Z",
        "lastEditedBy" : "e6f86365-3ac2-48b4-94f9-21ce737cf1ac",
        "tags" : [
        ]
      },
      {
        "id" : "3f3d40fd-b0b1-4b6d-baef-427f541139ba",
        "parentId" : "fa75c03d-c988-48c8-8a0c-2808faa4acec",
        "authorId" : "e6f86365-3ac2-48b4-94f9-21ce737cf1ac",
        "body" : "What I've meant here is that the test should fail if some nasty code puts irrelevant data into the map. For example when I put (just for the sake of representation) the following:\r\n```\r\n        CountListingLocalFileSystem.resetCount()\r\n        CountListingLocalFileSystem.pathToNumListStatusCalled.put(\"foo\", new AtomicLong(1))\r\n```\r\nit would be good to fail.\r\n",
        "createdAt" : "2020-04-16T14:05:54Z",
        "updatedAt" : "2020-06-29T06:41:19Z",
        "lastEditedBy" : "e6f86365-3ac2-48b4-94f9-21ce737cf1ac",
        "tags" : [
        ]
      },
      {
        "id" : "e7d9ca00-59ab-4f60-9383-ed7021e7deaa",
        "parentId" : "fa75c03d-c988-48c8-8a0c-2808faa4acec",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "Your example is now failing because I added check for counting the element of pathToNumListStatusCalled. Does it address your comment?",
        "createdAt" : "2020-04-17T04:36:51Z",
        "updatedAt" : "2020-06-29T06:41:19Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      },
      {
        "id" : "18930001-bd35-4ac3-a3f2-4680fae9454f",
        "parentId" : "fa75c03d-c988-48c8-8a0c-2808faa4acec",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "Sigh I realized I didn't push the change. Sorry about it. Will push.",
        "createdAt" : "2020-04-17T04:41:10Z",
        "updatedAt" : "2020-06-29T06:41:19Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      },
      {
        "id" : "f5fdae3c-1f9e-4726-b772-f495092ae7f1",
        "parentId" : "fa75c03d-c988-48c8-8a0c-2808faa4acec",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "Sorry I have to revert it. My bad. I remembered why I only checked the directory - this requires all input files to be verified, which is actually redundant, as we already verified such behavior from the UT \"Caches and leverages unread files\".",
        "createdAt" : "2020-04-17T14:48:18Z",
        "updatedAt" : "2020-06-29T06:41:19Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      },
      {
        "id" : "8912f15c-9cf8-4bce-a058-5192ed45f2d8",
        "parentId" : "fa75c03d-c988-48c8-8a0c-2808faa4acec",
        "authorId" : "e6f86365-3ac2-48b4-94f9-21ce737cf1ac",
        "body" : "Even if it's checked in the positive case it still holds value in this negative case unless we find a pretty good reason why it's not possible. Negative case code parts can list unnecessary dirs/files.",
        "createdAt" : "2020-04-20T09:51:39Z",
        "updatedAt" : "2020-06-29T06:41:19Z",
        "lastEditedBy" : "e6f86365-3ac2-48b4-94f9-21ce737cf1ac",
        "tags" : [
        ]
      },
      {
        "id" : "addcc6c0-f6c5-44d2-92d8-0551e32ad18f",
        "parentId" : "fa75c03d-c988-48c8-8a0c-2808faa4acec",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "I'm not sure we want to verify whole behavior of file stream source in this PR. This test only makes sure the calls of listing input directory (and input files as well) are expected, other checks are redundant and error-prone. E.g. Suppose file stream source employs some changes to read side due to some changes, then this test will fail unintentionally.\r\n\r\nEDIT: it might be true for input files as well, but that may be the one of important things we may want to watch. (And we checked it in other test I've added.) Other paths are not that important relatively.",
        "createdAt" : "2020-04-21T00:20:49Z",
        "updatedAt" : "2020-06-29T06:41:19Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      },
      {
        "id" : "cd8e6d49-6a55-4bcc-a0b7-cd7cd4da7570",
        "parentId" : "fa75c03d-c988-48c8-8a0c-2808faa4acec",
        "authorId" : "e6f86365-3ac2-48b4-94f9-21ce737cf1ac",
        "body" : "> This test only makes sure the calls of listing input directory (and input files as well) are expected\r\n\r\nMaking sure that the modified code doesn't introduce further unintended directory listing is also important but I agree not with the price to make test failures when somebody makes modification in the stream source code. All in all I agree not to add it since we've double checked that no further unintended directory listing introduced.",
        "createdAt" : "2020-04-21T07:41:29Z",
        "updatedAt" : "2020-06-29T06:41:19Z",
        "lastEditedBy" : "e6f86365-3ac2-48b4-94f9-21ce737cf1ac",
        "tags" : [
        ]
      }
    ],
    "commit" : "0e972fc20fb1a77fee90200b26a824bb19a91879",
    "line" : 149,
    "diffHunk" : "@@ -1,1 +2029,2033 @@        source.latestOffset(FileStreamSourceOffset(-1L), ReadLimit.maxFiles(5))\n          .asInstanceOf[FileStreamSourceOffset]\n        assert(1 === CountListingLocalFileSystem.pathToNumListStatusCalled\n          .get(src.getCanonicalPath).map(_.get()).getOrElse(0))\n"
  }
]