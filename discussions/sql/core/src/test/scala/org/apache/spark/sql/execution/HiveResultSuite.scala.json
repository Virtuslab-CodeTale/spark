[
  {
    "id" : "e6ae13f5-63f2-4603-baad-678a1345cf88",
    "prId" : 28705,
    "prUrl" : "https://github.com/apache/spark/pull/28705#pullrequestreview-422933648",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0db56162-07ab-4442-88f4-2f57872afa27",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "After enabling Java 8 API, the result is always the same independently from JVM and Spark's session time zones. Before it wasn't possible.",
        "createdAt" : "2020-06-02T17:34:39Z",
        "updatedAt" : "2020-06-03T19:35:16Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "95908780-ce43-4253-b0d3-742747cca02b",
        "parentId" : "0db56162-07ab-4442-88f4-2f57872afa27",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "So, when Java 8 API is off, the test will fail because Java 7 based date/timestamp conversions depend on JVM time zone on the executors side and HiveResult side. If they are not in sync each other and with Spark session time zone, the result can be wrong.",
        "createdAt" : "2020-06-02T18:04:54Z",
        "updatedAt" : "2020-06-03T19:35:17Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "74dfe4d428000ec31c6cdaac8c35301b904d1d1d",
    "line" : 38,
    "diffHunk" : "@@ -1,1 +40,44 @@\n  test(\"date formatting in hive result\") {\n    withOutstandingZoneIds {\n      val dates = Seq(\"2018-12-28\", \"1582-10-03\", \"1582-10-04\", \"1582-10-15\")\n      val df = dates.toDF(\"a\").selectExpr(\"cast(a as date) as b\")"
  },
  {
    "id" : "4b7a5e69-d84c-42d1-a88c-e5093d2b812b",
    "prId" : 28705,
    "prUrl" : "https://github.com/apache/spark/pull/28705#pullrequestreview-422986028",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "70300f59-f32e-4eae-b7ea-862eb985f739",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "This should test the cases when jvm default time zone and session time zone are not in sync.",
        "createdAt" : "2020-06-02T19:18:08Z",
        "updatedAt" : "2020-06-03T19:35:17Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "74dfe4d428000ec31c6cdaac8c35301b904d1d1d",
    "line" : 27,
    "diffHunk" : "@@ -1,1 +29,33 @@    for {\n      jvmZoneId <- outstandingZoneIds\n      sessionZoneId <- outstandingZoneIds\n    } {\n      withDefaultTimeZone(jvmZoneId) {"
  },
  {
    "id" : "dfa6e1b9-06a4-4383-ba62-5126a46314ff",
    "prId" : 28004,
    "prUrl" : "https://github.com/apache/spark/pull/28004#pullrequestreview-382560153",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "153b6f40-7b8f-4081-9eca-0cfb7fcba025",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "can we make the test more robust? e.g.\r\n```\r\nassert(HiveResult.hiveResultString(executedPlan).head.split(\"\\n\").map(_.trim) == Seq(\"id\", \"bigint\", \"col1\"))\r\n```",
        "createdAt" : "2020-03-26T10:27:36Z",
        "updatedAt" : "2020-03-26T15:22:58Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "04f4b434-50f9-405d-b25d-ca77468451c4",
        "parentId" : "153b6f40-7b8f-4081-9eca-0cfb7fcba025",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "If you `trim`, wouldn't it make the test less robust? Adding the padding was the compatibility change for `DESCRIBE`.",
        "createdAt" : "2020-03-26T15:19:07Z",
        "updatedAt" : "2020-03-26T15:22:58Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      },
      {
        "id" : "832bd452-c593-43a5-a3f2-c9e774eaecd4",
        "parentId" : "153b6f40-7b8f-4081-9eca-0cfb7fcba025",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "ok so the number of spaces is also defined by Hive.",
        "createdAt" : "2020-03-27T03:33:32Z",
        "updatedAt" : "2020-03-27T03:33:38Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "5de8684b5f38be01f5978247c9f81529100ee096",
    "line" : 38,
    "diffHunk" : "@@ -1,1 +96,100 @@              \"\\tbigint              \" +\n              \"\\tcol1                \"\n            assert(HiveResult.hiveResultString(executedPlan).head == expected)\n          }\n      }"
  }
]