[
  {
    "id" : "a379d9ee-0a9d-48ea-9ee8-1b29d48b42c7",
    "prId" : 31405,
    "prUrl" : "https://github.com/apache/spark/pull/31405#pullrequestreview-582063305",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "60696b3a-6912-489f-adff-29f11a75a77d",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "This is a bug fix. `withGlobalTempView()` doesn't remove global temp view if it is called with full path: `withGlobalTempView(\"global_temp.v2\")`",
        "createdAt" : "2021-02-03T07:20:20Z",
        "updatedAt" : "2021-02-03T07:20:20Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "becc740b9cc5e87298f4f3f9cde72ca41456f191",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +223,227 @@\n      val v2 = s\"${spark.sharedState.globalTempViewManager.database}.v2\"\n      withGlobalTempView(\"v2\") {\n        sql(s\"CREATE GLOBAL TEMP VIEW v2 AS SELECT * FROM $t\")\n        cacheRelation(v2)"
  },
  {
    "id" : "47eb25c2-19cd-4f30-9f86-980946b52975",
    "prId" : 31017,
    "prUrl" : "https://github.com/apache/spark/pull/31017#pullrequestreview-561342864",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3abf9f4d-0dce-4c99-87c2-996dfa021c2a",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "I had to add `QueryTest` to `checkAnswer` because I got pretty weird error when I run the test as part of Hive's test suite:\r\n```\r\n[info] org.apache.spark.sql.hive.execution.command.AlterTableDropPartitionSuite *** ABORTED *** (19 seconds, 910 milliseconds)\r\n[info]   java.lang.AbstractMethodError: Method org/apache/spark/sql/hive/execution/command/AlterTableDropPartitionSuite.org$apache$spark$sql$execution$command$AlterTableDropPartitionSuiteBase$$super$checkAnswer(Lscala/Function0;Lscala/collection/Seq;)V is abstract\r\n[info]   at org.apache.spark.sql.hive.execution.command.AlterTableDropPartitionSuite.org$apache$spark$sql$execution$command$AlterTableDropPartitionSuiteBase$$super$checkAnswer(AlterTableDropPartitionSuite.scala)\r\n```\r\nI don't have any clues what's going on here because `checkAnswer` from the `QueryTest` is defined, and it is not abstact.",
        "createdAt" : "2021-01-04T21:03:00Z",
        "updatedAt" : "2021-01-04T21:03:01Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "271b8e543d22f49b81b8dc36d3b8cee516bcde28",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +165,169 @@      sql(s\"CACHE TABLE $t\")\n      assert(spark.catalog.isCached(t))\n      QueryTest.checkAnswer(sql(s\"SELECT * FROM $t\"), Seq(Row(0, 0), Row(1, 1)))\n      sql(s\"ALTER TABLE $t DROP PARTITION (part=0)\")\n      assert(spark.catalog.isCached(t))"
  },
  {
    "id" : "ca1e76b9-3b53-4a61-90b5-4e3000bb100f",
    "prId" : 30747,
    "prUrl" : "https://github.com/apache/spark/pull/30747#pullrequestreview-552372074",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a7c3fdb9-207b-4eeb-9144-28163843caec",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "I will refactor and move this to a common trait later. I don't want to touch tests that are not related to `ALTER TABLE .. DROP PARTITION`.",
        "createdAt" : "2020-12-13T15:08:55Z",
        "updatedAt" : "2020-12-14T17:11:58Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "97933075-ff94-4a86-9e76-bd6366bef95f",
        "parentId" : "a7c3fdb9-207b-4eeb-9144-28163843caec",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "yea, like adding a `DDLCommandTestUtils`  trait.",
        "createdAt" : "2020-12-14T14:19:16Z",
        "updatedAt" : "2020-12-14T17:11:58Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "56e726cd-69dc-4da8-8dfd-d6aaf8f8d8d8",
        "parentId" : "a7c3fdb9-207b-4eeb-9144-28163843caec",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "@cloud-fan Here is the PR for that: https://github.com/apache/spark/pull/30779",
        "createdAt" : "2020-12-15T11:49:59Z",
        "updatedAt" : "2020-12-15T11:49:59Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "62f539b1e5cc7f573e789fc2a1f5386c431f6ad3",
    "line" : 40,
    "diffHunk" : "@@ -1,1 +38,42 @@  }\n\n  protected def withNsTable(ns: String, tableName: String, cat: String = catalog)\n    (f: String => Unit): Unit = {\n    val nsCat = s\"$cat.$ns\""
  },
  {
    "id" : "50a62bb6-216e-4c5c-81d6-52001f09a954",
    "prId" : 30538,
    "prUrl" : "https://github.com/apache/spark/pull/30538#pullrequestreview-563018363",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "83f48b4f-26f8-4e57-9d05-ba9b8b489bfb",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Does it work for hive catalog?",
        "createdAt" : "2020-12-29T14:15:03Z",
        "updatedAt" : "2021-01-08T08:03:31Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "9695e069-af4f-40c6-bea8-be94d225284b",
        "parentId" : "83f48b4f-26f8-4e57-9d05-ba9b8b489bfb",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "This is the common test suite for all catalogs. Yes, it works for Hive external catalog too.",
        "createdAt" : "2020-12-29T14:30:17Z",
        "updatedAt" : "2021-01-08T08:03:31Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "7365d1c2-9bc5-4852-bc0b-2c553b8d51ce",
        "parentId" : "83f48b4f-26f8-4e57-9d05-ba9b8b489bfb",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "hmm, don't we have a check to fail null partition value for ADD PARTITION with hive catalog? https://github.com/apache/spark/pull/30538/files#diff-9dd0899e5406230aeff96654432da54f35255f6dc60eecb87264a5c508a8c826R1193",
        "createdAt" : "2020-12-29T16:03:12Z",
        "updatedAt" : "2021-01-08T08:03:31Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "ed21f19e-dce8-4b80-9923-4ffe76563daa",
        "parentId" : "83f48b4f-26f8-4e57-9d05-ba9b8b489bfb",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "> don't we have a check to fail null partition value for ADD PARTITION with hive catalog\r\n\r\nFor hive catalog, we convert `null` to `DEFAULT_PARTITION_NAME` by `ExternalCatalogUtils.convertNullPartitionValues` from `toMetaStorePartitionSpec`. The last one is invoked in all functions in `HiveExternalCatalog` that makes deal with partition specs.",
        "createdAt" : "2021-01-06T20:30:25Z",
        "updatedAt" : "2021-01-08T08:03:31Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "89c15724d5af9b423a14f512c8764bd26eee6c9f",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +176,180 @@    withNamespaceAndTable(\"ns\", \"tbl\") { t =>\n      sql(s\"CREATE TABLE $t (col1 INT, p1 STRING) $defaultUsing PARTITIONED BY (p1)\")\n      sql(s\"ALTER TABLE $t ADD PARTITION (p1 = null)\")\n      checkPartitions(t, Map(\"p1\" -> nullPartitionValue))\n      sql(s\"ALTER TABLE $t DROP PARTITION (p1 = null)\")"
  }
]