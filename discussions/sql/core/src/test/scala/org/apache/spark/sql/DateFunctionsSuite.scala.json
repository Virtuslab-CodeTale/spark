[
  {
    "id" : "84ff2d6b-95f4-4c39-bad5-db99463a21e8",
    "prId" : 33278,
    "prUrl" : "https://github.com/apache/spark/pull/33278#pullrequestreview-702901574",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7f2d781a-fd4c-4865-80fb-a90012ea6323",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "It would be nice to check that the type of the result is `timestamp_ntz` but not `timestamp_ltz`.",
        "createdAt" : "2021-07-09T09:47:09Z",
        "updatedAt" : "2021-07-09T09:47:42Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "41fcfa3a-d771-4015-bb95-48b22e152488",
        "parentId" : "7f2d781a-fd4c-4865-80fb-a90012ea6323",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "`unix_timestamp` always return `LongType`. Can you explain it better?",
        "createdAt" : "2021-07-09T10:11:24Z",
        "updatedAt" : "2021-07-09T10:11:24Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      },
      {
        "id" : "6e4a2c65-bb11-4b58-8e3e-8535f98c6b46",
        "parentId" : "7f2d781a-fd4c-4865-80fb-a90012ea6323",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "sorry, my mistake.",
        "createdAt" : "2021-07-09T10:15:28Z",
        "updatedAt" : "2021-07-09T10:15:28Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "1761df9f685f19c68951389231753f9b5e7bcfdd",
    "line" : 20,
    "diffHunk" : "@@ -1,1 +603,607 @@        checkAnswer(df.select(unix_timestamp(col(\"ntzTs\"))), Seq(\n          Row(secs(DateTimeUtils.microsToMillis(DateTimeUtils.localDateTimeToMicros(ntzTs1)))),\n          Row(secs(DateTimeUtils.microsToMillis(DateTimeUtils.localDateTimeToMicros(ntzTs2))))))\n        checkAnswer(df.select(unix_timestamp(col(\"d\"), fmt)), Seq(\n          Row(secs(date1.getTime)), Row(secs(date2.getTime))))"
  },
  {
    "id" : "4068fcd4-87cd-4b9a-86ed-d076e10202a1",
    "prId" : 28650,
    "prUrl" : "https://github.com/apache/spark/pull/28650#pullrequestreview-426970294",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c638e761-1f35-4849-b4ab-26d798c8071a",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "can we check more in the error message?",
        "createdAt" : "2020-06-09T08:45:07Z",
        "updatedAt" : "2020-06-09T10:32:20Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "246a7c6b-b7e6-4ac4-81dd-8d5851bcf1a9",
        "parentId" : "c638e761-1f35-4849-b4ab-26d798c8071a",
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "Just pick the intersection of `Illegal pattern character 'b'` and  `Unknown pattern letter: b`",
        "createdAt" : "2020-06-09T09:42:26Z",
        "updatedAt" : "2020-06-09T10:32:20Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      }
    ],
    "commit" : "8139dfc1d064ab7b1b1d7be1af0c8f903d3e6b13",
    "line" : 8,
    "diffHunk" : "@@ -1,1 +692,696 @@        val invalid = df1.selectExpr(s\"to_unix_timestamp(x, 'yyyy-MM-dd bb:HH:ss')\")\n        val e = intercept[IllegalArgumentException](invalid.collect())\n        assert(e.getMessage.contains('b'))\n      }\n    }"
  },
  {
    "id" : "9b531ca8-66dc-4eb0-8ace-997037935537",
    "prId" : 27612,
    "prUrl" : "https://github.com/apache/spark/pull/27612#pullrequestreview-360059191",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ed93d86b-2466-41fa-94da-a3592625a378",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "~nit. If possible, can we have additional test statements for `minute` and `second` together below line 743 to make it sure?~\r\nNever mind. I missed the other PR which landed already on `branch-2.4`.",
        "createdAt" : "2020-02-18T04:00:38Z",
        "updatedAt" : "2020-02-18T05:50:26Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "4ed3a204482b8c7f5d5d6047de6613d77f89babe",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +743,747 @@    checkTrunc(\"MINUTE\", \"1961-04-12 00:01:00\")\n    checkTrunc(\"HOUR\", \"1961-04-12 00:00:00\")\n    checkTrunc(\"DAY\", \"1961-04-12 00:00:00\")\n  }\n}"
  },
  {
    "id" : "5edd1faf-f239-4368-acf0-2189a4a25bb5",
    "prId" : 27524,
    "prUrl" : "https://github.com/apache/spark/pull/27524#pullrequestreview-356521686",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "da7a2fad-6dc0-48e6-92e2-a98ae77c7976",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "I had to handle legacy mode especially due to behavior change of `to_timestamp`",
        "createdAt" : "2020-02-10T16:16:34Z",
        "updatedAt" : "2020-02-11T07:33:41Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "6601c3fc-6099-49a9-b347-ad139ce6998f",
        "parentId" : "da7a2fad-6dc0-48e6-92e2-a98ae77c7976",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Unfortunately, `SimpleDateFormat` doesn't work correctly with the pattern `.S`. In Spark 2.4, it wasn't visible in the test because `to_timestamp` truncated results to seconds. ",
        "createdAt" : "2020-02-10T16:18:22Z",
        "updatedAt" : "2020-02-11T07:33:41Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "bd7facc6-79a9-47a8-9ea1-4b6ef9cc35b7",
        "parentId" : "da7a2fad-6dc0-48e6-92e2-a98ae77c7976",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "@cloud-fan Only here, I have to modify the test to adopt it for the legacy parser.",
        "createdAt" : "2020-02-11T09:49:12Z",
        "updatedAt" : "2020-02-11T09:49:12Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "93f3ae1c32f893cc3cc22ae075753098440e76b5",
    "line" : 355,
    "diffHunk" : "@@ -1,1 +702,706 @@        checkAnswer(df.select(to_timestamp(col(\"ss\"))), Seq(\n          Row(ts1), Row(ts2)))\n        if (legacyParser) {\n          // In Spark 2.4 and earlier, to_timestamp() parses in seconds precision and cuts off\n          // the fractional part of seconds. The behavior was changed by SPARK-27438."
  },
  {
    "id" : "0556a893-2470-4f68-8d97-bc6720f3ee03",
    "prId" : 27441,
    "prUrl" : "https://github.com/apache/spark/pull/27441#pullrequestreview-352421597",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c47600c5-732a-4b24-a11d-29e6ceb4ab44",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Thank you for adding this test coverage.",
        "createdAt" : "2020-02-03T17:15:59Z",
        "updatedAt" : "2020-02-04T10:07:34Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "19a47c1cd08ce6e2e00e37abdc8fd6c4b4311b4e",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +791,795 @@  }\n\n  test(\"SPARK-30668: use legacy timestamp parser in to_timestamp\") {\n    def checkTimeZoneParsing(expected: Any): Unit = {\n      val df = Seq(\"2020-01-27T20:06:11.847-0800\").toDF(\"ts\")"
  },
  {
    "id" : "5cd481fb-6ffb-49a3-a69c-6425cd2679a1",
    "prId" : 27441,
    "prUrl" : "https://github.com/apache/spark/pull/27441#pullrequestreview-352453301",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2809005f-59ad-43fd-8021-711a02928982",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Shall we check `NULL` case together when `SQLConf.LEGACY_TIME_PARSER_ENABLED.key=false`? That will detect when we fix the regression issue in the default configuration (`SQLConf.LEGACY_TIME_PARSER_ENABLED.key=true`).",
        "createdAt" : "2020-02-03T17:18:45Z",
        "updatedAt" : "2020-02-04T10:07:34Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "c720d989-0907-49b6-9431-5ee10316fb06",
        "parentId" : "2809005f-59ad-43fd-8021-711a02928982",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "I will add the check",
        "createdAt" : "2020-02-03T18:07:26Z",
        "updatedAt" : "2020-02-04T10:07:34Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "19a47c1cd08ce6e2e00e37abdc8fd6c4b4311b4e",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +802,806 @@    withSQLConf(SQLConf.LEGACY_TIME_PARSER_ENABLED.key -> \"false\") {\n      checkTimeZoneParsing(null)\n    }\n  }\n}"
  },
  {
    "id" : "a988c49b-5182-4881-9fb5-5726536506b0",
    "prId" : 27441,
    "prUrl" : "https://github.com/apache/spark/pull/27441#pullrequestreview-354699620",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c589c85c-66cd-48a3-9ac2-938fc9bb3fd1",
        "parentId" : null,
        "authorId" : "d19fc546-1296-40ce-befb-9eca847aeceb",
        "body" : "fallback to the old parser?",
        "createdAt" : "2020-02-06T18:58:39Z",
        "updatedAt" : "2020-02-06T18:58:40Z",
        "lastEditedBy" : "d19fc546-1296-40ce-befb-9eca847aeceb",
        "tags" : [
        ]
      },
      {
        "id" : "76fd6282-4de4-4705-bd09-30e7d85cd4db",
        "parentId" : "c589c85c-66cd-48a3-9ac2-938fc9bb3fd1",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Silent fallback to old parser can lead to mixed values in the same column - some in combined calendar Julian+Gregorian another in Proleptic Gregorian calendar. ",
        "createdAt" : "2020-02-06T19:06:25Z",
        "updatedAt" : "2020-02-06T19:06:25Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "3c621b5d-113a-4bfd-b5a2-2ad254e08f78",
        "parentId" : "c589c85c-66cd-48a3-9ac2-938fc9bb3fd1",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Strings parsed in different calendars may have difference of dozen days.",
        "createdAt" : "2020-02-06T19:08:13Z",
        "updatedAt" : "2020-02-06T19:08:13Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "19a47c1cd08ce6e2e00e37abdc8fd6c4b4311b4e",
    "line" : 15,
    "diffHunk" : "@@ -1,1 +801,805 @@    }\n    withSQLConf(SQLConf.LEGACY_TIME_PARSER_ENABLED.key -> \"false\") {\n      checkTimeZoneParsing(null)\n    }\n  }"
  }
]