[
  {
    "id" : "0143f9a6-3188-4b0d-a86b-c532697d0a9f",
    "prId" : 29667,
    "prUrl" : "https://github.com/apache/spark/pull/29667#pullrequestreview-483770724",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "bd74c0f0-1d9c-48dd-bd52-a077b1d35b38",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "I would just use `withTempPath`",
        "createdAt" : "2020-09-08T03:07:48Z",
        "updatedAt" : "2020-09-08T21:58:19Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "13214228-6558-41c3-8c98-597d9c121f68",
        "parentId" : "bd74c0f0-1d9c-48dd-bd52-a077b1d35b38",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "SparkFunSuite has only withTempDir. I think it's not worth adding withTempPath here, so leave as is.",
        "createdAt" : "2020-09-08T03:20:16Z",
        "updatedAt" : "2020-09-08T21:58:19Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "568176dd0118f2e1793f9bd0258953bc8c574a4b",
    "line" : 30,
    "diffHunk" : "@@ -1,1 +133,137 @@    SparkSession.cleanupAnyExistingSession()\n\n    withTempDir { tempDir =>\n      try {\n        val tablePath = tempDir.toString + \"/table\""
  },
  {
    "id" : "276e26f7-6d1c-49ae-9f9a-118d794e4b06",
    "prId" : 29667,
    "prUrl" : "https://github.com/apache/spark/pull/29667#pullrequestreview-483767777",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8ca7803d-bc26-4f25-846f-aebaeaf789c9",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Shall we stop the `session`?",
        "createdAt" : "2020-09-08T03:14:08Z",
        "updatedAt" : "2020-09-08T21:58:19Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "568176dd0118f2e1793f9bd0258953bc8c574a4b",
    "line" : 49,
    "diffHunk" : "@@ -1,1 +152,156 @@        }(ExecutionContext.fromExecutorService(executor2)), 1.minute)\n      } finally {\n        executor1.shutdown()\n        executor2.shutdown()\n        session.stop()"
  },
  {
    "id" : "52eeb783-1573-4b2a-85cf-6b154f84fcff",
    "prId" : 29667,
    "prUrl" : "https://github.com/apache/spark/pull/29667#pullrequestreview-483771577",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3d55902c-3c12-4dff-906c-d6b49019625c",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Should we necessarily write and read it back?",
        "createdAt" : "2020-09-08T03:17:46Z",
        "updatedAt" : "2020-09-08T21:58:19Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "e0f665e8-98f4-4b4b-9fe6-9897d6269e88",
        "parentId" : "3d55902c-3c12-4dff-906c-d6b49019625c",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "read is used to trigger scan. ",
        "createdAt" : "2020-09-08T03:22:46Z",
        "updatedAt" : "2020-09-08T21:58:19Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "a852fe78-5312-4ff5-a8a1-e73ae8eb820c",
        "parentId" : "3d55902c-3c12-4dff-906c-d6b49019625c",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Ah, I misread. Sure.",
        "createdAt" : "2020-09-08T03:23:58Z",
        "updatedAt" : "2020-09-08T21:58:19Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "568176dd0118f2e1793f9bd0258953bc8c574a4b",
    "line" : 42,
    "diffHunk" : "@@ -1,1 +145,149 @@            .write.parquet(tablePath)\n\n          session.read.parquet(tablePath)\n        }(ExecutionContext.fromExecutorService(executor1)), 1.minute)\n"
  },
  {
    "id" : "7ffd8394-4f74-4657-9b3b-d630c2bc6494",
    "prId" : 29667,
    "prUrl" : "https://github.com/apache/spark/pull/29667#pullrequestreview-483790679",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "fce2625e-cba6-4eba-ac50-692f6a32caf3",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "nit: why don't we use `tempDir` directly?",
        "createdAt" : "2020-09-08T03:29:12Z",
        "updatedAt" : "2020-09-08T21:58:19Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "4ac08976-c2c6-428b-b942-a5647af74555",
        "parentId" : "fce2625e-cba6-4eba-ac50-692f6a32caf3",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "will complain ... dir was already existing.",
        "createdAt" : "2020-09-08T03:38:07Z",
        "updatedAt" : "2020-09-08T21:58:19Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "135213ff-5fc0-411a-8762-df40bd4e16ac",
        "parentId" : "fce2625e-cba6-4eba-ac50-692f6a32caf3",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "oh, can we try `withTempPath`?",
        "createdAt" : "2020-09-08T04:39:25Z",
        "updatedAt" : "2020-09-08T21:58:19Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "84ffdae1-0ec1-4906-be61-0bd428fee620",
        "parentId" : "fce2625e-cba6-4eba-ac50-692f6a32caf3",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "https://github.com/apache/spark/pull/29667#discussion_r484625824 :-)",
        "createdAt" : "2020-09-08T04:42:41Z",
        "updatedAt" : "2020-09-08T21:58:19Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "568176dd0118f2e1793f9bd0258953bc8c574a4b",
    "line" : 32,
    "diffHunk" : "@@ -1,1 +135,139 @@    withTempDir { tempDir =>\n      try {\n        val tablePath = tempDir.toString + \"/table\"\n        val df = ThreadUtils.awaitResult(Future {\n          session = SparkSession.builder().appName(\"test\").master(\"local[*]\").getOrCreate()"
  }
]