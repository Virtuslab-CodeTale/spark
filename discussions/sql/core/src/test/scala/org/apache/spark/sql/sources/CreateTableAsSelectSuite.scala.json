[
  {
    "id" : "a88427c8-1cad-4b15-ba8b-cfed0ba9346e",
    "prId" : 32411,
    "prUrl" : "https://github.com/apache/spark/pull/32411#pullrequestreview-662978118",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a62bdec1-4549-4c42-8808-889ac9cac6ba",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "is this change necessary? it `beforeEach` we create a new temp dir and assign it to `path`.",
        "createdAt" : "2021-05-17T15:31:05Z",
        "updatedAt" : "2021-05-17T15:31:06Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "93639f24-2999-412b-9049-cd739eeb2ad1",
        "parentId" : "a62bdec1-4549-4c42-8808-889ac9cac6ba",
        "authorId" : "ef5dbbaf-a5b0-4413-b0ce-b9c0fe76b859",
        "body" : "Yes, in this test case, the function  `createTableSql ` will be called twice inside `Seq(100001, maxNrBuckets).foreach(...)`. As this PR doesn't allow CTAS with a non-empty location, the second call of  `createTableSql` will fail if the same `path` used. That is why for each iteration a new table location is created",
        "createdAt" : "2021-05-19T09:37:56Z",
        "updatedAt" : "2021-05-19T09:37:56Z",
        "lastEditedBy" : "ef5dbbaf-a5b0-4413-b0ce-b9c0fe76b859",
        "tags" : [
        ]
      }
    ],
    "commit" : "bafe546ae09a9a0c0e118aef3d4e7f05b30c8ed3",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +239,243 @@      s\"\"\"\n         |CREATE TABLE t USING PARQUET\n         |OPTIONS (PATH '$tablePath')\n         |CLUSTERED BY (a) SORTED BY (b) INTO $numBuckets BUCKETS\n         |AS SELECT 1 AS a, 2 AS b"
  }
]