[
  {
    "id" : "ddf9dd1d-5f09-4f23-af19-c31aee9359d6",
    "prId" : 25507,
    "prUrl" : "https://github.com/apache/spark/pull/25507#pullrequestreview-279674231",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "93794f31-5246-4e16-bb0b-71a3a2b0b6e9",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "shouldn't we use `DataFrameWriter.insertInto` here? Otherwise we only test the SQL test cases.",
        "createdAt" : "2019-08-26T13:38:48Z",
        "updatedAt" : "2019-08-26T18:57:39Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "7a487cdf-1314-4735-9b16-c757620004c9",
        "parentId" : "93794f31-5246-4e16-bb0b-71a3a2b0b6e9",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "ok seems we do want to run SQL test cases only here. Shouldn't we extend `InsertIntoSQLTests` instead of `InsertIntoTests`?",
        "createdAt" : "2019-08-26T13:41:06Z",
        "updatedAt" : "2019-08-26T18:57:39Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "a913f22e-60a7-4cf9-bba4-ba9d19ec2be6",
        "parentId" : "93794f31-5246-4e16-bb0b-71a3a2b0b6e9",
        "authorId" : "471c3dfe-259c-447a-9abd-f7fdecccd9a7",
        "body" : "InsertIntoTests contain both SQL as well as non-sql tests. The tests in InsertIntoSQLTests are purely SQL, because they test various versions of static and dynamic partition overwrites.",
        "createdAt" : "2019-08-26T15:50:08Z",
        "updatedAt" : "2019-08-26T18:57:39Z",
        "lastEditedBy" : "471c3dfe-259c-447a-9abd-f7fdecccd9a7",
        "tags" : [
        ]
      }
    ],
    "commit" : "f1d86fffdafaac99a040ecd718f9e16aa49d164c",
    "line" : 32,
    "diffHunk" : "@@ -1,1 +86,90 @@      insert.createOrReplaceTempView(tmpView)\n      val overwrite = if (mode == SaveMode.Overwrite) \"OVERWRITE\" else \"INTO\"\n      sql(s\"INSERT $overwrite TABLE $tableName SELECT * FROM $tmpView\")\n    }\n  }"
  },
  {
    "id" : "0792dd56-c17b-4725-a133-c57b5bd2f8d1",
    "prId" : 25348,
    "prUrl" : "https://github.com/apache/spark/pull/25348#pullrequestreview-277449035",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d72d9b4f-3f1f-4d0a-82f8-dd4380b2ee26",
        "parentId" : null,
        "authorId" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "body" : "Can you also add tests that use the session catalog? This should work with both SQL and other paths like `saveAsTable`.",
        "createdAt" : "2019-08-20T00:00:22Z",
        "updatedAt" : "2019-08-21T00:55:24Z",
        "lastEditedBy" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "tags" : [
        ]
      },
      {
        "id" : "790cca82-e83b-4e89-a87c-844bf0a4c051",
        "parentId" : "d72d9b4f-3f1f-4d0a-82f8-dd4380b2ee26",
        "authorId" : "471c3dfe-259c-447a-9abd-f7fdecccd9a7",
        "body" : "Done",
        "createdAt" : "2019-08-20T21:24:01Z",
        "updatedAt" : "2019-08-21T00:55:24Z",
        "lastEditedBy" : "471c3dfe-259c-447a-9abd-f7fdecccd9a7",
        "tags" : [
        ]
      }
    ],
    "commit" : "27598ce9b5ef7bc8224e37df6f14907e766ddd54",
    "line" : 52,
    "diffHunk" : "@@ -1,1 +50,54 @@  }\n\n  test(\"append fallback\") {\n    val df = Seq((1, \"x\"), (2, \"y\"), (3, \"z\")).toDF(\"a\", \"b\")\n    df.write.mode(\"append\").option(\"name\", \"t1\").format(v2Format).save()"
  }
]