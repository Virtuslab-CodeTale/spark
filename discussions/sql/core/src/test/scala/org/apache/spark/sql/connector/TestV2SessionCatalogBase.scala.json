[
  {
    "id" : "fb171117-f3bd-4d43-9680-7e7c0c62a2f7",
    "prId" : 30079,
    "prUrl" : "https://github.com/apache/spark/pull/30079#pullrequestreview-515817518",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3ee3232b-fc9c-401f-8bb3-ac6199bc27f2",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Why doesn't `!tables.isEmpty` work?",
        "createdAt" : "2020-10-23T05:00:08Z",
        "updatedAt" : "2020-10-27T21:04:52Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "0a47972d-9963-44ad-8ddb-b2f7e2ea72a2",
        "parentId" : "3ee3232b-fc9c-401f-8bb3-ac6199bc27f2",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "We have tests like the following:\r\n```scala\r\n  test(\"saveAsTable: Append mode should not fail if the table already exists \" +\r\n    \"and a same-name temp view exist\") {\r\n    withTable(\"same_name\") {\r\n      withTempView(\"same_name\") {\r\n```\r\nBefore, the table was not cleaned up correctly, so `!tables.isEmpty` was fine. But now that tables are cleaned up with this PR, we need a different way to check if this code path was executed.",
        "createdAt" : "2020-10-23T16:17:10Z",
        "updatedAt" : "2020-10-27T21:04:52Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "dfc44923d10fa7cbb5cd6cde4dfcffa19a9e994d",
    "line" : 46,
    "diffHunk" : "@@ -1,1 +84,88 @@  def clearTables(): Unit = {\n    assert(\n      tableCreated.get,\n      \"Tables are not created, maybe didn't use the session catalog code path?\")\n    tables.keySet().asScala.foreach(super.dropTable)"
  },
  {
    "id" : "70b6c595-f78e-4610-b58b-bbb1082736d6",
    "prId" : 30079,
    "prUrl" : "https://github.com/apache/spark/pull/30079#pullrequestreview-515329555",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c0b54be0-28f3-48eb-b3c8-32b9cdf6c6c6",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Why doesn't `!tables.isEmpty` work?",
        "createdAt" : "2020-10-23T05:00:12Z",
        "updatedAt" : "2020-10-27T21:04:52Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "dfc44923d10fa7cbb5cd6cde4dfcffa19a9e994d",
    "line" : 46,
    "diffHunk" : "@@ -1,1 +84,88 @@  def clearTables(): Unit = {\n    assert(\n      tableCreated.get,\n      \"Tables are not created, maybe didn't use the session catalog code path?\")\n    tables.keySet().asScala.foreach(super.dropTable)"
  },
  {
    "id" : "1222bf51-9c18-4ac4-b689-7ce2423a7fed",
    "prId" : 29811,
    "prUrl" : "https://github.com/apache/spark/pull/29811#pullrequestreview-492161148",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9954276c-b476-45cd-b035-ae8eb3f259b7",
        "parentId" : null,
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "Now that the test runs, it actually fails because this block remove `V1Table` info, which is needed in the following:\r\nhttps://github.com/apache/spark/blob/f1dc479d39a6f05df7155008d8ec26dff42bb06c/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/analysis/Analyzer.scala#L1008",
        "createdAt" : "2020-09-19T23:17:01Z",
        "updatedAt" : "2020-09-21T20:25:19Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "3f08d037b242f0ee77d191f646c372394b13f884",
    "line" : 25,
    "diffHunk" : "@@ -1,1 +54,58 @@          tables.put(ident, table)\n          table\n      }\n    }\n  }"
  },
  {
    "id" : "31950a36-feb7-4e57-95be-520261f14280",
    "prId" : 29811,
    "prUrl" : "https://github.com/apache/spark/pull/29811#pullrequestreview-493809193",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0fd56670-0064-40da-b5e9-9ded8b81ac42",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "@imback82 . This is orthogonal to `Fix an invalid test in DataSourceV2SQLSuite`. Could you make a PR for this one independently?",
        "createdAt" : "2020-09-22T03:29:27Z",
        "updatedAt" : "2020-09-22T03:29:27Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "1ec4b327-b439-430f-8362-bbb013eab1db",
        "parentId" : "0fd56670-0064-40da-b5e9-9ded8b81ac42",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "or we should at least mention it in the PR description, to explain why it's needed to fix the test.",
        "createdAt" : "2020-09-22T08:14:18Z",
        "updatedAt" : "2020-09-22T08:14:19Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "6ab1df00-1566-4a2d-8569-86aeae024f51",
        "parentId" : "0fd56670-0064-40da-b5e9-9ded8b81ac42",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "Updated the PR description.",
        "createdAt" : "2020-09-22T20:11:18Z",
        "updatedAt" : "2020-09-22T20:11:18Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "3f08d037b242f0ee77d191f646c372394b13f884",
    "line" : 20,
    "diffHunk" : "@@ -1,1 +49,53 @@      // Table was created through the built-in catalog\n      super.loadTable(ident) match {\n        case v1Table: V1Table if v1Table.v1Table.tableType == CatalogTableType.VIEW => v1Table\n        case t =>\n          val table = newTable(t.name(), t.schema(), t.partitioning(), t.properties())"
  }
]