[
  {
    "id" : "eb2e1af0-99fb-41a1-b0f8-a88f1aff585f",
    "prId" : 32067,
    "prUrl" : "https://github.com/apache/spark/pull/32067#pullrequestreview-629470987",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "92340b2f-23e7-4306-97e9-67c920a01807",
        "parentId" : null,
        "authorId" : "9cd657f0-37cd-41bd-908a-f2c996b95a7a",
        "body" : "this is a test for the resolution bug mentioned earlier.",
        "createdAt" : "2021-04-06T22:57:39Z",
        "updatedAt" : "2021-04-07T14:06:10Z",
        "lastEditedBy" : "9cd657f0-37cd-41bd-908a-f2c996b95a7a",
        "tags" : [
        ]
      }
    ],
    "commit" : "65fd370fc1f80212915fae84b36b984400f58336",
    "line" : 30,
    "diffHunk" : "@@ -1,1 +1311,1315 @@        }\n\n        // merge with star should get resolved into specific actions even if there\n        // is no other unresolved expression in the merge\n        parseAndResolve(s\"\"\""
  },
  {
    "id" : "4d31f727-81df-4d6b-b181-cbd092946066",
    "prId" : 30574,
    "prUrl" : "https://github.com/apache/spark/pull/30574#pullrequestreview-543821608",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2318a9b9-ad15-4ed7-964d-4e6b50f67862",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Is this relevant to this Analyzer change?",
        "createdAt" : "2020-12-02T21:11:10Z",
        "updatedAt" : "2020-12-02T21:11:11Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "dff5037c-ae4a-4634-9241-67a08b98d998",
        "parentId" : "2318a9b9-ad15-4ed7-964d-4e6b50f67862",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "yes, otherwise some tests fail because they insert into the table and need to check the table partition columns.",
        "createdAt" : "2020-12-03T10:39:40Z",
        "updatedAt" : "2020-12-03T10:39:40Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "cff33a924e275f06933af763d4d4245359cf8b85",
    "line" : 23,
    "diffHunk" : "@@ -1,1 +52,56 @@    val t = mock(classOf[Table])\n    when(t.schema()).thenReturn(new StructType().add(\"i\", \"int\").add(\"s\", \"string\"))\n    when(t.partitioning()).thenReturn(Array.empty[Transform])\n    t\n  }"
  },
  {
    "id" : "34c4dbdd-1070-475b-b54e-7b5eeaef2a7e",
    "prId" : 30574,
    "prUrl" : "https://github.com/apache/spark/pull/30574#pullrequestreview-543822189",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a4079ab4-03f8-41b0-b6e8-458d76c3beb8",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "ditto. Is this relevant to this Analyzer change?",
        "createdAt" : "2020-12-02T21:11:48Z",
        "updatedAt" : "2020-12-02T21:11:48Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "debe1720-3ba0-4b73-83a4-0b7e066b9268",
        "parentId" : "a4079ab4-03f8-41b0-b6e8-458d76c3beb8",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "yes, otherwise some tests fail because the input query has a different number of columns compared to the table schema.",
        "createdAt" : "2020-12-03T10:40:25Z",
        "updatedAt" : "2020-12-03T10:40:25Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "cff33a924e275f06933af763d4d4245359cf8b85",
    "line" : 64,
    "diffHunk" : "@@ -1,1 +1152,1156 @@      (\"INSERT INTO TABLE tab VALUES (1, 'a')\", false),\n      (\"INSERT INTO TABLE testcat.tab VALUES (1, 'a')\", false),\n      (s\"INSERT INTO TABLE $v2SessionCatalogTable VALUES (1, 'a')\", true),\n      (\"DESC TABLE tab\", false),\n      (\"DESC TABLE testcat.tab\", false),"
  },
  {
    "id" : "2c3a128f-02bb-46b6-befd-54de36fc274c",
    "prId" : 30079,
    "prUrl" : "https://github.com/apache/spark/pull/30079#pullrequestreview-515978837",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0e11fee2-dd0f-4ad1-8c9e-f06f2a7f500d",
        "parentId" : null,
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "We need to use an existing table now that table resolution is happening during analysis.",
        "createdAt" : "2020-10-23T20:06:43Z",
        "updatedAt" : "2020-10-27T21:04:52Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "dfc44923d10fa7cbb5cd6cde4dfcffa19a9e994d",
    "line" : 8,
    "diffHunk" : "@@ -1,1 +631,635 @@\n  test(\"drop table\") {\n    val tableName1 = \"db.v1Table\"\n    val tableIdent1 = TableIdentifier(\"v1Table\", Option(\"db\"))\n    val tableName2 = \"v1Table\""
  },
  {
    "id" : "28fb69c2-30d1-493a-9cd6-f65c8137186e",
    "prId" : 27718,
    "prUrl" : "https://github.com/apache/spark/pull/27718#pullrequestreview-366834690",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "67a701e1-7168-4cfa-a46a-374dd1a30523",
        "parentId" : null,
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "This needs to be updated since the current catalog is a session catalog.",
        "createdAt" : "2020-03-01T04:34:52Z",
        "updatedAt" : "2020-03-03T18:01:27Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "4add7b2424be83cb9dce5320e8d0502ab3d36b40",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +129,133 @@    })\n    when(manager.currentCatalog).thenReturn(v2SessionCatalog)\n    when(manager.currentNamespace).thenReturn(Array(\"default\"))\n    when(manager.v1SessionCatalog).thenReturn(v1SessionCatalog)\n    manager"
  },
  {
    "id" : "d1e11dca-7836-4283-8152-28f4aaf9afd8",
    "prId" : 27265,
    "prUrl" : "https://github.com/apache/spark/pull/27265#pullrequestreview-345124769",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d9d57660-1643-4393-94bd-4fe2a2822528",
        "parentId" : null,
        "authorId" : "9cd657f0-37cd-41bd-908a-f2c996b95a7a",
        "body" : "nit: Should these be in the same order as they are in the actual analyzer? If so, how do we make sure that we dont break this constraint? At the very least this should be commented as it is critical for the tests to run correctly .. isnt it?\r\n\r\nThis is probably not relevant for this PR, but I am curious.... instead of pulling out a few rules from the analyzer, why are we not using the Analyzer directly (with all the rules) to parse and resolve?",
        "createdAt" : "2020-01-17T21:43:00Z",
        "updatedAt" : "2020-01-22T07:14:05Z",
        "lastEditedBy" : "9cd657f0-37cd-41bd-908a-f2c996b95a7a",
        "tags" : [
        ]
      },
      {
        "id" : "3dd806af-4621-4592-9d62-73da3e668c7d",
        "parentId" : "d9d57660-1643-4393-94bd-4fe2a2822528",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "I tried to use the analyzer then a lof of tests failed. I've added a TODO to fix it.",
        "createdAt" : "2020-01-20T07:52:49Z",
        "updatedAt" : "2020-01-22T07:14:05Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "952b8b08419a9dafe2a19ab13ea97c292464995c",
    "line" : 41,
    "diffHunk" : "@@ -1,1 +137,141 @@      new ResolveSessionCatalog(catalogManager, conf, _ == Seq(\"v\")),\n      analyzer.ResolveTables,\n      analyzer.ResolveReferences,\n      analyzer.ResolveSubqueryColumnAliases,\n      analyzer.ResolveReferences)"
  },
  {
    "id" : "1c2a5a67-7c52-4609-9f00-e2dab5c0b51d",
    "prId" : 27265,
    "prUrl" : "https://github.com/apache/spark/pull/27265#pullrequestreview-346380884",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2a3ee8ca-d73b-4929-aece-b2f22fb939e8",
        "parentId" : null,
        "authorId" : "9cd657f0-37cd-41bd-908a-f2c996b95a7a",
        "body" : "super nit: I suggest making these tests a bit more robust by not depending on the order of columns. Changes in the resolving of the star can easily change the order of columns and expressions, and will unnecessarily fail the tests.",
        "createdAt" : "2020-01-21T22:27:40Z",
        "updatedAt" : "2020-01-22T07:14:05Z",
        "lastEditedBy" : "9cd657f0-37cd-41bd-908a-f2c996b95a7a",
        "tags" : [
        ]
      },
      {
        "id" : "2d51158f-c7ea-4488-8c4e-1dc9d37499b0",
        "parentId" : "2a3ee8ca-d73b-4929-aece-b2f22fb939e8",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "on the other hand, this test also verifies the column order after resolving the star. Maybe good to keep it?",
        "createdAt" : "2020-01-22T07:12:46Z",
        "updatedAt" : "2020-01-22T07:14:05Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "952b8b08419a9dafe2a19ab13ea97c292464995c",
    "line" : 78,
    "diffHunk" : "@@ -1,1 +1088,1092 @@      if (starInUpdate) {\n        assert(updateAssigns.size == 2)\n        assert(updateAssigns(0).key.asInstanceOf[AttributeReference].sameRef(ti))\n        assert(updateAssigns(0).value.asInstanceOf[AttributeReference].sameRef(si))\n        assert(updateAssigns(1).key.asInstanceOf[AttributeReference].sameRef(ts))"
  },
  {
    "id" : "25234819-dc40-493a-87eb-e5661b5823ff",
    "prId" : 27265,
    "prUrl" : "https://github.com/apache/spark/pull/27265#pullrequestreview-346236141",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3de38042-bab9-47a9-834a-306549e393e2",
        "parentId" : null,
        "authorId" : "9cd657f0-37cd-41bd-908a-f2c996b95a7a",
        "body" : "same comment about column order as above.",
        "createdAt" : "2020-01-21T22:27:52Z",
        "updatedAt" : "2020-01-22T07:14:05Z",
        "lastEditedBy" : "9cd657f0-37cd-41bd-908a-f2c996b95a7a",
        "tags" : [
        ]
      }
    ],
    "commit" : "952b8b08419a9dafe2a19ab13ea97c292464995c",
    "line" : 88,
    "diffHunk" : "@@ -1,1 +1098,1102 @@      }\n      assert(insertAssigns.size == 2)\n      assert(insertAssigns(0).key.asInstanceOf[AttributeReference].sameRef(ti))\n      assert(insertAssigns(0).value.asInstanceOf[AttributeReference].sameRef(si))\n      assert(insertAssigns(1).key.asInstanceOf[AttributeReference].sameRef(ts))"
  },
  {
    "id" : "0792a945-ad05-45cc-aa28-2082984f3b07",
    "prId" : 27265,
    "prUrl" : "https://github.com/apache/spark/pull/27265#pullrequestreview-346240042",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ac0a48a0-cbf1-498e-a0cf-e35b185d4d1b",
        "parentId" : null,
        "authorId" : "9cd657f0-37cd-41bd-908a-f2c996b95a7a",
        "body" : "why cant you still use the `checkResolution` function here. ",
        "createdAt" : "2020-01-21T22:34:18Z",
        "updatedAt" : "2020-01-22T07:14:05Z",
        "lastEditedBy" : "9cd657f0-37cd-41bd-908a-f2c996b95a7a",
        "tags" : [
        ]
      },
      {
        "id" : "831f0f28-3c34-41a9-b1b1-32708ac0815e",
        "parentId" : "ac0a48a0-cbf1-498e-a0cf-e35b185d4d1b",
        "authorId" : "9cd657f0-37cd-41bd-908a-f2c996b95a7a",
        "body" : "nvm. I see the significant differences.",
        "createdAt" : "2020-01-21T22:35:58Z",
        "updatedAt" : "2020-01-22T07:14:05Z",
        "lastEditedBy" : "9cd657f0-37cd-41bd-908a-f2c996b95a7a",
        "tags" : [
        ]
      }
    ],
    "commit" : "952b8b08419a9dafe2a19ab13ea97c292464995c",
    "line" : 415,
    "diffHunk" : "@@ -1,1 +1274,1278 @@          assert(il.sameRef(ss))\n          assert(updateAssigns.size == 1)\n          // UPDATE key is resolved with target table only, so column `s` is not ambiguous.\n          assert(updateAssigns.head.key.asInstanceOf[AttributeReference].sameRef(ts))\n          assert(insertAssigns.size == 1)"
  }
]