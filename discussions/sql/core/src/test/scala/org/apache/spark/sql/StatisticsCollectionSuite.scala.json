[
  {
    "id" : "bc69f33b-5a0b-4099-b34e-a2205f4af5d1",
    "prId" : 24725,
    "prUrl" : "https://github.com/apache/spark/pull/24725#pullrequestreview-242593270",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b4e78184-27c6-4eab-9412-032125703c41",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "nits:\r\n\r\n```diff\r\n@@ -619,7 +619,7 @@ class StatisticsCollectionSuite extends StatisticsCollectionTestBase with Shared\r\n     withTempDir { tempDir =>\r\n       val tableName = \"t1\"\r\n       val stagingDirName = \".test-staging-dir\"\r\n-      val tableLocation = s\"${tempDir.getCanonicalPath}/$tableName\"\r\n+      val tableLocation = s\"${tempDir.toURI}/$tableName\"\r\n       withSQLConf(\r\n         SQLConf.AUTO_SIZE_UPDATE_ENABLED.key -> \"true\",\r\n         \"hive.exec.stagingdir\" -> stagingDirName) {\r\n@@ -627,21 +627,22 @@ class StatisticsCollectionSuite extends StatisticsCollectionTestBase with Shared\r\n           sql(s\"CREATE TABLE $tableName(c1 BIGINT) USING PARQUET LOCATION '$tableLocation'\")\r\n           sql(s\"INSERT INTO TABLE $tableName VALUES(1)\")\r\n\r\n-          val staging = new File(s\"$tableLocation/$stagingDirName\")\r\n-          val stagingWriter = new PrintWriter(staging)\r\n-          stagingWriter.write(\"12\")\r\n-          stagingWriter.close()\r\n+          val staging = new File(new URI(s\"$tableLocation/$stagingDirName\"))\r\n+          Utils.tryWithResource(new PrintWriter(staging)) { stagingWriter =>\r\n+            stagingWriter.write(\"12\")\r\n+          }\r\n+\r\n+          val metadata = new File(new URI(s\"$tableLocation/_metadata\"))\r\n\r\n-          val metadata = new File(s\"$tableLocation/_metadata\")\r\n-          val metadataWriter = new PrintWriter(metadata)\r\n-          metadataWriter.write(\"1234\")\r\n-          metadataWriter.close()\r\n+          Utils.tryWithResource(new PrintWriter(staging)) { metadataWriter =>\r\n+            metadataWriter.write(\"1234\")\r\n+          }\r\n\r\n           sql(s\"INSERT INTO TABLE $tableName VALUES(1)\")\r\n\r\n           val stagingFileSize = staging.length()\r\n           val metadataFileSize = metadata.length()\r\n-          val tableLocationSize = getDataSize(new File(tableLocation))\r\n+          val tableLocationSize = getDataSize(new File(new URI(tableLocation)))\r\n\r\n           val stats = checkTableStats(tableName, hasSizeInBytes = true, expectedRowCounts = None)\r\n           assert(stats.get.sizeInBytes === tableLocationSize - stagingFileSize - metadataFileSize)\r\n```\r\n\r\nUsing URI makes the test working on Windows too. If the test isn't specific to paths, it's better to stick to using URI.",
        "createdAt" : "2019-05-28T10:25:55Z",
        "updatedAt" : "2019-05-28T11:24:00Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "0d6905f4-7ec9-4dda-b969-893de450ad7c",
        "parentId" : "b4e78184-27c6-4eab-9412-032125703c41",
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "OK. Thank you @HyukjinKwon",
        "createdAt" : "2019-05-28T10:59:17Z",
        "updatedAt" : "2019-05-28T11:24:00Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      }
    ],
    "commit" : "fb44905b6eff346919965065bc39da35fa247ef7",
    "line" : 15,
    "diffHunk" : "@@ -1,1 +617,621 @@  }\n\n  test(\"Metadata files and temporary files should not be counted as data files\") {\n    withTempDir { tempDir =>\n      val tableName = \"t1\""
  }
]