[
  {
    "id" : "59115b34-5d86-4747-a4ab-1d04238ba1cd",
    "prId" : 33343,
    "prUrl" : "https://github.com/apache/spark/pull/33343#pullrequestreview-706913332",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "347a7258-a5b4-48b1-9915-561b0f42a166",
        "parentId" : null,
        "authorId" : "3a227965-84e0-47cf-9974-11293764f028",
        "body" : "The modified test fails with both Scala `2.12` and `2.13` without the change in `ShowCreateTableExec.scala`.",
        "createdAt" : "2021-07-15T04:28:37Z",
        "updatedAt" : "2021-07-15T04:28:37Z",
        "lastEditedBy" : "3a227965-84e0-47cf-9974-11293764f028",
        "tags" : [
        ]
      }
    ],
    "commit" : "4d6d401a0ab101a0262c48105726a169393d68dc",
    "line" : 28,
    "diffHunk" : "@@ -1,1 +2015,2019 @@        \"'prop2' = '2',\",\n        \"'prop3' = '3',\",\n        \"'prop4' = '4')\"\n      ))\n    }"
  },
  {
    "id" : "318b4404-9887-4c7b-9fd3-c3b3fb3511e9",
    "prId" : 32931,
    "prUrl" : "https://github.com/apache/spark/pull/32931#pullrequestreview-692662262",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "97e82b67-b589-487b-b3d8-e31648e282e0",
        "parentId" : null,
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "shall these attributes be quoted too?",
        "createdAt" : "2021-06-23T09:51:57Z",
        "updatedAt" : "2021-06-23T09:51:57Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      },
      {
        "id" : "905fe519-27c8-4cd1-8233-5ee4cefe16a5",
        "parentId" : "97e82b67-b589-487b-b3d8-e31648e282e0",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "I think we should not quote the column names in other places instead, if there is no special char.",
        "createdAt" : "2021-06-23T09:57:53Z",
        "updatedAt" : "2021-06-23T09:57:53Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "c9275104-dbff-48f5-9d2a-7458ecf572b3",
        "parentId" : "97e82b67-b589-487b-b3d8-e31648e282e0",
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "> I think we should not quote the column names in other places instead, if there is no special char.\r\n\r\n+1",
        "createdAt" : "2021-06-23T09:59:26Z",
        "updatedAt" : "2021-06-23T09:59:26Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      },
      {
        "id" : "0652305d-dc1a-4f2b-9681-52356255ac45",
        "parentId" : "97e82b67-b589-487b-b3d8-e31648e282e0",
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "@Peng-Lei can you address this?\r\n\r\n> I think we should not quote the column names in other places instead, if there is no special char.\r\n\r\n",
        "createdAt" : "2021-06-25T10:01:15Z",
        "updatedAt" : "2021-06-25T10:01:15Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      }
    ],
    "commit" : "b8e6db8840b5de34213179ea54e02db287d6427f",
    "line" : 100,
    "diffHunk" : "@@ -1,1 +2055,2059 @@        \"`ts` TIMESTAMP)\",\n        \"USING foo\",\n        \"PARTITIONED BY (a, bucket(16, b), years(ts), months(ts), days(ts), hours(ts))\"\n      ))\n    }"
  },
  {
    "id" : "cc50b3c8-bdfa-4567-a8ae-72da0a6afc53",
    "prId" : 31654,
    "prUrl" : "https://github.com/apache/spark/pull/31654#pullrequestreview-601092928",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2086c97b-fa17-4e4d-baee-77e963bf7fab",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "I'm a bit confused. We have a test `SPARK-31255: Projects data column when metadata column has the same name` in this file, which tests when column name and metadata column name have conflicts. Why does that test work?",
        "createdAt" : "2021-03-01T05:31:28Z",
        "updatedAt" : "2021-03-01T19:53:18Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "3924d5a0-0505-4708-af6d-f3ad4167b645",
        "parentId" : "2086c97b-fa17-4e4d-baee-77e963bf7fab",
        "authorId" : "ada71464-b8c9-4d7b-9020-d49c27251fdb",
        "body" : "This is covered at the [level](https://github.com/apache/spark/blob/62737e140c7b04805726a33c392c297335db7b45/sql/catalyst/src/main/scala/org/apache/spark/sql/execution/datasources/v2/DataSourceV2Relation.scala#L59) of the DatasourceV2Relation, but does not apply above it.",
        "createdAt" : "2021-03-01T05:35:19Z",
        "updatedAt" : "2021-03-01T19:53:18Z",
        "lastEditedBy" : "ada71464-b8c9-4d7b-9020-d49c27251fdb",
        "tags" : [
        ]
      },
      {
        "id" : "76091593-32e1-4369-a5f5-6f52e8e642b0",
        "parentId" : "2086c97b-fa17-4e4d-baee-77e963bf7fab",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Ah I see! Can we remove the hack in `DatasourceV2Relation` now?",
        "createdAt" : "2021-03-01T05:54:42Z",
        "updatedAt" : "2021-03-01T19:53:18Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "9ec951e4-3256-456c-8a92-bd79f5c63889",
        "parentId" : "2086c97b-fa17-4e4d-baee-77e963bf7fab",
        "authorId" : "ada71464-b8c9-4d7b-9020-d49c27251fdb",
        "body" : "We can remove it from `metadataOutput`, but I don't believe we can remove it in `withMetadataColumns` due to the output containing a name collision.",
        "createdAt" : "2021-03-01T19:32:34Z",
        "updatedAt" : "2021-03-01T19:53:18Z",
        "lastEditedBy" : "ada71464-b8c9-4d7b-9020-d49c27251fdb",
        "tags" : [
        ]
      }
    ],
    "commit" : "5a7209edd25fd0f59a0eadc1b0dabd2d146d2a70",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +2493,2497 @@  }\n\n  test(\"SPARK-34547: metadata columns are resolved last\") {\n    val t1 = s\"${catalogAndNamespace}tableOne\"\n    val t2 = \"t2\""
  },
  {
    "id" : "08ec4cbc-c318-4ea5-9c12-249545834434",
    "prId" : 31427,
    "prUrl" : "https://github.com/apache/spark/pull/31427#pullrequestreview-587019861",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b2828a02-35c7-4e24-aa4b-cbc73d1397a9",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "nit: Is it okay to remove the information about why a given name is unsupported?",
        "createdAt" : "2021-02-02T01:05:10Z",
        "updatedAt" : "2021-02-02T01:05:10Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "49f59e27-fc4a-4799-aa02-20dea87a4186",
        "parentId" : "b2828a02-35c7-4e24-aa4b-cbc73d1397a9",
        "authorId" : "ae55b635-dd0e-41aa-9272-372de9a35f38",
        "body" : "So the reason isn't that the namespace in session catalog must have exactly one name part anymore, so I think it's an OK change.",
        "createdAt" : "2021-02-04T17:55:44Z",
        "updatedAt" : "2021-02-04T17:55:44Z",
        "lastEditedBy" : "ae55b635-dd0e-41aa-9272-372de9a35f38",
        "tags" : [
        ]
      },
      {
        "id" : "e308f382-22a6-4c75-984a-59236e3bda6f",
        "parentId" : "b2828a02-35c7-4e24-aa4b-cbc73d1397a9",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Do you mean now we have the allowed case? Do we have a test case when it works if so?",
        "createdAt" : "2021-02-09T21:18:44Z",
        "updatedAt" : "2021-02-09T21:18:44Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "23964ff1b4bdae26f4e5617322316197a388ae2c",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +2101,2105 @@      sql(\"DESCRIBE FUNCTION default.ns1.ns2.fun\")\n    }\n    assert(e1.message.contains(\"Unsupported function name 'default.ns1.ns2.fun'\"))\n  }\n"
  },
  {
    "id" : "8e89029d-6091-4594-b661-63c6fd9d802c",
    "prId" : 31427,
    "prUrl" : "https://github.com/apache/spark/pull/31427#pullrequestreview-587260747",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "33deed84-afd6-4e6a-af7f-5ce45ed771f8",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "The error message is confusing now because there is a table `t` and Spark still complains that `Table or view not found`. ",
        "createdAt" : "2021-02-10T05:10:28Z",
        "updatedAt" : "2021-02-10T05:10:28Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "23964ff1b4bdae26f4e5617322316197a388ae2c",
    "line" : 57,
    "diffHunk" : "@@ -1,1 +2217,2221 @@        def verify(sql: String): Unit = {\n          val e = intercept[AnalysisException](spark.sql(sql))\n          assert(e.message.contains(s\"Table or view not found: $t\"),\n            s\"Error message did not contain expected text while evaluting $sql\")\n        }"
  }
]