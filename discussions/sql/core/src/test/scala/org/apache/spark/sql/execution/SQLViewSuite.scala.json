[
  {
    "id" : "07c52600-691a-47e1-a298-072f3752490c",
    "prId" : 32831,
    "prUrl" : "https://github.com/apache/spark/pull/32831#pullrequestreview-697044801",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "bb72fe1b-19c7-4256-a001-60447b48cc06",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "oh I missed it . It's better to move this test to PersistedViewTestSuite\r\n\r\nYou can fix it in https://github.com/apache/spark/pull/32832",
        "createdAt" : "2021-07-01T09:48:11Z",
        "updatedAt" : "2021-07-01T09:48:11Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "2fede50b9df0f1775fff86272a06e3fa2fe0eccd",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +913,917 @@  }\n\n  test(\"SPARK-35685: Prompt recreating view message for schema mismatch\") {\n    withTable(\"t\") {\n      sql(\"CREATE TABLE t USING json AS SELECT 1 AS col_i\")"
  },
  {
    "id" : "b947187e-441b-46f5-84fd-75eab91f2b88",
    "prId" : 31422,
    "prUrl" : "https://github.com/apache/spark/pull/31422#pullrequestreview-582020446",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "41869148-d264-4197-8eff-6f7237628cdb",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "cc @MaxGekk we should add tests here.",
        "createdAt" : "2021-02-02T19:01:13Z",
        "updatedAt" : "2021-02-02T19:01:14Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "d48c348a-28f5-48c1-a3df-0e50d53c2a97",
        "parentId" : "41869148-d264-4197-8eff-6f7237628cdb",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "And I guess to `HiveDDLSuite` too, right? I just wonder if we test v2 and v1 Hive external catalog, should we test v1 In-Memory catalog in that case?",
        "createdAt" : "2021-02-02T19:44:43Z",
        "updatedAt" : "2021-02-02T19:44:50Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "283b12af-4d27-43c1-9507-110845e5a3e7",
        "parentId" : "41869148-d264-4197-8eff-6f7237628cdb",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "I don't think so. It's UT and we know how the code works. The catalog implementation doesn't matter. Testing it once with whatever catalog is good enough.",
        "createdAt" : "2021-02-03T05:43:50Z",
        "updatedAt" : "2021-02-03T05:43:50Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "8610b8e5924eba64394607ae80bcb0db89da5741",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +171,175 @@        s\"ALTER TABLE $viewName SET TBLPROPERTIES ('p' = 'an')\",\n        s\"$viewName is a temp view. 'ALTER TABLE ... SET TBLPROPERTIES' expects a table\")\n      assertAnalysisError(\n        s\"ALTER TABLE $viewName UNSET TBLPROPERTIES ('p')\",\n        s\"$viewName is a temp view. 'ALTER TABLE ... UNSET TBLPROPERTIES' expects a table\")"
  },
  {
    "id" : "58497e9e-3bb7-4ef1-a05d-2a10ee36badf",
    "prId" : 30567,
    "prUrl" : "https://github.com/apache/spark/pull/30567#pullrequestreview-542886673",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a2e4b000-956a-4fb9-8586-30f1234caedc",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "let's also test the first created view and make sure it respect `STORE_ANALYZED_PLAN_FOR_VIEW`",
        "createdAt" : "2020-12-02T14:26:20Z",
        "updatedAt" : "2020-12-04T02:37:28Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "db9f0baffd424beba5f9efd19620d781cfb2b22b",
    "line" : 31,
    "diffHunk" : "@@ -1,1 +784,788 @@      withView(\"v1\") {\n        withSQLConf(STORE_ANALYZED_PLAN_FOR_VIEW.key -> \"true\") {\n          sql(\"CREATE TEMPORARY VIEW v1 AS SELECT * FROM t\")\n          Seq(4, 6, 5).toDF(\"c1\").write.mode(\"overwrite\").format(\"parquet\").saveAsTable(\"t\")\n          val e = intercept[SparkException] {"
  },
  {
    "id" : "b146e108-c977-4763-ae04-c289ead96321",
    "prId" : 30229,
    "prUrl" : "https://github.com/apache/spark/pull/30229#pullrequestreview-522578843",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "80194068-ed47-48ca-ae87-4fa2834a4bdb",
        "parentId" : null,
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "Weirdly, `AnalyzeColumnCommand` throws `NoSuchTableException` if the temp view is not cached (even if it exists):\r\nhttps://github.com/apache/spark/blob/3959f0d9879fa7fa9e8f2e8ed8c8b12003d21788/sql/core/src/main/scala/org/apache/spark/sql/execution/command/AnalyzeColumnCommand.scala#L72-L78\r\nSo, this line doesn't need to be updated.",
        "createdAt" : "2020-11-03T05:20:40Z",
        "updatedAt" : "2020-11-03T18:46:05Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      },
      {
        "id" : "f769fea4-88c7-43f3-a568-6bb6415206e3",
        "parentId" : "80194068-ed47-48ca-ae87-4fa2834a4bdb",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "We can create a separate PR to fix it. I think it should be `AnalysisException` with clear message to mention that it's not cached.",
        "createdAt" : "2020-11-03T14:56:14Z",
        "updatedAt" : "2020-11-03T18:46:05Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "c80e8eb5828ff68a1ebab4f9ee56b55b852ba7d0",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +180,184 @@      }.getMessage\n      assert(e3.contains(s\"$viewName is a temp view not table or permanent view\"))\n      assertNoSuchTable(s\"ANALYZE TABLE $viewName COMPUTE STATISTICS FOR COLUMNS id\")\n    }\n  }"
  },
  {
    "id" : "10edc5a7-809e-4c44-9a3b-7f1540587c91",
    "prId" : 26304,
    "prUrl" : "https://github.com/apache/spark/pull/26304#pullrequestreview-309413815",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4f57448f-362b-4956-a594-157da938d8ce",
        "parentId" : null,
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "@cloud-fan, If we need to retain the same behavior to throw an exception with `\"'$viewName' is a view not a table\"` message, we need to pass `partitionSpec` to `AlterTable`, then check if `partitionSpec` is set inside `AlterTableExec`. I don't think it's necessary, but please let me know if that is preferred. ",
        "createdAt" : "2019-10-30T16:00:18Z",
        "updatedAt" : "2019-10-30T17:10:01Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      },
      {
        "id" : "65ea18dd-6dfa-4fa6-aec5-a772c7da7072",
        "parentId" : "4f57448f-362b-4956-a594-157da938d8ce",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "looks reasonable to me",
        "createdAt" : "2019-10-30T16:53:49Z",
        "updatedAt" : "2019-10-30T17:10:01Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "9b3def7c-89cb-4039-8a4c-c065cab9fe5b",
        "parentId" : "4f57448f-362b-4956-a594-157da938d8ce",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "I assume you meant the current approach looks reasonable, right?",
        "createdAt" : "2019-10-30T17:07:10Z",
        "updatedAt" : "2019-10-30T17:10:01Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      },
      {
        "id" : "2341a776-8d43-44b0-8977-022d2e2c1294",
        "parentId" : "4f57448f-362b-4956-a594-157da938d8ce",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "yea, the unsupported feature should be reported first.",
        "createdAt" : "2019-10-30T18:04:23Z",
        "updatedAt" : "2019-10-30T18:04:23Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "1f5907288ee76d0b67cc0ed4eb426b5607c898dc",
    "line" : 20,
    "diffHunk" : "@@ -1,1 +151,155 @@      assertAnalysisError(\n        s\"ALTER TABLE $viewName PARTITION (a='4') SET LOCATION '/path/to/home'\",\n        \"ALTER TABLE SET LOCATION does not support partition for v2 tables\")\n    }\n  }"
  }
]