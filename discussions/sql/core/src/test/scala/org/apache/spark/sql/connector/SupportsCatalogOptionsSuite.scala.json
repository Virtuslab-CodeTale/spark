[
  {
    "id" : "10658671-8c8b-41aa-bc98-a0f99a0d4554",
    "prId" : 26913,
    "prUrl" : "https://github.com/apache/spark/pull/26913#pullrequestreview-335950670",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a44a8c2f-8499-4d02-b67b-8a718422ee70",
        "parentId" : null,
        "authorId" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "body" : "These assertions are probably easier if you use the extractors:\r\n\r\n```scala\r\ntable.partitioning.head match {\r\n  case IdentityTransform(FieldReference(field)) =>\r\n    assert(field === Seq(partitionBy.head))\r\n  case _ =>\r\n    fail(...)\r\n}",
        "createdAt" : "2019-12-23T17:34:28Z",
        "updatedAt" : "2020-01-09T15:12:09Z",
        "lastEditedBy" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "tags" : [
        ]
      }
    ],
    "commit" : "963133edc5004a465347fd7b1c3edfffd6ff5a8d",
    "line" : 90,
    "diffHunk" : "@@ -1,1 +88,92 @@    }\n    assert(table.partitioning().map(_.references().head.fieldNames().head) === partitionBy,\n      \"Partitioning was incorrect\")\n    assert(table.schema() === df.schema.asNullable, \"Schema did not match\")\n"
  }
]