[
  {
    "id" : "cc6314ef-fa50-4770-9971-cc10e1ef2ff0",
    "prId" : 31887,
    "prUrl" : "https://github.com/apache/spark/pull/31887#pullrequestreview-628356228",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6469e194-b76b-4e9f-9ade-0d53cf0de1e8",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "nit: `nested transform (DSL)` -> `SPARK-34794: nested transform`",
        "createdAt" : "2021-04-06T01:05:59Z",
        "updatedAt" : "2021-04-06T01:10:48Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "8c2ad611bf6aa4a0acdbebc6f78248d0a2a6ac9e",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +2262,2266 @@  }\n\n  test(\"nested transform (DSL)\") {\n    val df = Seq(\n        (Seq(1, 2, 3), Seq(\"a\", \"b\", \"c\"))"
  },
  {
    "id" : "f9db6ef2-fd16-43c3-b159-fe4adee79159",
    "prId" : 31887,
    "prUrl" : "https://github.com/apache/spark/pull/31887#pullrequestreview-628356228",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "cccdcd78-15c3-455d-a123-ea7164cdea71",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "I think we need exhaustive tests for this issue, e.g., two/three argument cases and their combination cases.",
        "createdAt" : "2021-04-06T01:10:25Z",
        "updatedAt" : "2021-04-06T01:10:48Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "8c2ad611bf6aa4a0acdbebc6f78248d0a2a6ac9e",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +2272,2276 @@            transform(\n              $\"numbers\",\n              (number: Column) => transform(\n                $\"letters\",\n                (letter: Column) => struct("
  },
  {
    "id" : "833773e6-3051-4511-a9f7-b32e4a0084ca",
    "prId" : 27991,
    "prUrl" : "https://github.com/apache/spark/pull/27991#pullrequestreview-399617281",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e720d3c3-fbbf-4335-966e-f3316a247e28",
        "parentId" : null,
        "authorId" : "a80e0991-f7b1-415a-8d2e-ab615cc6ef4a",
        "body" : "How about `concat(array(), array(NULL))`? That should have the same type as `array(NULL)`.",
        "createdAt" : "2020-04-23T12:01:21Z",
        "updatedAt" : "2020-04-23T12:01:22Z",
        "lastEditedBy" : "a80e0991-f7b1-415a-8d2e-ab615cc6ef4a",
        "tags" : [
        ]
      },
      {
        "id" : "4e4c8d2c-9fd7-4bb5-ae4c-13198ef6e97b",
        "parentId" : "e720d3c3-fbbf-4335-966e-f3316a247e28",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Yea, the output has the same type with array(null);\r\n```\r\nscala> sql(\"select concat(array(), array(NULL))\").printSchema\r\nroot\r\n |-- concat(array(), array(NULL)): array (nullable = false)\r\n |    |-- element: null (containsNull = true)\r\n\r\nscala> sql(\"select array()\").printSchema\r\nroot\r\n |-- array(): array (nullable = false)\r\n |    |-- element: null (containsNull = false)\r\n\r\nscala> sql(\"select array(null)\").printSchema\r\nroot\r\n |-- array(NULL): array (nullable = false)\r\n |    |-- element: null (containsNull = true)\r\n```\r\nAny concern?",
        "createdAt" : "2020-04-23T12:26:24Z",
        "updatedAt" : "2020-04-23T12:26:24Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "7b0450eb-2e77-409d-b6ef-122900035337",
        "parentId" : "e720d3c3-fbbf-4335-966e-f3316a247e28",
        "authorId" : "a80e0991-f7b1-415a-8d2e-ab615cc6ef4a",
        "body" : "Only that it should be tested, since it's an interesting corner case!",
        "createdAt" : "2020-04-23T13:56:39Z",
        "updatedAt" : "2020-04-23T13:56:39Z",
        "lastEditedBy" : "a80e0991-f7b1-415a-8d2e-ab615cc6ef4a",
        "tags" : [
        ]
      },
      {
        "id" : "b8cc1bac-f47e-440d-a3ab-d86f1f8912ed",
        "parentId" : "e720d3c3-fbbf-4335-966e-f3316a247e28",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "I believe those cases are tested in `CastSuite.scala` and `TypeCoercionSuite.scala` including all types if I didn't miss anything. I just kept one e2e test here since it was the reported case in the JIRA SPARK-31227.",
        "createdAt" : "2020-04-24T03:33:50Z",
        "updatedAt" : "2020-04-24T03:33:50Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "1bf68f03acce3cb46380ecbadd66693cbff39195",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +1533,1537 @@  }\n\n  test(\"SPARK-31227: Non-nullable null type should not coerce to nullable type in concat\") {\n    val actual = spark.range(1).selectExpr(\"concat(array(), array(1)) as arr\")\n    val expected = spark.range(1).selectExpr(\"array(1) as arr\")"
  }
]