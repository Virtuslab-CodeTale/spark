[
  {
    "id" : "d3bf2cc6-2f83-49bc-917b-45ee84e83939",
    "prId" : 30854,
    "prUrl" : "https://github.com/apache/spark/pull/30854#pullrequestreview-556165377",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5e4a3011-359c-470d-beb3-e6987a2b5e68",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "do you know what goes wrong?",
        "createdAt" : "2020-12-21T06:38:03Z",
        "updatedAt" : "2020-12-21T06:38:03Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "5ebc1ec0-ed78-43a4-b109-3eaca0db02c1",
        "parentId" : "5e4a3011-359c-470d-beb3-e6987a2b5e68",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "I haven't investigated yet why v1 In-Memory and Hive ext catalog have different behavior. The same approach in tests worked for other commands. It seems something specific to `DROP TABLE`. Need to look at it separately since this PR about tests.",
        "createdAt" : "2020-12-21T06:51:43Z",
        "updatedAt" : "2020-12-21T06:51:43Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "2203bc93-d879-4df3-b0c8-3623fcd8702e",
        "parentId" : "5e4a3011-359c-470d-beb3-e6987a2b5e68",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "This is some kind of Hive specific check:\r\n```\r\n  spark_catalog.ns.tbl is not a valid TableIdentifier as it has more than 2 name parts.\r\n  org.apache.spark.sql.AnalysisException: spark_catalog.ns.tbl is not a valid TableIdentifier as it has more than 2 name parts.\r\n      at org.apache.spark.sql.connector.catalog.CatalogV2Implicits$MultipartIdentifierHelper.asTableIdentifier(CatalogV2Implicits.scala:130)\r\n      at org.apache.spark.sql.hive.test.TestHiveQueryExecution$$anonfun$1.applyOrElse(TestHive.scala:606)\r\n      at org.apache.spark.sql.hive.test.TestHiveQueryExecution$$anonfun$1.applyOrElse(TestHive.scala:606)\r\n```",
        "createdAt" : "2020-12-21T07:00:43Z",
        "updatedAt" : "2020-12-21T07:00:43Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "4d250003874cc9ffe8d3d721ad0ca8274d2013f0",
    "line" : 39,
    "diffHunk" : "@@ -1,1 +37,41 @@  // The test fails in Hive External catalog with:\n  // org.apache.spark.sql.AnalysisException:\n  //   spark_catalog.ns.tbl is not a valid TableIdentifier as it has more than 2 name parts.\n  test(\"SPARK-33305: DROP TABLE should also invalidate cache\") {\n    val t = s\"$catalog.ns.tbl\""
  }
]