[
  {
    "id" : "f4c4d060-0946-4aa7-86be-a4ec08b0fa0b",
    "prId" : 31002,
    "prUrl" : "https://github.com/apache/spark/pull/31002#pullrequestreview-560813236",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9bab2816-4f25-49e9-94a6-4e798b7cf999",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Should we maybe check the explicit compression type? I know one test:\r\n\r\nhttps://github.com/apache/spark/blob/3a299aa6480ac22501512cd0310d31a441d7dfdc/sql/hive/src/test/scala/org/apache/spark/sql/hive/orc/OrcHadoopFsRelationSuite.scala#L85-L108",
        "createdAt" : "2021-01-04T06:58:29Z",
        "updatedAt" : "2021-01-04T07:01:55Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "c97e1b84-a421-46c1-ba2f-eb2b05f08602",
        "parentId" : "9bab2816-4f25-49e9-94a6-4e798b7cf999",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "@dongjoon-hyun feel free to skip this comment. Actually, I think the tests are good enough.",
        "createdAt" : "2021-01-04T07:02:42Z",
        "updatedAt" : "2021-01-04T07:02:43Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "ae72db0c-d14e-4bec-a682-920a8b478bc6",
        "parentId" : "9bab2816-4f25-49e9-94a6-4e798b7cf999",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Thanks, @HyukjinKwon . I avoided it due to the two reasons.\r\n1. `OrcFileOperator` is in `hive` module and this is `sql` module.\r\n2. The ORC native data source file names do not end with `.zstd.orc` postfix.\r\n```\r\n$ ls -al /tmp/zstd/*.orc | head -n1\r\n-rw-r--r--  1 dongjoon  wheel  109 Jan  3 22:41 /tmp/zstd/part-00000-a63d9a17-456f-42d3-87a1-d922112ed28c-c000.orc\r\n```",
        "createdAt" : "2021-01-04T07:07:53Z",
        "updatedAt" : "2021-01-04T07:10:48Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "ca1aa2c80e38147f87e339463258654c81827bdd",
    "line" : 18,
    "diffHunk" : "@@ -1,1 +600,604 @@      val path = dir.getAbsolutePath\n      spark.range(3).write.option(\"compression\", \"zstd\").orc(path)\n      checkAnswer(spark.read.orc(path), Seq(Row(0), Row(1), Row(2)))\n    }\n  }"
  }
]