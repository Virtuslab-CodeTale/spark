[
  {
    "id" : "227efd4d-0957-4b02-8624-8a9192b9569b",
    "prId" : 30937,
    "prUrl" : "https://github.com/apache/spark/pull/30937#pullrequestreview-561292217",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "be74d754-d03f-4bb5-bd55-68f4ada8fc8d",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "shall we test it with v1 catalog as well?",
        "createdAt" : "2021-01-04T07:00:02Z",
        "updatedAt" : "2021-01-04T19:34:18Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "d4f771c9-291c-46dc-a4ca-11bfc93561e8",
        "parentId" : "be74d754-d03f-4bb5-bd55-68f4ada8fc8d",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "This PR already have case sensitivity tests for v1 In-Memory and Hive catalogs. I had to put the test to catalog specific test suites because the behavior is different in all catalogs.",
        "createdAt" : "2021-01-04T08:10:54Z",
        "updatedAt" : "2021-01-04T19:34:18Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "8aa3e0e0-aad4-4cfc-ae1e-a598412bbed8",
        "parentId" : "be74d754-d03f-4bb5-bd55-68f4ada8fc8d",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "can you highlight the differences?",
        "createdAt" : "2021-01-04T08:35:13Z",
        "updatedAt" : "2021-01-04T19:34:18Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "24f2d005-0805-4fea-a4fc-be1fa8e4941e",
        "parentId" : "be74d754-d03f-4bb5-bd55-68f4ada8fc8d",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "- V2 is case sensitive, and does not  respect the SQL config `spark.sql.caseSensitive`. It always shows namespaces in **upper case**.\r\n- V1 In-Memory takes into account `spark.sql.caseSensitive` but **when the config is `false`, it shows all names in lower case**. For example, if we create a namespace `AAA`, it shows `aaa` (but this could be behavior of `CREATE NAMESPACE`)\r\n- V1 Hive External catalog doesn't respect `spark.sql.caseSensitive`, and **always lower case namespaces**.",
        "createdAt" : "2021-01-04T19:42:16Z",
        "updatedAt" : "2021-01-04T19:42:39Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "8f8751dadc2394205ca351cf541aa92bd4a1f2b1",
    "line" : 57,
    "diffHunk" : "@@ -1,1 +55,59 @@  }\n\n  test(\"case sensitivity\") {\n    Seq(true, false).foreach { caseSensitive =>\n      withSQLConf(SQLConf.CASE_SENSITIVE.key -> caseSensitive.toString) {"
  },
  {
    "id" : "a81a4608-4d32-46d5-950c-0e6dbb718b44",
    "prId" : 30937,
    "prUrl" : "https://github.com/apache/spark/pull/30937#pullrequestreview-560851126",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "320bcb55-b979-4ef3-bdb8-420b93dff18a",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "should it fail?",
        "createdAt" : "2021-01-04T07:01:06Z",
        "updatedAt" : "2021-01-04T19:34:18Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "99b72dde-e650-4d85-b193-a4188ba5f479",
        "parentId" : "320bcb55-b979-4ef3-bdb8-420b93dff18a",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "v1 fails at least https://github.com/apache/spark/pull/30937/files#diff-8cbd4478c9a858099aef4d5eea6fa916e7a6a47efd3e00701c4606e7d1674982R37 . If we want to have the same behavior as v1, we should fail.",
        "createdAt" : "2021-01-04T08:12:38Z",
        "updatedAt" : "2021-01-04T19:34:18Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "e0677415-6f9b-4289-bd0b-4c65c17ee945",
        "parentId" : "320bcb55-b979-4ef3-bdb8-420b93dff18a",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "yea we should fail. We can do it later.",
        "createdAt" : "2021-01-04T08:34:51Z",
        "updatedAt" : "2021-01-04T19:34:18Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "8f8751dadc2394205ca351cf541aa92bd4a1f2b1",
    "line" : 35,
    "diffHunk" : "@@ -1,1 +33,37 @@  test(\"IN namespace doesn't exist\") {\n    withSQLConf(SQLConf.DEFAULT_CATALOG.key -> catalog) {\n      runShowNamespacesSql(\"SHOW NAMESPACES in dummy\", Seq.empty)\n    }\n    runShowNamespacesSql(s\"SHOW NAMESPACES in $catalog.ns1\", Seq.empty)"
  },
  {
    "id" : "8864005e-8293-4333-91a4-1bca708e2bcd",
    "prId" : 30937,
    "prUrl" : "https://github.com/apache/spark/pull/30937#pullrequestreview-561558016",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "cde0c4d4-a687-4f31-9fec-91e73979b49e",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "do you mean V2 is always case insensitive?",
        "createdAt" : "2021-01-05T04:44:41Z",
        "updatedAt" : "2021-01-05T04:44:41Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "7a03a5e4-c863-4cab-b2ec-4c1bc5c5d3e7",
        "parentId" : "cde0c4d4-a687-4f31-9fec-91e73979b49e",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Actually, there are 2 things here:\r\n1. How we apply pattern. It is always case insensitive, see https://github.com/apache/spark/blob/3a299aa6480ac22501512cd0310d31a441d7dfdc/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/util/StringUtils.scala#L85\r\n2. How we show results or create namespace. For example, if we create `AAA` namespace\r\n  - v2 shows it as `AAA` independently from `spark.sql.caseSensitive`\r\n  - v1 Hive shows it as `aaa` independently from `spark.sql.caseSensitive`\r\n  - v1 in-memory shows it as `AAA` if  `spark.sql.caseSensitive = true` and `aaa` if `spark.sql.caseSensitive = false` \r\n",
        "createdAt" : "2021-01-05T07:13:13Z",
        "updatedAt" : "2021-01-05T07:13:13Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "8f8751dadc2394205ca351cf541aa92bd4a1f2b1",
    "line" : 67,
    "diffHunk" : "@@ -1,1 +65,69 @@            Seq(\"AAA\", \"bbb\") ++ builtinTopNamespaces)\n          runShowNamespacesSql(s\"SHOW NAMESPACES IN $catalog LIKE 'AAA'\", Seq(\"AAA\"))\n          runShowNamespacesSql(s\"SHOW NAMESPACES IN $catalog LIKE 'aaa'\", Seq(\"AAA\"))\n        }\n      }"
  }
]