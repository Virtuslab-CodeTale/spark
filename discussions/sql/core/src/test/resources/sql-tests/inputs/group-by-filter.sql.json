[
  {
    "id" : "60c4d84a-2e40-4ffc-804c-bc4b7d05cd86",
    "prId" : 29291,
    "prUrl" : "https://github.com/apache/spark/pull/29291#pullrequestreview-459095822",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4d6e4940-fd37-4258-ac88-8288dca3eedb",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "can we also test `COUNT(DISTINCT id) FILTER (WHERE true)` and `COUNT(DISTINCT id) FILTER (WHERE false)`?",
        "createdAt" : "2020-07-31T07:39:22Z",
        "updatedAt" : "2020-08-03T05:40:34Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "7c59043a-9e43-4019-bf6d-5f46630711c6",
        "parentId" : "4d6e4940-fd37-4258-ac88-8288dca3eedb",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "OK",
        "createdAt" : "2020-07-31T11:09:46Z",
        "updatedAt" : "2020-08-03T05:40:34Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "883973b9bc8a9c530a002cf4b48217546929fb5e",
    "line" : 10,
    "diffHunk" : "@@ -1,1 +41,45 @@SELECT COUNT(DISTINCT id) FILTER (WHERE hiredate = to_timestamp(\"2001-01-01 00:00:00\")), COUNT(DISTINCT id) FILTER (WHERE hiredate = to_date('2001-01-01 00:00:00')) FROM emp;\nSELECT SUM(salary), COUNT(DISTINCT id), COUNT(DISTINCT id) FILTER (WHERE hiredate = date \"2001-01-01\") FROM emp;\nSELECT COUNT(DISTINCT 1) FILTER (WHERE a = 1) FROM testData;\nSELECT COUNT(DISTINCT id) FILTER (WHERE true) FROM emp;\nSELECT COUNT(DISTINCT id) FILTER (WHERE false) FROM emp;"
  },
  {
    "id" : "88c943a9-d2d9-4e9c-9712-5ca383de43af",
    "prId" : 27019,
    "prUrl" : "https://github.com/apache/spark/pull/27019#pullrequestreview-381882829",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2c734bee-b3ae-451b-a774-c3782492f352",
        "parentId" : null,
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "I can't understand this dimension config.\r\nWhen `spark.sql.codegen.wholeStage=false` and `spark.sql.codegen.factoryMode=CODEGEN_ONLY`.\r\nIt means each operator will be compiled into single java and cannot fallback to interpreted ?\r\nCould you tell me more about this?",
        "createdAt" : "2020-03-26T09:42:00Z",
        "updatedAt" : "2020-12-21T01:40:48Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      },
      {
        "id" : "e200f8db-36a8-4a1b-8891-ad40ee262ea6",
        "parentId" : "2c734bee-b3ae-451b-a774-c3782492f352",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "That means the plan interpreter is  used with the expression codegen (e.g., `GenerateUnsafeProjection`) enabled.",
        "createdAt" : "2020-03-26T09:55:23Z",
        "updatedAt" : "2020-12-21T01:40:48Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "a2233a26-5f5d-40a4-acdb-7ffe32e3bd58",
        "parentId" : "2c734bee-b3ae-451b-a774-c3782492f352",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "Thanks. I learned it.",
        "createdAt" : "2020-03-26T10:37:02Z",
        "updatedAt" : "2020-12-21T01:40:48Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "86d89ba79bd2d0a86a791d77bdde3eda00271561",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +1,5 @@-- Test filter clause for aggregate expression with codegen on and off.\n--CONFIG_DIM1 spark.sql.codegen.wholeStage=true\n--CONFIG_DIM1 spark.sql.codegen.wholeStage=false,spark.sql.codegen.factoryMode=CODEGEN_ONLY\n--CONFIG_DIM1 spark.sql.codegen.wholeStage=false,spark.sql.codegen.factoryMode=NO_CODEGEN\n"
  },
  {
    "id" : "45509e59-a2be-421b-bf68-4e650a1b9e35",
    "prId" : 26656,
    "prUrl" : "https://github.com/apache/spark/pull/26656#pullrequestreview-323394857",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f8775183-4356-49b6-8c01-79f4cd5f5969",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Can you add some tests for regular subqueries and correlated ones?",
        "createdAt" : "2019-11-25T12:41:27Z",
        "updatedAt" : "2019-12-24T03:01:16Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "13fd4397-34d6-461f-ac12-84d740773a14",
        "parentId" : "f8775183-4356-49b6-8c01-79f4cd5f5969",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "OK",
        "createdAt" : "2019-11-26T02:57:41Z",
        "updatedAt" : "2019-12-24T03:01:16Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      },
      {
        "id" : "81cfa0b0-030f-41a3-835e-833b07b3b007",
        "parentId" : "f8775183-4356-49b6-8c01-79f4cd5f5969",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Ah, can you add some tests for predicate with functions, too? https://github.com/apache/spark/blob/master/sql/core/src/test/resources/sql-tests/inputs/predicate-functions.sql",
        "createdAt" : "2019-11-26T10:28:46Z",
        "updatedAt" : "2019-12-24T03:01:16Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "c9a1dbe5-f0f5-44dc-9b19-c6fd180156d3",
        "parentId" : "f8775183-4356-49b6-8c01-79f4cd5f5969",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "OK",
        "createdAt" : "2019-11-27T02:19:25Z",
        "updatedAt" : "2019-12-24T03:01:16Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "d98ea4139454e3346e220aa0e1df8a2e4da18cea",
    "line" : 78,
    "diffHunk" : "@@ -1,1 +76,80 @@SELECT a + b, COUNT(b) FILTER (WHERE b >= 2) FROM testData GROUP BY a + b;\nSELECT a + 2, COUNT(b) FILTER (WHERE b IN (1, 2)) FROM testData GROUP BY a + 1;\nSELECT a + 1 + 1, COUNT(b) FILTER (WHERE b > 0) FROM testData GROUP BY a + 1;\n\n-- Aggregate with filter, foldable input and multiple distinct groups."
  },
  {
    "id" : "183be7ab-9b40-4627-ab71-f5f2fb7369ef",
    "prId" : 26656,
    "prUrl" : "https://github.com/apache/spark/pull/26656#pullrequestreview-322704322",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "de0782be-7750-4ce5-a022-83d1856380a7",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Can you write most of tests for this pr here where possible? If you cannot, plz use `SQLQuerySuite` instead. (Currently, I think some tests are overlapped between `group-by-filter.sql` and `SQLQuerySuite`.",
        "createdAt" : "2019-11-25T12:59:40Z",
        "updatedAt" : "2019-12-24T03:01:16Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "ee9fbf0d-94d6-466c-871b-215d5f29ff60",
        "parentId" : "de0782be-7750-4ce5-a022-83d1856380a7",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "I will add tests in `group-by-filter.sql`.",
        "createdAt" : "2019-11-26T02:58:22Z",
        "updatedAt" : "2019-12-24T03:01:16Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "d98ea4139454e3346e220aa0e1df8a2e4da18cea",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +2,6 @@\n-- Test data.\nCREATE OR REPLACE TEMPORARY VIEW testData AS SELECT * FROM VALUES\n(1, 1), (1, 2), (2, 1), (2, 2), (3, 1), (3, 2), (null, 1), (3, null), (null, null)\nAS testData(a, b);"
  },
  {
    "id" : "08a16f57-eba5-4443-be74-473eac9e32a6",
    "prId" : 26656,
    "prUrl" : "https://github.com/apache/spark/pull/26656#pullrequestreview-328787418",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9084f9d4-694d-42b8-95a9-433432466e55",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "It seems this test query is affected by the constant folding rule. So, can you add tests like `where some_func(hiredate) = <literal>`, too?",
        "createdAt" : "2019-12-07T07:09:07Z",
        "updatedAt" : "2019-12-24T03:01:16Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "ed4a9187-2a16-4bf4-8840-05a7896f0624",
        "parentId" : "9084f9d4-694d-42b8-95a9-433432466e55",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "OK.",
        "createdAt" : "2019-12-09T09:36:19Z",
        "updatedAt" : "2019-12-24T03:01:16Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "d98ea4139454e3346e220aa0e1df8a2e4da18cea",
    "line" : 33,
    "diffHunk" : "@@ -1,1 +31,35 @@SELECT COUNT(a) FILTER (WHERE a = 1), COUNT(b) FILTER (WHERE a > 1) FROM testData;\nSELECT COUNT(id) FILTER (WHERE hiredate = date \"2001-01-01\") FROM emp;\nSELECT COUNT(id) FILTER (WHERE hiredate = to_date('2001-01-01 00:00:00')) FROM emp;\nSELECT COUNT(id) FILTER (WHERE hiredate = to_timestamp(\"2001-01-01 00:00:00\")) FROM emp;\nSELECT COUNT(id) FILTER (WHERE date_format(hiredate, \"yyyy-MM-dd\") = \"2001-01-01\") FROM emp;"
  },
  {
    "id" : "ab300bef-30fa-4ef5-82fc-88635f13b3c0",
    "prId" : 26656,
    "prUrl" : "https://github.com/apache/spark/pull/26656#pullrequestreview-331059654",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "1383c991-548f-4f50-985c-30d350298fda",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "This table seems to be designed for `null` value tests. Shall we have more null values in `EMP` table together? (For now, `EMP` table has one null value)",
        "createdAt" : "2019-12-11T05:35:33Z",
        "updatedAt" : "2019-12-24T03:01:16Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "37b17b25-1e61-4698-9f58-f375b22c05bc",
        "parentId" : "1383c991-548f-4f50-985c-30d350298fda",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "I think it's OK. Do you have other idea?",
        "createdAt" : "2019-12-11T08:55:48Z",
        "updatedAt" : "2019-12-24T03:01:16Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      },
      {
        "id" : "e4dd64a2-372f-4f66-8745-9c1cbf6af139",
        "parentId" : "1383c991-548f-4f50-985c-30d350298fda",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "My idea was to have more values in `EMP` table like `testData` table. For example, one null per column?",
        "createdAt" : "2019-12-12T06:56:54Z",
        "updatedAt" : "2019-12-24T03:01:16Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "73bb31e9-40c2-4d89-9900-71e6d17667b3",
        "parentId" : "1383c991-548f-4f50-985c-30d350298fda",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "Do you mean I insert some null values to ensure that each column has a null?",
        "createdAt" : "2019-12-12T08:31:35Z",
        "updatedAt" : "2019-12-24T03:01:16Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "d98ea4139454e3346e220aa0e1df8a2e4da18cea",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +3,7 @@-- Test data.\nCREATE OR REPLACE TEMPORARY VIEW testData AS SELECT * FROM VALUES\n(1, 1), (1, 2), (2, 1), (2, 2), (3, 1), (3, 2), (null, 1), (3, null), (null, null)\nAS testData(a, b);\n"
  },
  {
    "id" : "78f89995-2618-4750-acf4-ae2abf1d33f2",
    "prId" : 26656,
    "prUrl" : "https://github.com/apache/spark/pull/26656#pullrequestreview-335688427",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3767d74d-f1a8-4577-a775-223e3dded1bb",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "let's test something like `FILTER (WHERE a + b > 3)`, which can catch this bug https://github.com/apache/spark/pull/26656#discussion_r360296384",
        "createdAt" : "2019-12-20T14:15:34Z",
        "updatedAt" : "2019-12-24T03:01:16Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "b0d78577-3c4d-4546-bcd3-e1915ec72cf7",
        "parentId" : "3767d74d-f1a8-4577-a775-223e3dded1bb",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "OK",
        "createdAt" : "2019-12-23T02:06:28Z",
        "updatedAt" : "2019-12-24T03:01:16Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "d98ea4139454e3346e220aa0e1df8a2e4da18cea",
    "line" : 59,
    "diffHunk" : "@@ -1,1 +57,61 @@select dept_id, count(distinct emp_name), count(distinct hiredate), sum(salary), sum(salary) filter (where id > 200) from emp group by dept_id;\nselect dept_id, count(distinct emp_name), count(distinct hiredate), sum(salary), sum(salary) filter (where id + dept_id > 500) from emp group by dept_id;\nselect dept_id, count(distinct emp_name), count(distinct hiredate), sum(salary) filter (where salary < 400.00D), sum(salary) filter (where id > 200) from emp group by dept_id;\nselect dept_id, count(distinct emp_name), count(distinct hiredate), sum(salary) filter (where salary < 400.00D), sum(salary) filter (where id + dept_id > 500) from emp group by dept_id;\n-- [SPARK-30276] Support Filter expression allows simultaneous use of DISTINCT"
  },
  {
    "id" : "3d3f22f9-2ca2-4aea-a6f8-769450333be3",
    "prId" : 26656,
    "prUrl" : "https://github.com/apache/spark/pull/26656#pullrequestreview-335689748",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "928981bb-078d-45a5-a627-339ede20b0ae",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "nit: add a blank line between two long queries.",
        "createdAt" : "2019-12-20T14:21:28Z",
        "updatedAt" : "2019-12-24T03:01:16Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "5e7c6ccf-7dc9-49ff-8a44-1260a2dce782",
        "parentId" : "928981bb-078d-45a5-a627-339ede20b0ae",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "OK",
        "createdAt" : "2019-12-23T02:17:00Z",
        "updatedAt" : "2019-12-24T03:01:16Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "d98ea4139454e3346e220aa0e1df8a2e4da18cea",
    "line" : 95,
    "diffHunk" : "@@ -1,1 +93,97 @@GROUP BY dept_id;\n\nSELECT emp.dept_id,\n       avg(salary),\n       avg(salary) FILTER (WHERE emp.dept_id = (SELECT dept_id FROM dept LIMIT 1))"
  }
]