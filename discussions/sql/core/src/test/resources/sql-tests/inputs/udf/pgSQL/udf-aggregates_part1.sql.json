[
  {
    "id" : "3477f071-d360-4f96-83b7-addff6ca5c75",
    "prId" : 25128,
    "prUrl" : "https://github.com/apache/spark/pull/25128#pullrequestreview-261049105",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e26f7e18-c8d3-4d73-816a-70b00aa6ed11",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "The second cast `var_pop(CAST(x AS DOUBLE))` is fine?",
        "createdAt" : "2019-07-12T03:06:19Z",
        "updatedAt" : "2019-07-12T03:06:19Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "d0295b88-bb3c-4f73-a97f-9c13f2a668ed",
        "parentId" : "e26f7e18-c8d3-4d73-816a-70b00aa6ed11",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "I am going to make a fix to address all of them soon .. this is just a quick fix to make the tests run ..",
        "createdAt" : "2019-07-12T03:57:32Z",
        "updatedAt" : "2019-07-12T03:57:33Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "78d636d49efc416ac50367bb751b8819f263316b",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +79,83 @@SELECT CAST(avg(udf(CAST(x AS DOUBLE))) AS int), CAST(udf(var_pop(CAST(x AS DOUBLE))) AS decimal(10,3))\nFROM (VALUES (100000003), (100000004), (100000006), (100000007)) v(x);\nSELECT CAST(avg(udf(x)) AS long), CAST(udf(var_pop(CAST(x AS DOUBLE))) AS decimal(10,3))\nFROM (VALUES (7000000000005), (7000000000007)) v(x);\n"
  },
  {
    "id" : "842f43da-bcf3-444a-9d63-ef5667f81f25",
    "prId" : 25110,
    "prUrl" : "https://github.com/apache/spark/pull/25110#pullrequestreview-260540571",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "afebb8ea-6691-4f29-a635-89a077bfd289",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "I guess only float/double has the issue, we cast int/long just for more robust too?",
        "createdAt" : "2019-07-11T08:08:32Z",
        "updatedAt" : "2019-07-11T08:08:32Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "65fd9cff-92c5-42ee-aac2-3ed6625138b1",
        "parentId" : "afebb8ea-6691-4f29-a635-89a077bfd289",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Ah, we don't have to. But casting makes closer to the original results:\r\n\r\n```diff\r\n -- !query 3\r\n-SELECT sum(four) AS sum_1500 FROM onek\r\n+SELECT CAST(sum(udf(four)) AS int) AS sum_1500 FROM onek\r\n -- !query 3 schema\r\n-struct<sum_1500:bigint>\r\n+struct<sum_1500:int>\r\n -- !query 3 output\r\n 1500\r\n```\r\n\r\nIf we don't cast, it returns a double due to type coercion. Should be fine.\r\n",
        "createdAt" : "2019-07-11T08:25:36Z",
        "updatedAt" : "2019-07-11T08:25:36Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "21870c64e6fccf44844770867f14e966cba9512e",
    "line" : 17,
    "diffHunk" : "@@ -1,1 +24,28 @@-- SELECT avg(gpa) AS avg_3_4 FROM ONLY student;\n\nSELECT CAST(sum(udf(four)) AS int) AS sum_1500 FROM onek;\nSELECT udf(sum(a)) AS sum_198 FROM aggtest;\nSELECT CAST(udf(udf(sum(b))) AS decimal(10,3)) AS avg_431_773 FROM aggtest;"
  }
]