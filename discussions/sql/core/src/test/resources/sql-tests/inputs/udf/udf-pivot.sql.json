[
  {
    "id" : "ce8d0275-8001-47f9-9544-080a1f912e8b",
    "prId" : 25122,
    "prUrl" : "https://github.com/apache/spark/pull/25122#pullrequestreview-263520604",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "bed0bad3-6121-45c6-98bd-f4c893debe22",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "We could also try to add udf here instead to avoid to test the same combination.",
        "createdAt" : "2019-07-18T04:25:38Z",
        "updatedAt" : "2019-07-18T12:16:44Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "d5dd4ed4-dc73-4de6-9543-6d296655e69b",
        "parentId" : "bed0bad3-6121-45c6-98bd-f4c893debe22",
        "authorId" : "45f6574e-09ec-49ee-afb4-9d73db285448",
        "body" : "Added udf there",
        "createdAt" : "2019-07-18T09:03:00Z",
        "updatedAt" : "2019-07-18T12:16:44Z",
        "lastEditedBy" : "45f6574e-09ec-49ee-afb4-9d73db285448",
        "tags" : [
        ]
      }
    ],
    "commit" : "f979a47674c589b34fcf7e988311e89b1c67821c",
    "line" : 246,
    "diffHunk" : "@@ -1,1 +244,248 @@  SELECT course, earnings, udf(year) as year, a\n  FROM courseSales\n  JOIN yearsWithComplexTypes ON year = y\n)\nPIVOT ("
  },
  {
    "id" : "a681bf6c-141d-4839-8422-58cf16e72965",
    "prId" : 25122,
    "prUrl" : "https://github.com/apache/spark/pull/25122#pullrequestreview-263601820",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ab99b305-19e1-4a8c-a216-01b3605f6f64",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "I can test it by myself but I thought you know the results - just out of curiosity,  what do we get if we do `FOR udf(course)`?",
        "createdAt" : "2019-07-18T11:35:12Z",
        "updatedAt" : "2019-07-18T12:16:44Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "2b3222cf-7611-4475-ab2d-14fd56a77be7",
        "parentId" : "ab99b305-19e1-4a8c-a216-01b3605f6f64",
        "authorId" : "45f6574e-09ec-49ee-afb4-9d73db285448",
        "body" : "`FOR udf(course)` in line 29 will result in a `org.apache.spark.sql.catalyst.parser.ParseException`",
        "createdAt" : "2019-07-18T11:53:44Z",
        "updatedAt" : "2019-07-18T12:16:44Z",
        "lastEditedBy" : "45f6574e-09ec-49ee-afb4-9d73db285448",
        "tags" : [
        ]
      }
    ],
    "commit" : "f979a47674c589b34fcf7e988311e89b1c67821c",
    "line" : 29,
    "diffHunk" : "@@ -1,1 +27,31 @@PIVOT (\n  udf(sum(earnings))\n  FOR course IN ('dotNET', 'Java')\n);\n"
  }
]