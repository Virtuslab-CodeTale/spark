[
  {
    "id" : "8c7db30b-aada-4c75-bb28-35e760372036",
    "prId" : 31372,
    "prUrl" : "https://github.com/apache/spark/pull/31372#pullrequestreview-579025927",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c59c7530-2589-4371-b65f-22c571c1f3ca",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Why do we need this change?",
        "createdAt" : "2021-01-28T02:49:38Z",
        "updatedAt" : "2021-01-28T02:49:38Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "0ccc70ee-d87d-4a84-9b2f-8a285d95251b",
        "parentId" : "c59c7530-2589-4371-b65f-22c571c1f3ca",
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "The difference is introduced by `NonSQLExpression.sql` which use `toString` instead of `sql` and `Cast` has different implementation between `toString` and `sql`. Then the change happened.  Is this get your point ?",
        "createdAt" : "2021-01-28T02:59:00Z",
        "updatedAt" : "2021-01-28T02:59:00Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      },
      {
        "id" : "26e8f3fc-a99e-412f-9297-1c6ee098d163",
        "parentId" : "c59c7530-2589-4371-b65f-22c571c1f3ca",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Why do we couple this with `NonSQLExpression`? Can we change `AnsiCast.sql` directly?",
        "createdAt" : "2021-01-29T06:44:40Z",
        "updatedAt" : "2021-01-29T06:44:40Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "932b6463-a481-41ff-bf2d-b79623c9a145",
        "parentId" : "c59c7530-2589-4371-b65f-22c571c1f3ca",
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "Not couple them, just follow the semantics of `NonSQLExpression` to make child toString instead of sql. `AnsiCast` could be seen as an another issue.\r\n\r\nYou mean we could override `CastBase.sql` to print `ansi_cast` like what `CastBase.toString` do ? Seems we have not provided a public api to user with `AnsiCast`. I wonder if `AnsiCast` is only used in Spark internal and not exposed.",
        "createdAt" : "2021-01-29T08:17:03Z",
        "updatedAt" : "2021-01-29T08:17:03Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      }
    ],
    "commit" : "deaa5351e36996ff5b3bb19a245710881918610c",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +110,114 @@SELECT udf(stddev_pop(CAST(b AS Decimal(38,0)))) FROM aggtest\n-- !query schema\nstruct<udf(stddev_pop(ansi_cast(b as decimal(38,0)))):double>\n-- !query output\n131.18117242958306"
  }
]