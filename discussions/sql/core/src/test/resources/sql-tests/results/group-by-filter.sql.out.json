[
  {
    "id" : "21bf3996-b4d6-4280-b8c0-71f3a1fd02d3",
    "prId" : 31368,
    "prUrl" : "https://github.com/apache/spark/pull/31368#pullrequestreview-578940407",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "83a30687-3ee9-43d1-b0e4-c5bb03ca4edc",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "There are some newly added `cast`. Are they redundant?",
        "createdAt" : "2021-01-28T21:04:33Z",
        "updatedAt" : "2021-01-29T04:46:03Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "e6768921-f23c-4b56-9f46-4b83d773f735",
        "parentId" : "83a30687-3ee9-43d1-b0e4-c5bb03ca4edc",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Redundant casts in an analyzing phase looks fine to me.",
        "createdAt" : "2021-01-29T00:59:55Z",
        "updatedAt" : "2021-01-29T04:46:03Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "14f892cd-0693-43e1-b1df-65e2ed956a0a",
        "parentId" : "83a30687-3ee9-43d1-b0e4-c5bb03ca4edc",
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "Can we add a rule at the end of `Analyzer` if the plan is resolved to check the top `Project` and reduce the`Cast` if is redundant ? The UpCast seems to avoid the table reference changed before view analysis but we can remove it after analysis.",
        "createdAt" : "2021-01-29T01:40:51Z",
        "updatedAt" : "2021-01-29T04:46:03Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      },
      {
        "id" : "02cd116f-aa09-45a7-b683-61c8aba9455a",
        "parentId" : "83a30687-3ee9-43d1-b0e4-c5bb03ca4edc",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "It's better to delay the cast adding (after the parsed view plan is resolved), so that we can skip adding cast for views that have no schema changing. But I can't find an easy way to do it and this is really not a big deal (optimizer willl remove redundant casts), so I go with the simple approach for maintainability.",
        "createdAt" : "2021-01-29T04:41:22Z",
        "updatedAt" : "2021-01-29T04:46:03Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "13aef54f-0cb4-40d0-9c48-ec0398ef735b",
        "parentId" : "83a30687-3ee9-43d1-b0e4-c5bb03ca4edc",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "sounds okay.",
        "createdAt" : "2021-01-29T04:53:58Z",
        "updatedAt" : "2021-01-29T04:53:58Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "2aebf0516f146456e4567612db8823fc3407641b",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +797,801 @@:        +- SubqueryAlias dept\n:           +- View (`DEPT`, [dept_id#x,dept_name#x,state#x])\n:              +- Project [cast(dept_id#x as int) AS dept_id#x, cast(dept_name#x as string) AS dept_name#x, cast(state#x as string) AS state#x]\n:                 +- Project [dept_id#x, dept_name#x, state#x]\n:                    +- SubqueryAlias DEPT"
  }
]