[
  {
    "id" : "f561e014-d4ed-408b-93e9-df4ca638d679",
    "prId" : 32470,
    "prUrl" : "https://github.com/apache/spark/pull/32470#pullrequestreview-680572384",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "499446fd-2479-4be0-86a9-c256a701679d",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "This is a more correct plan. If you look at other tests in this file, `test(\"grouping function\")` and `test(\"filter with grouping function\")`, they both expect plans to group by `gid` first, then calculate the grouping function (which is `grouping_a`) in agg list or the filter node above.",
        "createdAt" : "2021-06-10T09:44:27Z",
        "updatedAt" : "2021-06-10T09:44:27Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "b362a098978be65ab1fc033fe0213a78a467b6ae",
    "line" : 8,
    "diffHunk" : "@@ -1,1 +290,294 @@      Seq(SortOrder(grouping_a, Ascending)), true,\n      Aggregate(Seq(a, b, gid),\n        Seq(a, b, gid),\n        Expand(\n          Seq(Seq(a, b, c, nulInt, nulStr, 3L), Seq(a, b, c, a, nulStr, 1L),"
  },
  {
    "id" : "d90d0ba4-5651-4eb7-93c1-b2f4930bd539",
    "prId" : 25300,
    "prUrl" : "https://github.com/apache/spark/pull/25300#pullrequestreview-269988343",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "74bc71e0-b0bb-4aa4-9e5b-6367fa5e295c",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Why you changed this? You hit some test failures?",
        "createdAt" : "2019-08-02T02:21:55Z",
        "updatedAt" : "2019-08-02T07:09:25Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "1d8dca62-1404-43bb-b32a-81fe6d0667a3",
        "parentId" : "74bc71e0-b0bb-4aa4-9e5b-6367fa5e295c",
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "In line 38\r\n```\r\nlazy val grouping_a = Cast(ShiftRight(gid, 1) & 1, ByteType, Option(TimeZone.getDefault().getID))\r\n```\r\nThe grouping expr is casting a integer to byte, so the nullability is true.",
        "createdAt" : "2019-08-02T05:19:25Z",
        "updatedAt" : "2019-08-02T07:09:25Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      }
    ],
    "commit" : "63a6e62dd127f1d774ddf6c823527276d481af1d",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +286,290 @@        Seq(unresolved_a, unresolved_b), r1, Seq(unresolved_a, unresolved_b)))\n    val expected = Project(Seq(a, b), Sort(\n      Seq(SortOrder('aggOrder.byte.withNullability(true), Ascending)), true,\n      Aggregate(Seq(a, b, gid),\n        Seq(a, b, grouping_a.as(\"aggOrder\")),"
  }
]