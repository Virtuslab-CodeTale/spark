[
  {
    "id" : "1ae7bd56-9d11-4901-98ed-c430b4cc2041",
    "prId" : 31789,
    "prUrl" : "https://github.com/apache/spark/pull/31789#pullrequestreview-609440083",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "caf8e820-1357-4906-931a-b2dfb41f2736",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "`UnaryMinus` has the `failOnError` flag as well. Shall we move it inside as well? ",
        "createdAt" : "2021-03-11T06:54:55Z",
        "updatedAt" : "2021-03-11T07:12:09Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "3994b6976fdf5e97bf47a88d8d176392319e946e",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +580,584 @@\n  test(\"SPARK-34677: exact add and subtract of day-time and year-month intervals\") {\n    Seq(true, false).foreach { failOnError =>\n      checkExceptionInExpression[ArithmeticException](\n        UnaryMinus("
  },
  {
    "id" : "01cd3459-56e1-493b-a98a-eb9a6c7b0d98",
    "prId" : 25136,
    "prUrl" : "https://github.com/apache/spark/pull/25136#pullrequestreview-273419336",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c31f8494-5c59-4811-bfd1-f39666b46bfb",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "We need to support decimals for this divide in the legacy mode, too?",
        "createdAt" : "2019-08-10T08:34:50Z",
        "updatedAt" : "2019-08-20T12:52:29Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "87ae8400-8410-42d0-b97a-dc43bc44d10e",
        "parentId" : "c31f8494-5c59-4811-bfd1-f39666b46bfb",
        "authorId" : "24e1dd39-ae3f-4bbb-a391-f60afb62d075",
        "body" : "I think it is good for consistency",
        "createdAt" : "2019-08-10T09:38:00Z",
        "updatedAt" : "2019-08-20T12:52:29Z",
        "lastEditedBy" : "24e1dd39-ae3f-4bbb-a391-f60afb62d075",
        "tags" : [
        ]
      }
    ],
    "commit" : "8caf4a95376623bd6f1e3e999c49be69e726852e",
    "line" : 26,
    "diffHunk" : "@@ -1,1 +421,425 @@        null)\n    }\n    withSQLConf(SQLConf.LEGACY_INTEGRALDIVIDE_RETURN_LONG.key -> \"true\") {\n      checkEvaluation(IntegralDivide(Literal(Decimal(1)), Literal(Decimal(2))), 0L)\n      checkEvaluation(IntegralDivide(Literal(Decimal(1.4)), Literal(Decimal(0.6))), 2L)"
  },
  {
    "id" : "7cb0fe48-558e-4490-a01a-4f55c82312a4",
    "prId" : 25136,
    "prUrl" : "https://github.com/apache/spark/pull/25136#pullrequestreview-276709333",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "dfe17369-7f8d-4cb1-9342-37e66871d1f8",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "How about checking the case where `nullOnOverflow` = true?",
        "createdAt" : "2019-08-19T01:59:25Z",
        "updatedAt" : "2019-08-20T12:52:30Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "f54509af-ba35-43ef-8be1-aa58da681df0",
        "parentId" : "dfe17369-7f8d-4cb1-9342-37e66871d1f8",
        "authorId" : "24e1dd39-ae3f-4bbb-a391-f60afb62d075",
        "body" : "why? this doesn't overflow. I don't see the reason for that",
        "createdAt" : "2019-08-19T17:37:05Z",
        "updatedAt" : "2019-08-20T12:52:30Z",
        "lastEditedBy" : "24e1dd39-ae3f-4bbb-a391-f60afb62d075",
        "tags" : [
        ]
      }
    ],
    "commit" : "8caf4a95376623bd6f1e3e999c49be69e726852e",
    "line" : 18,
    "diffHunk" : "@@ -1,1 +413,417 @@      checkEvaluation(IntegralDivide(Literal(Decimal(1.2)), Literal(Decimal(1.1))), Decimal(1))\n      checkEvaluation(IntegralDivide(Literal(Decimal(1.2)), Literal(Decimal(0.0))), null)\n      checkEvaluation(DecimalPrecision.decimalAndDecimal.apply(IntegralDivide(\n        Literal(Decimal(\"99999999999999999999999999999999999\")), Literal(Decimal(0.001)))),\n        BigDecimal(\"99999999999999999999999999999999999000\"))"
  },
  {
    "id" : "6bde4e84-3a72-4540-a0b5-779cac14a81f",
    "prId" : 25136,
    "prUrl" : "https://github.com/apache/spark/pull/25136#pullrequestreview-276949340",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e1c22616-49c9-4d6d-99aa-5d47e926f3c2",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "if we add more digits, can this overflow?",
        "createdAt" : "2019-08-20T06:07:05Z",
        "updatedAt" : "2019-08-20T12:52:30Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "acb443be-2898-4bcb-abf1-86b093502bd4",
        "parentId" : "e1c22616-49c9-4d6d-99aa-5d47e926f3c2",
        "authorId" : "24e1dd39-ae3f-4bbb-a391-f60afb62d075",
        "body" : "No, we cannot overflow in this operation. Please see the code comment at https://github.com/apache/spark/pull/25136#discussion_r315016848",
        "createdAt" : "2019-08-20T06:15:57Z",
        "updatedAt" : "2019-08-20T12:52:30Z",
        "lastEditedBy" : "24e1dd39-ae3f-4bbb-a391-f60afb62d075",
        "tags" : [
        ]
      }
    ],
    "commit" : "8caf4a95376623bd6f1e3e999c49be69e726852e",
    "line" : 19,
    "diffHunk" : "@@ -1,1 +414,418 @@      checkEvaluation(IntegralDivide(Literal(Decimal(1.2)), Literal(Decimal(0.0))), null)\n      checkEvaluation(DecimalPrecision.decimalAndDecimal.apply(IntegralDivide(\n        Literal(Decimal(\"99999999999999999999999999999999999\")), Literal(Decimal(0.001)))),\n        BigDecimal(\"99999999999999999999999999999999999000\"))\n      // overflow during promote precision"
  }
]