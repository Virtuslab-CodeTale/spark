[
  {
    "id" : "9bc6f1bd-1adb-4236-9594-070a0e8cbff5",
    "prId" : 33354,
    "prUrl" : "https://github.com/apache/spark/pull/33354#pullrequestreview-707072084",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b9ea5ad3-a247-4d21-9c6e-2e3851e12899",
        "parentId" : null,
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "LGTM.",
        "createdAt" : "2021-07-15T08:29:54Z",
        "updatedAt" : "2021-07-15T08:29:59Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "867b2f79d111117bc403e7576f371eb54fc1d922",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +99,103 @@  test(\"datetime function localtimestamp\") {\n    // Verify with multiple outstanding time zones which has no daylight saving time.\n    Seq(\"UTC\", \"Africa/Dakar\", \"Asia/Hong_Kong\").foreach { zid =>\n      val zoneId = DateTimeUtils.getZoneId(zid)\n      val ct = LocalTimestamp(Some(zid)).eval(EmptyRow).asInstanceOf[Long]"
  },
  {
    "id" : "e90f1ee4-94a3-45c4-9dcf-d3b0ab3934c5",
    "prId" : 33346,
    "prUrl" : "https://github.com/apache/spark/pull/33346#pullrequestreview-706958946",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "fa0f3130-381b-44f4-a450-492286c1e839",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "What if the test runs during daylight saving time? So, the diff can be 1 hour.",
        "createdAt" : "2021-07-14T18:13:24Z",
        "updatedAt" : "2021-07-14T18:13:36Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "9680b03f-fb15-4267-9f04-ff2565e58c5e",
        "parentId" : "fa0f3130-381b-44f4-a450-492286c1e839",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "only test it on UTC then?",
        "createdAt" : "2021-07-15T01:56:53Z",
        "updatedAt" : "2021-07-15T01:56:53Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "8dd6115e-da62-4120-a3c4-e367eaa33abb",
        "parentId" : "fa0f3130-381b-44f4-a450-492286c1e839",
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "If the execution time is 8ms, the chance to hit daylight saving time is less than 8/(365 * 24 * 3600 * 1000)..The operation should be finished in 1 second. I can filter \"PST\" and \"LA\" if you really want to avoid it. WDYT?",
        "createdAt" : "2021-07-15T03:16:31Z",
        "updatedAt" : "2021-07-15T03:17:40Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      },
      {
        "id" : "5e650405-517c-4542-b789-3416f92688c8",
        "parentId" : "fa0f3130-381b-44f4-a450-492286c1e839",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "There is only a momentary chance of reaching daylight saving time every year.",
        "createdAt" : "2021-07-15T03:23:46Z",
        "updatedAt" : "2021-07-15T03:23:46Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      },
      {
        "id" : "991981cc-069c-4ede-b2ee-bb5721cff6c8",
        "parentId" : "fa0f3130-381b-44f4-a450-492286c1e839",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Actually the current_timestamp test has the same DST issue and the test is working pretty well. It should be fine.",
        "createdAt" : "2021-07-15T03:30:02Z",
        "updatedAt" : "2021-07-15T03:30:02Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "ea699d2a-e606-4935-8fa7-9c846e2b80b5",
        "parentId" : "fa0f3130-381b-44f4-a450-492286c1e839",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "> If the execution time is 8ms, the chance to hit daylight saving time is less than 8/(365 * 24 * 3600 * 1000)\r\n\r\n@gengliangwang This is wrong. You should take into account all runs in forks (not only OSS).\r\n\r\n> Actually the current_timestamp test has the same DST issue ...\r\n\r\n@cloud-fan Don't think so. Could you explain me, please, how the result of `current_timestamp` is shifted during DST.\r\n\r\nFYI, I have already fixed a few tests during DST. You can look for fixes to OSS during LA DST, like https://github.com/apache/spark/pull/27474",
        "createdAt" : "2021-07-15T05:04:14Z",
        "updatedAt" : "2021-07-15T05:04:14Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "6bc30fcc-8980-4e1a-8c84-acfbc4abe4c9",
        "parentId" : "fa0f3130-381b-44f4-a450-492286c1e839",
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "@MaxGekk since you insist, I created https://github.com/apache/spark/pull/33354 to address your comment.",
        "createdAt" : "2021-07-15T06:07:21Z",
        "updatedAt" : "2021-07-15T06:07:21Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      }
    ],
    "commit" : "ea49929210e640f479a71af27abb8da7f7cf1d76",
    "line" : 10,
    "diffHunk" : "@@ -1,1 +102,106 @@      val ct = LocalTimestamp(Some(zid)).eval(EmptyRow).asInstanceOf[Long]\n      val t1 = DateTimeUtils.localDateTimeToMicros(LocalDateTime.now(zoneId))\n      assert(math.abs(t1 - ct) < 1000000)\n    }\n  }"
  },
  {
    "id" : "165efe66-f9ff-4380-83e6-69f1da7f078a",
    "prId" : 33258,
    "prUrl" : "https://github.com/apache/spark/pull/33258#pullrequestreview-706870171",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "542df3c0-045a-452d-a95a-5632e9208aee",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "This fails at GitHub Action sometime.\r\n- master: https://github.com/apache/spark/runs/3070497510\r\n- branch-3.2: https://github.com/apache/spark/runs/3065336986",
        "createdAt" : "2021-07-14T21:06:43Z",
        "updatedAt" : "2021-07-14T21:08:32Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "ac9bcdd3-b8eb-449f-89cc-2ba98c364eca",
        "parentId" : "542df3c0-045a-452d-a95a-5632e9208aee",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "Thank you for reminder.",
        "createdAt" : "2021-07-15T02:31:06Z",
        "updatedAt" : "2021-07-15T02:31:06Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "998089cd0f1c2368e5a2b2773651836561a0a209",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +97,101 @@  }\n\n  test(\"datetime function localtimestamp\") {\n    outstandingTimezonesIds.foreach { zid =>\n      val ct = LocalTimestamp(Some(zid)).eval(EmptyRow).asInstanceOf[Long]"
  },
  {
    "id" : "fdd21f04-928c-4e38-b06f-10e379ba33dc",
    "prId" : 33229,
    "prUrl" : "https://github.com/apache/spark/pull/33229#pullrequestreview-699828422",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "40c35719-8cd1-47c2-a464-9596a988ed2f",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Where is `i` used?",
        "createdAt" : "2021-07-06T10:58:06Z",
        "updatedAt" : "2021-07-06T10:58:11Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "06019d67-4670-4cb3-84f9-bbfeb4201715",
        "parentId" : "40c35719-8cd1-47c2-a464-9596a988ed2f",
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "It is not used. ",
        "createdAt" : "2021-07-06T11:04:58Z",
        "updatedAt" : "2021-07-06T11:04:58Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      },
      {
        "id" : "db07a685-dca6-48d6-8783-d98afbd428e6",
        "parentId" : "40c35719-8cd1-47c2-a464-9596a988ed2f",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Why? What is the reason to test the same `HOUR_OF_DAY ` multiple times?",
        "createdAt" : "2021-07-06T11:07:05Z",
        "updatedAt" : "2021-07-06T11:07:05Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "a65c0e33-639c-4346-bfe4-aefcefc72896",
        "parentId" : "40c35719-8cd1-47c2-a464-9596a988ed2f",
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "> Why? What is the reason to test the same HOUR_OF_DAY multiple times?\r\n\r\nThe HOUR_OF_DAY is increasing in the loop. I am simply following the original logic.\r\n",
        "createdAt" : "2021-07-06T11:10:20Z",
        "updatedAt" : "2021-07-06T11:10:20Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      },
      {
        "id" : "b55334fa-8e8e-4a7c-b700-34a1b661578c",
        "parentId" : "40c35719-8cd1-47c2-a464-9596a988ed2f",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "ah, I see. Thanks.",
        "createdAt" : "2021-07-06T11:14:47Z",
        "updatedAt" : "2021-07-06T11:14:47Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "3227ca9ec91965dd216ed5fcaa4379d01f85f736",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +125,129 @@      (0 to 11 by 11).foreach { m =>\n        c.set(y, m, 28)\n        (0 to 12).foreach { i =>\n          c.add(Calendar.HOUR_OF_DAY, 10)\n          checkEvaluation(Year(Literal(new Date(c.getTimeInMillis))),"
  }
]