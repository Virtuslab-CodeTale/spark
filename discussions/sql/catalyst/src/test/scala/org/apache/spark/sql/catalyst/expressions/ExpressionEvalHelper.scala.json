[
  {
    "id" : "95013ed1-3ede-428f-98d8-31eee6cccf30",
    "prId" : 25745,
    "prUrl" : "https://github.com/apache/spark/pull/25745#pullrequestreview-286258093",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3001a59f-2f18-4676-8784-2c01bc70def0",
        "parentId" : null,
        "authorId" : "a11722a8-ecfa-4827-88e3-4d708f023846",
        "body" : "This change was needed because we can't do direct `equals()` comparison between UnsafeRow and other row classes. After this PR's changes, the _\"SPARK-14793: split wide struct creation into blocks due to JVM code size limit\"_ test case in `CodeGenerationSuite` was failing because the new code was producing `UnsafeRow` but the test code was comparing against `GenericInternalRow`. In the old code, this comparison between sequences of rows was happening in the default `case _ =>` below, but that case doesn't work when the `InternalRow` implementations are mismatched.\r\n\r\nI'm not sure whether this change-of-internal-row-format will have adverse consequences in other parts of the code.",
        "createdAt" : "2019-09-10T15:50:49Z",
        "updatedAt" : "2019-09-10T15:50:49Z",
        "lastEditedBy" : "a11722a8-ecfa-4827-88e3-4d708f023846",
        "tags" : [
        ]
      }
    ],
    "commit" : "d3925bc02604fdb7223091c066018b2142c38753",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +139,143 @@        if (expected.isNaN) result.isNaN else expected == result\n      case (result: Row, expected: InternalRow) => result.toSeq == expected.toSeq(result.schema)\n      case (result: Seq[InternalRow], expected: Seq[InternalRow]) =>\n        result.size == expected.size && result.zip(expected).forall { case (r, e) =>\n          checkResult(r, e, exprDataType, exprNullable)"
  }
]