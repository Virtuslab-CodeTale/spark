[
  {
    "id" : "db450853-fc0c-499c-9756-12f778906c47",
    "prId" : 32898,
    "prUrl" : "https://github.com/apache/spark/pull/32898#pullrequestreview-682606880",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ae0baeea-0ffb-43b3-aeb2-17f9240b1f2b",
        "parentId" : null,
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "@pingsutw could you test multiple time zone as the default, similar to https://github.com/apache/spark/pull/32878?\r\nAlso, we should test input strings with time zone like `2021-06-14 15:01:24+08:00` as well, which expects `2021-06-14 15:01:24`.",
        "createdAt" : "2021-06-14T07:02:13Z",
        "updatedAt" : "2021-06-14T07:02:24Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      },
      {
        "id" : "d07a8e87-22fc-474e-99fc-4aa5f88e89ba",
        "parentId" : "ae0baeea-0ffb-43b3-aeb2-17f9240b1f2b",
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "As I mentioned in https://issues.apache.org/jira/browse/SPARK-35720, I don't think we can simply use `stringToTimestamp` here. You will find that when you have more test cases here.",
        "createdAt" : "2021-06-14T07:04:27Z",
        "updatedAt" : "2021-06-14T07:04:27Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      },
      {
        "id" : "28396dca-e7f4-47f5-8e4d-ed91719a8142",
        "parentId" : "ae0baeea-0ffb-43b3-aeb2-17f9240b1f2b",
        "authorId" : "ceeeb20a-de49-4bcb-b9cf-1347004fd842",
        "body" : "@gengliangwang thanks for the review. Will update ASAP.",
        "createdAt" : "2021-06-14T07:51:20Z",
        "updatedAt" : "2021-06-14T07:51:20Z",
        "lastEditedBy" : "ceeeb20a-de49-4bcb-b9cf-1347004fd842",
        "tags" : [
        ]
      }
    ],
    "commit" : "b17975f024fb0dd66ab60912aa4b63f5008ccea2",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +1298,1302 @@\n  test(\"SPARK-35720: Support casting of String to timestamp without time zone type\") {\n    specialTs.foreach { s =>\n      val expectedTs = LocalDateTime.parse(s)\n      checkEvaluation(cast(Literal(s), TimestampWithoutTZType), expectedTs)"
  },
  {
    "id" : "43759c38-9d82-4967-bd42-d11af1c323ae",
    "prId" : 32869,
    "prUrl" : "https://github.com/apache/spark/pull/32869#pullrequestreview-681070354",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "dc4b7657-8290-40bf-86bb-6141d36fba0b",
        "parentId" : null,
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "This is a trivial change for the test case. There is no need to replace the space.",
        "createdAt" : "2021-06-10T17:30:31Z",
        "updatedAt" : "2021-06-10T17:30:31Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      }
    ],
    "commit" : "dde4cd800a3d2e9aac55d05b5d99cc00fba0a2e6",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +1257,1261 @@  test(\"SPARK-35711: cast timestamp without time zone to timestamp with local time zone\") {\n    specialTs.foreach { s =>\n      val dt = LocalDateTime.parse(s)\n      checkEvaluation(cast(dt, TimestampType), DateTimeUtils.localDateTimeToMicros(dt))\n    }"
  },
  {
    "id" : "0493788b-e402-4376-a54d-8486d6f29847",
    "prId" : 32846,
    "prUrl" : "https://github.com/apache/spark/pull/32846#pullrequestreview-679874361",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "edba62df-56ae-40d3-9d89-2bae6bf8845c",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "can we put `T` in the strings directly?",
        "createdAt" : "2021-06-09T16:11:56Z",
        "updatedAt" : "2021-06-09T16:11:56Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "d9ea3260-5fed-437b-bb58-34de8ca0489d",
        "parentId" : "edba62df-56ae-40d3-9d89-2bae6bf8845c",
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "well, the result won't contain the \"T\", so we have to replace one of them eventually.\r\nThe test inputs are from https://github.com/apache/spark/blob/master/sql/catalyst/src/test/scala/org/apache/spark/sql/RandomDataGenerator.scala#L156",
        "createdAt" : "2021-06-09T16:14:21Z",
        "updatedAt" : "2021-06-09T16:14:21Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      },
      {
        "id" : "814e1076-139b-4072-b6af-fde5d7837cc2",
        "parentId" : "edba62df-56ae-40d3-9d89-2bae6bf8845c",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "ah I see, got it",
        "createdAt" : "2021-06-09T16:15:16Z",
        "updatedAt" : "2021-06-09T16:15:16Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "ec0b133846ea0cdabb14a30de1e77709053e9347",
    "line" : 32,
    "diffHunk" : "@@ -1,1 +1716,1720 @@      \"9999-12-31 23:59:59\"  // the last supported timestamp according to SQL standard\n    ).foreach { s =>\n      checkEvaluation(cast(LocalDateTime.parse(s.replace(\" \", \"T\")), StringType), s)\n    }\n  }"
  },
  {
    "id" : "9c9d862d-df7b-417b-85e9-bc8fd65be170",
    "prId" : 32266,
    "prUrl" : "https://github.com/apache/spark/pull/32266#pullrequestreview-648440471",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3daa7c08-c1e4-491d-b1b8-a677be9e5e1e",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Could you add round trip tests: string -> year-month interval -> string, and year-month interval -> string -> year-month interval",
        "createdAt" : "2021-04-21T08:36:21Z",
        "updatedAt" : "2021-04-30T02:48:22Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "060c5871-aeb6-44f7-81b7-6e1e2e4f4a3a",
        "parentId" : "3daa7c08-c1e4-491d-b1b8-a677be9e5e1e",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Could you test corner cases when arithmetic overflow happens. Also test upper and lower cases.",
        "createdAt" : "2021-04-21T08:42:44Z",
        "updatedAt" : "2021-04-30T02:48:22Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "4e2234f6-ed7a-4925-8fe9-2d1084a5a529",
        "parentId" : "3daa7c08-c1e4-491d-b1b8-a677be9e5e1e",
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "> Could you test corner cases when arithmetic overflow happens. Also test upper and lower cases.\r\n\r\nCurrent test is not correct according to https://github.com/apache/spark/pull/32281, will update after https://github.com/apache/spark/pull/32281 merged",
        "createdAt" : "2021-04-22T07:53:05Z",
        "updatedAt" : "2021-04-30T02:48:22Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      },
      {
        "id" : "f63d6dcb-3d2d-4248-940e-e6c7f4d921ae",
        "parentId" : "3daa7c08-c1e4-491d-b1b8-a677be9e5e1e",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Please, check the input in lower case.  For example:\r\n```scala\r\n    checkEvaluation(cast(Literal.create(\"  interval '1-0' YEAR TO MONTH  \"),\r\n      YearMonthIntervalType), 12)\r\n```",
        "createdAt" : "2021-04-29T16:53:33Z",
        "updatedAt" : "2021-04-30T02:48:23Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "5ca83abe001897216575fad9f00906de553626c6",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +1776,1780 @@  }\n\n  test(\"SPARK-35111: Cast string to year-month interval\") {\n    checkEvaluation(cast(Literal.create(\"INTERVAL '1-0' YEAR TO MONTH\"),\n      YearMonthIntervalType), 12)"
  },
  {
    "id" : "8c710948-2dc0-4ea7-99a0-ee2389764ab1",
    "prId" : 31775,
    "prUrl" : "https://github.com/apache/spark/pull/31775#pullrequestreview-606031136",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "069e3196-d2c6-47cc-97af-b22490c022c8",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "nit: It looks like we don't need to wrap `SQLConf.withExistingConf` now.",
        "createdAt" : "2021-03-08T07:49:10Z",
        "updatedAt" : "2021-03-08T07:49:11Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "6bfb870b9c1bb446c20ac5ae306efdf10a1ddb7a",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +964,968 @@    val activeConf = conf\n    ALL_TIMEZONES.foreach { zid =>\n      def checkCastWithParseError(str: String): Unit = {\n        checkExceptionInExpression[DateTimeException](\n          cast(Literal(str), TimestampType, Option(zid.getId)),"
  },
  {
    "id" : "c4391692-6212-42de-bbd0-ae1f4949f50f",
    "prId" : 31764,
    "prUrl" : "https://github.com/apache/spark/pull/31764#pullrequestreview-606043698",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0cc113d6-0966-4186-aec0-e020d0cc5cab",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "do we have to clone the conf here?",
        "createdAt" : "2021-03-08T04:50:10Z",
        "updatedAt" : "2021-03-08T04:50:10Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "156f9268-7779-48b9-b491-24d03c0ccea4",
        "parentId" : "0cc113d6-0966-4186-aec0-e020d0cc5cab",
        "authorId" : "99e31844-a5b3-48a2-af71-412edb607a13",
        "body" : "agree, I thought that this was a tentative workaround.",
        "createdAt" : "2021-03-08T07:26:45Z",
        "updatedAt" : "2021-03-08T07:26:46Z",
        "lastEditedBy" : "99e31844-a5b3-48a2-af71-412edb607a13",
        "tags" : [
        ]
      },
      {
        "id" : "44f33914-d26f-4b58-826d-a771738c3fb0",
        "parentId" : "0cc113d6-0966-4186-aec0-e020d0cc5cab",
        "authorId" : "99e31844-a5b3-48a2-af71-412edb607a13",
        "body" : "@dongjoon-hyun Can #31775 allow us to revert this?",
        "createdAt" : "2021-03-08T07:35:30Z",
        "updatedAt" : "2021-03-08T07:35:30Z",
        "lastEditedBy" : "99e31844-a5b3-48a2-af71-412edb607a13",
        "tags" : [
        ]
      },
      {
        "id" : "4c954592-2380-4345-96d3-96408db716a9",
        "parentId" : "0cc113d6-0966-4186-aec0-e020d0cc5cab",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "I think so.",
        "createdAt" : "2021-03-08T08:10:07Z",
        "updatedAt" : "2021-03-08T08:10:08Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "ed5c3c0aa37f2e660ec7fafe8ee014716f6ddacc",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +962,966 @@\n  test(\"ANSI mode: cast string to timestamp with parse error\") {\n    val activeConf = conf.clone()\n    new ParVector(ALL_TIMEZONES.toVector).foreach { zid =>\n      def checkCastWithParseError(str: String): Unit = {"
  },
  {
    "id" : "2a609665-ebee-4676-a531-d6f426413cb6",
    "prId" : 30540,
    "prUrl" : "https://github.com/apache/spark/pull/30540#pullrequestreview-540607365",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "01051acc-bc88-4781-87ef-546673f95ca5",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "It doesn't need to make a followup only to fix some nits. We can just do it when we happen to touch the codes around here.",
        "createdAt" : "2020-11-30T03:04:07Z",
        "updatedAt" : "2020-11-30T03:04:07Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "7fd78973-2bb0-4745-bc4a-ee7ff1dff850",
        "parentId" : "01051acc-bc88-4781-87ef-546673f95ca5",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "I am going to approve this PR for this time since it's already open but let's avoid next time.",
        "createdAt" : "2020-11-30T03:04:32Z",
        "updatedAt" : "2020-11-30T03:04:33Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "271d6c4b-84cc-4aba-849a-752e5d73785d",
        "parentId" : "01051acc-bc88-4781-87ef-546673f95ca5",
        "authorId" : "cce1c782-0596-44b6-8b99-6b77d2cca53c",
        "body" : "OK. I got it, will try my best to avoid such issue in future.",
        "createdAt" : "2020-11-30T05:28:58Z",
        "updatedAt" : "2020-11-30T05:28:59Z",
        "lastEditedBy" : "cce1c782-0596-44b6-8b99-6b77d2cca53c",
        "tags" : [
        ]
      }
    ],
    "commit" : "30257d89a3216698caf10c248cecd3c1d11586f8",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +972,976 @@        checkCastWithParseError(\"2015-031-8\")\n        checkCastWithParseError(\"2015-03-18T12:03:17-0:70\")\n        checkCastWithParseError(\"abdef\")\n      }\n    }"
  },
  {
    "id" : "12318761-eb55-4b3f-9924-d5e301a8bea7",
    "prId" : 30442,
    "prUrl" : "https://github.com/apache/spark/pull/30442#pullrequestreview-539976065",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4153dfc9-c575-49a4-a835-06eefc1b50e1",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "is it just `checkCastWithParseError(\"abdef\")`?",
        "createdAt" : "2020-11-27T13:22:17Z",
        "updatedAt" : "2020-11-27T13:22:18Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "e4fe5ee34b47bb5f57aad76fa41caa2c27eee53d",
    "line" : 67,
    "diffHunk" : "@@ -1,1 +957,961 @@\n        val input = \"abdef\"\n        checkExceptionInExpression[DateTimeException](\n          cast(input, TimestampType, Option(zid.getId)),\n          s\"Cannot cast $input to TimestampType.\")"
  }
]