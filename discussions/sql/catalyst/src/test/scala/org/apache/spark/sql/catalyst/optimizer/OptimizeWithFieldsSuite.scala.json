[
  {
    "id" : "dda4cc2d-cbb2-4b0e-a188-ffdab504d745",
    "prId" : 32338,
    "prUrl" : "https://github.com/apache/spark/pull/32338#pullrequestreview-644179273",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "24023c11-157c-4168-ad63-60bf506297f0",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "If you check the output data type, you can see the struct type is not different:\r\n\r\n```\r\noptimized: ArrayBuffer(StructType(StructField(a1,IntegerType,false), StructField(b1,IntegerType,false)))\r\ncorrectAnswer: ArrayBuffer(StructType(StructField(a1,IntegerType,false), StructField(b1,IntegerType,false)))\r\n```\r\n\r\nBy design, `UpdateFields` will keep the order of fields in struct expression.",
        "createdAt" : "2021-04-25T19:52:17Z",
        "updatedAt" : "2021-04-25T21:04:20Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "2ae7e1bd-d00c-470f-b5f3-0a676bd62ded",
        "parentId" : "24023c11-157c-4168-ad63-60bf506297f0",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "But yea, it looks better to keep original `WithField` order.",
        "createdAt" : "2021-04-25T20:11:27Z",
        "updatedAt" : "2021-04-25T21:04:20Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "4232e0d2-e9d6-4cf1-a12e-b10b76a0f308",
        "parentId" : "24023c11-157c-4168-ad63-60bf506297f0",
        "authorId" : "92aa9573-b64a-4a86-aebf-54c827df3ed0",
        "body" : "This was just to sanity check the WithField order does actually stay the same, the tests on the Column Suite show how it can actually give you an incorrect schema. I don't fully know how a schema is determined (what part of the planning phase)",
        "createdAt" : "2021-04-25T20:39:14Z",
        "updatedAt" : "2021-04-25T21:04:20Z",
        "lastEditedBy" : "92aa9573-b64a-4a86-aebf-54c827df3ed0",
        "tags" : [
        ]
      }
    ],
    "commit" : "23ee4282a5ace4b9adf16aaa060e9a7709b4bf71",
    "line" : 24,
    "diffHunk" : "@@ -1,1 +147,151 @@\n    comparePlans(optimized, correctAnswer)\n  }\n}"
  }
]