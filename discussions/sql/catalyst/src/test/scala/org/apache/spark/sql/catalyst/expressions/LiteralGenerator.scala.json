[
  {
    "id" : "e15112bc-054c-43e9-895f-218cea6a3654",
    "prId" : 31855,
    "prUrl" : "https://github.com/apache/spark/pull/31855#pullrequestreview-615670483",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f8ae3e45-3e5e-49af-85b7-77e1ca937141",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "This generator is used to test expressions like `random timestamp + random day-time interval`. I have to adjust the generator to have reasonable intervals, and prevent overflows.",
        "createdAt" : "2021-03-18T17:17:58Z",
        "updatedAt" : "2021-03-18T17:17:58Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "c851449fd6b76079a0e8694366e892c1833135c9",
    "line" : 11,
    "diffHunk" : "@@ -1,1 +165,169 @@\n  lazy val dayTimeIntervalLiteralGen: Gen[Literal] = {\n    calendarIntervalLiterGen.map { calendarIntervalLiteral =>\n      Literal.create(\n        calendarIntervalLiteral.value.asInstanceOf[CalendarInterval].extractAsDuration(),"
  },
  {
    "id" : "7185d723-ce32-47d8-90d9-37d66885f7ad",
    "prId" : 31812,
    "prUrl" : "https://github.com/apache/spark/pull/31812#pullrequestreview-610564663",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4d2f5335-14d6-4682-82e9-1bbad1a9397b",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "I restricted the range of random year-month intervals here because such interval are used in the tests for expressions like `date -/+ interval` where `date` is random too. If we don't restrict the range, we will just get the overflow exception in most cases. The code here is similar to https://github.com/apache/spark/blob/4ea27787bf96c83aeda4ff6d4b1d9b00cc189f7e/sql/catalyst/src/test/scala/org/apache/spark/sql/catalyst/expressions/LiteralGenerator.scala#L140-L143\r\n\r\nBTW, there is another random generator in `RandomDataGenerator` which doesn't have such restriction, and it can be used in other tests like saving/loading to datasources.",
        "createdAt" : "2021-03-12T08:50:03Z",
        "updatedAt" : "2021-03-12T08:51:28Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "058591bfad33006d13bcc091ab529a96e7b24890",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +177,181 @@  lazy val yearMonthIntervalLiteralGen: Gen[Literal] = {\n    for { months <- Gen.choose(-1 * maxIntervalInMonths, maxIntervalInMonths) }\n      yield Literal.create(Period.ofMonths(months), YearMonthIntervalType)\n  }\n"
  }
]