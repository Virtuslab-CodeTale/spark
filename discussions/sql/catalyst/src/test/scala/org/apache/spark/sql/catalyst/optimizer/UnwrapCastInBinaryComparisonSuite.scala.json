[
  {
    "id" : "e72b7b94-09b9-4c46-98d1-5a1eb74acfe3",
    "prId" : 32488,
    "prUrl" : "https://github.com/apache/spark/pull/32488#pullrequestreview-659143673",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9752455e-a6e5-44d9-9754-456f73a43aaa",
        "parentId" : null,
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "can we have tests for the case when a `EqualTo` is converted to a `And` clause?",
        "createdAt" : "2021-05-13T01:11:30Z",
        "updatedAt" : "2021-05-13T01:12:11Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      },
      {
        "id" : "f184c1c6-6055-4b01-8d2c-31d776e3feba",
        "parentId" : "9752455e-a6e5-44d9-9754-456f73a43aaa",
        "authorId" : "c12eb4aa-c39d-4fa9-8470-ed071c0be24a",
        "body" : "Sure, The second one `Cast(f, LongType).in(1.toLong, Int.MaxValue.toLong)` is for this case.",
        "createdAt" : "2021-05-13T03:46:50Z",
        "updatedAt" : "2021-05-13T03:46:50Z",
        "lastEditedBy" : "c12eb4aa-c39d-4fa9-8470-ed071c0be24a",
        "tags" : [
        ]
      },
      {
        "id" : "e503aa5a-0baf-4f13-bd5f-c24b9720c672",
        "parentId" : "9752455e-a6e5-44d9-9754-456f73a43aaa",
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "nit nit: perhaps remove `InSet` from `SPARK-35316: unwrap should support In/InSet predicate.` as we don't support it in this PR.",
        "createdAt" : "2021-05-13T17:41:03Z",
        "updatedAt" : "2021-05-13T17:46:36Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      }
    ],
    "commit" : "ea0ba385ec38b231a37f871cecf1ca9ffb852c3d",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +236,240 @@  }\n\n  test(\"SPARK-35316: unwrap should support In/InSet predicate.\") {\n    val longLit = Literal.create(null, LongType)\n    val intLit = Literal.create(null, IntegerType)"
  },
  {
    "id" : "45b4d537-3feb-4b21-a686-45ca5e7725b1",
    "prId" : 29792,
    "prUrl" : "https://github.com/apache/spark/pull/29792#pullrequestreview-494836753",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d397ee0f-555f-48cc-8d99-c2b98b34b2a6",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "is casting double to float rounding up or rounding down?",
        "createdAt" : "2020-09-23T05:59:54Z",
        "updatedAt" : "2020-10-12T20:16:06Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "ce67c72a-39f4-4ac3-8446-2bbc2832a64b",
        "parentId" : "d397ee0f-555f-48cc-8d99-c2b98b34b2a6",
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "it is rounding down, see below for a test on this.",
        "createdAt" : "2020-09-23T16:24:30Z",
        "updatedAt" : "2020-10-12T20:16:06Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      }
    ],
    "commit" : "76b9f73862380dda40b332b56464278bfb0b88d3",
    "line" : 33,
    "diffHunk" : "@@ -1,1 +80,84 @@\n    val d = Float.NegativeInfinity\n    assertEquivalent(castDouble(f2) > d.toDouble, f2 =!= d)\n    assertEquivalent(castDouble(f2) >= d.toDouble, trueIfNotNull(f2))\n    assertEquivalent(castDouble(f2) === d.toDouble, f2 === d)"
  },
  {
    "id" : "bf66eb93-ca30-4874-9991-f5d8fadc272a",
    "prId" : 29792,
    "prUrl" : "https://github.com/apache/spark/pull/29792#pullrequestreview-497948211",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "657c7bb8-fc09-4b96-aed6-f7eed49c8b0d",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "so casting double to float can be either rounding up or down, depend on the value?",
        "createdAt" : "2020-09-23T16:32:45Z",
        "updatedAt" : "2020-10-12T20:16:06Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "0d533d42-d5f9-4127-9f45-0fa6ad3907fc",
        "parentId" : "657c7bb8-fc09-4b96-aed6-f7eed49c8b0d",
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "@cloud-fan Sorry i was wrong in the above comment (somehow I was thinking casting from double to short there). \r\n\r\nYes, it appears that casting from double to float can be either rounding up or down, depending on value:\r\n\r\n```scala\r\nscala> val x = 0.39999999\r\nx: Double = 0.39999999\r\n\r\nscala> val y = x.toFloat\r\ny: Float = 0.39999998\r\n\r\nscala > val x = 0.49999999\r\ny: Double = 0.49999999\r\n\r\nscala> val y = x.toFloat\r\ny: Float = 0.5\r\n```\r\nTo clarify, here the round up is after casting roundtrip: double 3.14 -> float 3.14 -> double 3.14000010...",
        "createdAt" : "2020-09-23T17:08:42Z",
        "updatedAt" : "2020-10-12T20:16:06Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      },
      {
        "id" : "bdf5b8fd-77e7-4d4d-aa86-db32b064653b",
        "parentId" : "657c7bb8-fc09-4b96-aed6-f7eed49c8b0d",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "This is an important point. Can we explain how to know it's rounding up or down in the PR description?",
        "createdAt" : "2020-09-25T14:01:34Z",
        "updatedAt" : "2020-10-12T20:16:06Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "1941bdc4-fe80-460a-aafd-a9b3b68c422b",
        "parentId" : "657c7bb8-fc09-4b96-aed6-f7eed49c8b0d",
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "Yup, will do. This is a good point.",
        "createdAt" : "2020-09-25T22:22:10Z",
        "updatedAt" : "2020-10-12T20:16:06Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      },
      {
        "id" : "cde33733-03dc-4ad9-8535-58910a7bdd39",
        "parentId" : "657c7bb8-fc09-4b96-aed6-f7eed49c8b0d",
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "@cloud-fan updated the description. Please take another look. Thanks!",
        "createdAt" : "2020-09-28T22:42:27Z",
        "updatedAt" : "2020-10-12T20:16:06Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      }
    ],
    "commit" : "76b9f73862380dda40b332b56464278bfb0b88d3",
    "line" : 104,
    "diffHunk" : "@@ -1,1 +149,153 @@    assertEquivalent(castDouble(f) < doubleValue, f <= doubleValue.toShort)\n\n    // Cases for rounding up: 3.14 will be rounded to 3.14000010... after casting to float\n    doubleValue = 3.14\n    assertEquivalent(castDouble(f2) > doubleValue, f2 >= doubleValue.toFloat)"
  }
]