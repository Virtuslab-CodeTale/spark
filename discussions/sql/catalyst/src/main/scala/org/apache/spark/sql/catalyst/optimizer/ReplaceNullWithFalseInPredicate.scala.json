[
  {
    "id" : "f56c423a-2dc3-48e8-8bf6-71a435972d99",
    "prId" : 31797,
    "prUrl" : "https://github.com/apache/spark/pull/31797#pullrequestreview-610397809",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "224b5fc0-3753-4580-9437-7bef8ca6617e",
        "parentId" : null,
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "`null in (xxx)`  is a special case that we have already handled in `NullPropagation`, but it's better that return the same result whether other rule is excluded. We also add the `value` pattern here.",
        "createdAt" : "2021-03-11T04:24:33Z",
        "updatedAt" : "2021-03-12T02:15:15Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      },
      {
        "id" : "6608845f-9921-4afa-b59e-15beda6ab842",
        "parentId" : "224b5fc0-3753-4580-9437-7bef8ca6617e",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Can we add some comments to explain the rationale?\r\n\r\nif `value` is null, the IN result is null and thus `Not(null)` means false. If `value` is not null but the list contains null values, the IN result can be either `true` or `null`, and thus the final result after Not is always false as a predicate.",
        "createdAt" : "2021-03-11T13:41:00Z",
        "updatedAt" : "2021-03-12T02:15:15Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "ea1e17d9-e967-40fa-898e-f68881a29ab7",
        "parentId" : "224b5fc0-3753-4580-9437-7bef8ca6617e",
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "Yes, it's better to add the comment.",
        "createdAt" : "2021-03-12T02:16:05Z",
        "updatedAt" : "2021-03-12T02:16:05Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      }
    ],
    "commit" : "b61da86a30da85c87a9071ec38eb472c186bbd6b",
    "line" : 19,
    "diffHunk" : "@@ -1,1 +102,106 @@    // `1 not in (2, NULL)` -> NULL\n    // In predicate, NULL is equal to false, so we can simplify them to false directly.\n    case Not(In(value, list)) if (value +: list).exists(isNullLiteral) =>\n      FalseLiteral\n    case Not(InSet(value, list)) if isNullLiteral(value) || list.contains(null) =>"
  },
  {
    "id" : "481858d5-3388-4974-a209-084d13a2e8c3",
    "prId" : 30953,
    "prUrl" : "https://github.com/apache/spark/pull/30953#pullrequestreview-559293216",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2307a8f8-1ccb-40ae-9364-02f3ffaa8899",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "The change is needed here to not fail the existing tests. When we convert `If` to `EqualNullSafe`, we should make sure the rule `ReplaceNullWithFalseInPredicate` still applies.",
        "createdAt" : "2020-12-28T18:34:54Z",
        "updatedAt" : "2020-12-28T18:34:54Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "54113fea-1b55-4709-abbf-e5d6e8a7c262",
        "parentId" : "2307a8f8-1ccb-40ae-9364-02f3ffaa8899",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "It would be great if someone can pull this out and open a separated PR/JIRA. Otherwise, I'll do it tomorrow.",
        "createdAt" : "2020-12-28T18:36:02Z",
        "updatedAt" : "2020-12-28T18:36:03Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "2eaed4dc-eefe-4125-8057-a8b1b259f77d",
        "parentId" : "2307a8f8-1ccb-40ae-9364-02f3ffaa8899",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "`NullPropagation` should optimize `EqualNullSafe(null, TrueLiteral)` to false too, isn't?",
        "createdAt" : "2020-12-28T20:06:29Z",
        "updatedAt" : "2020-12-28T20:06:29Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "5cb1c6cf-aca8-4fe7-9ab6-1f9853cdce0a",
        "parentId" : "2307a8f8-1ccb-40ae-9364-02f3ffaa8899",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "It can, but not with `And`, e.g.  `EqualNullSafe(col && null, true)` => `EqualNullSafe(col && false, true)` => `EqualNullSafe(false, true)` => `false`.",
        "createdAt" : "2020-12-28T20:12:27Z",
        "updatedAt" : "2020-12-28T20:12:27Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "12b0739e-7a02-4424-be1a-00a8f1d980b6",
        "parentId" : "2307a8f8-1ccb-40ae-9364-02f3ffaa8899",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Oh I see. Makes sense.",
        "createdAt" : "2020-12-28T20:32:27Z",
        "updatedAt" : "2020-12-28T20:32:27Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "34a5628b9f53d220f7e4ad30509ae8d97a6d32e9",
    "line" : 18,
    "diffHunk" : "@@ -1,1 +58,62 @@      // For `EqualNullSafe` with a `TrueLiteral`, whether the other side is null or false has no\n      // difference, as `null <=> true` and `false <=> true` both return false.\n      case EqualNullSafe(left, TrueLiteral) =>\n        EqualNullSafe(replaceNullWithFalse(left), TrueLiteral)\n      case EqualNullSafe(TrueLiteral, right) =>"
  }
]