[
  {
    "id" : "78a448d1-d70b-42ef-98c1-e135e1e8c957",
    "prId" : 32494,
    "prUrl" : "https://github.com/apache/spark/pull/32494#pullrequestreview-658542065",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2e52055a-00a7-4ecf-9410-55c4bc9dae0f",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "The `estimate` method is a bit too long, so how about splitting it into smaller functions?",
        "createdAt" : "2021-05-13T01:33:14Z",
        "updatedAt" : "2021-05-13T01:34:56Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "1b188128-4de1-4ab5-83e4-0ebddf087da9",
        "parentId" : "2e52055a-00a7-4ecf-9410-55c4bc9dae0f",
        "authorId" : "d0d56018-475d-4da3-93a6-5e843402b7f2",
        "body" : "Done. I have splitted it to smaller methods",
        "createdAt" : "2021-05-13T02:52:37Z",
        "updatedAt" : "2021-05-13T02:52:37Z",
        "lastEditedBy" : "d0d56018-475d-4da3-93a6-5e843402b7f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "06fbbec02072e91cb859d5df90246dfa336a3d50",
    "line" : 92,
    "diffHunk" : "@@ -1,1 +122,126 @@    }\n  }\n\n  private def computeNullCountStats(union: Union): Seq[(Attribute, ColumnStat)] = {\n    val unionOutput = union.output"
  },
  {
    "id" : "d2935d74-7d2e-44a5-a7b8-813fe4e0da0f",
    "prId" : 30334,
    "prUrl" : "https://github.com/apache/spark/pull/30334#pullrequestreview-540377278",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "83ad1b1c-c556-4c72-a71e-c17b219f7bf7",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Could you leave some comments about how to estimate `Union` stats here?",
        "createdAt" : "2020-11-15T11:56:43Z",
        "updatedAt" : "2021-03-12T16:39:52Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "b6ded9a4-e6c4-4b6f-be24-29ffa9bb5739",
        "parentId" : "83ad1b1c-c556-4c72-a71e-c17b219f7bf7",
        "authorId" : "be513b7c-2bbe-4a99-bff2-74592b215b5d",
        "body" : "Added comment",
        "createdAt" : "2020-11-28T14:00:52Z",
        "updatedAt" : "2021-03-12T16:39:52Z",
        "lastEditedBy" : "be513b7c-2bbe-4a99-bff2-74592b215b5d",
        "tags" : [
        ]
      }
    ],
    "commit" : "9eb4b7054c7185cd7dd665797188ad236ff78e43",
    "line" : 31,
    "diffHunk" : "@@ -1,1 +29,33 @@ * column coming from its children.\n */\nobject UnionEstimation {\n  import EstimationUtils._\n"
  },
  {
    "id" : "c70e92fa-ff37-45f6-b391-e782be510903",
    "prId" : 30334,
    "prUrl" : "https://github.com/apache/spark/pull/30334#pullrequestreview-555940552",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b1624347-8993-4c2f-b0eb-c3825db77fbb",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "How about checking if we need to compute min/max stats before computing them?\r\n```\r\n    val childrenToComputeMinMaxStats = union.children.map(_.output)\r\n        .transpose.zipWithIndex.filter { case (attrs, _) =>\r\n      supportedType(attrs.head.dataType) &&\r\n        // Checks if all the children have min/max stats\r\n        attrs.zipWithIndex.forall { case (attr, childIndex) =>\r\n          val attrStats = union.children(childIndex).stats.attributeStats\r\n          attrStats.get(attr).isDefined && attrStats(attr).hasMinMaxStats\r\n        }\r\n    }\r\n    val newAttrStats = if (childrenToComputeMinMaxStats.nonEmpty) {\r\n      // Compute min/max stats\r\n    } else {\r\n      AttributeMap.empty[ColumnStat]\r\n    }\r\n```",
        "createdAt" : "2020-11-29T07:24:07Z",
        "updatedAt" : "2021-03-12T16:39:52Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "6c49d0bf-c12b-48fc-86fc-914ebdba9a38",
        "parentId" : "b1624347-8993-4c2f-b0eb-c3825db77fbb",
        "authorId" : "be513b7c-2bbe-4a99-bff2-74592b215b5d",
        "body" : "Changed",
        "createdAt" : "2020-12-19T13:07:21Z",
        "updatedAt" : "2021-03-12T16:39:52Z",
        "lastEditedBy" : "be513b7c-2bbe-4a99-bff2-74592b215b5d",
        "tags" : [
        ]
      }
    ],
    "commit" : "9eb4b7054c7185cd7dd665797188ad236ff78e43",
    "line" : 81,
    "diffHunk" : "@@ -1,1 +79,83 @@          case (attr, childIndex) =>\n            val attrStats = union.children(childIndex).stats.attributeStats\n            attrStats.get(attr).isDefined && attrStats(attr).hasMinMaxStats\n        }\n    }"
  }
]