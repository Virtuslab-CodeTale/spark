[
  {
    "id" : "dd9a8d77-5072-4507-abbe-b79cfdaac0d5",
    "prId" : 33728,
    "prUrl" : "https://github.com/apache/spark/pull/33728#pullrequestreview-729707972",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f88967ef-f6ba-45ac-a728-68902ae3407c",
        "parentId" : null,
        "authorId" : "a2fcc15e-a51a-42f0-87a6-137048a28e30",
        "body" : "@cloud-fan Thanks for the fix !! I am thinking, do we need cases for Array and Map types ? Like for cases.\r\nStruct<a: Array<Struct>> . Don't we need to build up new expressions to create the arrays and maps from the remapped inner structs ?",
        "createdAt" : "2021-08-12T16:02:23Z",
        "updatedAt" : "2021-08-12T16:04:25Z",
        "lastEditedBy" : "a2fcc15e-a51a-42f0-87a6-137048a28e30",
        "tags" : [
        ]
      },
      {
        "id" : "68929b98-6337-4360-974e-08e94af75106",
        "parentId" : "f88967ef-f6ba-45ac-a728-68902ae3407c",
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "I think these case are already covered in the clause.",
        "createdAt" : "2021-08-12T17:50:03Z",
        "updatedAt" : "2021-08-12T17:50:40Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      },
      {
        "id" : "95c72344-f6c2-4cf9-9e93-c5c3e4c9e344",
        "parentId" : "f88967ef-f6ba-45ac-a728-68902ae3407c",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Let me add tests and check it out.",
        "createdAt" : "2021-08-13T03:20:28Z",
        "updatedAt" : "2021-08-13T03:20:28Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "aa40d27d-7961-416b-b4e9-0068494df4f0",
        "parentId" : "f88967ef-f6ba-45ac-a728-68902ae3407c",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Added",
        "createdAt" : "2021-08-13T08:40:48Z",
        "updatedAt" : "2021-08-13T08:40:48Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "7c985196-63c4-4186-a18c-4b150f729835",
        "parentId" : "f88967ef-f6ba-45ac-a728-68902ae3407c",
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "oops I missed the cases when structs are inside array & map, good point @dilipbiswal !",
        "createdAt" : "2021-08-13T14:59:27Z",
        "updatedAt" : "2021-08-13T14:59:28Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      }
    ],
    "commit" : "452b53571f26ad8b4994910b2cb99325f43a4215",
    "line" : 77,
    "diffHunk" : "@@ -1,1 +105,109 @@            resolveMapType(\n              matchedCol, matchedType, expectedType, expectedName, conf, addError, newColPath)\n          case _ =>\n            checkField(expectedCol, matchedCol, byName = true, conf, addError)\n        }"
  },
  {
    "id" : "b42ac83e-9c40-4743-b96f-e016756930e5",
    "prId" : 33728,
    "prUrl" : "https://github.com/apache/spark/pull/33728#pullrequestreview-730333097",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a486c0a6-32c2-4f23-9c51-cc447943273d",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "`TransformValues(TransformKeys(input, keyFunc), valueFunc)`?",
        "createdAt" : "2021-08-15T02:09:49Z",
        "updatedAt" : "2021-08-15T02:10:08Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "4933d5a0-a8f9-4cce-877e-d28010766454",
        "parentId" : "a486c0a6-32c2-4f23-9c51-cc447943273d",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "This creates map twice, can be slower.",
        "createdAt" : "2021-08-16T05:07:47Z",
        "updatedAt" : "2021-08-16T05:07:47Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "a1560be5-3f59-41d0-b511-f16e892f09e6",
        "parentId" : "a486c0a6-32c2-4f23-9c51-cc447943273d",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "ok",
        "createdAt" : "2021-08-16T05:21:38Z",
        "updatedAt" : "2021-08-16T05:21:39Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "452b53571f26ad8b4994910b2cb99325f43a4215",
    "line" : 186,
    "diffHunk" : "@@ -1,1 +214,218 @@        val newKeys = ArrayTransform(MapKeys(input), keyFunc)\n        val newValues = ArrayTransform(MapValues(input), valueFunc)\n        Some(Alias(MapFromArrays(newKeys, newValues), expectedName)())\n      } else {\n        None"
  }
]