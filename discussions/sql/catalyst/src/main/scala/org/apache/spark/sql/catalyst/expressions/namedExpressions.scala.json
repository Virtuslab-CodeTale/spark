[
  {
    "id" : "45f6c5f4-36df-4dd6-bacf-d00daa41e79f",
    "prId" : 31754,
    "prUrl" : "https://github.com/apache/spark/pull/31754#pullrequestreview-620685577",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "73c2d82a-3822-4bc4-b800-53bb3d2012f4",
        "parentId" : null,
        "authorId" : "2d6b46ba-4100-4c4d-9341-fff5e39647ec",
        "body" : "@sarutak @cloud-fan previously we always add backticks. But now we only add backticks when `name` contains dot or backtick. Is there any other valid case that may require backticks even if they don't contain dot or backtick, such as spaces in `name`? For example,\r\n\r\n```\r\nspark.sessionState.sqlParser.parseExpression(\"`a b` + 1\").sql\r\n```\r\nIt returns the following string before the change:\r\n```\r\n(`a b` + 1)\r\n```\r\nBut now it returns\r\n```\r\n(a b + 1)\r\n```",
        "createdAt" : "2021-03-25T01:08:14Z",
        "updatedAt" : "2021-03-25T01:08:15Z",
        "lastEditedBy" : "2d6b46ba-4100-4c4d-9341-fff5e39647ec",
        "tags" : [
        ]
      },
      {
        "id" : "407451e7-3c1d-44a5-8a91-2441a6fed0e9",
        "parentId" : "73c2d82a-3822-4bc4-b800-53bb3d2012f4",
        "authorId" : "3a227965-84e0-47cf-9974-11293764f028",
        "body" : "The first idea of mine was always adding backticks but finally I used `quoteIfNeeded` after discussion.\r\nWe might need to quote none of alphabets, numbers, underscore.\r\nOr, do you think it's better to always quote ?",
        "createdAt" : "2021-03-25T02:15:02Z",
        "updatedAt" : "2021-03-25T02:15:03Z",
        "lastEditedBy" : "3a227965-84e0-47cf-9974-11293764f028",
        "tags" : [
        ]
      },
      {
        "id" : "eccc5168-c732-4682-8a79-2a7ce800a8e4",
        "parentId" : "73c2d82a-3822-4bc4-b800-53bb3d2012f4",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "This is a good point. For places that only display the table/column name, like in the error message `Table not found: a b`, it's a bit weird but users can still understand the meaning. But in an expression sql string, `a b + 1` is ambiguous.\r\n\r\nI think we shoud follow the parser definition of identifiers `(LETTER | DIGIT | '_')+`, and only omit the quoting if the name only contains letter, digit or underscore.",
        "createdAt" : "2021-03-25T04:56:18Z",
        "updatedAt" : "2021-03-25T04:56:18Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "7b38dde3-9079-42e3-bbad-bf992cf081cd",
        "parentId" : "73c2d82a-3822-4bc4-b800-53bb3d2012f4",
        "authorId" : "3a227965-84e0-47cf-9974-11293764f028",
        "body" : "O.K, I'll open a PR to fix it.",
        "createdAt" : "2021-03-25T04:58:02Z",
        "updatedAt" : "2021-03-25T04:58:02Z",
        "lastEditedBy" : "3a227965-84e0-47cf-9974-11293764f028",
        "tags" : [
        ]
      }
    ],
    "commit" : "503fb07ba53005db412c460cbd521c3dfd883e02",
    "line" : 29,
    "diffHunk" : "@@ -1,1 +351,355 @@    val qualifierPrefix =\n      if (qualifier.nonEmpty) qualifier.map(quoteIfNeeded).mkString(\".\") + \".\" else \"\"\n    s\"$qualifierPrefix${quoteIfNeeded(name)}\"\n  }\n}"
  },
  {
    "id" : "57f7efd9-ec30-4b38-abcd-cd1c1c3f24af",
    "prId" : 30488,
    "prUrl" : "https://github.com/apache/spark/pull/30488#pullrequestreview-541807590",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "47c4b97c-c0bc-4c89-b1fb-598fd7a52a51",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "let's add a param doc for it",
        "createdAt" : "2020-12-01T11:32:56Z",
        "updatedAt" : "2020-12-02T15:39:45Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "d13b88c25a10022be0ff0190fd6fa8d158b24560",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +151,155 @@    val qualifier: Seq[String] = Seq.empty,\n    val explicitMetadata: Option[Metadata] = None,\n    val deniedMetadataKeys: Seq[String] = Seq.empty)\n  extends UnaryExpression with NamedExpression {\n"
  },
  {
    "id" : "ae24d5a6-14f2-40b3-a851-7408c73bc9c1",
    "prId" : 28745,
    "prUrl" : "https://github.com/apache/spark/pull/28745#pullrequestreview-425876352",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3aeb5e81-085f-464a-8c4c-72f97a976526",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "I will send another PR to use this in other places, for example,\r\n\r\nhttps://github.com/apache/spark/blob/a3a42b30d04009282e770c289b043ca5941e32e5/sql/core/src/main/scala/org/apache/spark/sql/execution/aggregate/AggUtils.scala#L147-L150\r\n\r\nhttps://github.com/apache/spark/blob/6c80ebbccb7f354f645dd63a73114332d26f901f/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/dsl/package.scala#L361-L364\r\n\r\nhttps://github.com/apache/spark/blob/17857f9b8bdf95eb64735eb986e86bf8fd8bc1a9/sql/core/src/main/scala/org/apache/spark/sql/RelationalGroupedDataset.scala#L83-L89\r\n\r\nand possibly at:\r\n\r\nhttps://github.com/apache/spark/blob/7195a18bf24d9506d2f8d9d4d93ff679b3d21b65/sql/core/src/main/scala/org/apache/spark/sql/Column.scala#L204\r\n\r\nI can don't add this util here for now too if anyone is not sure on this.",
        "createdAt" : "2020-06-07T07:14:11Z",
        "updatedAt" : "2020-06-09T13:14:46Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "12bb93b9-af7c-4d6d-ac0b-f426f10e4389",
        "parentId" : "3aeb5e81-085f-464a-8c4c-72f97a976526",
        "authorId" : "919368dc-8bac-4d8f-9fa6-be962263fc1e",
        "body" : "I find `org.apache.spark.sql.Dataset#groupBy(cols: Column*)` is invoked through py4j instead of `groupBy(col1: String, cols: String*)`, is it possible to change param sent in python side only to invoke `groupBy(col1: String, cols: String*)`, which may also be helpful to this jira :-)",
        "createdAt" : "2020-06-07T13:07:28Z",
        "updatedAt" : "2020-06-09T13:14:46Z",
        "lastEditedBy" : "919368dc-8bac-4d8f-9fa6-be962263fc1e",
        "tags" : [
        ]
      },
      {
        "id" : "651b69ee-f23f-4d65-8864-8520e2189314",
        "parentId" : "3aeb5e81-085f-464a-8c4c-72f97a976526",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Yeah, let me take a look separate with a separate JIRA.",
        "createdAt" : "2020-06-08T01:42:11Z",
        "updatedAt" : "2020-06-09T13:14:46Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "2bf09c0b2b009ddea5d9fe1b08c52bcee705e2f7",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +35,39 @@    case ne: NamedExpression => ne\n    case _: Expression => Alias(expr, toPrettySQL(expr))()\n  }\n}\n"
  },
  {
    "id" : "b2632e53-90d8-4785-99ad-c27713be73cb",
    "prId" : 28726,
    "prUrl" : "https://github.com/apache/spark/pull/28726#pullrequestreview-426839536",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "238845b7-7f35-4869-bd2d-85320fea68bc",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "namespace instead?",
        "createdAt" : "2020-06-05T22:41:43Z",
        "updatedAt" : "2020-06-05T22:41:43Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "be59f2ec-6658-4fdd-aaa9-e5dd2991bf75",
        "parentId" : "238845b7-7f35-4869-bd2d-85320fea68bc",
        "authorId" : "aa2391d2-258d-487d-9173-0c2dcee36c47",
        "body" : "\r\n\r\n\r\n\r\n> namespace instead?\r\n\r\n Sorry for the late response. You mean `catalog namespace`?\r\n",
        "createdAt" : "2020-06-09T03:02:53Z",
        "updatedAt" : "2020-06-09T03:02:53Z",
        "lastEditedBy" : "aa2391d2-258d-487d-9173-0c2dcee36c47",
        "tags" : [
        ]
      },
      {
        "id" : "f10432e6-31b0-48b9-8080-6c59e8b9c9de",
        "parentId" : "238845b7-7f35-4869-bd2d-85320fea68bc",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "I think he meant to document the namespace support in catalogV2, which is related but I think can be done separately.",
        "createdAt" : "2020-06-09T04:02:09Z",
        "updatedAt" : "2020-06-09T04:02:10Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "3c2f4d71-cd2a-4b27-aeb2-04c279b8f702",
        "parentId" : "238845b7-7f35-4869-bd2d-85320fea68bc",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Yea, it looks fine as it is.",
        "createdAt" : "2020-06-09T06:58:40Z",
        "updatedAt" : "2020-06-09T06:58:40Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "d7b9afed6cecbeb89916733039c0d2ee90127b3d",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +86,90 @@   * 2. Seq with a Single element: either the table name or the alias name of the table.\n   * 3. Seq with 2 elements: database name and table name\n   * 4. Seq with 3 elements: catalog name, database name and table name\n   */\n  def qualifier: Seq[String]"
  }
]