[
  {
    "id" : "267b0cc8-0834-47c5-b478-3eed4873d18f",
    "prId" : 28787,
    "prUrl" : "https://github.com/apache/spark/pull/28787#pullrequestreview-428609058",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "06011415-ea3c-40d9-9a50-f18799324dbe",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "when will we go into this expensive branch?",
        "createdAt" : "2020-06-11T05:27:00Z",
        "updatedAt" : "2020-06-11T08:30:00Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "63227601-28c4-44ba-9851-fb27b48e91cf",
        "parentId" : "06011415-ea3c-40d9-9a50-f18799324dbe",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Only when overlapping happens, it shouldn't be so often. Usually, it happens once per year. Please, see my comment in the code above.",
        "createdAt" : "2020-06-11T05:49:28Z",
        "updatedAt" : "2020-06-11T08:30:00Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "c655c8fabe2f3a2a530dc5f3aa27498d2acd1066",
    "line" : 28,
    "diffHunk" : "@@ -1,1 +345,349 @@    // instant, we take the standard and DST offsets of the previous day otherwise of the next one.\n    val trans = zoneId.getRules.getTransition(ldt)\n    if (trans != null && trans.isOverlap) {\n      val cloned = cal.clone().asInstanceOf[Calendar]\n      // Does the current offset belong to the offset before the transition."
  },
  {
    "id" : "94db6abd-d52f-4f7d-a480-82eac1c767ec",
    "prId" : 28441,
    "prUrl" : "https://github.com/apache/spark/pull/28441#pullrequestreview-405517460",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "13183c3f-231a-421c-b7db-638f9fc95e2f",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "ideally `require` should be the first line in a method.",
        "createdAt" : "2020-05-05T06:08:59Z",
        "updatedAt" : "2020-05-05T09:19:48Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "f46196f6-fa22-42bf-970b-a828934756da",
        "parentId" : "13183c3f-231a-421c-b7db-638f9fc95e2f",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "It uses `latestTs` in the error message. I am going to improve the message by converting micros to Instant, so, toString should form nicer string:\r\n```scala\r\n    require(rebaseMap.values.forall(_.diffs.last == 0),\r\n      s\"Differences between Julian and Gregorian calendar after ${microsToInstant(latestTs)} \" +\r\n      \"are expected to be zero for available time zones.\")\r\n```",
        "createdAt" : "2020-05-05T06:22:26Z",
        "updatedAt" : "2020-05-05T09:19:48Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "2badf88a12f9aa0aecdeb0e4ec645843bc99347d",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +289,293 @@  private def getLastSwitchTs(rebaseMap: AnyRefMap[String, RebaseInfo]): Long = {\n    val latestTs = rebaseMap.values.map(_.switches.last).max\n    require(rebaseMap.values.forall(_.diffs.last == 0),\n      s\"Differences between Julian and Gregorian calendar after ${microsToInstant(latestTs)} \" +\n      \"are expected to be zero for all available time zones.\")"
  },
  {
    "id" : "94ad6b9a-fe62-4314-88e8-b905194adad4",
    "prId" : 28172,
    "prUrl" : "https://github.com/apache/spark/pull/28172#pullrequestreview-391974382",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7222b4c2-3450-4961-87f6-50a912d2b91e",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "shall we remove `All dates before the staring point have the same difference ...`?",
        "createdAt" : "2020-04-13T06:03:01Z",
        "updatedAt" : "2020-04-13T06:03:01Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "8b0023b0-9a61-4272-908d-f72b76cc4cdb",
        "parentId" : "7222b4c2-3450-4961-87f6-50a912d2b91e",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "For this particular array, it is valid comment. It is not valid for `rebaseJulianToGregorianDays`, strictly speaking.",
        "createdAt" : "2020-04-13T06:09:03Z",
        "updatedAt" : "2020-04-13T06:09:04Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "68cebb9696f6f43003e105f4890a1b43894663f7",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +66,70 @@  // The starting point is the `0001-01-01` (-719164 days since the epoch in\n  // Julian calendar). All dates before the staring point have the same difference\n  // of 2 days in Julian and Proleptic Gregorian calendars.\n  // Rebasing switch days and diffs `julianGregDiffSwitchDay` and `julianGregDiffs`\n  // was generated by the `localRebaseJulianToGregorianDays` function."
  },
  {
    "id" : "101b6906-4cc4-4d2d-a0be-1d7d83373f92",
    "prId" : 28172,
    "prUrl" : "https://github.com/apache/spark/pull/28172#pullrequestreview-391973186",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "537478c8-f309-45e0-a43f-aaa309e3bdd6",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "ditto",
        "createdAt" : "2020-04-13T06:04:24Z",
        "updatedAt" : "2020-04-13T06:04:25Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "68cebb9696f6f43003e105f4890a1b43894663f7",
    "line" : 79,
    "diffHunk" : "@@ -1,1 +142,146 @@  // The starting point is the `0001-01-01` (-719162 days since the epoch in\n  // Proleptic Gregorian calendar). All dates before the staring point have the same\n  // difference of -2 days in Proleptic Gregorian and Julian calendars.\n  // Rebasing switch days and diffs `gregJulianDiffSwitchDay` and `gregJulianDiffs`\n  // was generated by the `localRebaseGregorianToJulianDays` function."
  },
  {
    "id" : "a1d211bc-9448-4182-a853-88c6b6625316",
    "prId" : 28172,
    "prUrl" : "https://github.com/apache/spark/pull/28172#pullrequestreview-400788394",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f02b395a-46f5-484c-800e-d60f95c43e49",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "nit: let's avoid to use `private[sql]`, next time.",
        "createdAt" : "2020-04-27T09:40:25Z",
        "updatedAt" : "2020-04-27T09:40:26Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "68cebb9696f6f43003e105f4890a1b43894663f7",
    "line" : 30,
    "diffHunk" : "@@ -1,1 +84,88 @@   * @return The rebased number of days in Gregorian calendar.\n   */\n  private[sql] def localRebaseJulianToGregorianDays(days: Int): Int = {\n    val utcCal = new Calendar.Builder()\n      // `gregory` is a hybrid calendar that supports both"
  },
  {
    "id" : "82ccae5d-3441-46cc-8131-c7fe82c6b95c",
    "prId" : 28166,
    "prUrl" : "https://github.com/apache/spark/pull/28166#pullrequestreview-390706863",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "dbc05d6d-4e02-42fe-9790-4623358c076d",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Technically, it is the hybrid calendar because Julian calendar doesn't stop at 1582-10-15. Java 7. GregorianCalendar just switches internally between 2 calendars.",
        "createdAt" : "2020-04-09T10:35:25Z",
        "updatedAt" : "2020-04-09T14:32:19Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "e4ca8557-71d7-4195-9805-7db8fa416d19",
        "parentId" : "dbc05d6d-4e02-42fe-9790-4623358c076d",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "The rebase mostly happens before 1582, so Julian calenday is OK. The method name is also `JulianToGregorian`.",
        "createdAt" : "2020-04-09T11:24:16Z",
        "updatedAt" : "2020-04-09T14:32:19Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "2e8fac47be5a2e546c06adbf08d6bbb20cd817bb",
    "line" : 212,
    "diffHunk" : "@@ -1,1 +287,291 @@   * @param zoneId The time zone ID at which the rebasing should be performed.\n   * @param micros The number of microseconds since the epoch '1970-01-01T00:00:00Z'\n   *               in the Julian calendar. It can be negative.\n   * @return The rebased microseconds since the epoch in Proleptic Gregorian calendar.\n   */"
  },
  {
    "id" : "93e9dc8b-e4a7-4c11-81e3-0c79cde09e3b",
    "prId" : 28119,
    "prUrl" : "https://github.com/apache/spark/pull/28119#pullrequestreview-389479495",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "65979cce-165e-4363-a513-005af011f445",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "We need to add a bit more document that we assume the julian seconds was generated with the JVM system default timezone.",
        "createdAt" : "2020-04-07T14:00:09Z",
        "updatedAt" : "2020-04-08T18:05:04Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "3587a64b-e0c5-4044-b70b-82fe0e07019a",
        "parentId" : "65979cce-165e-4363-a513-005af011f445",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "ditto for `rebaseGregorianToJulianMicros`",
        "createdAt" : "2020-04-07T14:01:25Z",
        "updatedAt" : "2020-04-08T18:05:04Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "e9a0e7ec-582a-45e3-837e-d6ce88f45d58",
        "parentId" : "65979cce-165e-4363-a513-005af011f445",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Added notes",
        "createdAt" : "2020-04-07T20:49:40Z",
        "updatedAt" : "2020-04-08T18:05:04Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "4281d4b40fd5e116d3c0f0d4b5ed6d7958539f19",
    "line" : 329,
    "diffHunk" : "@@ -1,1 +327,331 @@   */\n  def rebaseJulianToGregorianMicros(micros: Long): Long = {\n    val timeZone = TimeZone.getDefault\n    val tzId = timeZone.getID\n    val rebaseRecord = julianGregRebaseMap.getOrNull(tzId)"
  },
  {
    "id" : "a598bcab-de69-4c15-8822-96a584cf9fac",
    "prId" : 28119,
    "prUrl" : "https://github.com/apache/spark/pull/28119#pullrequestreview-398222139",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c779595f-6a9b-49ea-9f89-268d644d0021",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Let's try to don't `private[sql]` per SPARK-16813 next time.",
        "createdAt" : "2020-04-22T13:08:57Z",
        "updatedAt" : "2020-04-22T13:59:03Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "b1498b82-bb50-441d-871f-088b24413dae",
        "parentId" : "c779595f-6a9b-49ea-9f89-268d644d0021",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "The reason \"It simply makes debugging harder when Spark developers need to inspect the plans at runtime.\" is not applicable here, I believe. I would make the method `private` but I needed to access it from tests.",
        "createdAt" : "2020-04-22T13:28:27Z",
        "updatedAt" : "2020-04-22T13:28:28Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "7f21f706-adec-4d58-ab58-51261bd4d2fe",
        "parentId" : "c779595f-6a9b-49ea-9f89-268d644d0021",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Seems like it's the same package `org.apache.spark.sql.catalyst.util`. I guess `private[util]` works. ",
        "createdAt" : "2020-04-22T14:01:02Z",
        "updatedAt" : "2020-04-22T14:01:03Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "4281d4b40fd5e116d3c0f0d4b5ed6d7958539f19",
    "line" : 201,
    "diffHunk" : "@@ -1,1 +199,203 @@  // `JsonRebaseRecord`. AnyRefMap is used here instead of Scala's immutable map because\n  // it is 2 times faster in DateTimeRebaseBenchmark.\n  private[sql] def loadRebaseRecords(fileName: String): AnyRefMap[String, RebaseInfo] = {\n    val file = Thread.currentThread().getContextClassLoader.getResource(fileName)\n    val mapper = new ObjectMapper() with ScalaObjectMapper"
  }
]