[
  {
    "id" : "99549990-fbae-4e5e-a770-be400e5c6544",
    "prId" : 31964,
    "prUrl" : "https://github.com/apache/spark/pull/31964#pullrequestreview-622873018",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ff78205a-fed3-444f-8aca-5bdb1542e359",
        "parentId" : null,
        "authorId" : "2d6b46ba-4100-4c4d-9341-fff5e39647ec",
        "body" : "This is a pretty common method. Could you double check if it's okay to change this behavior for other places?",
        "createdAt" : "2021-03-25T18:12:00Z",
        "updatedAt" : "2021-03-26T06:41:38Z",
        "lastEditedBy" : "2d6b46ba-4100-4c4d-9341-fff5e39647ec",
        "tags" : [
        ]
      },
      {
        "id" : "bdb98039-03ab-4215-ba64-e6ff3e6a89b9",
        "parentId" : "ff78205a-fed3-444f-8aca-5bdb1542e359",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "I think it's only for error message or EXPLAIN result (e.g. `Attribute.sql`). @sarutak can you confirm?",
        "createdAt" : "2021-03-26T08:03:07Z",
        "updatedAt" : "2021-03-26T08:03:07Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "03409895-2ee3-46fa-8994-7b94b9ce3947",
        "parentId" : "ff78205a-fed3-444f-8aca-5bdb1542e359",
        "authorId" : "3a227965-84e0-47cf-9974-11293764f028",
        "body" : "I'm now confirming but, for now,  I don't think this change breaks existing behavior except for display format.",
        "createdAt" : "2021-03-26T11:19:57Z",
        "updatedAt" : "2021-03-26T11:19:57Z",
        "lastEditedBy" : "3a227965-84e0-47cf-9974-11293764f028",
        "tags" : [
        ]
      },
      {
        "id" : "590cead4-4263-4c9f-ae9a-5d6487bef8da",
        "parentId" : "ff78205a-fed3-444f-8aca-5bdb1542e359",
        "authorId" : "3a227965-84e0-47cf-9974-11293764f028",
        "body" : "I looked into the following classes which use `quoteIfNeeded`\r\n\r\n* ResolveSessionCatalog.apply\r\n* IdentifierHelper.quoted\r\n* MultipartIdentifierHelper.quoted\r\n* DatabaseInSessionCatalog$.unapply\r\n* NamespaceHelper.quoted\r\n* Alias.sql\r\n* AttributeReference.sql\r\n* UnresolvedAttribute.sql\r\n* IdentifierImpl.toString\r\n* IdentifierHelper.quoted\r\n\r\nFinally, I think this change doesn't break existing behavior.",
        "createdAt" : "2021-03-29T05:19:40Z",
        "updatedAt" : "2021-03-29T05:19:40Z",
        "lastEditedBy" : "3a227965-84e0-47cf-9974-11293764f028",
        "tags" : [
        ]
      }
    ],
    "commit" : "6faef6ba70e4ed17f4d26c45566f2c63483b9ad8",
    "line" : 3,
    "diffHunk" : "@@ -1,1 +148,152 @@  }\n\n  def quoteIfNeeded(part: String): String = {\n    if (part.matches(\"[a-zA-Z0-9_]+\") && !part.matches(\"\\\\d+\")) {\n      part"
  },
  {
    "id" : "ccb3322a-26f6-4897-974a-841a068630e9",
    "prId" : 31372,
    "prUrl" : "https://github.com/apache/spark/pull/31372#pullrequestreview-577993134",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f11936a8-6124-45c9-8984-40ce359989d0",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Should we handle this in `NonSQLExpression.sql`?",
        "createdAt" : "2021-01-28T05:03:55Z",
        "updatedAt" : "2021-01-28T05:03:55Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "f754518d-1a14-465b-a3db-3e019d1cf0ab",
        "parentId" : "f11936a8-6124-45c9-8984-40ce359989d0",
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "Not need. It's only apply in `toPrettySQL`. For other case which is not invoked by `toPrettySQL` (some error msg), we should keep the origin info.",
        "createdAt" : "2021-01-28T05:14:47Z",
        "updatedAt" : "2021-01-28T05:14:47Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      }
    ],
    "commit" : "deaa5351e36996ff5b3bb19a245710881918610c",
    "line" : 21,
    "diffHunk" : "@@ -1,1 +129,133 @@      e: Expression, existsNonSQLExpression: Boolean = false): Expression = e match {\n    case e: NonSQLExpression =>\n      e.withNewChildren(e.children.map(child => usePrettyExpression(child, true)))\n\n    case e => e transform {"
  },
  {
    "id" : "43693377-fe9a-4315-849b-2c37e29f1db3",
    "prId" : 31034,
    "prUrl" : "https://github.com/apache/spark/pull/31034#pullrequestreview-566969721",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8933ead5-65ea-4094-8051-950138fdb798",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "So the purpose is to strip Cast only from `toPrettySQL`? Only for changing column name but the actual Cast expression still works?",
        "createdAt" : "2021-01-13T07:30:35Z",
        "updatedAt" : "2021-01-13T09:49:01Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "19c932ad-56e7-45ba-93f5-10f45e10e88a",
        "parentId" : "8933ead5-65ea-4094-8051-950138fdb798",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Could you elaborate it clearly in the PR description?",
        "createdAt" : "2021-01-13T07:32:05Z",
        "updatedAt" : "2021-01-13T09:49:01Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "a88cc41d-a68a-48d4-9902-7a85da82f353",
        "parentId" : "8933ead5-65ea-4094-8051-950138fdb798",
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "Yes, it's the only place which we changed. Update the description.",
        "createdAt" : "2021-01-13T08:02:20Z",
        "updatedAt" : "2021-01-13T09:49:01Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      }
    ],
    "commit" : "2d1335397d3ea2de10eeb356ce8a3ccc1257ce56",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +138,142 @@      PrettyAttribute(r.mkString(r.exprsReplaced.map(toPrettySQL)), r.dataType)\n    case c: CastBase if !c.getTagValue(Cast.USER_SPECIFIED_CAST).getOrElse(false) =>\n      PrettyAttribute(usePrettyExpression(c.child).sql, c.dataType)\n  }\n"
  }
]