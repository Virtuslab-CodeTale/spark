[
  {
    "id" : "e7b10ff0-bef3-4aaa-ab17-2eb530a40905",
    "prId" : 31067,
    "prUrl" : "https://github.com/apache/spark/pull/31067#pullrequestreview-562674306",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ff37719a-6e30-4711-b180-84746a42c364",
        "parentId" : null,
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "This case has handled by https://github.com/apache/spark/blob/3ceffeb42a69365ec811cf09119f995eabe68954/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/optimizer/SimplifyConditionalsInPredicate.scala#L62-L64",
        "createdAt" : "2021-01-06T12:31:36Z",
        "updatedAt" : "2021-01-06T14:11:48Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      }
    ],
    "commit" : "fbd837d526fcdb89cdab528f1f0a7bcf47b0b434",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +63,67 @@    case CaseWhen(Seq((cond, trueValue)), Some(TrueLiteral)) =>\n      Or(Not(cond), trueValue)\n    case CaseWhen(Seq((cond, FalseLiteral)), Some(elseValue)) =>\n      And(Not(cond), elseValue)\n    case CaseWhen(Seq((cond, TrueLiteral)), Some(elseValue)) =>"
  },
  {
    "id" : "e68890ec-72bb-4965-bd0d-981431f27f6a",
    "prId" : 30865,
    "prUrl" : "https://github.com/apache/spark/pull/30865#pullrequestreview-557820738",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "1ec719d6-07ca-4d3a-9da3-166eacdaf4e9",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "can we add some comments to explain this rule?",
        "createdAt" : "2020-12-23T11:49:30Z",
        "updatedAt" : "2020-12-24T05:43:06Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "878beb0be0ee1f76186a59ec9db900445a52ddfa",
    "line" : 46,
    "diffHunk" : "@@ -1,1 +44,48 @@ * - CASE WHEN cond THEN true END               => cond\n */\nobject SimplifyConditionalsInPredicate extends Rule[LogicalPlan] {\n\n  def apply(plan: LogicalPlan): LogicalPlan = plan transform {"
  },
  {
    "id" : "aa84c897-251c-4dae-857c-3704a09f0093",
    "prId" : 30865,
    "prUrl" : "https://github.com/apache/spark/pull/30865#pullrequestreview-558822384",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ece8e5fd-6926-43f1-b9a5-d75da44a6651",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "We can add an assert. The analyzer should guarantee it.",
        "createdAt" : "2020-12-23T11:54:06Z",
        "updatedAt" : "2020-12-24T05:43:06Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "c34e7729-95e5-41df-aefb-c8530e3fb47e",
        "parentId" : "ece8e5fd-6926-43f1-b9a5-d75da44a6651",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "I mean something like\r\n```\r\ncase e =>\r\n  assert(e.dataType != BooleanType, ...)\r\n  e\r\n```",
        "createdAt" : "2020-12-24T05:29:28Z",
        "updatedAt" : "2020-12-24T05:43:06Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "7779e412-89bc-4d1d-a24c-8b64e8c6ea3b",
        "parentId" : "ece8e5fd-6926-43f1-b9a5-d75da44a6651",
        "authorId" : "a8e23d47-3ae4-4385-848c-38a216d1bd08",
        "body" : "It seems the added assert can never be triggered.\r\nI think @cloud-fan meant also to remove the `case e if e.dataType == BooleanType => e`",
        "createdAt" : "2020-12-25T14:55:11Z",
        "updatedAt" : "2020-12-25T14:55:11Z",
        "lastEditedBy" : "a8e23d47-3ae4-4385-848c-38a216d1bd08",
        "tags" : [
        ]
      }
    ],
    "commit" : "878beb0be0ee1f76186a59ec9db900445a52ddfa",
    "line" : 75,
    "diffHunk" : "@@ -1,1 +73,77 @@    case CaseWhen(Seq((cond, TrueLiteral)), Some(elseValue)) =>\n      Or(cond, elseValue)\n    case e if e.dataType == BooleanType => e\n    case e =>\n      assert(e.dataType != BooleanType,"
  },
  {
    "id" : "962cac6e-9c67-4627-aa9c-53685a0bc445",
    "prId" : 30865,
    "prUrl" : "https://github.com/apache/spark/pull/30865#pullrequestreview-562674651",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "aeeaefd2-d381-4480-adc0-67390ac1cc70",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "This skips evaluating the condition, and we should make sure the condition is deterministic. @wangyum can you fix it?",
        "createdAt" : "2021-01-06T06:01:30Z",
        "updatedAt" : "2021-01-06T06:01:30Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "9e20f0be-c8cc-4038-819c-d8e82589623e",
        "parentId" : "aeeaefd2-d381-4480-adc0-67390ac1cc70",
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "OK, will fix it later.",
        "createdAt" : "2021-01-06T06:04:10Z",
        "updatedAt" : "2021-01-06T06:04:10Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      },
      {
        "id" : "225cba95-67c1-46b2-92c4-e11a42cf45f8",
        "parentId" : "aeeaefd2-d381-4480-adc0-67390ac1cc70",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "and also it matters if `cond` throws an exception. Should probably think about `NoThrow` too.",
        "createdAt" : "2021-01-06T06:36:45Z",
        "updatedAt" : "2021-01-06T06:36:46Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "ce55d5b8-d292-4bf5-80a0-96bfc5f3e1f0",
        "parentId" : "aeeaefd2-d381-4480-adc0-67390ac1cc70",
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "Do we need to make these condition deterministic?\r\nhttps://github.com/apache/spark/blob/26d8df300a1a57e220b1a0f9814795f68101f28b/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/optimizer/expressions.scala#L295-L298",
        "createdAt" : "2021-01-06T10:25:02Z",
        "updatedAt" : "2021-01-06T10:25:03Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      },
      {
        "id" : "6f70d3cb-fd29-4730-b446-4f158aff5332",
        "parentId" : "aeeaefd2-d381-4480-adc0-67390ac1cc70",
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "https://github.com/apache/spark/pull/31067",
        "createdAt" : "2021-01-06T12:32:13Z",
        "updatedAt" : "2021-01-06T12:32:13Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      }
    ],
    "commit" : "878beb0be0ee1f76186a59ec9db900445a52ddfa",
    "line" : 67,
    "diffHunk" : "@@ -1,1 +65,69 @@    case CaseWhen(Seq((cond, trueValue)), Some(TrueLiteral)) =>\n      Or(Not(cond), trueValue)\n    case CaseWhen(Seq((_, FalseLiteral)), Some(FalseLiteral) | None) =>\n      FalseLiteral\n    case CaseWhen(Seq((cond, FalseLiteral)), Some(elseValue)) =>"
  }
]