[
  {
    "id" : "66e4a919-f63b-4e25-9349-c2a1c0c48f96",
    "prId" : 31440,
    "prUrl" : "https://github.com/apache/spark/pull/31440#pullrequestreview-584542275",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c68345cf-d049-4e39-b5dc-02d8b7eeaa62",
        "parentId" : null,
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "nit: can be created outside the loop (or even at `object` level - new metadata related `object` to go with `METADATA_COL_ATTR_KEY`).",
        "createdAt" : "2021-02-05T17:28:03Z",
        "updatedAt" : "2021-02-05T17:39:04Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "be4aefefd402637e77e50936b442ac619e14bf1d",
    "line" : 22,
    "diffHunk" : "@@ -1,1 +86,90 @@    def asStruct: StructType = {\n      val fields = metadata.map { metaCol =>\n        val fieldMeta = new MetadataBuilder().putBoolean(METADATA_COL_ATTR_KEY, true).build()\n        val field = StructField(metaCol.name, metaCol.dataType, metaCol.isNullable, fieldMeta)\n        Option(metaCol.comment).map(field.withComment).getOrElse(field)"
  }
]