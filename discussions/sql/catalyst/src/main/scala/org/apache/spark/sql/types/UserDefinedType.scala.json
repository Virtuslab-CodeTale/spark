[
  {
    "id" : "dc181221-fb51-4fe0-9796-29cd2fc077ef",
    "prId" : 30157,
    "prUrl" : "https://github.com/apache/spark/pull/30157#pullrequestreview-518235230",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "76cb3943-d85a-44bf-97b2-5e8bf7378322",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "This update comes from https://github.com/apache/spark/commit/0ec17c989debddb56a8048e4bd29ae666e4d9c56. I'm currently checking the python test results.",
        "createdAt" : "2020-10-27T08:24:47Z",
        "updatedAt" : "2020-10-27T08:24:47Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "6b08bf48-ab79-423d-82a9-ea4852825f1b",
        "parentId" : "76cb3943-d85a-44bf-97b2-5e8bf7378322",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Ah, ok. `branch-3.0` has [the same issue](https://github.com/apache/spark/runs/1307296057), but `test_infer_schema_with_udt` in `branch-3.0` does not fail because it drops the `labeled_point` view created in L350 before running the second `createOrReplaceTempView` in L361:\r\nhttps://github.com/apache/spark/blob/22392be4315900346ac884ad32bd6332ffc3e64e/python/pyspark/sql/tests/test_types.py#L349-L363\r\n\r\nA root cause of this issue is that, since `PythonUserDefinedType#userClass`is always null, `isAssignableFrom` in `UserDefinedType#acceptsType ` throws a null exception. To fix this issue, I think we need to backport https://issues.apache.org/jira/browse/SPARK-32090 into branch-3.0/2.4. WDYT? @dongjoon-hyun @viirya @HyukjinKwon ",
        "createdAt" : "2020-10-27T13:17:34Z",
        "updatedAt" : "2020-10-27T13:17:34Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "ce419faa-e0fb-44c7-943d-dadb0bf6bb0d",
        "parentId" : "76cb3943-d85a-44bf-97b2-5e8bf7378322",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "+1 for backporting. Thank you for analysis, @maropu .",
        "createdAt" : "2020-10-27T15:50:31Z",
        "updatedAt" : "2020-10-27T15:50:31Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "37cae8cf-366f-40f3-8a69-0872ea7947fc",
        "parentId" : "76cb3943-d85a-44bf-97b2-5e8bf7378322",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Looks okay. Thanks for looking at it.",
        "createdAt" : "2020-10-27T16:27:46Z",
        "updatedAt" : "2020-10-27T16:27:46Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "74f959ab-30d2-4328-b1bb-d8e42c7dacbb",
        "parentId" : "76cb3943-d85a-44bf-97b2-5e8bf7378322",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "okay, I will. Thanks for the check, @dongjoon-hyun and @viirya !",
        "createdAt" : "2020-10-27T23:46:13Z",
        "updatedAt" : "2020-10-27T23:46:13Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "96d7f213-48dc-4b78-87a2-bb000dc0ab73",
        "parentId" : "76cb3943-d85a-44bf-97b2-5e8bf7378322",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "done, thanks, all!",
        "createdAt" : "2020-10-28T00:00:45Z",
        "updatedAt" : "2020-10-28T00:00:45Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "aba6916330a76554e944d64a62a251e747f89d10",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +91,95 @@\n  override def equals(other: Any): Boolean = other match {\n    case that: UserDefinedType[_] => this.getClass == other.getClass\n    case _ => false\n  }"
  }
]