[
  {
    "id" : "f9569b05-8358-49c2-87d8-c8e32165e301",
    "prId" : 24436,
    "prUrl" : "https://github.com/apache/spark/pull/24436#pullrequestreview-241367904",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2921f8ec-cb75-4e18-b1c3-664967f2f7c6",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Hm, actually, do we need to count `null` as distinct value? It's not counted as a distinct value in SQL (`F.countDistinct` or `count(DISTINCT col)`) and Pandas (`unique()` by default) at least.",
        "createdAt" : "2019-05-23T18:10:16Z",
        "updatedAt" : "2019-05-23T18:10:17Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "4bdc89c5-9262-488c-833e-6cb2637a9754",
        "parentId" : "2921f8ec-cb75-4e18-b1c3-664967f2f7c6",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Looking into the current impl, seems we ignore `null` as distinct values:\r\n\r\nhttps://github.com/apache/spark/blob/239082d9667a4fa4198bd9524d63c739df147e0e/sql/core/src/main/scala/org/apache/spark/sql/execution/command/CommandUtils.scala#L270\r\nhttps://github.com/apache/spark/blob/b1857a4d7dfe17663f8adccd7825d890ae70d2a1/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/plans/logical/statsEstimation/EstimationUtils.scala#L50-L51\r\n",
        "createdAt" : "2019-05-23T18:11:37Z",
        "updatedAt" : "2019-05-23T18:11:37Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "50ae5cfb3ef29aaf44dc2891c21207ff0cc5f9bc",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +44,48 @@          val distinctCount = columnStat.distinctCount.get\n          val distinctValue: BigInt = if (columnStat.nullCount.get > 0) {\n            distinctCount + 1\n          } else {\n            distinctCount"
  }
]