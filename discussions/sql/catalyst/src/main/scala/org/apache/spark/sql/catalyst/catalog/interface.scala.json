[
  {
    "id" : "c30caff2-99aa-44c0-bf30-f3de90b06509",
    "prId" : 31112,
    "prUrl" : "https://github.com/apache/spark/pull/31112#pullrequestreview-564850658",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7cefd5e0-9433-4a9b-b850-7cd2d398ac6d",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "This is the bug fix. Cleaning of `storage` and `createTime` is not enough. `tableMeta` can have other \"temporary\" fields.",
        "createdAt" : "2021-01-10T10:39:18Z",
        "updatedAt" : "2021-01-10T10:39:18Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "6d3058e20ace94502b02a95cb8ec598cc0cee187",
    "line" : 39,
    "diffHunk" : "@@ -1,1 +806,810 @@\n  override def doCanonicalize(): HiveTableRelation = copy(\n    tableMeta = CatalogTable.normalize(tableMeta),\n    dataCols = dataCols.zipWithIndex.map {\n      case (attr, index) => attr.withExprId(ExprId(index))"
  },
  {
    "id" : "0fc0ee12-e349-44ca-b54b-08bfdb5323cd",
    "prId" : 30799,
    "prUrl" : "https://github.com/apache/spark/pull/30799#pullrequestreview-554323429",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9f17de57-ac10-43d1-8ecd-de0f8f5847cf",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Should we sort by entire strings (._1 and ._2)? For example, if you have `key0 = b` and `key0 = a`, you may get unstable output either `[key0 = b, key0 = a]` or `[key0 = a, key0 = b]`",
        "createdAt" : "2020-12-17T06:52:45Z",
        "updatedAt" : "2020-12-17T06:54:46Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "af414871-a84d-49e4-94a4-167701cd2795",
        "parentId" : "9f17de57-ac10-43d1-8ecd-de0f8f5847cf",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "ah, sorry, we can guarantee uniqueness of keys.",
        "createdAt" : "2020-12-17T06:59:04Z",
        "updatedAt" : "2020-12-17T06:59:04Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "2e908def417f933a993972110df86a43ec0b2f73",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +390,394 @@    val map = new mutable.LinkedHashMap[String, String]()\n    val tableProperties = properties.toSeq.sortBy(_._1)\n      .map(p => p._1 + \"=\" + p._2).mkString(\"[\", \", \", \"]\")\n    val partitionColumns = partitionColumnNames.map(quoteIdentifier).mkString(\"[\", \", \", \"]\")\n    val lastAccess = {"
  },
  {
    "id" : "b0212368-d0dc-4c68-a92e-40821053e111",
    "prId" : 29739,
    "prUrl" : "https://github.com/apache/spark/pull/29739#pullrequestreview-489232886",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "257b24f3-fcad-4505-82ea-3dc16cfa4804",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "The explain output of `HiveTableScanExec` does not have the same issue?",
        "createdAt" : "2020-09-16T02:34:02Z",
        "updatedAt" : "2020-09-17T10:25:55Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "e1c1ea32-3378-4c5c-921b-9e58ee48d2dd",
        "parentId" : "257b24f3-fcad-4505-82ea-3dc16cfa4804",
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "> The explain output of `HiveTableScanExec` does not have the same issue?\r\n\r\nNo, only caused. by `HiveTableRelation`, Optimized Plan also show too many information too.",
        "createdAt" : "2020-09-16T02:37:08Z",
        "updatedAt" : "2020-09-17T10:25:55Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      }
    ],
    "commit" : "2a8fd35899afc4ae6f43ad7afe192fc57e519966",
    "line" : 24,
    "diffHunk" : "@@ -1,1 +696,700 @@    partitionCols = partitionCols.map(_.newInstance()))\n\n  override def simpleString(maxFields: Int): String = {\n    val catalogTable = tableMeta.storage.serde match {\n      case Some(serde) => tableMeta.identifier :: serde :: Nil"
  },
  {
    "id" : "e9fc09b9-33d8-44c8-b912-1d7c253f05de",
    "prId" : 29739,
    "prUrl" : "https://github.com/apache/spark/pull/29739#pullrequestreview-489322453",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6508372f-3cd4-4ebd-bc91-a614317f9c45",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "is it also how file source tables display table info?",
        "createdAt" : "2020-09-16T06:44:50Z",
        "updatedAt" : "2020-09-17T10:25:55Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "d617d9a7-00e4-4f19-ba04-5e7a34575055",
        "parentId" : "6508372f-3cd4-4ebd-bc91-a614317f9c45",
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "> is it also how file source tables display table info?\r\n\r\nFile source tables won't show this.\r\n```\r\n== Parsed Logical Plan ==\r\n'Project [*]\r\n+- 'Filter ('df.k < 3)\r\n   +- 'UnresolvedRelation [df], []\r\n\r\n== Analyzed Logical Plan ==\r\nid: bigint, k: bigint\r\nProject [id#7L, k#8L]\r\n+- Filter (k#8L < cast(3 as bigint))\r\n   +- SubqueryAlias spark_catalog.default.df\r\n      +- Relation[id#7L,k#8L] parquet\r\n\r\n== Optimized Logical Plan ==\r\nFilter (isnotnull(k#8L) AND (k#8L < 3))\r\n+- Relation[id#7L,k#8L] parquet\r\n\r\n== Physical Plan ==\r\n*(1) ColumnarToRow\r\n+- FileScan parquet default.df[id#7L,k#8L] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex[file:/Users/angerszhu/Documents/project/AngersZhu/spark/sql/hive/target/tmp/hiv..., PartitionFilters: [isnotnull(k#8L), (k#8L < 3)], PushedFilters: [], ReadSchema: struct<id:bigint>\r\n\r\n```",
        "createdAt" : "2020-09-16T06:50:52Z",
        "updatedAt" : "2020-09-17T10:25:55Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      }
    ],
    "commit" : "2a8fd35899afc4ae6f43ad7afe192fc57e519966",
    "line" : 31,
    "diffHunk" : "@@ -1,1 +703,707 @@\n    var metadata = Map(\n      \"CatalogTable\" -> catalogTable.mkString(\", \"),\n      \"Data Cols\" -> truncatedString(dataCols, \"[\", \", \", \"]\", maxFields),\n      \"Partition Cols\" -> truncatedString(partitionCols, \"[\", \", \", \"]\", maxFields)"
  }
]