[
  {
    "id" : "972f5383-f9ed-4d79-b4e7-b2654df2b34c",
    "prId" : 31368,
    "prUrl" : "https://github.com/apache/spark/pull/31368#pullrequestreview-578939606",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d53759b0-6969-4944-af94-1c8e20cd58a2",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "@maropu We can eliminate cast for complex types that are compatible (only nullability is different), so the previous logic could fail valid queries.",
        "createdAt" : "2021-01-27T19:05:25Z",
        "updatedAt" : "2021-01-29T04:46:02Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "fbce25a2-6a0c-4149-bf4b-2e7f9ab3925f",
        "parentId" : "d53759b0-6969-4944-af94-1c8e20cd58a2",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "should we add a test for the query that failed with the previous logic? ",
        "createdAt" : "2021-01-28T18:45:43Z",
        "updatedAt" : "2021-01-29T04:46:03Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      },
      {
        "id" : "681046eb-66a7-418e-9b22-8f87277cad10",
        "parentId" : "d53759b0-6969-4944-af94-1c8e20cd58a2",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "The view tests fail without this change. It's a test only thing (the check is skipped in production) that we don't need to backport, so I didn't spend time putting this into a separate PR with tests.",
        "createdAt" : "2021-01-29T04:43:29Z",
        "updatedAt" : "2021-01-29T04:46:03Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "d15a1166-3e23-4938-ad03-fa96ececa8ec",
        "parentId" : "d53759b0-6969-4944-af94-1c8e20cd58a2",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "got it. thanks.",
        "createdAt" : "2021-01-29T04:51:05Z",
        "updatedAt" : "2021-01-29T04:51:06Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "2aebf0516f146456e4567612db8823fc3407641b",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +231,235 @@      // some resolved logical plans can have unresolved references,\n      // e.g., outer references in `ExistenceJoin`.\n      p.output.filter(_.resolved).map { a => (a.exprId, a.dataType.asNullable) }\n    }.flatten\n"
  }
]