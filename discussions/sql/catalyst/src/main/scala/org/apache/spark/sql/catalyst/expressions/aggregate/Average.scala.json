[
  {
    "id" : "ff2835ef-0f60-4d96-9fe6-2aaac8d27e69",
    "prId" : 32909,
    "prUrl" : "https://github.com/apache/spark/pull/32909#pullrequestreview-687820337",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ed574f91-8d5f-4e1e-960b-66ff4ef3dce4",
        "parentId" : null,
        "authorId" : "3a227965-84e0-47cf-9974-11293764f028",
        "body" : "@MaxGekk For `Sum`,  `resultType` is the same as `child.dataType` but for `Average` `resultType` is always `YearMonthIntervalType(0, 1)`. Is this intended behavior?",
        "createdAt" : "2021-06-19T12:20:12Z",
        "updatedAt" : "2021-06-19T12:20:12Z",
        "lastEditedBy" : "3a227965-84e0-47cf-9974-11293764f028",
        "tags" : [
        ]
      }
    ],
    "commit" : "0554526e86d876de79af779f87366df24ad3bb43",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +58,62 @@    case DecimalType.Fixed(p, s) =>\n      DecimalType.bounded(p + 4, s + 4)\n    case _: YearMonthIntervalType => YearMonthIntervalType()\n    case _: DayTimeIntervalType => DayTimeIntervalType()\n    case _ => DoubleType"
  },
  {
    "id" : "5b65207b-0080-4022-8884-5d5b73f77a09",
    "prId" : 32229,
    "prUrl" : "https://github.com/apache/spark/pull/32229#pullrequestreview-645679148",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f8bce0eb-38ca-42d1-b295-d574145a1ab8",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "how about global aggregate with empty input? we should return null or fail?",
        "createdAt" : "2021-04-20T05:07:28Z",
        "updatedAt" : "2021-04-20T05:07:29Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "c2c21a74-8f54-4ac5-aea8-524fdc85f4df",
        "parentId" : "f8bce0eb-38ca-42d1-b295-d574145a1ab8",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "I fixed it with https://github.com/apache/spark/pull/32358.",
        "createdAt" : "2021-04-27T10:10:40Z",
        "updatedAt" : "2021-04-27T10:10:41Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "20cc8b16b467505e7c5cb6841daec8eeeb5a9105",
    "line" : 37,
    "diffHunk" : "@@ -1,1 +91,95 @@    case _: DayTimeIntervalType => DivideDTInterval(sum, count)\n    case _ =>\n      Divide(sum.cast(resultType), count.cast(resultType), failOnError = false)\n  }\n"
  },
  {
    "id" : "1c0ec0b5-c80d-4d21-8b78-1f79a568676c",
    "prId" : 31932,
    "prUrl" : "https://github.com/apache/spark/pull/31932#pullrequestreview-624637882",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "574129db-d294-4f73-944e-8ad8751cf348",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "2 space indent",
        "createdAt" : "2021-03-30T19:40:58Z",
        "updatedAt" : "2021-03-30T19:50:21Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "3c0e5077722d39b25680870ba9d435aafc62466c",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +37,41 @@  since = \"1.0.0\")\ncase class Average(child: Expression) extends DeclarativeAggregate with ImplicitCastInputTypes\n    with UnaryLike[Expression] {\n\n  override def prettyName: String = getTagValue(FunctionRegistry.FUNC_ALIAS).getOrElse(\"avg\")"
  }
]