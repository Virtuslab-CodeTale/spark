[
  {
    "id" : "6a760a95-0e7c-46e9-b0a0-5700bf371b7e",
    "prId" : 32351,
    "prUrl" : "https://github.com/apache/spark/pull/32351#pullrequestreview-645475252",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c40443fe-41cb-42e6-887f-bce6b8e3d809",
        "parentId" : null,
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "match the field and type both, so that we don't need to do type checking in all the `ExtractXXX` implementations, and reduce the code diff when removing CalendarIntervalType",
        "createdAt" : "2021-04-27T06:20:15Z",
        "updatedAt" : "2021-04-27T06:20:15Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      }
    ],
    "commit" : "687a384afe914c1ed4688f64a20cf8f923919e53",
    "line" : 124,
    "diffHunk" : "@@ -1,1 +124,128 @@      errorHandleFunc: => Nothing): Expression = {\n    (extractField.toUpperCase(Locale.ROOT), source.dataType) match {\n      case (\"YEAR\" | \"Y\" | \"YEARS\" | \"YR\" | \"YRS\", YearMonthIntervalType) =>\n        ExtractANSIIntervalYears(source)\n      case (\"YEAR\" | \"Y\" | \"YEARS\" | \"YR\" | \"YRS\", CalendarIntervalType) =>"
  },
  {
    "id" : "5aa44029-1ec2-4c7c-adf9-0c1db7148880",
    "prId" : 32314,
    "prUrl" : "https://github.com/apache/spark/pull/32314#pullrequestreview-645470166",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "372602fd-a28f-426c-9c18-e8dbd28bca85",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "nit: identation",
        "createdAt" : "2021-04-27T06:04:37Z",
        "updatedAt" : "2021-04-27T06:11:50Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "13a49c61-9549-4ae9-8d84-24b069cb7775",
        "parentId" : "372602fd-a28f-426c-9c18-e8dbd28bca85",
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "Done",
        "createdAt" : "2021-04-27T06:11:46Z",
        "updatedAt" : "2021-04-27T06:11:50Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      }
    ],
    "commit" : "161bb7ff071c073ab90bb5128f836e0c8b20aab4",
    "line" : 102,
    "diffHunk" : "@@ -1,1 +514,518 @@      nullSafeCodeGen(ctx, ev, (m, n) =>\n        s\"\"\"\n           |$checkIntegralDivideOverflow\n           |${ev.value} = $math.divide($m, $n, java.math.RoundingMode.HALF_UP);\n        \"\"\".stripMargin)"
  },
  {
    "id" : "b8200111-9a44-47e1-adc6-b52ead34355e",
    "prId" : 31961,
    "prUrl" : "https://github.com/apache/spark/pull/31961#pullrequestreview-622040477",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "116c5955-ffa5-4800-a5ff-a7214204f9f0",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "`months` is int, the result of `/` must fit to int too. So, `toInt` should be safe.",
        "createdAt" : "2021-03-25T19:29:12Z",
        "updatedAt" : "2021-03-25T19:29:13Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "050f8276-8723-48b1-9172-53ec6f250979",
        "parentId" : "116c5955-ffa5-4800-a5ff-a7214204f9f0",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "It's better to put it as a code comment. We can fix it in the next PR.",
        "createdAt" : "2021-03-26T05:56:29Z",
        "updatedAt" : "2021-03-26T05:56:30Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "d8accd9f-8b0a-4325-9197-a7d313c9616e",
        "parentId" : "116c5955-ffa5-4800-a5ff-a7214204f9f0",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "I added comments in https://github.com/apache/spark/pull/31972",
        "createdAt" : "2021-03-26T11:41:00Z",
        "updatedAt" : "2021-03-26T11:41:01Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "92deb160ad92c69092a8dfa343a8f608680404c2",
    "line" : 31,
    "diffHunk" : "@@ -1,1 +357,361 @@  private lazy val evalFunc: (Int, Any) => Any = right.dataType match {\n    case LongType => (months: Int, num) =>\n      LongMath.divide(months, num.asInstanceOf[Long], RoundingMode.HALF_UP).toInt\n    case _: IntegralType => (months: Int, num) =>\n      IntMath.divide(months, num.asInstanceOf[Number].intValue(), RoundingMode.HALF_UP)"
  },
  {
    "id" : "62bffe3b-20a7-441b-933e-89454a6cf838",
    "prId" : 31929,
    "prUrl" : "https://github.com/apache/spark/pull/31929#pullrequestreview-618374719",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ebc6e7de-198c-44d0-9b47-dffb17cf7dd2",
        "parentId" : null,
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "Strings are also accepted then?",
        "createdAt" : "2021-03-23T09:16:15Z",
        "updatedAt" : "2021-03-23T10:04:00Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      },
      {
        "id" : "43c011bc-3537-476c-8149-b73cd8a458bd",
        "parentId" : "ebc6e7de-198c-44d0-9b47-dffb17cf7dd2",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "yes, I checked that in a test.",
        "createdAt" : "2021-03-23T09:24:29Z",
        "updatedAt" : "2021-03-23T10:04:00Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "6c42ce33-fb59-4645-9fe7-e8c9b402f15d",
        "parentId" : "ebc6e7de-198c-44d0-9b47-dffb17cf7dd2",
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "ah sorry, I missed that case",
        "createdAt" : "2021-03-23T09:33:58Z",
        "updatedAt" : "2021-03-23T10:04:00Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      }
    ],
    "commit" : "6acff97182d6d890dd0148383656ae22684caa58",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +255,259 @@    interval: Expression,\n    num: Expression)\n  extends BinaryExpression with ImplicitCastInputTypes with NullIntolerant with Serializable {\n  override def left: Expression = interval\n  override def right: Expression = num"
  },
  {
    "id" : "6326320b-1232-4d99-83c6-990696161880",
    "prId" : 30516,
    "prUrl" : "https://github.com/apache/spark/pull/30516#pullrequestreview-540647528",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0cdfc2c2-f6ca-4d0c-bb95-90ce0b058c6a",
        "parentId" : null,
        "authorId" : "cce1c782-0596-44b6-8b99-6b77d2cca53c",
        "body" : "nullable on other two class should be the same.",
        "createdAt" : "2020-11-30T07:22:34Z",
        "updatedAt" : "2020-12-01T02:49:27Z",
        "lastEditedBy" : "cce1c782-0596-44b6-8b99-6b77d2cca53c",
        "tags" : [
        ]
      }
    ],
    "commit" : "9f07294562c9529629798950d5e5ebc3e82acbd6",
    "line" : 37,
    "diffHunk" : "@@ -1,1 +208,212 @@    IntegerType, IntegerType, IntegerType, DecimalType(Decimal.MAX_LONG_DIGITS, 6))\n  override def dataType: DataType = CalendarIntervalType\n  override def nullable: Boolean = if (failOnError) children.exists(_.nullable) else true\n\n  override def nullSafeEval("
  },
  {
    "id" : "2075eea9-095a-459f-8377-db2773d4f582",
    "prId" : 30516,
    "prUrl" : "https://github.com/apache/spark/pull/30516#pullrequestreview-620172916",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3052a1da-ba45-427a-88a1-b039d959b651",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Is `faile` typo? `faileOnErrorBranch` -> `failOnErrorBranch`. I will fix this in https://github.com/apache/spark/pull/31951.",
        "createdAt" : "2021-03-24T19:50:48Z",
        "updatedAt" : "2021-03-24T19:51:13Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "9f07294562c9529629798950d5e5ebc3e82acbd6",
    "line" : 54,
    "diffHunk" : "@@ -1,1 +236,240 @@      val iu = IntervalUtils.getClass.getName.stripSuffix(\"$\")\n      val secFrac = sec.getOrElse(\"0\")\n      val faileOnErrorBranch = if (failOnError) \"throw e;\" else s\"${ev.isNull} = true;\"\n      s\"\"\"\n        try {"
  },
  {
    "id" : "c1c80ced-38bf-4243-a2e6-96c0946597ba",
    "prId" : 26446,
    "prUrl" : "https://github.com/apache/spark/pull/26446#pullrequestreview-314585117",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "01211f83-7c14-496c-a6e4-c5d3ac5fb35a",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "`weeks` is missing before `days`.",
        "createdAt" : "2019-11-10T01:19:48Z",
        "updatedAt" : "2019-11-10T18:36:44Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "0f9a3bb846f2f7f40a3be4c13ccc201a09aaf554",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +163,167 @@      * months - the number of months, positive or negative\n      * weeks - the number of weeks, positive or negative\n      * days - the number of days, positive or negative\n      * hours - the number of hours, positive or negative\n      * mins - the number of minutes, positive or negative"
  },
  {
    "id" : "3d850efd-6944-4c4f-a30b-a6f3c5f2e02a",
    "prId" : 26446,
    "prUrl" : "https://github.com/apache/spark/pull/26446#pullrequestreview-314585153",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0ad2db12-9216-4f92-a2c1-2d5e83ac5770",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "~new line before this.~ Never mind. I noticed that you collect all constructors as a single group.",
        "createdAt" : "2019-11-10T01:21:33Z",
        "updatedAt" : "2019-11-10T18:36:44Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "0f9a3bb846f2f7f40a3be4c13ccc201a09aaf554",
    "line" : 46,
    "diffHunk" : "@@ -1,1 +196,200 @@    this(years, months, weeks, days, hours, mins, Literal(Decimal(0, 8, 6)))\n  }\n  def this(\n      years: Expression,\n      months: Expression,"
  },
  {
    "id" : "fd96e47b-0df9-4908-9db6-7b3d27597bbc",
    "prId" : 26446,
    "prUrl" : "https://github.com/apache/spark/pull/26446#pullrequestreview-434306933",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "87eab65b-4399-4abb-b31a-d9563db21008",
        "parentId" : null,
        "authorId" : "e5beb795-ac0e-4bd6-ad66-708215b8ae58",
        "body" : "@MaxGekk `DecimalType(8, 6)` for seconds makes it overflow to null if the input expression has values > 100.\r\nSimba reported it when testing using this function to implement TIMESTAMPADD ODBC translation: {fn TIMESTAMPADD(SECONDS, integer_exp, timestamp)} -> timestamp + make_interval(0, 0, 0, 0, 0, 0, integer_exp)\r\n\r\nI rased https://issues.apache.org/jira/browse/SPARK-32021",
        "createdAt" : "2020-06-18T11:28:41Z",
        "updatedAt" : "2020-06-18T11:28:41Z",
        "lastEditedBy" : "e5beb795-ac0e-4bd6-ad66-708215b8ae58",
        "tags" : [
        ]
      },
      {
        "id" : "a0f0acbd-9ad4-4aa3-93e5-13bcd79053cd",
        "parentId" : "87eab65b-4399-4abb-b31a-d9563db21008",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Thank you for filing a JIRA, @juliuszsompolski .",
        "createdAt" : "2020-06-18T22:18:35Z",
        "updatedAt" : "2020-06-18T22:18:36Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "e94124b0-cbdd-4ad2-8fec-aa76d8192033",
        "parentId" : "87eab65b-4399-4abb-b31a-d9563db21008",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Here is the PR https://github.com/apache/spark/pull/28873 in which I bumped precision of seconds+fractions",
        "createdAt" : "2020-06-19T19:45:59Z",
        "updatedAt" : "2020-06-19T19:45:59Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "0f9a3bb846f2f7f40a3be4c13ccc201a09aaf554",
    "line" : 66,
    "diffHunk" : "@@ -1,1 +216,220 @@  // them to the fractional part of `secs`.\n  override def inputTypes: Seq[AbstractDataType] = Seq(IntegerType, IntegerType, IntegerType,\n    IntegerType, IntegerType, IntegerType, DecimalType(8, 6))\n  override def dataType: DataType = CalendarIntervalType\n  override def nullable: Boolean = true"
  },
  {
    "id" : "4fb122f0-d8e2-425e-984e-f1d889723a0b",
    "prId" : 26132,
    "prUrl" : "https://github.com/apache/spark/pull/26132#pullrequestreview-311638587",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "14159e5b-e19f-45bd-b092-74ed1188a877",
        "parentId" : null,
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "https://github.com/apache/spark/pull/26345/files#diff-b83497f7bc11578a0b63a814a2a30f48R2198-R2207\r\nHow about adding these doc and test cases here",
        "createdAt" : "2019-11-05T10:24:27Z",
        "updatedAt" : "2019-11-05T10:39:09Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      },
      {
        "id" : "9a06139d-8296-48dd-bb6d-9944ee8b8ec2",
        "parentId" : "14159e5b-e19f-45bd-b092-74ed1188a877",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "This should be added for only expressions registered as functions.",
        "createdAt" : "2019-11-05T10:34:42Z",
        "updatedAt" : "2019-11-05T10:39:09Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "b70c0f8421e855d4038459a951cb5a6f3b9607c9",
    "line" : 102,
    "diffHunk" : "@@ -1,1 +149,153 @@}\n\ncase class MultiplyInterval(interval: Expression, num: Expression)\n  extends IntervalNumOperation(interval, num, multiply, \"multiply\")\n"
  },
  {
    "id" : "70ab6f1b-dda6-4a98-8197-c0b8e99bafb7",
    "prId" : 26132,
    "prUrl" : "https://github.com/apache/spark/pull/26132#pullrequestreview-311633042",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ad5d8283-cce8-49de-a215-2aeb322c0dd1",
        "parentId" : null,
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "https://github.com/apache/spark/pull/26345/files#diff-b83497f7bc11578a0b63a814a2a30f48R2167-R2176 ditto",
        "createdAt" : "2019-11-05T10:25:33Z",
        "updatedAt" : "2019-11-05T10:39:09Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      }
    ],
    "commit" : "b70c0f8421e855d4038459a951cb5a6f3b9607c9",
    "line" : 105,
    "diffHunk" : "@@ -1,1 +152,156 @@  extends IntervalNumOperation(interval, num, multiply, \"multiply\")\n\ncase class DivideInterval(interval: Expression, num: Expression)\n  extends IntervalNumOperation(interval, num, divide, \"divide\")"
  },
  {
    "id" : "886d9c1e-b65a-4e57-94a9-4f8b56af05e9",
    "prId" : 25981,
    "prUrl" : "https://github.com/apache/spark/pull/25981#pullrequestreview-303706978",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6b974177-6ee8-49d7-965a-cd4012312ee1",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "not related to this PR, but we can apply the same naming policy to the related date/timestamp functions.",
        "createdAt" : "2019-10-18T07:27:16Z",
        "updatedAt" : "2019-10-18T07:28:33Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "5620472a26f57590f2d5a67b24b5295980641f1c",
    "line" : 80,
    "diffHunk" : "@@ -1,1 +78,82 @@    extends ExtractIntervalPart(child, DecimalType(8, 3), getMilliseconds, \"getMilliseconds\")\n\ncase class ExtractIntervalMicroseconds(child: Expression)\n    extends ExtractIntervalPart(child, LongType, getMicroseconds, \"getMicroseconds\")\n"
  }
]