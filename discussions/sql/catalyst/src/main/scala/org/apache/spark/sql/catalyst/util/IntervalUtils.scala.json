[
  {
    "id" : "3b9a7468-81d0-42d8-92fe-6ba4169c3dc0",
    "prId" : 33751,
    "prUrl" : "https://github.com/apache/spark/pull/33751#pullrequestreview-730792516",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "436c5ae9-b6ab-48d6-a504-836fc4debd8f",
        "parentId" : null,
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "This one is used in the type constructor. ",
        "createdAt" : "2021-08-16T14:36:36Z",
        "updatedAt" : "2021-08-16T14:36:36Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      }
    ],
    "commit" : "7a03c24491af59c76744d791d76e06d68fe37b3f",
    "line" : 36,
    "diffHunk" : "@@ -1,1 +220,224 @@  def fromYearMonthString(input: String, startField: Byte, endField: Byte): CalendarInterval = {\n    require(input != null, \"Interval year-month string must be not null\")\n    val months = castStringToYMIntervalAnsi(UTF8String.fromString(input), startField, endField)\n    new CalendarInterval(months, 0, 0)\n  }"
  },
  {
    "id" : "5db72206-0510-4846-b685-00b36107094f",
    "prId" : 33242,
    "prUrl" : "https://github.com/apache/spark/pull/33242#pullrequestreview-700670239",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "78581c6a-6aca-451e-a019-eb9d2d28f30a",
        "parentId" : null,
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "Here fix a bug about parse `INTERVAL '111' day` failed issue. FYI @MaxGekk  @cloud-fan ",
        "createdAt" : "2021-07-07T07:33:13Z",
        "updatedAt" : "2021-07-07T07:36:16Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      }
    ],
    "commit" : "12e83e6da7a931dd17109c4632f8332c2ef33294",
    "line" : 132,
    "diffHunk" : "@@ -1,1 +368,372 @@        safeToInterval(\"day-time\") {\n          val sign = finalSign(firstSign, secondSign)\n          unit.toUpperCase(Locale.ROOT) match {\n            case \"DAY\" if suffix == null && value.length <= 9 && checkTargetType(DT.DAY, DT.DAY) =>\n              sign * value.toLong * MICROS_PER_DAY"
  },
  {
    "id" : "6a8b5a48-8f2c-4bcd-a8d3-da0685f3718a",
    "prId" : 33231,
    "prUrl" : "https://github.com/apache/spark/pull/33231#pullrequestreview-701142060",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e0a770c5-1fc0-4a3d-b4af-a0696c167d7f",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Do we have tests for MAX_DAY + 1 and MAX_DAY, and for MIN_DAY-1 and MIN_DAY?",
        "createdAt" : "2021-07-07T14:45:54Z",
        "updatedAt" : "2021-07-07T14:51:12Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "765659a3-24a4-4284-b2a6-74eeaa17f102",
        "parentId" : "e0a770c5-1fc0-4a3d-b4af-a0696c167d7f",
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "Added in interval.sql",
        "createdAt" : "2021-07-07T15:18:49Z",
        "updatedAt" : "2021-07-07T15:18:49Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      }
    ],
    "commit" : "3a569e2db1636d2dcd89a0d877193b335ae7283f",
    "line" : 52,
    "diffHunk" : "@@ -1,1 +410,414 @@      sign: Int): Long = {\n    var micros = 0L\n    val days = toLongWithRange(DAY, dayStr, 0, MAX_DAY).toInt\n    micros = Math.addExact(micros, sign * days * MICROS_PER_DAY)\n    val hours = toLongWithRange(HOUR, hourStr, 0, 23)"
  },
  {
    "id" : "c9fe4d0f-0b77-41ec-b31e-ae697f6cd221",
    "prId" : 33217,
    "prUrl" : "https://github.com/apache/spark/pull/33217#pullrequestreview-699495917",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "1cc7fc79-e0fb-4ce3-8fc6-ccb471ba76ce",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Should we add a gap between the two line?\r\nCould you show an example of the error message, please. I just wonder is it readable ...",
        "createdAt" : "2021-07-05T17:59:30Z",
        "updatedAt" : "2021-07-05T18:11:28Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "1f1c1a91-46d3-4439-ad8a-3076610166af",
        "parentId" : "1cc7fc79-e0fb-4ce3-8fc6-ccb471ba76ce",
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "> Should we add a gap between the two line?\r\n> Could you show an example of the error message, please. I just wonder is it readable ...\r\n\r\n```\r\nInterval string does not match day-time format of `[+|-]d h`, `INTERVAL [+|-]'[+|-]d h' DAY TO HOUR` when cast to interval day to hour: INTERVAL '1 01:01:01.12345' DAY TO SECOND, set spark.sql.legacy.fromDayTimeString.enabled to true to restore the behavior before Spark 3.0.\r\n```",
        "createdAt" : "2021-07-06T02:53:19Z",
        "updatedAt" : "2021-07-06T02:53:19Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      }
    ],
    "commit" : "e6bdf8167866183300cc779c0efb61e178ca9939",
    "line" : 32,
    "diffHunk" : "@@ -1,1 +130,134 @@      s\"Interval string does not match $intervalStr format of \" +\n        s\"${supportedFormat((startFiled, endField)).map(format => s\"`$format`\").mkString(\", \")} \" +\n        s\"when cast to $typeName: ${input.toString}\" +\n        s\"${fallBackNotice.map(s => s\", $s\").getOrElse(\"\")}\")\n  }"
  },
  {
    "id" : "2e5bfc11-37ec-4882-b30f-538d3140a5d3",
    "prId" : 33217,
    "prUrl" : "https://github.com/apache/spark/pull/33217#pullrequestreview-699496576",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "61c081d8-ee4c-48f7-8407-b5d62b6e1865",
        "parentId" : null,
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "FYI @MaxGekk rename the parameter make it more clear",
        "createdAt" : "2021-07-06T02:55:15Z",
        "updatedAt" : "2021-07-06T02:55:15Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      }
    ],
    "commit" : "e6bdf8167866183300cc779c0efb61e178ca9939",
    "line" : 41,
    "diffHunk" : "@@ -1,1 +139,143 @@      targetEndField: Byte,\n      inputIntervalType: DataType,\n      fallBackNotice: Option[String] = None): Unit = {\n    val (intervalStr, typeName, inputStartField, inputEndField) = inputIntervalType match {\n      case DT(startField, endField) =>"
  },
  {
    "id" : "7dcc8c07-b1c5-44e4-a4db-290a1289f150",
    "prId" : 32940,
    "prUrl" : "https://github.com/apache/spark/pull/32940#pullrequestreview-687481456",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "26a0f00e-cfe1-4e80-b45a-a207f511dda6",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Could you change the error message, please. It should reflect `startField` and `endField`.",
        "createdAt" : "2021-06-17T19:17:30Z",
        "updatedAt" : "2021-06-17T19:25:14Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "7ecac15f-5305-4086-8e2f-109e11b364c8",
        "parentId" : "26a0f00e-cfe1-4e80-b45a-a207f511dda6",
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "> Could you change the error message, please. It should reflect `startField` and `endField`.\r\n\r\nHow about current?",
        "createdAt" : "2021-06-18T14:38:28Z",
        "updatedAt" : "2021-06-18T14:38:28Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      }
    ],
    "commit" : "bb9f055ad27514f574d4bdbe2f91a0a4bf3b43ff",
    "line" : 83,
    "diffHunk" : "@@ -1,1 +177,181 @@          }\n        }\n      case _ => throw new IllegalArgumentException(\n        s\"Interval string does not match year-month format of \" +\n          s\"${supportedFormat((YM.YEAR, YM.MONTH))"
  },
  {
    "id" : "15fa383f-c192-4200-8cc9-dbd07e042263",
    "prId" : 32940,
    "prUrl" : "https://github.com/apache/spark/pull/32940#pullrequestreview-691451928",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2bd85d04-c075-417d-af5f-694373af01e6",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "The regex\r\n```scala\r\n  private val yearMonthLiteralRegex =\r\n    (s\"(?i)^INTERVAL\\\\s+([+|-])?'$yearMonthPatternString'\\\\s+YEAR\\\\s+TO\\\\s+MONTH$$\").r\r\n```\r\ndoesn't support other year-month interval types, for instance `INTERVAL MONTH`. @cloud-fan Again, this is a duplicate of SQL parser logic.",
        "createdAt" : "2021-06-17T19:21:30Z",
        "updatedAt" : "2021-06-17T19:25:14Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "8accd3fe-96ae-4452-8517-58f9a389bf6b",
        "parentId" : "2bd85d04-c075-417d-af5f-694373af01e6",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Let's unify them later",
        "createdAt" : "2021-06-23T08:10:00Z",
        "updatedAt" : "2021-06-23T08:10:00Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "af653e69-25c8-4753-918b-8c97e836bb8e",
        "parentId" : "2bd85d04-c075-417d-af5f-694373af01e6",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "@AngersZhuuuu Could you open JIRA ticket for this, please.",
        "createdAt" : "2021-06-24T07:49:37Z",
        "updatedAt" : "2021-06-24T07:49:37Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "769e5382-1cf4-4935-a90b-0fa8c606f641",
        "parentId" : "2bd85d04-c075-417d-af5f-694373af01e6",
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "> @AngersZhuuuu Could you open JIRA ticket for this, please.\r\n\r\nSure and will work for ths.",
        "createdAt" : "2021-06-24T08:00:48Z",
        "updatedAt" : "2021-06-24T08:00:48Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      }
    ],
    "commit" : "bb9f055ad27514f574d4bdbe2f91a0a4bf3b43ff",
    "line" : 49,
    "diffHunk" : "@@ -1,1 +148,152 @@        checkStringIntervalType(YM.YEAR, YM.MONTH)\n        toYMInterval(year, month, 1)\n      case yearMonthLiteralRegex(firstSign, secondSign, year, month) =>\n        checkStringIntervalType(YM.YEAR, YM.MONTH)\n        toYMInterval(year, month, getSign(firstSign, secondSign))"
  },
  {
    "id" : "c72ad714-24b8-49a2-812a-adaf651f61b4",
    "prId" : 32601,
    "prUrl" : "https://github.com/apache/spark/pull/32601#pullrequestreview-684806678",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d7cbb07e-993c-4bec-a40c-ebca83586a5b",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Should hours (and other fields) be in some range? See the table from the SQL:2016\r\n<img width=\"595\" alt=\"Screenshot 2021-06-14 at 20 41 45\" src=\"https://user-images.githubusercontent.com/1580697/121935371-07b0bb80-cd51-11eb-851d-000c865f99c4.png\">\r\nIf not, please, explain.",
        "createdAt" : "2021-06-14T17:43:43Z",
        "updatedAt" : "2021-06-14T17:45:07Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "3425010b-0bc2-4c3f-b541-c64977c914dc",
        "parentId" : "d7cbb07e-993c-4bec-a40c-ebca83586a5b",
        "authorId" : "924ae4ed-b84b-4216-9852-5db80e7d0e1b",
        "body" : "Well, it's true that the range of fields such as hour breaks SQL:2016. And other interval related functions such as `make_interval` and `make_ym_interval` have same problem. Further more, MySQL and PostgreSQL have same behavior, following is the example of PG:\r\n![image](https://user-images.githubusercontent.com/2949045/122197365-b0cef180-ceca-11eb-81af-4427dc6e55a2.png)\r\n\r\nSo, I think we should keep the consistency with other functions first, and launch a discussion for further decision.\r\nBy the way, could you give me the link of the SQL:2016 image by adding a new comment?",
        "createdAt" : "2021-06-16T09:48:16Z",
        "updatedAt" : "2021-06-17T01:16:00Z",
        "lastEditedBy" : "924ae4ed-b84b-4216-9852-5db80e7d0e1b",
        "tags" : [
        ]
      }
    ],
    "commit" : "b2ab3a08c47129b96ecdd6aa0aca124a370cfbdb",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +871,875 @@    var micros = secs.toUnscaledLong\n    micros = Math.addExact(micros, Math.multiplyExact(days, MICROS_PER_DAY))\n    micros = Math.addExact(micros, Math.multiplyExact(hours, MICROS_PER_HOUR))\n    micros = Math.addExact(micros, Math.multiplyExact(mins, MICROS_PER_MINUTE))\n    micros"
  },
  {
    "id" : "ae91a8bc-2862-45ab-8e6b-5b69759589cf",
    "prId" : 32271,
    "prUrl" : "https://github.com/apache/spark/pull/32271#pullrequestreview-654436695",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ed3c26f9-f89f-40ac-9622-957de1d46e65",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "`unquotedDaySecondRegex`?",
        "createdAt" : "2021-05-07T12:58:59Z",
        "updatedAt" : "2021-05-07T12:58:59Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "c793b794-75e5-4b83-a953-1da002e3c09a",
        "parentId" : "ed3c26f9-f89f-40ac-9622-957de1d46e65",
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "> `unquotedDaySecondRegex`?\r\n\r\nChange this in https://github.com/apache/spark/pull/32444",
        "createdAt" : "2021-05-07T13:06:37Z",
        "updatedAt" : "2021-05-07T13:06:38Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      }
    ],
    "commit" : "4e2608c92809bc1e1e08271c98060592e3861728",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +153,157 @@  private val unquotedDaySecondPattern =\n    \"([+|-])?(\\\\d+) (\\\\d{1,2}):(\\\\d{1,2}):(\\\\d{1,2})(\\\\.\\\\d{1,9})?\"\n  private val quotedDaySecondPattern = (s\"^$unquotedDaySecondPattern$$\").r\n  private val daySecondLiteralPattern =\n    (s\"(?i)^INTERVAL\\\\s+([+|-])?\\\\'$unquotedDaySecondPattern\\\\'\\\\s+DAY\\\\s+TO\\\\s+SECOND$$\").r"
  },
  {
    "id" : "91d1d73a-db28-4927-abbb-81bf5fb4482a",
    "prId" : 32266,
    "prUrl" : "https://github.com/apache/spark/pull/32266#pullrequestreview-646891606",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "31328577-f096-4b4b-af8a-597f8d0f784e",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Now I understand why we need a new version of `fromYearMonthString`, as we need to allow `INTERVAL ... YEAR TO MONTH`. Let's make it clear in the PR description.\r\n\r\nLet's add a new method `castStringToYMInterval`, and define a new regex for it.",
        "createdAt" : "2021-04-27T08:03:51Z",
        "updatedAt" : "2021-04-30T02:48:23Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "c83493dc-6de9-4c19-a058-e0f429824393",
        "parentId" : "31328577-f096-4b4b-af8a-597f8d0f784e",
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "Doneï¼Œ how about current?",
        "createdAt" : "2021-04-28T10:27:05Z",
        "updatedAt" : "2021-04-30T02:48:23Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      }
    ],
    "commit" : "5ca83abe001897216575fad9f00906de553626c6",
    "line" : 28,
    "diffHunk" : "@@ -1,1 +118,122 @@   * adapted from HiveIntervalYearMonth.valueOf\n   */\n  def fromYearMonthString(input: String): CalendarInterval = {\n    require(input != null, \"Interval year-month string must be not null\")\n    input.trim match {"
  },
  {
    "id" : "e8163b6a-f139-4d8e-919b-09d844047b8a",
    "prId" : 32070,
    "prUrl" : "https://github.com/apache/spark/pull/32070#pullrequestreview-629754020",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e37415a5-9796-4baa-a420-3204b00bf5b1",
        "parentId" : null,
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "nice catch!",
        "createdAt" : "2021-04-07T08:50:27Z",
        "updatedAt" : "2021-04-07T08:50:28Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      }
    ],
    "commit" : "0bb44e39ca3060d8217c81b72fdc6dee202a02c1",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +864,868 @@    var rest = micros\n    if (micros < 0) {\n      if (micros == Long.MinValue) {\n        // Especial handling of minimum `Long` value because negate op overflows `Long`.\n        // seconds = 106751991 * (24 * 60 * 60) + 4 * 60 * 60 + 54 = 9223372036854"
  },
  {
    "id" : "16ceaf4b-52ac-45f8-a5f0-99ba59fec630",
    "prId" : 31765,
    "prUrl" : "https://github.com/apache/spark/pull/31765#pullrequestreview-606052999",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a1b178b4-1d55-428d-b2d9-dfd1a29323c0",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Shall we fail if the day field is not 0? Or at least give a warning?",
        "createdAt" : "2021-03-08T07:58:04Z",
        "updatedAt" : "2021-03-08T07:58:05Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "fd5c4f1d-01b1-46c1-a557-769567953599",
        "parentId" : "a1b178b4-1d55-428d-b2d9-dfd1a29323c0",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "We don't fail when we convert:\r\n\r\n1. `java.sql.Date` has time component with millisecond precision but we ignore it when we convert to days at https://github.com/apache/spark/blob/56e664c7179eadeb5134b4418f3aaa6a9d742ef6/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/util/DateTimeUtils.scala#L93\r\n2. `java.sql.Timestamp` which has nanoseconds precision: https://github.com/apache/spark/blob/56e664c7179eadeb5134b4418f3aaa6a9d742ef6/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/util/DateTimeUtils.scala#L166\r\n3. `java.time.Instant` which contains nanoseconds, and we don't fail when we convert it to microseconds: https://github.com/apache/spark/blob/56e664c7179eadeb5134b4418f3aaa6a9d742ef6/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/util/DateTimeUtils.scala#L383\r\n\r\nTo be consistent with current implementation for other types, I do believe we should not fail.\r\n\r\n> Or at least give a warning?\r\n\r\nThis will just fill in the logs by useless records, and this is again inconsistent with current implementation.",
        "createdAt" : "2021-03-08T08:23:50Z",
        "updatedAt" : "2021-03-08T08:26:46Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "c22e01ed0e66a959619cfcb2b2dc253786512971",
    "line" : 24,
    "diffHunk" : "@@ -1,1 +803,807 @@   * @throws ArithmeticException If numeric overflow occurs\n   */\n  def periodToMonths(period: Period): Int = {\n    val monthsInYears = Math.multiplyExact(period.getYears, MONTHS_PER_YEAR)\n    Math.addExact(monthsInYears, period.getMonths)"
  },
  {
    "id" : "488360ba-14b1-4b79-8bea-b8062df2534c",
    "prId" : 28886,
    "prUrl" : "https://github.com/apache/spark/pull/28886#pullrequestreview-435690739",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "1659c22c-c2ef-41f0-894c-5e6c8cc397a3",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "shall we check the precision as well?",
        "createdAt" : "2020-06-23T06:47:52Z",
        "updatedAt" : "2020-06-23T06:47:53Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "a497622d-1221-46c5-af04-11250c8fecc6",
        "parentId" : "1659c22c-c2ef-41f0-894c-5e6c8cc397a3",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "We can check it but `precision` value is not important for this code...or I am wrong?",
        "createdAt" : "2020-06-23T07:01:42Z",
        "updatedAt" : "2020-06-23T07:01:42Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "5888e9d2-b775-4456-9013-b205484a3ca9",
        "parentId" : "1659c22c-c2ef-41f0-894c-5e6c8cc397a3",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "So, `Decimal` guarantees that `precision` >= `scale` (@Ngone51 correct?). That's enough for the code.",
        "createdAt" : "2020-06-23T07:40:10Z",
        "updatedAt" : "2020-06-23T07:40:11Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "31c888cd-393d-4329-b7c6-f7ba16f8d486",
        "parentId" : "1659c22c-c2ef-41f0-894c-5e6c8cc397a3",
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "Technically, I think we should say `DecimalType`  guarantees `precision` >= `scale`. But since any `Decimal` is directly or indirectly bounded with a `DecimalType`. Therefore, `Decimal` also guarantees `precision` >= `scale`.",
        "createdAt" : "2020-06-23T08:11:00Z",
        "updatedAt" : "2020-06-23T08:11:01Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      },
      {
        "id" : "4b8b82e7-e99a-4ebc-b00c-bc7fa04c23df",
        "parentId" : "1659c22c-c2ef-41f0-894c-5e6c8cc397a3",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "I just want to be consistent with https://github.com/apache/spark/pull/28886/files#diff-b83497f7bc11578a0b63a814a2a30f48R2003",
        "createdAt" : "2020-06-23T09:12:27Z",
        "updatedAt" : "2020-06-23T09:12:27Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "5681e0d3-dc04-4cf7-b6fa-4c7e3efdb308",
        "parentId" : "1659c22c-c2ef-41f0-894c-5e6c8cc397a3",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "I added assert there to guarantee that Int will not overflow. What would you like to assert here?",
        "createdAt" : "2020-06-23T09:16:01Z",
        "updatedAt" : "2020-06-23T09:16:01Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "8ab60cb1-e869-4bb6-a4e4-373a2579218c",
        "parentId" : "1659c22c-c2ef-41f0-894c-5e6c8cc397a3",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "for sanity check? The `precision` must be `<= 8` here, right?",
        "createdAt" : "2020-06-23T11:26:44Z",
        "updatedAt" : "2020-06-23T11:26:44Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "dd570fa2-2834-4ff8-a231-c6be761bd65a",
        "parentId" : "1659c22c-c2ef-41f0-894c-5e6c8cc397a3",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Not anymore, please, take a look at https://github.com/apache/spark/pull/28873 and https://issues.apache.org/jira/browse/SPARK-32021",
        "createdAt" : "2020-06-23T11:31:22Z",
        "updatedAt" : "2020-06-23T11:32:17Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "b9e2ee097bdbe6c6ff1d5680025ade7cc9fca9e7",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +752,756 @@    val totalMonths = Math.addExact(months, Math.multiplyExact(years, MONTHS_PER_YEAR))\n    val totalDays = Math.addExact(days, Math.multiplyExact(weeks, DAYS_PER_WEEK))\n    assert(secs.scale == 6, \"Seconds fractional must have 6 digits for microseconds\")\n    var micros = secs.toUnscaledLong\n    micros = Math.addExact(micros, Math.multiplyExact(hours, MICROS_PER_HOUR))"
  },
  {
    "id" : "f66250d7-8965-4890-9411-64580816663a",
    "prId" : 26995,
    "prUrl" : "https://github.com/apache/spark/pull/26995#pullrequestreview-336687245",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "87d53853-900c-46fa-8286-d8978aa9bab1",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "ah, seems better to follow the java naming conversion: `negate` and `negateExact`. ",
        "createdAt" : "2019-12-27T06:27:38Z",
        "updatedAt" : "2020-01-02T09:09:38Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "895373be-7d9e-498b-9b93-f39cf3c8a46c",
        "parentId" : "87d53853-900c-46fa-8286-d8978aa9bab1",
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "sgtm",
        "createdAt" : "2019-12-27T07:01:46Z",
        "updatedAt" : "2020-01-02T09:09:38Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      }
    ],
    "commit" : "f80f0f37c0e26eba797ee9ab047e7df3ec4ffb1f",
    "line" : 27,
    "diffHunk" : "@@ -1,1 +422,426 @@   */\n  def negateExact(interval: CalendarInterval): CalendarInterval = {\n    val months = Math.negateExact(interval.months)\n    val days = Math.negateExact(interval.days)\n    val microseconds = Math.negateExact(interval.microseconds)"
  },
  {
    "id" : "70cd0b7e-6bd7-4962-825a-482e73040d5c",
    "prId" : 26573,
    "prUrl" : "https://github.com/apache/spark/pull/26573#pullrequestreview-318840455",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "18495ccd-437e-4c35-8dbb-60eb9298359d",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "do we still need it now?",
        "createdAt" : "2019-11-19T08:02:37Z",
        "updatedAt" : "2019-11-19T08:02:37Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "f6b0edd79aac4c415afc1bad3ca3c9cd6cf21cbc",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +506,510 @@    var microseconds: Long = 0\n    var fractionScale: Int = 0\n    val initialFractionScale = (NANOS_PER_SECOND / 10).toInt\n    var fraction: Int = 0\n    var pointPrefixed: Boolean = false"
  },
  {
    "id" : "99a01b35-9bef-43e1-8266-240114cb0365",
    "prId" : 26573,
    "prUrl" : "https://github.com/apache/spark/pull/26573#pullrequestreview-318847648",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d35b178c-4b6c-4af5-8c28-a777806d888d",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "since `1.` is allowed, I don't think `fractionScale < initialFractionScale` is a valid check any more.",
        "createdAt" : "2019-11-19T08:03:20Z",
        "updatedAt" : "2019-11-19T08:03:21Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "2f2666a2-7c2a-4121-bba9-d915c1e5550a",
        "parentId" : "d35b178c-4b6c-4af5-8c28-a777806d888d",
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "we need this, the cases are (`1.0`, `0.1`, `.1`,  `1.`) + (`.`), this condition is equal to `!(pointPrefixed && fractionScale == initialFractionScale)`",
        "createdAt" : "2019-11-19T08:10:30Z",
        "updatedAt" : "2019-11-19T08:10:30Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      },
      {
        "id" : "d0fb8579-5072-4f72-8a30-2dc77ab98bb9",
        "parentId" : "d35b178c-4b6c-4af5-8c28-a777806d888d",
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "rm `fractionScale < initialFractionScale` forbiding `.1` case",
        "createdAt" : "2019-11-19T08:11:32Z",
        "updatedAt" : "2019-11-19T08:11:32Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      },
      {
        "id" : "daf92ce4-c3fe-4c07-9fab-b8c6e2c12b1f",
        "parentId" : "d35b178c-4b6c-4af5-8c28-a777806d888d",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "ah i see!",
        "createdAt" : "2019-11-19T08:16:59Z",
        "updatedAt" : "2019-11-19T08:16:59Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "f6b0edd79aac4c415afc1bad3ca3c9cd6cf21cbc",
    "line" : 42,
    "diffHunk" : "@@ -1,1 +587,591 @@              fraction += (b - '0') * fractionScale\n              fractionScale /= 10\n            case ' ' if !pointPrefixed || fractionScale < initialFractionScale =>\n              fraction /= NANOS_PER_MICROS.toInt\n              state = TRIM_BEFORE_UNIT"
  },
  {
    "id" : "987f07ad-fe7a-4b37-a143-30a64ea37944",
    "prId" : 26572,
    "prUrl" : "https://github.com/apache/spark/pull/26572#pullrequestreview-318293183",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "bf486f4b-e1a2-4eb2-ada6-f909545de626",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "probably add a comment saying that the `toString` implementation is the multi-units format.",
        "createdAt" : "2019-11-18T12:26:33Z",
        "updatedAt" : "2019-11-19T00:10:16Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "eefd45733435f7afa851449605bbaf7d18ccf9e8",
    "line" : 33,
    "diffHunk" : "@@ -1,1 +334,338 @@\n  // `toString` implementation in CalendarInterval is the multi-units format currently.\n  def toMultiUnitsString(interval: CalendarInterval): String = interval.toString\n\n  def toSqlStandardString(interval: CalendarInterval): String = {"
  },
  {
    "id" : "e9e684bf-c806-47ea-b1f9-09e6fdf759cf",
    "prId" : 26514,
    "prUrl" : "https://github.com/apache/spark/pull/26514#pullrequestreview-316978590",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "dac02fae-9614-4292-bbfc-54fd313bbb43",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "The comment is useless from my point of view. It describes what is obvious from the code but does not say why.",
        "createdAt" : "2019-11-14T09:11:40Z",
        "updatedAt" : "2019-11-14T14:17:54Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "8a362d36-cf87-484f-ba83-b726167afdc9",
        "parentId" : "dac02fae-9614-4292-bbfc-54fd313bbb43",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "agree. @yaooqinn can you refine the comments to explain why? We should mention that it's to support `.1 second`",
        "createdAt" : "2019-11-14T12:54:13Z",
        "updatedAt" : "2019-11-14T14:17:54Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "cfc509e6-4e25-486f-af55-32735309b831",
        "parentId" : "dac02fae-9614-4292-bbfc-54fd313bbb43",
        "authorId" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "body" : "OK",
        "createdAt" : "2019-11-14T14:09:13Z",
        "updatedAt" : "2019-11-14T14:17:54Z",
        "lastEditedBy" : "c62ded40-3015-4888-8e91-d671d0f615be",
        "tags" : [
        ]
      }
    ],
    "commit" : "76ba7ef9eff79276d6e4099527ce231fe8e60d6f",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +499,503 @@          currentValue = 0\n          fraction = 0\n          // We preset next state from SIGN to TRIM_BEFORE_VALUE. If we meet '.' in the SIGN state,\n          // it means that the interval value we deal with here is a numeric with only fractional\n          // part, such as '.11 second', which can be parsed to 0.11 seconds. In this case, we need"
  }
]