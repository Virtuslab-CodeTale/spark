[
  {
    "id" : "ff3ab9dc-d8d1-48f3-a87c-019575e5c5cf",
    "prId" : 29626,
    "prUrl" : "https://github.com/apache/spark/pull/29626#pullrequestreview-485526854",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8a41148d-b382-4364-a832-231264442036",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "can we add some comments to explain why we are doing it?",
        "createdAt" : "2020-09-10T02:10:29Z",
        "updatedAt" : "2020-09-10T02:41:13Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "48f20d7f-68ff-4423-b0a4-d9bf85c6671c",
        "parentId" : "8a41148d-b382-4364-a832-231264442036",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "OK",
        "createdAt" : "2020-09-10T02:41:34Z",
        "updatedAt" : "2020-09-10T02:41:34Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "16588f56d1d50e73908d5431062012a8ed20d922",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +298,302 @@              // distinctAggGroups. So here we only need to rewrite the first child to\n              // `if (gid = ...) ...` or `if (gid = ... and condition) ...`.\n              val firstChild = evalWithinGroup(id, af.children.head, condition)\n              af.withNewChildren(firstChild +: af.children.drop(1)).asInstanceOf[AggregateFunction]\n            } else {"
  },
  {
    "id" : "fd7fc30c-4da7-4a20-bbc4-d1cc6bc0403d",
    "prId" : 29291,
    "prUrl" : "https://github.com/apache/spark/pull/29291#pullrequestreview-459090039",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "029ab820-1308-4022-a846-5b8657b64c2d",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "can we add a comment here so that it's easier for others to understand?\r\n```\r\n// If 'max_cond1 is true, it means at least one row of a distinct value satisfies the filter.\r\n// This distinct value should be included in the aggregate function.\r\nfunctions = [count(if (('gid = 1) and 'max_cond1) 'cat1 else null),\r\n```",
        "createdAt" : "2020-07-31T07:24:24Z",
        "updatedAt" : "2020-08-03T05:40:34Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "d8f21899-24f2-44bb-acd0-11675c581b23",
        "parentId" : "029ab820-1308-4022-a846-5b8657b64c2d",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "OK",
        "createdAt" : "2020-07-31T10:57:40Z",
        "updatedAt" : "2020-08-03T05:40:34Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "883973b9bc8a9c530a002cf4b48217546929fb5e",
    "line" : 73,
    "diffHunk" : "@@ -1,1 +146,150 @@ * Aggregate(\n *    key = ['key]\n *    functions = [count(if (('gid = 1) and 'max_cond1) 'cat1 else null),\n *                 count(if (('gid = 2) and 'max_cond2) 'cat2 else null),\n *                 first(if (('gid = 0)) 'total else null) ignore nulls]"
  },
  {
    "id" : "6108c771-ec4d-423e-bc3e-9075cdd54081",
    "prId" : 29135,
    "prUrl" : "https://github.com/apache/spark/pull/29135#pullrequestreview-450549140",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a73e5212-34b1-4a52-b0fa-f4a9493baee1",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "what does it do?",
        "createdAt" : "2020-07-17T08:52:40Z",
        "updatedAt" : "2020-07-18T03:49:46Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "8f05da99-b5bf-4c37-90c4-46dfe1d3a936",
        "parentId" : "a73e5212-34b1-4a52-b0fa-f4a9493baee1",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "Because `RewriteDistinctAggregates` will create new attr to replace attr, so we need to update the attr in filter clause with the new one.",
        "createdAt" : "2020-07-17T10:28:55Z",
        "updatedAt" : "2020-07-18T03:49:46Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "ba7c3a4d3ad5827f03c09356f93079732284e29d",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +228,232 @@            }\n            val filterOpt = e.filter.map(_.transform {\n              case a: Attribute => distinctAggChildAttrLookup.getOrElse(a, a)\n            })\n            (e, e.copy(aggregateFunction = naf, isDistinct = false, filter = filterOpt))"
  }
]