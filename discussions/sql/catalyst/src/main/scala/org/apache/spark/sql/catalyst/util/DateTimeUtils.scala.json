[
  {
    "id" : "6030794a-0dfa-4ce7-a4e7-6f7ee530c084",
    "prId" : 32959,
    "prUrl" : "https://github.com/apache/spark/pull/32959#pullrequestreview-699672586",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c26a8b86-6b67-44be-b4e4-04395a2992a5",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "for `+12:12:12` do we fail or simply ignore the `+`?",
        "createdAt" : "2021-07-02T07:43:04Z",
        "updatedAt" : "2021-07-02T07:43:05Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "c0cbbf63-1d67-4715-9a42-02aae348c9cc",
        "parentId" : "c26a8b86-6b67-44be-b4e4-04395a2992a5",
        "authorId" : "29c89154-22f7-40ee-b295-115a55734d6c",
        "body" : "we simply ignore the `+`",
        "createdAt" : "2021-07-02T08:39:31Z",
        "updatedAt" : "2021-07-02T08:39:31Z",
        "lastEditedBy" : "29c89154-22f7-40ee-b295-115a55734d6c",
        "tags" : [
        ]
      },
      {
        "id" : "af877d78-37ab-428b-946f-ab7e50559766",
        "parentId" : "c26a8b86-6b67-44be-b4e4-04395a2992a5",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "I think failing is better? Since we won't respect `-` here anyway.",
        "createdAt" : "2021-07-02T12:05:50Z",
        "updatedAt" : "2021-07-02T12:05:50Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "9ac87ba2-0867-4f4b-8e12-0150d813092c",
        "parentId" : "c26a8b86-6b67-44be-b4e4-04395a2992a5",
        "authorId" : "29c89154-22f7-40ee-b295-115a55734d6c",
        "body" : "actually the we will respect the `-`, for example:\r\n```\r\nscala> sql(\"select date'-12-12-12'\").show()\r\n+------------------+\r\n|DATE '-0012-12-12'|\r\n+------------------+\r\n|       -0012-12-12|\r\n+------------------+\r\n\r\nscala> sql(\"select date'+12-12-12'\").show()\r\n+-----------------+\r\n|DATE '0012-12-12'|\r\n+-----------------+\r\n|       0012-12-12|\r\n+-----------------+\r\n\r\n```",
        "createdAt" : "2021-07-05T02:48:07Z",
        "updatedAt" : "2021-07-05T02:48:07Z",
        "lastEditedBy" : "29c89154-22f7-40ee-b295-115a55734d6c",
        "tags" : [
        ]
      },
      {
        "id" : "9e93ba1e-eb7d-439e-b1e7-3a99ec964bc2",
        "parentId" : "c26a8b86-6b67-44be-b4e4-04395a2992a5",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "are you sure? It seems we only consider the sign for year: https://github.com/apache/spark/pull/32959/files#diff-f59286f6576476c68ae766de0430fc41d424804dbb0658e0dccd998b0d9a756dR404",
        "createdAt" : "2021-07-06T04:58:54Z",
        "updatedAt" : "2021-07-06T04:58:54Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "5c61b2c4-d1c3-4c33-90a0-beb0572e21ef",
        "parentId" : "c26a8b86-6b67-44be-b4e4-04395a2992a5",
        "authorId" : "29c89154-22f7-40ee-b295-115a55734d6c",
        "body" : "I see. good catch.",
        "createdAt" : "2021-07-06T08:24:40Z",
        "updatedAt" : "2021-07-06T08:24:40Z",
        "lastEditedBy" : "29c89154-22f7-40ee-b295-115a55734d6c",
        "tags" : [
        ]
      }
    ],
    "commit" : "538463a405c2eac1ddfccba8d82ca846f81e5a22",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +231,235 @@   * `[+-]yyyy*-[m]m-[d]d [h]h:[m]m:[s]s.[ms][ms][ms][us][us][us][zone_id]`\n   * `[+-]yyyy*-[m]m-[d]dT[h]h:[m]m:[s]s.[ms][ms][ms][us][us][us][zone_id]`\n   * `[h]h:[m]m:[s]s.[ms][ms][ms][us][us][us][zone_id]`\n   * `T[h]h:[m]m:[s]s.[ms][ms][ms][us][us][us][zone_id]`\n   *"
  },
  {
    "id" : "a06752c3-bfc2-4f57-8305-142a2ff49d6a",
    "prId" : 32959,
    "prUrl" : "https://github.com/apache/spark/pull/32959#pullrequestreview-702361484",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8d601ae4-ec6b-4303-810f-dbea949522fc",
        "parentId" : null,
        "authorId" : "29c89154-22f7-40ee-b295-115a55734d6c",
        "body" : "segments except year are allowed to have 0 digits before this PR. so I didn't do zero checks for these segments.\r\nfor example, before and after this PR, the below query is valid:\r\n```sql\r\nselect cast('12::' as timestamp); -- output: 2021-07-07 12:00:00\r\nselect cast('T' as timestamp); -- output: 2021-07-07 00:00:00\r\n```",
        "createdAt" : "2021-07-07T03:36:24Z",
        "updatedAt" : "2021-07-07T04:58:50Z",
        "lastEditedBy" : "29c89154-22f7-40ee-b295-115a55734d6c",
        "tags" : [
        ]
      },
      {
        "id" : "5ab0c04f-e5f4-4022-88ee-bc0c037acb54",
        "parentId" : "8d601ae4-ec6b-4303-810f-dbea949522fc",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "good catch, we should fail it. Let's do it in another PR.",
        "createdAt" : "2021-07-08T18:07:32Z",
        "updatedAt" : "2021-07-08T18:07:33Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "538463a405c2eac1ddfccba8d82ca846f81e5a22",
    "line" : 29,
    "diffHunk" : "@@ -1,1 +255,259 @@      // For the nanosecond part, more than 6 digits is allowed, but will be truncated.\n      segment == 6 || (segment == 0 && digits >= 4 && digits <= maxDigitsYear) ||\n        (segment != 0 && segment != 6 && digits <= 2)\n    }\n    if (s == null || s.trimAll().numBytes() == 0) {"
  },
  {
    "id" : "7b646c32-8e30-4474-b3a2-0cd48658ccd8",
    "prId" : 32839,
    "prUrl" : "https://github.com/apache/spark/pull/32839#pullrequestreview-680269083",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2a768081-8606-4263-83e8-cea20f6fa001",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "We know `sec` in advance, so, we can calculate `us` in advance too. Please, fold the arithmetic expression. ",
        "createdAt" : "2021-06-09T13:24:52Z",
        "updatedAt" : "2021-06-09T13:24:53Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "b135c721-5966-4ada-9156-59040e249ee5",
        "parentId" : "2a768081-8606-4263-83e8-cea20f6fa001",
        "authorId" : "87a71d79-d4d2-4f2c-8e9a-be56cf39b035",
        "body" : "Are you sure? as us might be (secs+1) or secs depend on case",
        "createdAt" : "2021-06-09T14:16:43Z",
        "updatedAt" : "2021-06-09T14:16:44Z",
        "lastEditedBy" : "87a71d79-d4d2-4f2c-8e9a-be56cf39b035",
        "tags" : [
        ]
      },
      {
        "id" : "006c2a2a-fd5a-4088-92ef-ecd4182191fb",
        "parentId" : "2a768081-8606-4263-83e8-cea20f6fa001",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "`Math.floorDiv(Long.MinValue, MICROS_PER_SECOND)` is constant, right?",
        "createdAt" : "2021-06-09T14:33:15Z",
        "updatedAt" : "2021-06-09T14:33:16Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "1e9682f8-95f0-43bb-a03c-f0805ebad831",
        "parentId" : "2a768081-8606-4263-83e8-cea20f6fa001",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "I think it's rare to hit this branch and creating a constant for it is not necessary.",
        "createdAt" : "2021-06-09T15:20:41Z",
        "updatedAt" : "2021-06-09T15:20:41Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "042084de-d679-47b9-be06-e17f091003d5",
        "parentId" : "2a768081-8606-4263-83e8-cea20f6fa001",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "I mostly care of the comparison:\r\n```scala\r\nsecs == Math.floorDiv(Long.MinValue, MICROS_PER_SECOND)\r\n```\r\nwhich is performed per every input. Probably, JVM could optimize it but I would help to it and introduced a constant.",
        "createdAt" : "2021-06-09T15:40:15Z",
        "updatedAt" : "2021-06-09T15:40:15Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "de64f3a5-e96b-4cf0-a75f-425caff95432",
        "parentId" : "2a768081-8606-4263-83e8-cea20f6fa001",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Yea this should be a constant, but after we enter the if branch and reach here, it's rare and I'm OK to not have a constant for `val us = ...`",
        "createdAt" : "2021-06-09T16:04:36Z",
        "updatedAt" : "2021-06-09T16:04:36Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "ea7821f3-b668-4477-a496-105d8c63acdb",
        "parentId" : "2a768081-8606-4263-83e8-cea20f6fa001",
        "authorId" : "87a71d79-d4d2-4f2c-8e9a-be56cf39b035",
        "body" : "Done, thanks",
        "createdAt" : "2021-06-10T01:27:27Z",
        "updatedAt" : "2021-06-10T01:27:27Z",
        "lastEditedBy" : "87a71d79-d4d2-4f2c-8e9a-be56cf39b035",
        "tags" : [
        ]
      }
    ],
    "commit" : "134c356cb004283d477f1ce1a98cff97c194fc3f",
    "line" : 19,
    "diffHunk" : "@@ -1,1 +391,395 @@    val secs = instant.getEpochSecond\n    if (secs == MIN_SECONDS) {\n      val us = Math.multiplyExact(secs + 1, MICROS_PER_SECOND)\n      Math.addExact(us, NANOSECONDS.toMicros(instant.getNano) - MICROS_PER_SECOND)\n    } else {"
  },
  {
    "id" : "c0c916ca-96cb-498a-8590-9cb48dae4765",
    "prId" : 31624,
    "prUrl" : "https://github.com/apache/spark/pull/31624#pullrequestreview-597006083",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5caec95e-3bec-4d68-81a8-80249867dd56",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "This change affects all the datetime related functionalities, so I think we need more tests and document updates.",
        "createdAt" : "2021-02-24T02:22:37Z",
        "updatedAt" : "2021-02-25T05:44:36Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "41e0cb063d06d621049aa7103458b33fcf3fd098",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +51,55 @@  val TIMEZONE_OPTION = \"timeZone\"\n\n  def getZoneId(timeZoneId: String): ZoneId = {\n    // To support the (+|-)h:mm format because it was supported before Spark 3.0.\n    ZoneId.of(timeZoneId.replaceFirst(\"(\\\\+|\\\\-)(\\\\d):\", \"$10$2:\"), ZoneId.SHORT_IDS)"
  },
  {
    "id" : "baa1e657-fc40-461c-91ca-c46c46c2b1e6",
    "prId" : 30687,
    "prUrl" : "https://github.com/apache/spark/pull/30687#pullrequestreview-550073041",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9b6be110-765d-424e-8471-629a33e7f5dd",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "can you also update `stringToTimestampAnsi` to follow this code style?",
        "createdAt" : "2020-12-11T06:53:43Z",
        "updatedAt" : "2020-12-11T12:54:13Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "7b2a782f-2708-49e6-b5b4-9d8647865f6b",
        "parentId" : "9b6be110-765d-424e-8471-629a33e7f5dd",
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "sure, updated.",
        "createdAt" : "2020-12-11T12:54:58Z",
        "updatedAt" : "2020-12-11T12:54:58Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      }
    ],
    "commit" : "c3c82ebfb5b613fcb2382c42d747b0233ee04a86",
    "line" : 18,
    "diffHunk" : "@@ -1,1 +465,469 @@\n  def stringToDateAnsi(s: UTF8String, zoneId: ZoneId): Int = {\n    stringToDate(s, zoneId).getOrElse {\n      throw new DateTimeException(s\"Cannot cast $s to DateType.\")\n    }"
  }
]