[
  {
    "id" : "b119601d-85a8-467f-a0aa-195d2c3db2c9",
    "prId" : 32687,
    "prUrl" : "https://github.com/apache/spark/pull/32687#pullrequestreview-671006195",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2a7ca437-7c9e-40b7-9dcd-25628198db0c",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "can we add classdoc to explain these parameters?",
        "createdAt" : "2021-05-28T07:25:10Z",
        "updatedAt" : "2021-05-28T07:25:10Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "eab933a1ae2907f3c75000c44079abdaa09b447f",
    "line" : 10,
    "diffHunk" : "@@ -1,1 +66,70 @@ * @param joinCond: the join conditions with the outer query. It contains both inner and outer\n *                  query references.\n */\nabstract class SubqueryExpression(\n    plan: LogicalPlan,"
  },
  {
    "id" : "d399b2cd-928c-404b-8d62-80cd3a3aeeae",
    "prId" : 32503,
    "prUrl" : "https://github.com/apache/spark/pull/32503#pullrequestreview-661015438",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "291a403f-2ad0-4958-ad75-ce475d7f4449",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "@cloud-fan . This is a core logic refactoring instead of `Improve error message for correlated subquery`.\r\nCould you revise the PR title and description?",
        "createdAt" : "2021-05-16T17:55:21Z",
        "updatedAt" : "2021-05-16T17:55:21Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "87b36007-1df4-4a4c-b2a4-628eb5d7d870",
        "parentId" : "291a403f-2ad0-4958-ad75-ce475d7f4449",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "done",
        "createdAt" : "2021-05-17T14:10:44Z",
        "updatedAt" : "2021-05-17T14:10:44Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "6de4a152b8fb7f075e58d53eaf194acfdccc345b",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +189,193 @@   */\n  def getOuterReferences(expr: Expression): Seq[Expression] = {\n    val outerExpressions = ArrayBuffer.empty[Expression]\n    def collectOutRefs(input: Expression): Unit = input match {\n      case a: AggregateExpression if containsOuter(a) =>"
  },
  {
    "id" : "48dc0382-92b2-4121-9cb6-3c39666825e1",
    "prId" : 32303,
    "prUrl" : "https://github.com/apache/spark/pull/32303#pullrequestreview-677725069",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "16df5361-9e9d-4f78-ae3c-1fe1bf044ad1",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "can this be `Seq[Attribute]`?",
        "createdAt" : "2021-06-07T17:52:44Z",
        "updatedAt" : "2021-06-07T17:52:44Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "b7050367-c8cb-41cd-8201-095a25c23b9d",
        "parentId" : "16df5361-9e9d-4f78-ae3c-1fe1bf044ad1",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "I see, this is the outer references, the name follows `ScalarSubquery`",
        "createdAt" : "2021-06-07T17:58:01Z",
        "updatedAt" : "2021-06-07T17:58:01Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "01fa70ec156ad5540b862c4b13dd1257062f31fb",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +294,298 @@case class LateralSubquery(\n    plan: LogicalPlan,\n    outerAttrs: Seq[Expression] = Seq.empty,\n    exprId: ExprId = NamedExpression.newExprId,\n    joinCond: Seq[Expression] = Seq.empty)"
  },
  {
    "id" : "c5aa72a2-e6d1-4671-b91c-3aee144d2538",
    "prId" : 32303,
    "prUrl" : "https://github.com/apache/spark/pull/32303#pullrequestreview-678010859",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "1090bf9d-917d-489d-857e-713a4d6dfcaa",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Could you add simple tests for checking if an explain can print this new node correctly?",
        "createdAt" : "2021-06-08T04:26:37Z",
        "updatedAt" : "2021-06-08T04:39:02Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "01fa70ec156ad5540b862c4b13dd1257062f31fb",
    "line" : 19,
    "diffHunk" : "@@ -1,1 +301,305 @@  override def nullable: Boolean = true\n  override def withNewPlan(plan: LogicalPlan): LateralSubquery = copy(plan = plan)\n  override def toString: String = s\"lateral-subquery#${exprId.id} $conditionString\"\n  override lazy val canonicalized: Expression = {\n    LateralSubquery("
  },
  {
    "id" : "8320b9e0-20ee-4018-8246-b467ce64a23d",
    "prId" : 31573,
    "prUrl" : "https://github.com/apache/spark/pull/31573#pullrequestreview-591884582",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2b853502-49e0-4e9d-b57f-9d92d991f523",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Isn't it equal to `hasSubquery(e) && !hasScalarSubquery(e)`?",
        "createdAt" : "2021-02-17T06:57:19Z",
        "updatedAt" : "2021-02-22T13:22:44Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "b207612abbad8e5b64dd2b7d65f990e643ace6f0",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +89,93 @@   * Returns true when an expression contains a non-scalar subquery\n   */\n  def hasNonScalarSubquery(e: Expression): Boolean = {\n    e.find {\n      case _: ScalarSubquery => false"
  },
  {
    "id" : "deeff9d8-2365-4fa0-9b0b-5307210b8b97",
    "prId" : 24344,
    "prUrl" : "https://github.com/apache/spark/pull/24344#pullrequestreview-228188491",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "45cf0f7d-af16-4599-9a7d-ae3554404078",
        "parentId" : null,
        "authorId" : "4db0fc8e-ae25-4ad9-989f-2fb7198f797a",
        "body" : "`ListQuery` should be nullable, because `InSubquery`'s nullability depends on both left values and the subquery. If the subquery has nullable columns, `InSubquery` could be null.",
        "createdAt" : "2019-04-18T07:08:38Z",
        "updatedAt" : "2019-05-22T07:43:45Z",
        "lastEditedBy" : "4db0fc8e-ae25-4ad9-989f-2fb7198f797a",
        "tags" : [
        ]
      },
      {
        "id" : "15d1681c-d70d-4391-942c-97cce5f7be5f",
        "parentId" : "45cf0f7d-af16-4599-9a7d-ae3554404078",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "I might miss it, but as we don't execute `ListQuery` directly, do we need this?",
        "createdAt" : "2019-04-18T08:48:55Z",
        "updatedAt" : "2019-05-22T07:43:45Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "54dc3780-4247-476e-ac00-cc23da732f14",
        "parentId" : "45cf0f7d-af16-4599-9a7d-ae3554404078",
        "authorId" : "4db0fc8e-ae25-4ad9-989f-2fb7198f797a",
        "body" : "It works in the optimizer. Example:\r\n```\r\nselect *\r\nfrom t1\r\nwhere (3 in (select a from t2)) is null\r\n``` \r\n\r\nIf we don't change this, the filter will be eliminated because `3 in (select a from t2)` is not nullable.\r\n",
        "createdAt" : "2019-04-18T09:06:27Z",
        "updatedAt" : "2019-05-22T07:43:45Z",
        "lastEditedBy" : "4db0fc8e-ae25-4ad9-989f-2fb7198f797a",
        "tags" : [
        ]
      },
      {
        "id" : "996f801c-aba4-47a7-862d-302a500beb0b",
        "parentId" : "45cf0f7d-af16-4599-9a7d-ae3554404078",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Is an existing issue or related to this change?",
        "createdAt" : "2019-04-18T09:28:59Z",
        "updatedAt" : "2019-05-22T07:43:45Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "724f4f93-9eeb-4759-98dc-bd6a55617903",
        "parentId" : "45cf0f7d-af16-4599-9a7d-ae3554404078",
        "authorId" : "4db0fc8e-ae25-4ad9-989f-2fb7198f797a",
        "body" : "Related to this change, because we rewrite it as join before so the nullability of ListQuery was not used.",
        "createdAt" : "2019-04-18T09:33:32Z",
        "updatedAt" : "2019-05-22T07:43:45Z",
        "lastEditedBy" : "4db0fc8e-ae25-4ad9-989f-2fb7198f797a",
        "tags" : [
        ]
      }
    ],
    "commit" : "86f6c9deb99fcf4eb28b29a1dfe6beea68bedb38",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +300,304 @@  }\n  override lazy val resolved: Boolean = childrenResolved && plan.resolved && childOutputs.nonEmpty\n  override def nullable: Boolean = plan.schema.fields.exists(_.nullable)\n  override def withNewPlan(plan: LogicalPlan): ListQuery = copy(plan = plan)\n  override def toString: String = s\"list#${exprId.id} $conditionString\""
  }
]