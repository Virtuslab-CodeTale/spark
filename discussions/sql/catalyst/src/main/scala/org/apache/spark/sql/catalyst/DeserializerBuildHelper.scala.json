[
  {
    "id" : "b4816408-09d7-4364-afd0-2a4b0a43d376",
    "prId" : 28572,
    "prUrl" : "https://github.com/apache/spark/pull/28572#pullrequestreview-414247793",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8e5f7fe6-b5ed-4330-9ef2-e54559d42ae6",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Can we just directly pass `expected` to `UpCast`, and don't change the definition of `UpCast`? I think that will fix it less invasively.",
        "createdAt" : "2020-05-19T08:28:46Z",
        "updatedAt" : "2020-05-19T13:35:27Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "ea984895-6b79-4e4c-bc2e-231d04c81928",
        "parentId" : "8e5f7fe6-b5ed-4330-9ef2-e54559d42ae6",
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "hmm...I may not understand your concern here. If we do not change the  definition of `UpCast` from `DataType` to `AbstractDataType`, it can not accept **object** `DecimalType`.",
        "createdAt" : "2020-05-19T08:35:18Z",
        "updatedAt" : "2020-05-19T13:35:27Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      },
      {
        "id" : "35694a3c-138d-4141-bcc5-38cf899177ac",
        "parentId" : "8e5f7fe6-b5ed-4330-9ef2-e54559d42ae6",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "I mean `expected` here is a `DataType`. If we can't pass, how did the existing codes work before :-)..",
        "createdAt" : "2020-05-19T08:36:48Z",
        "updatedAt" : "2020-05-19T13:35:27Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "de9da79e-b996-4eac-aa15-d7ef01fbb1db",
        "parentId" : "8e5f7fe6-b5ed-4330-9ef2-e54559d42ae6",
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "It's for `semantic` purpose. `UpCast` could still mean to cast a value to a concrete decimal type in this way while `object DecimalType` is only an exception for the encoder.",
        "createdAt" : "2020-05-19T09:05:20Z",
        "updatedAt" : "2020-05-19T13:35:27Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      }
    ],
    "commit" : "e7664a11b7c6f14df0132e25316a1878792963c6",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +165,169 @@      // For Scala/Java `BigDecimal`, we accept decimal types of any valid precision/scale.\n      // Here we use the `DecimalType` object to indicate it.\n      UpCast(expr, DecimalType, walkedTypePath.getPaths)\n    case _ => UpCast(expr, expected, walkedTypePath.getPaths)\n  }"
  }
]