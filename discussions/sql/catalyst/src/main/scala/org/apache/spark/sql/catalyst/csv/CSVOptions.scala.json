[
  {
    "id" : "fbdbadbb-8fa3-4648-9b84-cd2ec8070cfa",
    "prId" : 29516,
    "prUrl" : "https://github.com/apache/spark/pull/29516#pullrequestreview-474123476",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9cbea291-e46f-4a89-9580-2f4a4ee8e020",
        "parentId" : null,
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "Arguably we should rework the handling of 'optional' configs to not use this default of `\\u0000` to mean \"none\" but I avoided that here. One consequence is that you cannot use `\\u0000` as a comment char right now.",
        "createdAt" : "2020-08-22T22:08:43Z",
        "updatedAt" : "2020-08-24T14:45:57Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "8726fd51-9a66-4ca5-ae21-3f364ed365e7",
        "parentId" : "9cbea291-e46f-4a89-9580-2f4a4ee8e020",
        "authorId" : "575f5b5d-9fc8-4207-a085-da97fe896ec4",
        "body" : "If we will change that way then it might impact existing users for which \\u0000 is a comment character by default. So I would say a separate optional config is a better solution. What I am saying here is that we need to wait for univocity 3.0.0 to be available where the new changes will be available then we can add spark changes in a proper manner.",
        "createdAt" : "2020-08-23T05:16:03Z",
        "updatedAt" : "2020-08-24T14:45:57Z",
        "lastEditedBy" : "575f5b5d-9fc8-4207-a085-da97fe896ec4",
        "tags" : [
        ]
      },
      {
        "id" : "2c083bc0-b38e-4edf-86f3-1df110456865",
        "parentId" : "9cbea291-e46f-4a89-9580-2f4a4ee8e020",
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "You are correct, but, this has never been a valid comment character, and the flip side is the bug you describe: it's _always_ a comment character. I think it's reasonable to fix as a bug. I don't think we need yet another config, as I think it would be quite obscure to use this non-printing control code for comments in a CSV file.",
        "createdAt" : "2020-08-23T13:43:26Z",
        "updatedAt" : "2020-08-24T14:45:57Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "70bc242f-b9d0-4a12-a94b-ec81dee40af3",
        "parentId" : "9cbea291-e46f-4a89-9580-2f4a4ee8e020",
        "authorId" : "575f5b5d-9fc8-4207-a085-da97fe896ec4",
        "body" : "I agree, but once the changes will be done then \\u0000 won't be treated as comment character. It will resolve this bug. But then default comment character will be # as in univocity this is the default comment character. So if my data row starts with # then will the row be processed now. If not then it will break most of the existing jobs.",
        "createdAt" : "2020-08-23T15:23:20Z",
        "updatedAt" : "2020-08-24T14:45:57Z",
        "lastEditedBy" : "575f5b5d-9fc8-4207-a085-da97fe896ec4",
        "tags" : [
        ]
      },
      {
        "id" : "efd3d2da-7295-48b0-8ba2-e5a8b9ed37c0",
        "parentId" : "9cbea291-e46f-4a89-9580-2f4a4ee8e020",
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "I agree, I'll fix that in the next commit - we need to set the comment char to whatever Spark is using no matter what. However it looks like we are going to need your univocity fix to really fix this. Looks like that was just released in 2.9.0: https://github.com/uniVocity/univocity-parsers/commit/f392311ad01676bcd0adf007c2f553112d8eb7c3\r\n\r\nlet me try that.\r\n\r\n@dongjoon-hyun it is a correctness issue but I wouldn't hold up a release for it. We should address it but doesn't absolutely have to happen in 2.4.7 or 3.0.1. It's not a regression.",
        "createdAt" : "2020-08-23T16:56:08Z",
        "updatedAt" : "2020-08-24T14:45:57Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "2e12d4fc-a7f7-4d46-b47b-48701a88324a",
        "parentId" : "9cbea291-e46f-4a89-9580-2f4a4ee8e020",
        "authorId" : "575f5b5d-9fc8-4207-a085-da97fe896ec4",
        "body" : "Thanks, if you are fine I can also raise a PR for this.",
        "createdAt" : "2020-08-23T18:01:45Z",
        "updatedAt" : "2020-08-24T14:45:57Z",
        "lastEditedBy" : "575f5b5d-9fc8-4207-a085-da97fe896ec4",
        "tags" : [
        ]
      },
      {
        "id" : "381112ca-74e1-4134-9fff-bfa42d30fca9",
        "parentId" : "9cbea291-e46f-4a89-9580-2f4a4ee8e020",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "I would think this is rather a bug fix. If comment is not set, it shouldn't assume anything else is a comment.",
        "createdAt" : "2020-08-25T02:28:13Z",
        "updatedAt" : "2020-08-25T02:28:13Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "6afa7814-69fa-40ed-aba0-0d76f6365ec8",
        "parentId" : "9cbea291-e46f-4a89-9580-2f4a4ee8e020",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "That's also what we documented, see also `DataFrameReader.csv`.",
        "createdAt" : "2020-08-25T02:29:05Z",
        "updatedAt" : "2020-08-25T02:29:05Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "0a9337f0-ec58-4777-97d7-b7be67b5d5e7",
        "parentId" : "9cbea291-e46f-4a89-9580-2f4a4ee8e020",
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "Right, yeah, so we have to use the new method in univocity 2.9.0 to turn off its comment handling if its unset in Spark (= `\\u0000`)",
        "createdAt" : "2020-08-25T04:07:31Z",
        "updatedAt" : "2020-08-25T04:07:32Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "c87b9102-c298-45f8-81de-e1258f6296ba",
        "parentId" : "9cbea291-e46f-4a89-9580-2f4a4ee8e020",
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "Oh right, this stanza is for writer settings. There is no `setCommentProcessingEnabled` for writers in univocity. Comments aren't generated. In fact the comment setting doesn't matter, really?",
        "createdAt" : "2020-08-25T04:18:07Z",
        "updatedAt" : "2020-08-25T04:18:07Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      }
    ],
    "commit" : "b685f1c0228594965d9daca8e9796d88ecb5680f",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +221,225 @@    format.setQuoteEscape(escape)\n    charToEscapeQuoteEscaping.foreach(format.setCharToEscapeQuoteEscaping)\n    if (isCommentSet) {\n      format.setComment(comment)\n    }"
  }
]