[
  {
    "id" : "847108f5-d779-4a63-b1e0-5f9da9e66342",
    "prId" : 32448,
    "prUrl" : "https://github.com/apache/spark/pull/32448#pullrequestreview-656000760",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2b8aae0d-ceaf-4e48-8fe8-fb7f8e3772a9",
        "parentId" : null,
        "authorId" : "92aa9573-b64a-4a86-aebf-54c827df3ed0",
        "body" : "Don't know enough about this code to know if this could cause any issues",
        "createdAt" : "2021-05-06T01:34:38Z",
        "updatedAt" : "2021-05-06T01:34:38Z",
        "lastEditedBy" : "92aa9573-b64a-4a86-aebf-54c827df3ed0",
        "tags" : [
        ]
      },
      {
        "id" : "acd3b394-e7db-4149-aae3-7353b2714131",
        "parentId" : "2b8aae0d-ceaf-4e48-8fe8-fb7f8e3772a9",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "This merges some required fields at root level as a single `StructType`. Looks okay.",
        "createdAt" : "2021-05-10T19:14:16Z",
        "updatedAt" : "2021-05-10T19:14:16Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "5762ddc83e96b640ffdd4125c182646bf9fb03ff",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +39,43 @@    val mergedSchema = requestedRootFields\n      .map { root: RootField => StructType(Array(root.field)) }\n      .reduceLeft((left, right) => left.merge(right, resolver))\n    val mergedDataSchema =\n      StructType(dataSchema.map(d => mergedSchema.find(m => resolver(m.name, d.name)).getOrElse(d)))"
  }
]