[
  {
    "id" : "847108f5-d779-4a63-b1e0-5f9da9e66342",
    "prId" : 32448,
    "prUrl" : "https://github.com/apache/spark/pull/32448#pullrequestreview-656000760",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2b8aae0d-ceaf-4e48-8fe8-fb7f8e3772a9",
        "parentId" : null,
        "authorId" : "92aa9573-b64a-4a86-aebf-54c827df3ed0",
        "body" : "Don't know enough about this code to know if this could cause any issues",
        "createdAt" : "2021-05-06T01:34:38Z",
        "updatedAt" : "2021-05-06T01:34:38Z",
        "lastEditedBy" : "92aa9573-b64a-4a86-aebf-54c827df3ed0",
        "tags" : [
        ]
      },
      {
        "id" : "acd3b394-e7db-4149-aae3-7353b2714131",
        "parentId" : "2b8aae0d-ceaf-4e48-8fe8-fb7f8e3772a9",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "This merges some required fields at root level as a single `StructType`. Looks okay.",
        "createdAt" : "2021-05-10T19:14:16Z",
        "updatedAt" : "2021-05-10T19:14:16Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "5762ddc83e96b640ffdd4125c182646bf9fb03ff",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +39,43 @@    val mergedSchema = requestedRootFields\n      .map { root: RootField => StructType(Array(root.field)) }\n      .reduceLeft((left, right) => left.merge(right, resolver))\n    val mergedDataSchema =\n      StructType(dataSchema.map(d => mergedSchema.find(m => resolver(m.name, d.name)).getOrElse(d)))"
  },
  {
    "id" : "8ddbd45d-6126-4501-9d43-c82021fa0c72",
    "prId" : 32354,
    "prUrl" : "https://github.com/apache/spark/pull/32354#pullrequestreview-649704592",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "eab22d40-48b2-4018-baa6-8fc964697b39",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Can we add a unit test in `SchemaPruningSuite`? We can make `getRootFields` as `private[spark]` to test it.",
        "createdAt" : "2021-04-30T21:19:28Z",
        "updatedAt" : "2021-05-04T18:00:49Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "1d644431-7cce-41a2-b9fe-61ac02524e1f",
        "parentId" : "eab22d40-48b2-4018-baa6-8fc964697b39",
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "Good point. Let me add a test.",
        "createdAt" : "2021-05-01T01:42:12Z",
        "updatedAt" : "2021-05-04T18:00:49Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      }
    ],
    "commit" : "a67dde0b2ddea64bf1eb5bb67e0b1cd938146ee6",
    "line" : 19,
    "diffHunk" : "@@ -1,1 +129,133 @@    expr match {\n      case att: Attribute =>\n        RootField(StructField(att.name, att.dataType, att.nullable, att.metadata),\n          derivedFromAtt = true) :: Nil\n      case SelectedField(field) => RootField(field, derivedFromAtt = false) :: Nil"
  }
]