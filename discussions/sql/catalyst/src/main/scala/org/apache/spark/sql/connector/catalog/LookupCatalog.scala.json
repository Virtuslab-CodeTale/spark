[
  {
    "id" : "509449ba-20eb-4416-b906-a1bbbfffd6e8",
    "prId" : 32082,
    "prUrl" : "https://github.com/apache/spark/pull/32082#pullrequestreview-642563021",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c5cf9481-2155-486b-8e2c-e4c8268a3376",
        "parentId" : null,
        "authorId" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "body" : "Does this need to wrap to the next line?",
        "createdAt" : "2021-04-21T21:05:29Z",
        "updatedAt" : "2021-04-27T19:27:48Z",
        "lastEditedBy" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "tags" : [
        ]
      },
      {
        "id" : "bcb562ac-bd29-4115-a644-b2277e3a79e7",
        "parentId" : "c5cf9481-2155-486b-8e2c-e4c8268a3376",
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "I think yes otherwise it will exceed the 100 character limit.",
        "createdAt" : "2021-04-22T18:52:21Z",
        "updatedAt" : "2021-04-27T19:27:48Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      }
    ],
    "commit" : "c18715fcc304f4a805d420e193d4a3884b3f7e4f",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +167,171 @@          Some(FunctionIdentifier(name))\n        case CatalogAndMultipartIdentifier(None, names)\n          if CatalogV2Util.isSessionCatalog(currentCatalog) =>\n          namesToFunctionIdentifier(names)\n        case CatalogAndMultipartIdentifier(Some(catalog), names)"
  },
  {
    "id" : "add2dfb8-805e-4626-9b67-d8918e0df27f",
    "prId" : 30919,
    "prUrl" : "https://github.com/apache/spark/pull/30919#pullrequestreview-559933467",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c52594a4-f548-4daf-b5ad-1018cd63ecb1",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "if catalog name is specified, why do we care about the current catalog?",
        "createdAt" : "2020-12-29T08:11:56Z",
        "updatedAt" : "2020-12-29T08:11:56Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "cb6a2334-e1fc-477f-9fd2-edc632377cb0",
        "parentId" : "c52594a4-f548-4daf-b5ad-1018cd63ecb1",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "So, `isSessionCatalog()` checks that the parameter is `spark_catalog`. If the specified catalog is `spark_catalog` but the current one **is not** `spark_catalog`, and we cut it off from names, then we \"bind\" table name to something different from `spark_catalog`, correct?",
        "createdAt" : "2020-12-29T09:18:49Z",
        "updatedAt" : "2020-12-29T09:18:50Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "1dd339cc-f615-479a-9c33-8df063456e33",
        "parentId" : "c52594a4-f548-4daf-b5ad-1018cd63ecb1",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "no, `TableIdentifier` is only used in v1 commands. V1 commands can't look up catalogs and the current catalog doesn't matter to it.",
        "createdAt" : "2020-12-29T13:26:36Z",
        "updatedAt" : "2020-12-29T13:26:37Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "cd6e2c20-aba6-45c4-afb9-66a35ed5c9e9",
        "parentId" : "c52594a4-f548-4daf-b5ad-1018cd63ecb1",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "`AsTableIdentifier` is used directly in public API methods:\r\n- https://github.com/apache/spark/blob/2da72593c1cf63fc6f815416b8d553f0a53f3e65/sql/core/src/main/scala/org/apache/spark/sql/DataFrameWriter.scala#L495\r\n- https://github.com/apache/spark/blob/2da72593c1cf63fc6f815416b8d553f0a53f3e65/sql/core/src/main/scala/org/apache/spark/sql/DataFrameWriter.scala#L625\r\n\r\nIf I remove the check, this could impact on their behavior. ",
        "createdAt" : "2020-12-30T07:17:07Z",
        "updatedAt" : "2020-12-30T07:17:07Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "046be5506721200667d52307e3ca2b5d16545d1f",
    "line" : 28,
    "diffHunk" : "@@ -1,1 +153,157 @@        case CatalogAndMultipartIdentifier(Some(catalog), names)\n          if CatalogV2Util.isSessionCatalog(catalog) &&\n             CatalogV2Util.isSessionCatalog(currentCatalog) =>\n          namesToTableIdentifier(names)\n        case _ => None"
  }
]