[
  {
    "id" : "509449ba-20eb-4416-b906-a1bbbfffd6e8",
    "prId" : 32082,
    "prUrl" : "https://github.com/apache/spark/pull/32082#pullrequestreview-642563021",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c5cf9481-2155-486b-8e2c-e4c8268a3376",
        "parentId" : null,
        "authorId" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "body" : "Does this need to wrap to the next line?",
        "createdAt" : "2021-04-21T21:05:29Z",
        "updatedAt" : "2021-04-27T19:27:48Z",
        "lastEditedBy" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "tags" : [
        ]
      },
      {
        "id" : "bcb562ac-bd29-4115-a644-b2277e3a79e7",
        "parentId" : "c5cf9481-2155-486b-8e2c-e4c8268a3376",
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "I think yes otherwise it will exceed the 100 character limit.",
        "createdAt" : "2021-04-22T18:52:21Z",
        "updatedAt" : "2021-04-27T19:27:48Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      }
    ],
    "commit" : "c18715fcc304f4a805d420e193d4a3884b3f7e4f",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +167,171 @@          Some(FunctionIdentifier(name))\n        case CatalogAndMultipartIdentifier(None, names)\n          if CatalogV2Util.isSessionCatalog(currentCatalog) =>\n          namesToFunctionIdentifier(names)\n        case CatalogAndMultipartIdentifier(Some(catalog), names)"
  },
  {
    "id" : "add2dfb8-805e-4626-9b67-d8918e0df27f",
    "prId" : 30919,
    "prUrl" : "https://github.com/apache/spark/pull/30919#pullrequestreview-559933467",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c52594a4-f548-4daf-b5ad-1018cd63ecb1",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "if catalog name is specified, why do we care about the current catalog?",
        "createdAt" : "2020-12-29T08:11:56Z",
        "updatedAt" : "2020-12-29T08:11:56Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "cb6a2334-e1fc-477f-9fd2-edc632377cb0",
        "parentId" : "c52594a4-f548-4daf-b5ad-1018cd63ecb1",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "So, `isSessionCatalog()` checks that the parameter is `spark_catalog`. If the specified catalog is `spark_catalog` but the current one **is not** `spark_catalog`, and we cut it off from names, then we \"bind\" table name to something different from `spark_catalog`, correct?",
        "createdAt" : "2020-12-29T09:18:49Z",
        "updatedAt" : "2020-12-29T09:18:50Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "1dd339cc-f615-479a-9c33-8df063456e33",
        "parentId" : "c52594a4-f548-4daf-b5ad-1018cd63ecb1",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "no, `TableIdentifier` is only used in v1 commands. V1 commands can't look up catalogs and the current catalog doesn't matter to it.",
        "createdAt" : "2020-12-29T13:26:36Z",
        "updatedAt" : "2020-12-29T13:26:37Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "cd6e2c20-aba6-45c4-afb9-66a35ed5c9e9",
        "parentId" : "c52594a4-f548-4daf-b5ad-1018cd63ecb1",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "`AsTableIdentifier` is used directly in public API methods:\r\n- https://github.com/apache/spark/blob/2da72593c1cf63fc6f815416b8d553f0a53f3e65/sql/core/src/main/scala/org/apache/spark/sql/DataFrameWriter.scala#L495\r\n- https://github.com/apache/spark/blob/2da72593c1cf63fc6f815416b8d553f0a53f3e65/sql/core/src/main/scala/org/apache/spark/sql/DataFrameWriter.scala#L625\r\n\r\nIf I remove the check, this could impact on their behavior. ",
        "createdAt" : "2020-12-30T07:17:07Z",
        "updatedAt" : "2020-12-30T07:17:07Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "046be5506721200667d52307e3ca2b5d16545d1f",
    "line" : 28,
    "diffHunk" : "@@ -1,1 +153,157 @@        case CatalogAndMultipartIdentifier(Some(catalog), names)\n          if CatalogV2Util.isSessionCatalog(catalog) &&\n             CatalogV2Util.isSessionCatalog(currentCatalog) =>\n          namesToTableIdentifier(names)\n        case _ => None"
  },
  {
    "id" : "51b9214c-63b8-4845-9a8d-6153b0dcdf2b",
    "prId" : 29198,
    "prUrl" : "https://github.com/apache/spark/pull/29198#pullrequestreview-456199663",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "67098b76-8be1-47b4-af68-6b9f4266cc44",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "function -> function command?",
        "createdAt" : "2020-07-26T05:39:17Z",
        "updatedAt" : "2020-07-28T16:26:35Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "cedbe1a7-d910-468e-baf2-bb18a1baf6fd",
        "parentId" : "67098b76-8be1-47b4-af68-6b9f4266cc44",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "This is called from `Analyzer.scala` except for `CREATE FUNCTION`, so I thought more general name would be better here. But if you think `function command` is better here, I am happy to change it. Please let me know!",
        "createdAt" : "2020-07-27T23:21:18Z",
        "updatedAt" : "2020-07-28T16:26:35Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "c662619bd00e74d4f683fcb565868bf72e4890d6",
    "line" : 17,
    "diffHunk" : "@@ -1,1 +177,181 @@        }\n\n      case _ => throw new AnalysisException(\"function is only supported in v1 catalog\")\n    }\n  }"
  },
  {
    "id" : "b67539c5-a7b4-4f0e-bd96-8dba820a12ca",
    "prId" : 28840,
    "prUrl" : "https://github.com/apache/spark/pull/28840#pullrequestreview-453825753",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "049c1629-cd9c-4724-8551-6e6ce1d10797",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "@imback82 do you have time to work on this TODO?",
        "createdAt" : "2020-07-13T13:24:00Z",
        "updatedAt" : "2020-07-21T12:12:06Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "4e00ff4f-ec06-4e1a-9a12-25a242192748",
        "parentId" : "049c1629-cd9c-4724-8551-6e6ce1d10797",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "Yea, I will get to it once this PR is merged.",
        "createdAt" : "2020-07-13T18:28:19Z",
        "updatedAt" : "2020-07-21T12:12:06Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      },
      {
        "id" : "475bed03-fdb6-4ce0-881f-699472b4996a",
        "parentId" : "049c1629-cd9c-4724-8551-6e6ce1d10797",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "Created #29198",
        "createdAt" : "2020-07-23T04:12:49Z",
        "updatedAt" : "2020-07-23T04:12:49Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "b18437c5998f5df50172732015f66b33c3908d2a",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +157,161 @@  }\n\n  // TODO: move function related v2 statements to the new framework.\n  def parseSessionCatalogFunctionIdentifier(\n      nameParts: Seq[String],"
  },
  {
    "id" : "0db676e4-bd8c-4920-9ee2-16216a6af987",
    "prId" : 27550,
    "prUrl" : "https://github.com/apache/spark/pull/27550#pullrequestreview-358045393",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7c371046-06c7-46c3-84fd-9e51023c9b50",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Hmm, this adds current namespace to the returned identifier? So we cannot tell if a returned identifier is for a temp view?",
        "createdAt" : "2020-02-12T20:07:38Z",
        "updatedAt" : "2020-02-14T10:56:14Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "a77a76f5-5161-459b-b4a9-1a147824b112",
        "parentId" : "7c371046-06c7-46c3-84fd-9e51023c9b50",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "I think `ResolveTempViews` needs to be updated to look up twice (one with namespace and one without).",
        "createdAt" : "2020-02-13T00:44:10Z",
        "updatedAt" : "2020-02-14T10:56:14Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      },
      {
        "id" : "4438debc-68ef-42df-8c07-553ae9a5f242",
        "parentId" : "7c371046-06c7-46c3-84fd-9e51023c9b50",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "if you look at `SessionCatalog.setCurrentDatabase`, we forbid to set `global_temp` as the current database.\r\n\r\nThis is to make the resolution of temp view simple: we look up temp view via the name parts given by users literally. No name extension is allowed.\r\n\r\nThe general rule of relation resolution is: we try to look up temp view first, then tables/permanent views. When we call `CatalogAndIdentifier`, the temp view lookup should already be tried, or the caller side don't want to resolve temp views.\r\n",
        "createdAt" : "2020-02-13T04:33:27Z",
        "updatedAt" : "2020-02-14T10:56:14Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "4ab488f7-fe8e-4b49-b23b-f43bff45d516",
        "parentId" : "7c371046-06c7-46c3-84fd-9e51023c9b50",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "> When we call `CatalogAndIdentifier`, the temp view lookup should already be tried, or the caller side don't want to resolve temp views.\r\n\r\nSo, `ResolveCatalogs` should be applied after `ResolveTables` and `ResolveRelations`?",
        "createdAt" : "2020-02-13T05:15:34Z",
        "updatedAt" : "2020-02-14T10:56:14Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      },
      {
        "id" : "c97f264f-4490-4098-9a80-d9709dce8fab",
        "parentId" : "7c371046-06c7-46c3-84fd-9e51023c9b50",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "these 2 are different frameworks so I don't see a way to guarantee the order. I think what we should do is to migrate to the new framework.",
        "createdAt" : "2020-02-13T08:57:42Z",
        "updatedAt" : "2020-02-14T10:56:14Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "f4a3d08d096ee44d2fc7bf5d23f6223f9700865a",
    "line" : 25,
    "diffHunk" : "@@ -1,1 +108,112 @@      assert(nameParts.nonEmpty)\n      if (nameParts.length == 1) {\n        Some((currentCatalog, Identifier.of(catalogManager.currentNamespace, nameParts.head)))\n      } else if (nameParts.head.equalsIgnoreCase(globalTempDB)) {\n        // Conceptually global temp views are in a special reserved catalog. However, the v2 catalog"
  },
  {
    "id" : "464ab000-9673-4c9b-8a71-f92fbc715350",
    "prId" : 27550,
    "prUrl" : "https://github.com/apache/spark/pull/27550#pullrequestreview-360848364",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a96f02d6-342d-4981-82a2-678390c971a1",
        "parentId" : null,
        "authorId" : "d19fc546-1296-40ce-befb-9eca847aeceb",
        "body" : "The term `Catalog` is being used in many places. For example, our internal SessionCatalog also manages temp objects. ",
        "createdAt" : "2020-02-18T18:54:46Z",
        "updatedAt" : "2020-02-18T18:54:46Z",
        "lastEditedBy" : "d19fc546-1296-40ce-befb-9eca847aeceb",
        "tags" : [
        ]
      },
      {
        "id" : "e442b6a4-ecf0-4ae7-9786-57c303673432",
        "parentId" : "a96f02d6-342d-4981-82a2-678390c971a1",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "> our internal SessionCatalog also manages temp objects\r\n\r\nWe can move them out and put it in a temp view manager like the `GlobalTempViewManager`. I'm talking more about the theory.",
        "createdAt" : "2020-02-19T05:20:30Z",
        "updatedAt" : "2020-02-19T05:20:31Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "f4a3d08d096ee44d2fc7bf5d23f6223f9700865a",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +98,102 @@   * Note that, this pattern is used to look up permanent catalog objects like table, view,\n   * function, etc. If you need to look up temp objects like temp view, please do it separately\n   * before calling this pattern, as temp objects don't belong to any catalog.\n   */\n  object CatalogAndIdentifier {"
  },
  {
    "id" : "07f7c22e-cf73-4860-924f-c7a1d408d0d3",
    "prId" : 26853,
    "prUrl" : "https://github.com/apache/spark/pull/26853#pullrequestreview-330873213",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "10451d6c-bc0c-47fa-8f19-94ea86d8f884",
        "parentId" : null,
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "Now that we handle the single-name part differently, we don't need the check here any more. This case will now resolve to the session catalog (mask v2 catalog named `global_temp`), and analysis will fail downstream if the name has more than two parts.",
        "createdAt" : "2019-12-11T22:02:10Z",
        "updatedAt" : "2019-12-11T22:02:14Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "a1fd1c13fdf221b41450403af0e508784f43212e",
    "line" : 41,
    "diffHunk" : "@@ -1,1 +105,109 @@      if (nameParts.length == 1) {\n        Some((currentCatalog, Identifier.of(Array(), nameParts.head)))\n      } else if (nameParts.head.equalsIgnoreCase(globalTempDB)) {\n        // Conceptually global temp views are in a special reserved catalog. However, the v2 catalog\n        // API does not support view yet, and we have to use v1 commands to deal with global temp"
  },
  {
    "id" : "91da06bd-53a8-4d16-9321-705d9d3e3cf6",
    "prId" : 26741,
    "prUrl" : "https://github.com/apache/spark/pull/26741#pullrequestreview-331690861",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d7598f8d-645f-4094-8074-b685caf5672f",
        "parentId" : null,
        "authorId" : "f06b291a-bc5c-4fd8-9bac-e5a6d035891b",
        "body" : "It seems this object is only used in LookupCatalogSuite. if it is only for test, shall we put it in LookupCatalogSuite.scala ?",
        "createdAt" : "2019-12-13T06:38:03Z",
        "updatedAt" : "2019-12-13T06:38:04Z",
        "lastEditedBy" : "f06b291a-bc5c-4fd8-9bac-e5a6d035891b",
        "tags" : [
        ]
      },
      {
        "id" : "fc90fa87-4e61-4412-8c06-87d56560fa66",
        "parentId" : "d7598f8d-645f-4094-8074-b685caf5672f",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "if it's only used in test, we can remove it.",
        "createdAt" : "2019-12-13T06:43:59Z",
        "updatedAt" : "2019-12-13T06:43:59Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "7684a93c-0e63-40b2-b908-10904bca0bb1",
        "parentId" : "d7598f8d-645f-4094-8074-b685caf5672f",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "sure. I can do a quick follow-up PR.",
        "createdAt" : "2019-12-13T06:52:33Z",
        "updatedAt" : "2019-12-13T06:52:33Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "0696c3328c793490b844bb4017b398e574964789",
    "line" : 88,
    "diffHunk" : "@@ -1,1 +162,166 @@   * For temp views, extract a table identifier from a multi-part identifier if it has no catalog.\n   */\n  object AsTemporaryViewIdentifier {\n    def unapply(parts: Seq[String]): Option[TableIdentifier] = parts match {\n      case CatalogAndMultipartIdentifier(None, Seq(table)) =>"
  }
]