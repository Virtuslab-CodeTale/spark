[
  {
    "id" : "93448fda-b31d-4007-b5bc-ac6340132a02",
    "prId" : 33099,
    "prUrl" : "https://github.com/apache/spark/pull/33099#pullrequestreview-693417704",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "11aa06d2-4757-41b7-884f-49c8a3e24ce8",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "This looks like a nice refactoring in order to make consistent and simplify.",
        "createdAt" : "2021-06-27T04:19:03Z",
        "updatedAt" : "2021-06-27T04:19:03Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "ba266562-8e34-4465-81fd-49cfbcb911e8",
        "parentId" : "11aa06d2-4757-41b7-884f-49c8a3e24ce8",
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "sorry for the late, I prefer not to do this. Since `RepartitionOperation` can affect the behavior of AQE, the semantics of `RepartitionOperation` have a little different from previous.\r\n\r\nCurrently, the `RepartitionOperation` behavior with AQE framwork follows:\r\n* `Repartition` does not use AQE stage optimizer rules\r\n* `RepartitionByExpression` depends on `optNumPartitions` and `partitionExpressions`\r\n*  `RebalancePartitions`(if extend)  depends on `partitionExpressions`\r\n\r\nAnd the rule `CollapseRepartition` may not effective in all use case.",
        "createdAt" : "2021-06-27T13:32:39Z",
        "updatedAt" : "2021-06-27T14:15:03Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      }
    ],
    "commit" : "67642d87f7d1799e97f925444484f52354e6af72",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +1374,1378 @@case class RebalancePartitions(\n    partitionExpressions: Seq[Expression],\n    child: LogicalPlan) extends RepartitionOperation {\n\n  override def numPartitions: Int = conf.numShufflePartitions"
  },
  {
    "id" : "0b5071e5-92b6-4a49-aa1d-74522d1e4df1",
    "prId" : 32932,
    "prUrl" : "https://github.com/apache/spark/pull/32932#pullrequestreview-693412190",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "599094f1-e305-4fe3-97fa-18b7f1e1b655",
        "parentId" : null,
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "Make `RebalancePartitions` extends `RepartitionOperation`?",
        "createdAt" : "2021-06-26T01:47:40Z",
        "updatedAt" : "2021-06-26T01:47:40Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      },
      {
        "id" : "11dc3ee2-0672-447e-a290-2baf03b5926d",
        "parentId" : "599094f1-e305-4fe3-97fa-18b7f1e1b655",
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "Since it's a special one. For conservative, this PR does not extend `RepartitionOperation`, see the comment  https://github.com/apache/spark/pull/32932#discussion_r656249153.",
        "createdAt" : "2021-06-27T12:34:15Z",
        "updatedAt" : "2021-06-27T12:34:15Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      }
    ],
    "commit" : "0fe14d0001adedef66696699d478dd4d4e9c392c",
    "line" : 15,
    "diffHunk" : "@@ -1,1 +1363,1367 @@case class RebalancePartitions(\n    partitionExpressions: Seq[Expression],\n    child: LogicalPlan) extends UnaryNode {\n  override def maxRows: Option[Long] = child.maxRows\n  override def output: Seq[Attribute] = child.output"
  }
]