[
  {
    "id" : "437cee65-fc44-4392-aa65-8a71669ef4ca",
    "prId" : 32309,
    "prUrl" : "https://github.com/apache/spark/pull/32309#pullrequestreview-684639999",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8f9bef81-d946-4ecc-bb11-57520834a12f",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Q: we need to fall back into the size-based one instead of just calling `p.child.stats`?",
        "createdAt" : "2021-06-16T00:55:14Z",
        "updatedAt" : "2021-06-16T00:55:14Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "383af7f9-a2c0-493b-ab22-723d1ec6dc0c",
        "parentId" : "8f9bef81-d946-4ecc-bb11-57520834a12f",
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "For better maintenance, if `BasicStatsPlanVisitor` and `SizeInBytesOnlyStatsPlanVisitor` have the same implementation, then fallback. For example `visitLocalLimit`:\r\nhttps://github.com/apache/spark/blob/5553429728859472e3babd507163fba6c9fddfb9/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/plans/logical/statsEstimation/BasicStatsPlanVisitor.scala#L76",
        "createdAt" : "2021-06-16T01:15:00Z",
        "updatedAt" : "2021-06-16T01:15:00Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      },
      {
        "id" : "c1ef5306-3232-4d50-aade-34e0bfdf281a",
        "parentId" : "8f9bef81-d946-4ecc-bb11-57520834a12f",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Ah, I see. It's trivial and sgtm.",
        "createdAt" : "2021-06-16T01:18:46Z",
        "updatedAt" : "2021-06-16T01:18:46Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "5553429728859472e3babd507163fba6c9fddfb9",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +82,86 @@  }\n\n  override def visitRepartition(p: Repartition): Statistics = fallback(p)\n\n  override def visitRepartitionByExpr(p: RepartitionByExpression): Statistics = fallback(p)"
  },
  {
    "id" : "e6358efe-33ae-4faa-a26f-0884160971e4",
    "prId" : 32291,
    "prUrl" : "https://github.com/apache/spark/pull/32291#pullrequestreview-642335910",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8fdda352-f614-45e0-b245-0ca25cdb478e",
        "parentId" : null,
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "SPARK-34061 need this change:\r\nhttps://github.com/apache/spark/pull/31113/files#diff-9973973f49899b41e043d219f8952275ec344237914e23c53c51a94b1eca9b52R46-R49",
        "createdAt" : "2021-04-22T15:18:55Z",
        "updatedAt" : "2021-04-22T15:18:56Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      }
    ],
    "commit" : "00739ecf716d7f4dae9458a43427f1c19a16e298",
    "line" : 8,
    "diffHunk" : "@@ -1,1 +47,51 @@    val child = p.child\n    visitAggregate(Aggregate(child.output, child.output, child))\n  }\n\n  override def visitExcept(p: Except): Statistics = fallback(p)"
  },
  {
    "id" : "5ea038a1-bf90-40a4-8801-e5c690fa98f6",
    "prId" : 31068,
    "prUrl" : "https://github.com/apache/spark/pull/31068#pullrequestreview-562739444",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c145ed21-95c7-44d1-9dc4-05c189782d27",
        "parentId" : null,
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "Same logic, just add row count:\r\nhttps://github.com/apache/spark/blob/6c5ba8169ae64fdcefd8530c2b38326178f5fa92/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/plans/logical/statsEstimation/SizeInBytesOnlyStatsPlanVisitor.scala#L148-L150",
        "createdAt" : "2021-01-06T14:15:32Z",
        "updatedAt" : "2021-01-07T05:33:39Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      }
    ],
    "commit" : "7521f420f766bdfc5afc431728c3d5b89393a968",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +88,92 @@    }\n    Statistics(sizeInBytes = stats.map(_.sizeInBytes).sum, rowCount = rowCount)\n  }\n\n  override def visitWindow(p: Window): Statistics = fallback(p)"
  },
  {
    "id" : "45ccbf12-e028-4337-8092-4a3619fd4a18",
    "prId" : 30987,
    "prUrl" : "https://github.com/apache/spark/pull/30987#pullrequestreview-560587951",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "70561c10-8a73-46b9-9118-0940428324dd",
        "parentId" : null,
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "The logic same to SizeInBytesOnlyStatsPlanVisitor#default, just add rowCount:\r\nhttps://github.com/apache/spark/blob/711d8dd28afd9af92b025f9908534e5f1d575042/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/plans/logical/statsEstimation/SizeInBytesOnlyStatsPlanVisitor.scala#L50-L58",
        "createdAt" : "2021-01-01T13:45:32Z",
        "updatedAt" : "2021-01-01T13:45:32Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      }
    ],
    "commit" : "fcc3b89a3d280e47f5b87a81b14c9cab2700c639",
    "line" : 15,
    "diffHunk" : "@@ -1,1 +38,42 @@      }\n      Statistics(sizeInBytes = stats.map(_.sizeInBytes).filter(_ > 0L).product, rowCount = rowCount)\n  }\n\n  override def visitAggregate(p: Aggregate): Statistics = {"
  }
]