[
  {
    "id" : "437cee65-fc44-4392-aa65-8a71669ef4ca",
    "prId" : 32309,
    "prUrl" : "https://github.com/apache/spark/pull/32309#pullrequestreview-684639999",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8f9bef81-d946-4ecc-bb11-57520834a12f",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Q: we need to fall back into the size-based one instead of just calling `p.child.stats`?",
        "createdAt" : "2021-06-16T00:55:14Z",
        "updatedAt" : "2021-06-16T00:55:14Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "383af7f9-a2c0-493b-ab22-723d1ec6dc0c",
        "parentId" : "8f9bef81-d946-4ecc-bb11-57520834a12f",
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "For better maintenance, if `BasicStatsPlanVisitor` and `SizeInBytesOnlyStatsPlanVisitor` have the same implementation, then fallback. For example `visitLocalLimit`:\r\nhttps://github.com/apache/spark/blob/5553429728859472e3babd507163fba6c9fddfb9/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/plans/logical/statsEstimation/BasicStatsPlanVisitor.scala#L76",
        "createdAt" : "2021-06-16T01:15:00Z",
        "updatedAt" : "2021-06-16T01:15:00Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      },
      {
        "id" : "c1ef5306-3232-4d50-aade-34e0bfdf281a",
        "parentId" : "8f9bef81-d946-4ecc-bb11-57520834a12f",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Ah, I see. It's trivial and sgtm.",
        "createdAt" : "2021-06-16T01:18:46Z",
        "updatedAt" : "2021-06-16T01:18:46Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "5553429728859472e3babd507163fba6c9fddfb9",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +82,86 @@  }\n\n  override def visitRepartition(p: Repartition): Statistics = fallback(p)\n\n  override def visitRepartitionByExpr(p: RepartitionByExpression): Statistics = fallback(p)"
  },
  {
    "id" : "e6358efe-33ae-4faa-a26f-0884160971e4",
    "prId" : 32291,
    "prUrl" : "https://github.com/apache/spark/pull/32291#pullrequestreview-642335910",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8fdda352-f614-45e0-b245-0ca25cdb478e",
        "parentId" : null,
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "SPARK-34061 need this change:\r\nhttps://github.com/apache/spark/pull/31113/files#diff-9973973f49899b41e043d219f8952275ec344237914e23c53c51a94b1eca9b52R46-R49",
        "createdAt" : "2021-04-22T15:18:55Z",
        "updatedAt" : "2021-04-22T15:18:56Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      }
    ],
    "commit" : "00739ecf716d7f4dae9458a43427f1c19a16e298",
    "line" : 8,
    "diffHunk" : "@@ -1,1 +47,51 @@    val child = p.child\n    visitAggregate(Aggregate(child.output, child.output, child))\n  }\n\n  override def visitExcept(p: Except): Statistics = fallback(p)"
  }
]