[
  {
    "id" : "e446b03a-b664-4819-9200-87f756c42698",
    "prId" : 27650,
    "prUrl" : "https://github.com/apache/spark/pull/27650#pullrequestreview-366258165",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "be1df51c-1320-421d-b227-c6484b6e04c4",
        "parentId" : null,
        "authorId" : "471c3dfe-259c-447a-9abd-f7fdecccd9a7",
        "body" : "Can the parser return this as `null`? If so, shouldn't these be `Option(c.provider)` so that they don't return null providers",
        "createdAt" : "2020-02-28T07:24:48Z",
        "updatedAt" : "2020-02-28T07:24:49Z",
        "lastEditedBy" : "471c3dfe-259c-447a-9abd-f7fdecccd9a7",
        "tags" : [
        ]
      },
      {
        "id" : "2e0fda0c-4d27-4ff2-89c2-fa86abc3f045",
        "parentId" : "be1df51c-1320-421d-b227-c6484b6e04c4",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Seems that's required https://github.com/apache/spark/pull/27650/files#diff-9847f5cef7cf7fbc5830fbc6b779ee10L2803 . So should be fine.",
        "createdAt" : "2020-02-28T08:31:55Z",
        "updatedAt" : "2020-02-28T08:31:56Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "3e28cb95-63e6-40aa-aac8-1ebe530f0ee5",
        "parentId" : "be1df51c-1320-421d-b227-c6484b6e04c4",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "https://github.com/cloud-fan/spark/blob/6685dc5dbbbea0f4cd069f1a5e92ccb70033f493/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/parser/AstBuilder.scala#L2826\r\n\r\nThis is how the parser gets the provider. I don't think it can be null.",
        "createdAt" : "2020-02-28T09:24:33Z",
        "updatedAt" : "2020-02-28T09:24:33Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "6685dc5dbbbea0f4cd069f1a5e92ccb70033f493",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +175,179 @@        // convert the bucket spec and add it as a transform\n        c.partitioning ++ c.bucketSpec.map(_.asTransform),\n        convertTableProperties(c.properties, c.options, c.location, c.comment, Some(c.provider)),\n        orCreate = c.orCreate)\n"
  },
  {
    "id" : "224b6052-597f-4d60-b813-47e8a1a37a73",
    "prId" : 27095,
    "prUrl" : "https://github.com/apache/spark/pull/27095#pullrequestreview-339018528",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "59a82877-fd4b-4035-8853-6c09d97e0339",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "do we still need the separation between `DescribeNamespaceStatement` and `DescribeNamespace`?",
        "createdAt" : "2020-01-06T04:06:02Z",
        "updatedAt" : "2020-01-07T05:54:46Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "faf6b777-dc5c-4a62-92b9-55120ab7d311",
        "parentId" : "59a82877-fd4b-4035-8853-6c09d97e0339",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "sorry, could you elaborate on your question?",
        "createdAt" : "2020-01-06T06:20:37Z",
        "updatedAt" : "2020-01-07T05:54:46Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      },
      {
        "id" : "62011241-cdf8-403a-9c19-9a7a7bb5a667",
        "parentId" : "59a82877-fd4b-4035-8853-6c09d97e0339",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "It's simpler to\r\n1. create `DescribeNamespace(UnresolvedNamespace(...))` in parser\r\n2. match `DescribeNamespace(ResolvedNamespace(catalog, ident))` in planner and convert it to physical node.",
        "createdAt" : "2020-01-06T06:54:32Z",
        "updatedAt" : "2020-01-07T05:54:46Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "e86469b1-13a0-44df-9710-8138b6c57a7a",
        "parentId" : "59a82877-fd4b-4035-8853-6c09d97e0339",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "But we still need to handle the case where catalog is a session catalog (and I don't think we want to handle this case in planner).",
        "createdAt" : "2020-01-06T07:13:57Z",
        "updatedAt" : "2020-01-07T05:54:46Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      },
      {
        "id" : "018a8a12-2cdd-456d-b1be-9fe697cf66af",
        "parentId" : "59a82877-fd4b-4035-8853-6c09d97e0339",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "yea, we should have an extra analyzer rule to catch\r\n```\r\ncase DescribeNamespace(ResolvedNamespace(catalog, ident)) if isSessionCatalog(catalog)\r\n```\r\nand convert to v1 command.",
        "createdAt" : "2020-01-06T07:17:22Z",
        "updatedAt" : "2020-01-07T05:54:46Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "cace4168-03c0-42cb-8884-2b998b8c3294",
        "parentId" : "59a82877-fd4b-4035-8853-6c09d97e0339",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "We can do this for the following commands right?\r\n```\r\nCreateNamespaceStatement\r\nDropNamespaceStatement\r\nDescribeNamespaceStatement\r\nShowNamespacesStatement\r\nShowTablesStatement\r\nAlterNamespaceSetPropertiesStatement\r\nAlterNamespaceSetLocationStatement\r\n```\r\nIn that case, can I do it as a follow up PR? Let me know if it's easer to review in this PR. Thanks for the suggestion!",
        "createdAt" : "2020-01-07T03:26:52Z",
        "updatedAt" : "2020-01-07T05:54:46Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      },
      {
        "id" : "7e56d90e-b7d8-4dfc-8cf4-dae68bc49587",
        "parentId" : "59a82877-fd4b-4035-8853-6c09d97e0339",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "sounds good",
        "createdAt" : "2020-01-07T03:49:16Z",
        "updatedAt" : "2020-01-07T05:54:46Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "b31f07bbf1ed0ae0e19498eea70e8c316e340262",
    "line" : 28,
    "diffHunk" : "@@ -1,1 +199,203 @@\n    case DescribeNamespaceStatement(NonSessionCatalogAndNamespace(catalog, ns), extended) =>\n      DescribeNamespace(catalog, ns, extended)\n\n    case ShowNamespacesStatement(NonSessionCatalogAndNamespace(catalog, ns), pattern) =>"
  },
  {
    "id" : "3431c264-a610-4fce-a37b-5e6780e04bff",
    "prId" : 26741,
    "prUrl" : "https://github.com/apache/spark/pull/26741#pullrequestreview-329612343",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2586cd5e-b6d4-49a6-9948-8381c8847e81",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "nit: let's be consistent and always use `ns`",
        "createdAt" : "2019-12-10T04:43:20Z",
        "updatedAt" : "2019-12-10T18:35:01Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "5fac3469-36bb-46d9-9556-43e409f08f5b",
        "parentId" : "2586cd5e-b6d4-49a6-9948-8381c8847e81",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "and also `tbl` instead of `tableName`, to make the code shorter.",
        "createdAt" : "2019-12-10T04:43:47Z",
        "updatedAt" : "2019-12-10T18:35:01Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "828229fb-5fd0-4132-9071-03c9282bc0dd",
        "parentId" : "2586cd5e-b6d4-49a6-9948-8381c8847e81",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "Updated. I also applied this to `ResolveSessionCatalogs.scala`. Please let me know if that was not intended, and I can revert.",
        "createdAt" : "2019-12-10T06:31:44Z",
        "updatedAt" : "2019-12-10T18:35:01Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "0696c3328c793490b844bb4017b398e574964789",
    "line" : 198,
    "diffHunk" : "@@ -1,1 +181,185 @@      CreateNamespace(catalog.asNamespaceCatalog, ns, c.ifNotExists, c.properties)\n\n    case DropNamespaceStatement(NonSessionCatalogAndNamespace(catalog, ns), ifExists, cascade) =>\n      DropNamespace(catalog, ns, ifExists, cascade)\n"
  },
  {
    "id" : "64d4b989-3527-4f5a-a9d4-9126dae18a44",
    "prId" : 26539,
    "prUrl" : "https://github.com/apache/spark/pull/26539#pullrequestreview-317816734",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "59140c9c-bad4-463e-a26d-6f8465bea01f",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Could you add a test coverage for this too?",
        "createdAt" : "2019-11-15T05:53:47Z",
        "updatedAt" : "2019-11-18T19:03:08Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "b7c3fe6c-490e-4a74-b056-37b8aa7a7ea9",
        "parentId" : "59140c9c-bad4-463e-a26d-6f8465bea01f",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "Thanks for catching this. I will add one.",
        "createdAt" : "2019-11-15T19:16:00Z",
        "updatedAt" : "2019-11-18T19:03:08Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "b6be4a9672cd1807b9b74b067d20d8877b420195",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +103,107 @@    case RenameTableStatement(NonSessionCatalog(catalog, oldName), newNameParts, isView) =>\n      if (isView) {\n        throw new AnalysisException(\"Renaming view is not supported in v2 catalogs.\")\n      }\n      RenameTable(catalog.asTableCatalog, oldName.asIdentifier, newNameParts.asIdentifier)"
  },
  {
    "id" : "47e76040-f204-4954-afc1-7b9ebe1bd25f",
    "prId" : 26219,
    "prUrl" : "https://github.com/apache/spark/pull/26219#pullrequestreview-315354526",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "242a403a-75b7-437a-b2fe-de1cd558389e",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "we can support the LOCATION clause. See `CatalogV2Utils.convertTableProperties`, we can store the location in a special table property `location`.",
        "createdAt" : "2019-11-12T06:49:06Z",
        "updatedAt" : "2019-11-12T06:49:06Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "2b116566-3f04-409b-a8f9-38529bcf3acc",
        "parentId" : "242a403a-75b7-437a-b2fe-de1cd558389e",
        "authorId" : "a2fcc15e-a51a-42f0-87a6-137048a28e30",
        "body" : "@cloud-fan Thanks a lot. I was not aware of this. I will check.",
        "createdAt" : "2019-11-12T08:17:12Z",
        "updatedAt" : "2019-11-12T08:17:12Z",
        "lastEditedBy" : "a2fcc15e-a51a-42f0-87a6-137048a28e30",
        "tags" : [
        ]
      }
    ],
    "commit" : "11ea11b80898f006ffe314f626b046a524a15ff6",
    "line" : 8,
    "diffHunk" : "@@ -1,1 +146,150 @@        if (loc.isDefined) {\n          throw new AnalysisException(\"Location clause not supported for \" +\n            \"CREATE TABLE LIKE statement when tables are of V2 type\")\n        }\n      }"
  },
  {
    "id" : "cdde5d4d-3eee-4ee8-8044-82ec7ff29e6a",
    "prId" : 26219,
    "prUrl" : "https://github.com/apache/spark/pull/26219#pullrequestreview-315662188",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6600573b-efe1-4310-a63b-f46b9c2cf561",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "If we need to catch session catalog, we should move the case to `ResolveSessionCatalog`. It's OK to create v2 command in `ResolveSessionCatalog`",
        "createdAt" : "2019-11-12T07:03:24Z",
        "updatedAt" : "2019-11-12T07:03:24Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "c28ecba4-0aaf-4192-a707-a425243823f0",
        "parentId" : "6600573b-efe1-4310-a63b-f46b9c2cf561",
        "authorId" : "a2fcc15e-a51a-42f0-87a6-137048a28e30",
        "body" : "@cloud-fan NonSessionCatalog is not available in ResolveSessionCatalog, right ? this case catches both NonSessionCatalog and SessionCatalog ?",
        "createdAt" : "2019-11-12T08:16:43Z",
        "updatedAt" : "2019-11-12T08:16:43Z",
        "lastEditedBy" : "a2fcc15e-a51a-42f0-87a6-137048a28e30",
        "tags" : [
        ]
      },
      {
        "id" : "31bca5cd-d25c-4eaa-b264-7c0fa64e7019",
        "parentId" : "6600573b-efe1-4310-a63b-f46b9c2cf561",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "ok let's leave it.",
        "createdAt" : "2019-11-12T16:20:26Z",
        "updatedAt" : "2019-11-12T16:20:26Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "11ea11b80898f006ffe314f626b046a524a15ff6",
    "line" : 19,
    "diffHunk" : "@@ -1,1 +157,161 @@            s,\n            ifNotExists)\n        case (NonSessionCatalog(tCatalog, t), SessionCatalog(sCatalog, s)) =>\n          validateLocation(loc)\n          CreateTableLike(tCatalog.asTableCatalog,"
  },
  {
    "id" : "c0cdf260-41a9-4a6d-80fe-da61e0af1ac9",
    "prId" : 26219,
    "prUrl" : "https://github.com/apache/spark/pull/26219#pullrequestreview-315326744",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3f326db1-c3f3-41fc-88b2-8a6b3d287f1b",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "shall we pass `sCatalog` in ?",
        "createdAt" : "2019-11-12T07:04:49Z",
        "updatedAt" : "2019-11-12T07:04:49Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "11ea11b80898f006ffe314f626b046a524a15ff6",
    "line" : 23,
    "diffHunk" : "@@ -1,1 +161,165 @@          CreateTableLike(tCatalog.asTableCatalog,\n            t,\n            None,\n            source,\n            ifNotExists)"
  },
  {
    "id" : "4c3d742f-3db7-449b-b207-d0c5874aee07",
    "prId" : 26176,
    "prUrl" : "https://github.com/apache/spark/pull/26176#pullrequestreview-314686367",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c0bd0a78-4f6a-4cd0-b717-a2593fc57066",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "nit: 4 space indentation",
        "createdAt" : "2019-11-11T04:01:33Z",
        "updatedAt" : "2019-11-11T19:52:51Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "846e21a96e106f44fa0b88ab71d07095995b3790",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +210,214 @@\n    case ShowTablePropertiesStatement(\n      nameParts @ NonSessionCatalog(catalog, tableName), propertyKey) =>\n      val r = UnresolvedV2Relation(nameParts, catalog.asTableCatalog, tableName.asIdentifier)\n      ShowTableProperties(r, propertyKey)"
  },
  {
    "id" : "259415fa-3a76-40b1-81dc-a6b7ea546d2b",
    "prId" : 26006,
    "prUrl" : "https://github.com/apache/spark/pull/26006#pullrequestreview-297774785",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6f797d93-01b2-4e41-8fee-df67e503ef3c",
        "parentId" : null,
        "authorId" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "body" : "This will always set the catalog, even if it is already the current? Why not use a rule that doesn't fill in the catalog and returns None instead?",
        "createdAt" : "2019-10-04T19:42:47Z",
        "updatedAt" : "2019-10-10T04:41:57Z",
        "lastEditedBy" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "tags" : [
        ]
      },
      {
        "id" : "7c3c484e-3f56-44aa-a656-f1ee1c0a601b",
        "parentId" : "6f797d93-01b2-4e41-8fee-df67e503ef3c",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "The check is done here: https://github.com/apache/spark/blob/8556710409d9f2fbaee9dbf76a2ea70218316693/sql/catalyst/src/main/scala/org/apache/spark/sql/connector/catalog/CatalogManager.scala#L128-L137",
        "createdAt" : "2019-10-05T04:31:35Z",
        "updatedAt" : "2019-10-10T04:41:57Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "d8b53624ab974e80e522c30ab2731a89cab1fa8f",
    "line" : 25,
    "diffHunk" : "@@ -1,1 +188,192 @@      } else {\n        val CatalogAndNamespace(catalog, namespace) = nameParts\n        SetCatalogAndNamespace(catalogManager, Some(catalog.name()), namespace)\n      }\n  }"
  }
]