[
  {
    "id" : "e446b03a-b664-4819-9200-87f756c42698",
    "prId" : 27650,
    "prUrl" : "https://github.com/apache/spark/pull/27650#pullrequestreview-366258165",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "be1df51c-1320-421d-b227-c6484b6e04c4",
        "parentId" : null,
        "authorId" : "471c3dfe-259c-447a-9abd-f7fdecccd9a7",
        "body" : "Can the parser return this as `null`? If so, shouldn't these be `Option(c.provider)` so that they don't return null providers",
        "createdAt" : "2020-02-28T07:24:48Z",
        "updatedAt" : "2020-02-28T07:24:49Z",
        "lastEditedBy" : "471c3dfe-259c-447a-9abd-f7fdecccd9a7",
        "tags" : [
        ]
      },
      {
        "id" : "2e0fda0c-4d27-4ff2-89c2-fa86abc3f045",
        "parentId" : "be1df51c-1320-421d-b227-c6484b6e04c4",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Seems that's required https://github.com/apache/spark/pull/27650/files#diff-9847f5cef7cf7fbc5830fbc6b779ee10L2803 . So should be fine.",
        "createdAt" : "2020-02-28T08:31:55Z",
        "updatedAt" : "2020-02-28T08:31:56Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "3e28cb95-63e6-40aa-aac8-1ebe530f0ee5",
        "parentId" : "be1df51c-1320-421d-b227-c6484b6e04c4",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "https://github.com/cloud-fan/spark/blob/6685dc5dbbbea0f4cd069f1a5e92ccb70033f493/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/parser/AstBuilder.scala#L2826\r\n\r\nThis is how the parser gets the provider. I don't think it can be null.",
        "createdAt" : "2020-02-28T09:24:33Z",
        "updatedAt" : "2020-02-28T09:24:33Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "6685dc5dbbbea0f4cd069f1a5e92ccb70033f493",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +175,179 @@        // convert the bucket spec and add it as a transform\n        c.partitioning ++ c.bucketSpec.map(_.asTransform),\n        convertTableProperties(c.properties, c.options, c.location, c.comment, Some(c.provider)),\n        orCreate = c.orCreate)\n"
  },
  {
    "id" : "224b6052-597f-4d60-b813-47e8a1a37a73",
    "prId" : 27095,
    "prUrl" : "https://github.com/apache/spark/pull/27095#pullrequestreview-339018528",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "59a82877-fd4b-4035-8853-6c09d97e0339",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "do we still need the separation between `DescribeNamespaceStatement` and `DescribeNamespace`?",
        "createdAt" : "2020-01-06T04:06:02Z",
        "updatedAt" : "2020-01-07T05:54:46Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "faf6b777-dc5c-4a62-92b9-55120ab7d311",
        "parentId" : "59a82877-fd4b-4035-8853-6c09d97e0339",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "sorry, could you elaborate on your question?",
        "createdAt" : "2020-01-06T06:20:37Z",
        "updatedAt" : "2020-01-07T05:54:46Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      },
      {
        "id" : "62011241-cdf8-403a-9c19-9a7a7bb5a667",
        "parentId" : "59a82877-fd4b-4035-8853-6c09d97e0339",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "It's simpler to\r\n1. create `DescribeNamespace(UnresolvedNamespace(...))` in parser\r\n2. match `DescribeNamespace(ResolvedNamespace(catalog, ident))` in planner and convert it to physical node.",
        "createdAt" : "2020-01-06T06:54:32Z",
        "updatedAt" : "2020-01-07T05:54:46Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "e86469b1-13a0-44df-9710-8138b6c57a7a",
        "parentId" : "59a82877-fd4b-4035-8853-6c09d97e0339",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "But we still need to handle the case where catalog is a session catalog (and I don't think we want to handle this case in planner).",
        "createdAt" : "2020-01-06T07:13:57Z",
        "updatedAt" : "2020-01-07T05:54:46Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      },
      {
        "id" : "018a8a12-2cdd-456d-b1be-9fe697cf66af",
        "parentId" : "59a82877-fd4b-4035-8853-6c09d97e0339",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "yea, we should have an extra analyzer rule to catch\r\n```\r\ncase DescribeNamespace(ResolvedNamespace(catalog, ident)) if isSessionCatalog(catalog)\r\n```\r\nand convert to v1 command.",
        "createdAt" : "2020-01-06T07:17:22Z",
        "updatedAt" : "2020-01-07T05:54:46Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "cace4168-03c0-42cb-8884-2b998b8c3294",
        "parentId" : "59a82877-fd4b-4035-8853-6c09d97e0339",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "We can do this for the following commands right?\r\n```\r\nCreateNamespaceStatement\r\nDropNamespaceStatement\r\nDescribeNamespaceStatement\r\nShowNamespacesStatement\r\nShowTablesStatement\r\nAlterNamespaceSetPropertiesStatement\r\nAlterNamespaceSetLocationStatement\r\n```\r\nIn that case, can I do it as a follow up PR? Let me know if it's easer to review in this PR. Thanks for the suggestion!",
        "createdAt" : "2020-01-07T03:26:52Z",
        "updatedAt" : "2020-01-07T05:54:46Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      },
      {
        "id" : "7e56d90e-b7d8-4dfc-8cf4-dae68bc49587",
        "parentId" : "59a82877-fd4b-4035-8853-6c09d97e0339",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "sounds good",
        "createdAt" : "2020-01-07T03:49:16Z",
        "updatedAt" : "2020-01-07T05:54:46Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "b31f07bbf1ed0ae0e19498eea70e8c316e340262",
    "line" : 28,
    "diffHunk" : "@@ -1,1 +199,203 @@\n    case DescribeNamespaceStatement(NonSessionCatalogAndNamespace(catalog, ns), extended) =>\n      DescribeNamespace(catalog, ns, extended)\n\n    case ShowNamespacesStatement(NonSessionCatalogAndNamespace(catalog, ns), pattern) =>"
  }
]