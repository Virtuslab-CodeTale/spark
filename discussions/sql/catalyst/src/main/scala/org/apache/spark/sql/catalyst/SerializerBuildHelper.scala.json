[
  {
    "id" : "14969276-9edf-4dbc-891e-ca2d19ab245f",
    "prId" : 27851,
    "prUrl" : "https://github.com/apache/spark/pull/27851#pullrequestreview-371695086",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b4a908a1-ceff-4d5a-a56c-2fad4f3c8b45",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "I think optimizer can optimize `IsNull(inputObject)` if `inputObject` is not nullable?",
        "createdAt" : "2020-03-09T07:45:53Z",
        "updatedAt" : "2020-03-10T05:53:54Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "29176d29-ce15-4eb6-aa2e-c0a80e8f4006",
        "parentId" : "b4a908a1-ceff-4d5a-a56c-2fad4f3c8b45",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "In `createDataset`, we use the `schema` of current encoder to be the output of `LocalRelation`. So the output schema is kept to be nullable.",
        "createdAt" : "2020-03-10T05:51:38Z",
        "updatedAt" : "2020-03-10T05:53:54Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "5a5345e8a203a44220f1580d3e7caa1448101ae6",
    "line" : 8,
    "diffHunk" : "@@ -1,1 +190,194 @@    if (inputObject.nullable) {\n      val nullOutput = expressions.Literal.create(null, nonNullOutput.dataType)\n      expressions.If(IsNull(inputObject), nullOutput, nonNullOutput)\n    } else {\n      nonNullOutput"
  }
]