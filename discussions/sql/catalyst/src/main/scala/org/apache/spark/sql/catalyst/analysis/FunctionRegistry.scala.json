[
  {
    "id" : "a1f62ce5-3812-4695-8142-dfde8260eb4a",
    "prId" : 33299,
    "prUrl" : "https://github.com/apache/spark/pull/33299#pullrequestreview-710122821",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "429e3147-6329-468c-9a08-0ad25cd05bde",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "If `setAlias` is set `true`, it means that an expression has multiple names but in your case `MakeTimestampNTZ` has only `make_timestamp_ntz`. Or `setAlias` has another meaning?",
        "createdAt" : "2021-07-12T16:27:33Z",
        "updatedAt" : "2021-07-12T16:30:54Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "cc1d0c3c-b165-43af-9254-4e4cc45c8467",
        "parentId" : "429e3147-6329-468c-9a08-0ad25cd05bde",
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : " It means we don't need to override the `prettyName` method. ",
        "createdAt" : "2021-07-12T17:06:45Z",
        "updatedAt" : "2021-07-12T17:06:45Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      },
      {
        "id" : "6293f225-c338-4824-be35-72bccb14389a",
        "parentId" : "429e3147-6329-468c-9a08-0ad25cd05bde",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "It's better to implement `prettyName`. The alias here is implemented via `TreeNodeTag`, which is quite unreliable.",
        "createdAt" : "2021-07-13T04:48:17Z",
        "updatedAt" : "2021-07-13T04:48:17Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "34e54466-5034-492f-b15f-1129a8222bde",
        "parentId" : "429e3147-6329-468c-9a08-0ad25cd05bde",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "@beliefer can you fix it in a followup pr?",
        "createdAt" : "2021-07-19T15:25:21Z",
        "updatedAt" : "2021-07-19T15:25:21Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "f42c8b25-3ea7-45f9-81a2-1a5d8d33a6b9",
        "parentId" : "429e3147-6329-468c-9a08-0ad25cd05bde",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "@cloud-fan Thank you ping me.",
        "createdAt" : "2021-07-20T02:12:46Z",
        "updatedAt" : "2021-07-20T02:12:46Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "ba6421de3b1f0012dbe871cfe43b0df6f51312bc",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +553,557 @@    expression[MakeDate](\"make_date\"),\n    expression[MakeTimestamp](\"make_timestamp\"),\n    expression[MakeTimestampNTZ](\"make_timestamp_ntz\", true),\n    expression[MakeTimestampLTZ](\"make_timestamp_ltz\", true),\n    expression[MakeInterval](\"make_interval\"),"
  },
  {
    "id" : "396afa53-7daf-49db-af1d-2dae4715a7dc",
    "prId" : 32842,
    "prUrl" : "https://github.com/apache/spark/pull/32842#pullrequestreview-680297486",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6e7bbad1-eb22-4a71-b7b0-01ec9f63d864",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "`protected`?",
        "createdAt" : "2021-06-09T13:24:47Z",
        "updatedAt" : "2021-06-09T13:24:47Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "22923e03-3cfb-4893-9070-2df758606bde",
        "parentId" : "6e7bbad1-eb22-4a71-b7b0-01ec9f63d864",
        "authorId" : "29c89154-22f7-40ee-b295-115a55734d6c",
        "body" : "we can't because it's used by other classes. like `TableFunctionRegistry `",
        "createdAt" : "2021-06-10T02:47:36Z",
        "updatedAt" : "2021-06-10T02:47:36Z",
        "lastEditedBy" : "29c89154-22f7-40ee-b295-115a55734d6c",
        "tags" : [
        ]
      }
    ],
    "commit" : "60dcf66c8b9b2bb3e1785bc24983b927411c78dc",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +208,212 @@   * This is used when registering built-in functions and doing `FunctionRegistry.clone()`\n   */\n  def internalRegisterFunction(\n      name: FunctionIdentifier,\n      info: ExpressionInfo,"
  },
  {
    "id" : "9ef8e15d-1556-4006-8d6c-481063ff969e",
    "prId" : 32645,
    "prUrl" : "https://github.com/apache/spark/pull/32645#pullrequestreview-668845548",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "77b5b295-52fc-41fc-af64-282d66eb2ffc",
        "parentId" : null,
        "authorId" : "924ae4ed-b84b-4216-9852-5db80e7d0e1b",
        "body" : "I think the name of interval series functions should be like following:\r\n```\r\nmake_interval\r\nmake_duration\r\nmake_period\r\n```\r\nThis naming convention has been adopted by Java such as [Duration](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/Duration.html) and [Period](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/Period.html).",
        "createdAt" : "2021-05-25T15:11:13Z",
        "updatedAt" : "2021-05-25T15:11:13Z",
        "lastEditedBy" : "924ae4ed-b84b-4216-9852-5db80e7d0e1b",
        "tags" : [
        ]
      },
      {
        "id" : "f2702716-2c09-4c10-aeb7-b3e9adac2c80",
        "parentId" : "77b5b295-52fc-41fc-af64-282d66eb2ffc",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "duration/period is not a SQL type, and users may not be able to map them to year-month and day-time intervals.",
        "createdAt" : "2021-05-25T15:14:48Z",
        "updatedAt" : "2021-05-25T15:14:48Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "989f0e0e-15da-4a94-a913-fe03880d4556",
        "parentId" : "77b5b295-52fc-41fc-af64-282d66eb2ffc",
        "authorId" : "924ae4ed-b84b-4216-9852-5db80e7d0e1b",
        "body" : "gotcha",
        "createdAt" : "2021-05-26T10:21:11Z",
        "updatedAt" : "2021-05-26T10:21:11Z",
        "lastEditedBy" : "924ae4ed-b84b-4216-9852-5db80e7d0e1b",
        "tags" : [
        ]
      }
    ],
    "commit" : "108d79e3bce4fb9acb87d09cbcc456f1765ca8e7",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +553,557 @@    expression[MakeTimestamp](\"make_timestamp\"),\n    expression[MakeInterval](\"make_interval\"),\n    expression[MakeYMInterval](\"make_ym_interval\"),\n    expression[DatePart](\"date_part\"),\n    expression[Extract](\"extract\"),"
  },
  {
    "id" : "ed9c4bbc-edf8-4376-9b2d-f51a4f985a06",
    "prId" : 31791,
    "prUrl" : "https://github.com/apache/spark/pull/31791#pullrequestreview-629609270",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "21323df0-a1d6-490a-82c5-527a1124dcf0",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "nit: what if we simply put it in the `trait FunctionRegistryBase[T]`?",
        "createdAt" : "2021-04-07T03:20:59Z",
        "updatedAt" : "2021-04-07T03:20:59Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "2778e7f5-94f5-4897-ae3c-dcba688b3d0e",
        "parentId" : "21323df0-a1d6-490a-82c5-527a1124dcf0",
        "authorId" : "b3ba992a-312c-46eb-b3c3-8d861d15ac40",
        "body" : "Please correct me if I am wrong here. Scala doesn't seem to allow calling the methods in a generic trait unless the class/object extends it and implements all abstract methods. Since we need to call these methods (build and expressionInfo) inside the companion objects for FunctionRegistry and TableFunctionRegistry, they can't be in the `FunctionRegistryBase[T]` trait.",
        "createdAt" : "2021-04-07T04:24:25Z",
        "updatedAt" : "2021-04-07T04:24:26Z",
        "lastEditedBy" : "b3ba992a-312c-46eb-b3c3-8d861d15ac40",
        "tags" : [
        ]
      },
      {
        "id" : "1dc54bb8-4e14-4a4f-9ceb-53cfb6d6efba",
        "parentId" : "21323df0-a1d6-490a-82c5-527a1124dcf0",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "You are right, I missed this part.",
        "createdAt" : "2021-04-07T05:38:48Z",
        "updatedAt" : "2021-04-07T05:38:48Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "3e41b618b1d01e1e36db3fa3b324834718ce38e0",
    "line" : 46,
    "diffHunk" : "@@ -1,1 +94,98 @@   * T using the given name.\n   */\n  def build[T : ClassTag](name: String): (ExpressionInfo, Seq[Expression] => T) = {\n    val runtimeClass = scala.reflect.classTag[T].runtimeClass\n    // For `RuntimeReplaceable`, skip the constructor with most arguments, which is the main"
  },
  {
    "id" : "a553fbca-7092-4366-bad1-55c2a739e93a",
    "prId" : 30243,
    "prUrl" : "https://github.com/apache/spark/pull/30243#pullrequestreview-560308081",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "df8464e8-77b2-448f-89cf-c6399b6b433f",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "The naming might be controversial later.",
        "createdAt" : "2020-12-23T01:43:03Z",
        "updatedAt" : "2020-12-23T01:43:03Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "d95d017c-6314-4ec2-b65b-56909b82a578",
        "parentId" : "df8464e8-77b2-448f-89cf-c6399b6b433f",
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "> The naming might be controversial later.\r\n\r\nDo you have other idea about the naming.\r\nAs we have discussed in https://github.com/apache/spark/pull/30243#discussion_r532255830",
        "createdAt" : "2020-12-23T01:44:58Z",
        "updatedAt" : "2020-12-23T01:44:58Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      },
      {
        "id" : "b62ec93a-b79f-4340-9690-a18b5d000490",
        "parentId" : "df8464e8-77b2-448f-89cf-c6399b6b433f",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Ya. I saw the discussion history, but the problem is that it doesn't come from the popular DBMSes.",
        "createdAt" : "2020-12-23T01:50:58Z",
        "updatedAt" : "2020-12-23T01:50:58Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "1173c347-c065-4a30-97e3-1e9fb598afdd",
        "parentId" : "df8464e8-77b2-448f-89cf-c6399b6b433f",
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "> Ya. I saw the discussion history, but the problem is that it doesn't come from the popular DBMSes.\r\n\r\nFirebase have similar function also called such way.\r\nhttps://firebase.google.com/docs/reference/rules/rules.List#hasAll\r\n\r\nPopular DBMS such as mysql, sql server, oracle have less array functions and PostgresSQL's naming is strange...",
        "createdAt" : "2020-12-23T02:14:15Z",
        "updatedAt" : "2020-12-23T02:14:25Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      },
      {
        "id" : "71bb5af7-822d-4c63-a22e-95f7c7838bb3",
        "parentId" : "df8464e8-77b2-448f-89cf-c6399b6b433f",
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "Any more concern ? Popular DBMS don't have less high-level  functions since slow iteration.\r\nAnd this method is really useful when many business scenario ",
        "createdAt" : "2020-12-31T09:41:21Z",
        "updatedAt" : "2020-12-31T09:41:21Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      }
    ],
    "commit" : "a1024f27b73a9dc41b4fbd246f4a468d79f3222c",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +442,446 @@    expression[CreateArray](\"array\"),\n    expression[ArrayContains](\"array_contains\"),\n    expression[HasAll](\"has_all\"),\n    expression[ArraysOverlap](\"arrays_overlap\"),\n    expression[ArrayIntersect](\"array_intersect\"),"
  },
  {
    "id" : "4bf4e89f-cb66-4b44-8cdf-0c5f5c6f4781",
    "prId" : 28342,
    "prUrl" : "https://github.com/apache/spark/pull/28342#pullrequestreview-442662722",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "cbb525f1-9ca1-4bea-b57f-b0fd134b7721",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Since the usage is different between `now` and `current_timestamp`, I added a `Now` expr.",
        "createdAt" : "2020-04-25T08:30:38Z",
        "updatedAt" : "2020-04-26T06:56:52Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "a614c8f9-6ba2-4dca-acce-ae17f5fb58ea",
        "parentId" : "cbb525f1-9ca1-4bea-b57f-b0fd134b7721",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "btw, we don't need to add a version here where an alias added? For example, `current_timestamp` and `now` have been implemented in the different versions, 1.5 and 1.6.",
        "createdAt" : "2020-04-26T02:18:32Z",
        "updatedAt" : "2020-04-26T06:56:52Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "f27dfb30-5634-4be7-b471-15098cce1ecb",
        "parentId" : "cbb525f1-9ca1-4bea-b57f-b0fd134b7721",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "What is the difference between `now` and `current_timestamp`? Should `now` extend `Nondeterministic`, for example?",
        "createdAt" : "2020-07-05T08:05:52Z",
        "updatedAt" : "2020-07-05T08:05:53Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "eb24e03a-0542-4dbc-8178-f64025f01c71",
        "parentId" : "cbb525f1-9ca1-4bea-b57f-b0fd134b7721",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "`CURRENT_TIMESTAMP` is a SQL syntax and `NOW` is not: https://github.com/apache/spark/blob/master/sql/catalyst/src/main/antlr4/org/apache/spark/sql/catalyst/parser/SqlBase.g4#L777",
        "createdAt" : "2020-07-05T09:47:48Z",
        "updatedAt" : "2020-07-05T09:47:48Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "463c4d3f69022fa8b2f5ae34675155ca0d87bec7",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +405,409 @@    expression[MonthsBetween](\"months_between\"),\n    expression[NextDay](\"next_day\"),\n    expression[Now](\"now\"),\n    expression[Quarter](\"quarter\"),\n    expression[Second](\"second\"),"
  },
  {
    "id" : "786c9a4e-b834-499e-a0a1-b13a47502258",
    "prId" : 28251,
    "prUrl" : "https://github.com/apache/spark/pull/28251#pullrequestreview-396928388",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2ee49ae2-1253-43ab-8384-38fc8e3fec64",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "one side effect is now we support `extract(field, source)` other than `extract(field from source)`. Not a big deal but better if we can avoid exposing more APIs,",
        "createdAt" : "2020-04-20T04:37:07Z",
        "updatedAt" : "2020-04-20T04:37:07Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "e1ed095a-990e-48bb-b68f-95b69d1cb02c",
        "parentId" : "2ee49ae2-1253-43ab-8384-38fc8e3fec64",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "> Not a big deal but better if we can avoid exposing more APIs\r\n\r\nYea, +1 .\r\n\r\nbtw, its better to add tests for the case `extract(field, source)`?\r\n",
        "createdAt" : "2020-04-20T05:50:15Z",
        "updatedAt" : "2020-04-20T05:50:15Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "cd9d55a0-6361-466f-82f0-d3c76d62da56",
        "parentId" : "2ee49ae2-1253-43ab-8384-38fc8e3fec64",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Yea if we decide to support it.",
        "createdAt" : "2020-04-20T07:41:11Z",
        "updatedAt" : "2020-04-20T07:41:11Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "8dcc20aa-73cf-492a-94bd-0bfcd810c3e2",
        "parentId" : "2ee49ae2-1253-43ab-8384-38fc8e3fec64",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "ok, I'll do follow-up later.",
        "createdAt" : "2020-04-20T07:52:38Z",
        "updatedAt" : "2020-04-20T07:52:38Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "79cbf791-63a7-4886-9033-0e11e6a346d3",
        "parentId" : "2ee49ae2-1253-43ab-8384-38fc8e3fec64",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "I opened https://github.com/apache/spark/pull/28276",
        "createdAt" : "2020-04-21T01:33:25Z",
        "updatedAt" : "2020-04-21T01:33:25Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "557973654f8cb10cfb826bd58c3609a2696cb94b",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +424,428 @@    expression[MakeInterval](\"make_interval\"),\n    expression[DatePart](\"date_part\"),\n    expression[Extract](\"extract\"),\n\n    // collection functions"
  },
  {
    "id" : "3cfbfb39-ed77-4f36-8e81-ec2cecbc7be2",
    "prId" : 28154,
    "prUrl" : "https://github.com/apache/spark/pull/28154#pullrequestreview-390458506",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5ab1706a-bfa1-48b3-bcba-3ac59b81ec3c",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "This seems already correct? https://github.com/apache/spark/blob/a5efbb284e29b1d879490a4ee2c9fa08acec42b0/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/expressions/bitwiseExpressions.scala#L188",
        "createdAt" : "2020-04-09T01:41:33Z",
        "updatedAt" : "2020-04-09T01:41:34Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "d1ee4e79-0a9b-4ad9-8ac3-acb56704e549",
        "parentId" : "5ab1706a-bfa1-48b3-bcba-3ac59b81ec3c",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "I don't think it's elegant enough. Because `Expression` gives the following definitions.\r\n```\r\n  def sql: String = {\r\n    val childrenSQL = children.map(_.sql).mkString(\", \")\r\n    s\"$prettyName($childrenSQL)\"\r\n  }\r\n```\r\nBy this definition, I judge legitimacy by comparing `prettyName` with alias.",
        "createdAt" : "2020-04-09T02:26:59Z",
        "updatedAt" : "2020-04-09T02:26:59Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      },
      {
        "id" : "05f36f6c-1c8f-49f0-b326-0ab0b8046c1d",
        "parentId" : "5ab1706a-bfa1-48b3-bcba-3ac59b81ec3c",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Okay, sticking with `prettyName` is okay. Can we change `prettyName` in `BitwiseCount` to `bit_count` then? Seems it's right to change.",
        "createdAt" : "2020-04-09T02:40:00Z",
        "updatedAt" : "2020-04-09T02:40:00Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "b674225c-1618-4814-a785-8434ac089172",
        "parentId" : "5ab1706a-bfa1-48b3-bcba-3ac59b81ec3c",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "OK. I will open another PR to manually handle the aliases. ",
        "createdAt" : "2020-04-09T02:52:04Z",
        "updatedAt" : "2020-04-09T02:52:04Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "1331c8d471ccdf42f5d9decbb83fb782ed71c193",
    "line" : 35,
    "diffHunk" : "@@ -1,1 +530,534 @@    expression[BitwiseOr](\"|\"),\n    expression[BitwiseXor](\"^\"),\n    expression[BitwiseCount](\"bit_count\", true),\n    expression[BitAndAgg](\"bit_and\"),\n    expression[BitOrAgg](\"bit_or\"),"
  },
  {
    "id" : "20f010d4-d136-4507-8010-3e7d48f97548",
    "prId" : 28154,
    "prUrl" : "https://github.com/apache/spark/pull/28154#pullrequestreview-391442441",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "84827a8a-3ec4-483e-bacf-5cebccab1e65",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "I think you should manually handle the aliases in `UnaryMinus`. The output column name will still be based on `override def sql: String = s\"(- ${child.sql})\"`.",
        "createdAt" : "2020-04-09T02:42:26Z",
        "updatedAt" : "2020-04-09T02:42:26Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "6bbf78c5-b70e-4175-ab40-abddaa4697d0",
        "parentId" : "84827a8a-3ec4-483e-bacf-5cebccab1e65",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "OK. I will open another PR to manually handle the aliases. This PR is used to add more powerful guarantees so that aliases outputed by built-in functions are correct.",
        "createdAt" : "2020-04-09T02:45:09Z",
        "updatedAt" : "2020-04-09T02:45:09Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      },
      {
        "id" : "119dbebb-6c9c-4be9-8947-62e6fca1963d",
        "parentId" : "84827a8a-3ec4-483e-bacf-5cebccab1e65",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "@HyukjinKwon This alias should be `negative` or `-` ?\r\n```\r\nspark-sql> desc select negative(1);\r\n(- 1)   int     NULL\r\nTime taken: 0.035 seconds, Fetched 1 row(s)\r\n```\r\nThis alias looks so strange.",
        "createdAt" : "2020-04-09T03:01:55Z",
        "updatedAt" : "2020-04-09T03:04:11Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      },
      {
        "id" : "41236244-aa30-47fb-bf23-236efa8d3604",
        "parentId" : "84827a8a-3ec4-483e-bacf-5cebccab1e65",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "Could we use `negative(1)` as alias ?",
        "createdAt" : "2020-04-09T03:04:59Z",
        "updatedAt" : "2020-04-09T03:04:59Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      },
      {
        "id" : "94cbd622-9232-4405-a021-dbdbbdc4ff1b",
        "parentId" : "84827a8a-3ec4-483e-bacf-5cebccab1e65",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Yes, I think we can use `negative(1)` as alias for `negative` function. Does that work if we check the tag in override `sql`?",
        "createdAt" : "2020-04-10T09:21:35Z",
        "updatedAt" : "2020-04-10T09:21:52Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "8490705f-ea12-4bb2-9a87-5959011e0a89",
        "parentId" : "84827a8a-3ec4-483e-bacf-5cebccab1e65",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "See https://github.com/apache/spark/pull/27901/files#diff-1516b10738479bbe190fb4e239258473R467-R470",
        "createdAt" : "2020-04-10T09:23:19Z",
        "updatedAt" : "2020-04-10T09:23:19Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "2f1544af-bbe5-4c91-bddd-01b82ce8ed77",
        "parentId" : "84827a8a-3ec4-483e-bacf-5cebccab1e65",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "@HyukjinKwon There are so many kinds of rewrites of SQL methods. it seems difficult to check. I need to reconsider the feasibility of this PR.",
        "createdAt" : "2020-04-10T13:30:23Z",
        "updatedAt" : "2020-04-10T13:31:18Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "1331c8d471ccdf42f5d9decbb83fb782ed71c193",
    "line" : 8,
    "diffHunk" : "@@ -1,1 +254,258 @@    expression[Log](\"ln\", true),\n    expression[Remainder](\"mod\", true),\n    expression[UnaryMinus](\"negative\", true),\n    expression[Pi](\"pi\"),\n    expression[Pmod](\"pmod\"),"
  },
  {
    "id" : "220d8fe8-6497-4692-82ae-1cb986dfbb14",
    "prId" : 28154,
    "prUrl" : "https://github.com/apache/spark/pull/28154#pullrequestreview-391352701",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6a638195-7319-4838-81a9-bad9f1c14204",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "This case, you should also manually handle the aliases at `override def prettyName: String = \"locate\"`",
        "createdAt" : "2020-04-09T02:43:37Z",
        "updatedAt" : "2020-04-09T02:43:37Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "c913a602-ef9c-4fac-9deb-1560614368fa",
        "parentId" : "6a638195-7319-4838-81a9-bad9f1c14204",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "OK. I will open another PR to manually handle the aliases. This PR is used to add more powerful guarantees so that aliases outputed by built-in functions are correct.",
        "createdAt" : "2020-04-09T02:45:24Z",
        "updatedAt" : "2020-04-09T02:45:25Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      },
      {
        "id" : "cd14647c-8ee9-4c43-b0a2-71655d492ac6",
        "parentId" : "6a638195-7319-4838-81a9-bad9f1c14204",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "There already exists\r\n`expression[StringLocate](\"locate\"),`\r\nand `StringLocate` has the override method.\r\n`override def prettyName: String = \"locate\"`",
        "createdAt" : "2020-04-09T03:09:20Z",
        "updatedAt" : "2020-04-09T03:09:20Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      },
      {
        "id" : "32ddae58-2b79-47d0-b764-7562fe33eb31",
        "parentId" : "6a638195-7319-4838-81a9-bad9f1c14204",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "I think we can just fix one line here. See https://github.com/apache/spark/pull/27901/files#diff-b83497f7bc11578a0b63a814a2a30f48R103-R104",
        "createdAt" : "2020-04-10T09:23:35Z",
        "updatedAt" : "2020-04-10T09:23:35Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "1331c8d471ccdf42f5d9decbb83fb782ed71c193",
    "line" : 26,
    "diffHunk" : "@@ -1,1 +351,355 @@    expression[JsonTuple](\"json_tuple\"),\n    expression[ParseUrl](\"parse_url\"),\n    expression[StringLocate](\"position\", true),\n    expression[FormatString](\"printf\", true),\n    expression[RegExpExtract](\"regexp_extract\"),"
  }
]