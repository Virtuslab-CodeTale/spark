[
  {
    "id" : "a1f62ce5-3812-4695-8142-dfde8260eb4a",
    "prId" : 33299,
    "prUrl" : "https://github.com/apache/spark/pull/33299#pullrequestreview-710122821",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "429e3147-6329-468c-9a08-0ad25cd05bde",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "If `setAlias` is set `true`, it means that an expression has multiple names but in your case `MakeTimestampNTZ` has only `make_timestamp_ntz`. Or `setAlias` has another meaning?",
        "createdAt" : "2021-07-12T16:27:33Z",
        "updatedAt" : "2021-07-12T16:30:54Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "cc1d0c3c-b165-43af-9254-4e4cc45c8467",
        "parentId" : "429e3147-6329-468c-9a08-0ad25cd05bde",
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : " It means we don't need to override the `prettyName` method. ",
        "createdAt" : "2021-07-12T17:06:45Z",
        "updatedAt" : "2021-07-12T17:06:45Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      },
      {
        "id" : "6293f225-c338-4824-be35-72bccb14389a",
        "parentId" : "429e3147-6329-468c-9a08-0ad25cd05bde",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "It's better to implement `prettyName`. The alias here is implemented via `TreeNodeTag`, which is quite unreliable.",
        "createdAt" : "2021-07-13T04:48:17Z",
        "updatedAt" : "2021-07-13T04:48:17Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "34e54466-5034-492f-b15f-1129a8222bde",
        "parentId" : "429e3147-6329-468c-9a08-0ad25cd05bde",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "@beliefer can you fix it in a followup pr?",
        "createdAt" : "2021-07-19T15:25:21Z",
        "updatedAt" : "2021-07-19T15:25:21Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "f42c8b25-3ea7-45f9-81a2-1a5d8d33a6b9",
        "parentId" : "429e3147-6329-468c-9a08-0ad25cd05bde",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "@cloud-fan Thank you ping me.",
        "createdAt" : "2021-07-20T02:12:46Z",
        "updatedAt" : "2021-07-20T02:12:46Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "ba6421de3b1f0012dbe871cfe43b0df6f51312bc",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +553,557 @@    expression[MakeDate](\"make_date\"),\n    expression[MakeTimestamp](\"make_timestamp\"),\n    expression[MakeTimestampNTZ](\"make_timestamp_ntz\", true),\n    expression[MakeTimestampLTZ](\"make_timestamp_ltz\", true),\n    expression[MakeInterval](\"make_interval\"),"
  },
  {
    "id" : "396afa53-7daf-49db-af1d-2dae4715a7dc",
    "prId" : 32842,
    "prUrl" : "https://github.com/apache/spark/pull/32842#pullrequestreview-680297486",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6e7bbad1-eb22-4a71-b7b0-01ec9f63d864",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "`protected`?",
        "createdAt" : "2021-06-09T13:24:47Z",
        "updatedAt" : "2021-06-09T13:24:47Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "22923e03-3cfb-4893-9070-2df758606bde",
        "parentId" : "6e7bbad1-eb22-4a71-b7b0-01ec9f63d864",
        "authorId" : "29c89154-22f7-40ee-b295-115a55734d6c",
        "body" : "we can't because it's used by other classes. like `TableFunctionRegistry `",
        "createdAt" : "2021-06-10T02:47:36Z",
        "updatedAt" : "2021-06-10T02:47:36Z",
        "lastEditedBy" : "29c89154-22f7-40ee-b295-115a55734d6c",
        "tags" : [
        ]
      }
    ],
    "commit" : "60dcf66c8b9b2bb3e1785bc24983b927411c78dc",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +208,212 @@   * This is used when registering built-in functions and doing `FunctionRegistry.clone()`\n   */\n  def internalRegisterFunction(\n      name: FunctionIdentifier,\n      info: ExpressionInfo,"
  },
  {
    "id" : "9ef8e15d-1556-4006-8d6c-481063ff969e",
    "prId" : 32645,
    "prUrl" : "https://github.com/apache/spark/pull/32645#pullrequestreview-668845548",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "77b5b295-52fc-41fc-af64-282d66eb2ffc",
        "parentId" : null,
        "authorId" : "924ae4ed-b84b-4216-9852-5db80e7d0e1b",
        "body" : "I think the name of interval series functions should be like following:\r\n```\r\nmake_interval\r\nmake_duration\r\nmake_period\r\n```\r\nThis naming convention has been adopted by Java such as [Duration](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/Duration.html) and [Period](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/time/Period.html).",
        "createdAt" : "2021-05-25T15:11:13Z",
        "updatedAt" : "2021-05-25T15:11:13Z",
        "lastEditedBy" : "924ae4ed-b84b-4216-9852-5db80e7d0e1b",
        "tags" : [
        ]
      },
      {
        "id" : "f2702716-2c09-4c10-aeb7-b3e9adac2c80",
        "parentId" : "77b5b295-52fc-41fc-af64-282d66eb2ffc",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "duration/period is not a SQL type, and users may not be able to map them to year-month and day-time intervals.",
        "createdAt" : "2021-05-25T15:14:48Z",
        "updatedAt" : "2021-05-25T15:14:48Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "989f0e0e-15da-4a94-a913-fe03880d4556",
        "parentId" : "77b5b295-52fc-41fc-af64-282d66eb2ffc",
        "authorId" : "924ae4ed-b84b-4216-9852-5db80e7d0e1b",
        "body" : "gotcha",
        "createdAt" : "2021-05-26T10:21:11Z",
        "updatedAt" : "2021-05-26T10:21:11Z",
        "lastEditedBy" : "924ae4ed-b84b-4216-9852-5db80e7d0e1b",
        "tags" : [
        ]
      }
    ],
    "commit" : "108d79e3bce4fb9acb87d09cbcc456f1765ca8e7",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +553,557 @@    expression[MakeTimestamp](\"make_timestamp\"),\n    expression[MakeInterval](\"make_interval\"),\n    expression[MakeYMInterval](\"make_ym_interval\"),\n    expression[DatePart](\"date_part\"),\n    expression[Extract](\"extract\"),"
  },
  {
    "id" : "ed9c4bbc-edf8-4376-9b2d-f51a4f985a06",
    "prId" : 31791,
    "prUrl" : "https://github.com/apache/spark/pull/31791#pullrequestreview-629609270",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "21323df0-a1d6-490a-82c5-527a1124dcf0",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "nit: what if we simply put it in the `trait FunctionRegistryBase[T]`?",
        "createdAt" : "2021-04-07T03:20:59Z",
        "updatedAt" : "2021-04-07T03:20:59Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "2778e7f5-94f5-4897-ae3c-dcba688b3d0e",
        "parentId" : "21323df0-a1d6-490a-82c5-527a1124dcf0",
        "authorId" : "b3ba992a-312c-46eb-b3c3-8d861d15ac40",
        "body" : "Please correct me if I am wrong here. Scala doesn't seem to allow calling the methods in a generic trait unless the class/object extends it and implements all abstract methods. Since we need to call these methods (build and expressionInfo) inside the companion objects for FunctionRegistry and TableFunctionRegistry, they can't be in the `FunctionRegistryBase[T]` trait.",
        "createdAt" : "2021-04-07T04:24:25Z",
        "updatedAt" : "2021-04-07T04:24:26Z",
        "lastEditedBy" : "b3ba992a-312c-46eb-b3c3-8d861d15ac40",
        "tags" : [
        ]
      },
      {
        "id" : "1dc54bb8-4e14-4a4f-9ceb-53cfb6d6efba",
        "parentId" : "21323df0-a1d6-490a-82c5-527a1124dcf0",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "You are right, I missed this part.",
        "createdAt" : "2021-04-07T05:38:48Z",
        "updatedAt" : "2021-04-07T05:38:48Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "3e41b618b1d01e1e36db3fa3b324834718ce38e0",
    "line" : 46,
    "diffHunk" : "@@ -1,1 +94,98 @@   * T using the given name.\n   */\n  def build[T : ClassTag](name: String): (ExpressionInfo, Seq[Expression] => T) = {\n    val runtimeClass = scala.reflect.classTag[T].runtimeClass\n    // For `RuntimeReplaceable`, skip the constructor with most arguments, which is the main"
  }
]