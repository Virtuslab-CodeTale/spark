[
  {
    "id" : "d0e389f6-f58a-4036-b38d-1a1596f96bfa",
    "prId" : 31448,
    "prUrl" : "https://github.com/apache/spark/pull/31448#pullrequestreview-608288509",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "101e7e8f-dfbe-494a-8e3d-69fe82c02566",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "It's a bit weird to define a format pattern string only for parsing. Are we going to add the formatting function?",
        "createdAt" : "2021-03-09T12:43:54Z",
        "updatedAt" : "2021-03-09T12:43:54Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "bc8b2a9f-fb86-4848-b031-4f23d5c92741",
        "parentId" : "101e7e8f-dfbe-494a-8e3d-69fe82c02566",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "I got it.",
        "createdAt" : "2021-03-10T02:51:45Z",
        "updatedAt" : "2021-03-10T02:51:45Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "c4b2ce6e20f49a85a91da94c457eba184bb26826",
    "line" : 101,
    "diffHunk" : "@@ -1,1 +2510,2514 @@      'D':  decimal point (uses locale)\n      'G':  group separator (uses locale)\n      '$':  specifies that the input value has a leading $ (Dollar) sign.\n  \"\"\",\n  examples = \"\"\""
  },
  {
    "id" : "3c31998b-0636-4fef-b0db-99a56784cc29",
    "prId" : 30479,
    "prUrl" : "https://github.com/apache/spark/pull/30479#pullrequestreview-549816617",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "72eac6e7-af01-4b9d-9c9d-1ba47f943544",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "hm, IMHO it would be good to rename the existing `decode` func or assign a new name into the new `decode` func because the generated doc for `decode` will be complicated.",
        "createdAt" : "2020-12-09T07:12:16Z",
        "updatedAt" : "2020-12-09T09:13:00Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "467fc0f0-ea51-4d82-bd99-acae8818bd70",
        "parentId" : "72eac6e7-af01-4b9d-9c9d-1ba47f943544",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "If rename the `existing` decode func will break the behavior. ",
        "createdAt" : "2020-12-09T07:36:13Z",
        "updatedAt" : "2020-12-09T09:13:00Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      },
      {
        "id" : "94a51e9c-b862-4e47-ac4f-fcd5aa8a7095",
        "parentId" : "72eac6e7-af01-4b9d-9c9d-1ba47f943544",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Yea, so I think we need add a legacy config, update the migration guide, ... if we rename it. Anyway, the latter approach (assigning a new name into the new `decode` func) looks better if possible.",
        "createdAt" : "2020-12-09T07:48:32Z",
        "updatedAt" : "2020-12-09T09:13:00Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "d19ebdcd-5860-4062-a52b-b7768a52c2c3",
        "parentId" : "72eac6e7-af01-4b9d-9c9d-1ba47f943544",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "This PR could avoid migration and support the new `decode` as well. cc @cloud-fan ",
        "createdAt" : "2020-12-09T08:40:13Z",
        "updatedAt" : "2020-12-09T09:13:00Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      },
      {
        "id" : "fd258f76-c83a-4731-a343-a91e8a11cc0a",
        "parentId" : "72eac6e7-af01-4b9d-9c9d-1ba47f943544",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "We can probably rename the function in ansi mode.",
        "createdAt" : "2020-12-11T05:46:21Z",
        "updatedAt" : "2020-12-11T05:46:22Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "eea967a4aa4ad18760c5a65c275c1b3f68971f85",
    "line" : 18,
    "diffHunk" : "@@ -1,1 +2090,2094 @@        throw new AnalysisException(\"Invalid number of arguments for function decode. \" +\n          s\"Expected: 2; Found: ${params.length}\")\n      case 2 => StringDecode(params.head, params.last)\n      case _ =>\n        val input = params.head"
  },
  {
    "id" : "07479b20-4921-4afe-8c49-5aaf19b1ae1a",
    "prId" : 30479,
    "prUrl" : "https://github.com/apache/spark/pull/30479#pullrequestreview-547909412",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d20d288d-e075-457a-a87c-c8586ed01e84",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Could you follow the other format? e.g., https://github.com/apache/spark/blob/c88eddac3bf860d04bba91fc913f8b2069a94153/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/expressions/stringExpressions.scala#L479-L486",
        "createdAt" : "2020-12-09T07:16:22Z",
        "updatedAt" : "2020-12-09T09:13:00Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "969e1545-614f-44e4-8e8a-444022729e9d",
        "parentId" : "d20d288d-e075-457a-a87c-c8586ed01e84",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "The new `decode` function is the same as other function uses `RuntimeReplaceable`. The parameter list is not fixed.",
        "createdAt" : "2020-12-09T07:41:02Z",
        "updatedAt" : "2020-12-09T09:13:00Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "eea967a4aa4ad18760c5a65c275c1b3f68971f85",
    "line" : 47,
    "diffHunk" : "@@ -1,1 +2119,2123 @@            |  to each search value one by one. If expr is equal to a search, returns the corresponding result.\n            |  If no match is found, then Oracle returns default. If default is omitted, returns null.\n          \"\"\",\n  examples = \"\"\"\n    Examples:"
  },
  {
    "id" : "5ebcd09e-a278-4dc9-96b4-11d473dfbf13",
    "prId" : 30479,
    "prUrl" : "https://github.com/apache/spark/pull/30479#pullrequestreview-549823403",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "376e68fe-1e10-44f4-9815-96133bb66379",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "So this replaces the existing `decode` in SQL side only, right? shall we update migration guide?",
        "createdAt" : "2020-12-11T05:55:37Z",
        "updatedAt" : "2020-12-11T05:55:37Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "b3da8dfb-08c1-4497-96c3-ad6f6b9c70d0",
        "parentId" : "376e68fe-1e10-44f4-9815-96133bb66379",
        "authorId" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "body" : "The new `decode` could keep compatible with old one.",
        "createdAt" : "2020-12-11T06:06:52Z",
        "updatedAt" : "2020-12-11T06:07:01Z",
        "lastEditedBy" : "f26e51a2-ed90-47c7-9856-a6cc134b7f39",
        "tags" : [
        ]
      }
    ],
    "commit" : "eea967a4aa4ad18760c5a65c275c1b3f68971f85",
    "line" : 61,
    "diffHunk" : "@@ -1,1 +2133,2137 @@  since = \"3.2.0\")\n// scalastyle:on line.size.limit\ncase class Decode(params: Seq[Expression], child: Expression) extends RuntimeReplaceable {\n\n  def this(params: Seq[Expression]) = {"
  },
  {
    "id" : "38cf5ac5-526c-4ecd-bf0b-b49b274151cf",
    "prId" : 30479,
    "prUrl" : "https://github.com/apache/spark/pull/30479#pullrequestreview-549823447",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7002a47a-28ab-4556-9e80-220d0b34bcf0",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Do we have an alternative for the previous `decode` after this change?",
        "createdAt" : "2020-12-11T05:56:50Z",
        "updatedAt" : "2020-12-11T05:56:50Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "8700a284-a318-4c72-86b7-ca4e9d9d2c8b",
        "parentId" : "7002a47a-28ab-4556-9e80-220d0b34bcf0",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "This only renames the expression, not the function. This PR just adds an overload of the `decode` function when there are more than 3 parameters.",
        "createdAt" : "2020-12-11T06:00:45Z",
        "updatedAt" : "2020-12-11T06:00:46Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "a2edd5b6-6bab-40ce-b70c-a596026f77f9",
        "parentId" : "7002a47a-28ab-4556-9e80-220d0b34bcf0",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "I'd suggest the following followup:\r\n1. add a new function name for `StringDecode`. Probably \"string_decode\".\r\n2. require `decode` function to take more than 2 parameters, under ansi mode(or a legacy config)",
        "createdAt" : "2020-12-11T06:06:58Z",
        "updatedAt" : "2020-12-11T06:06:58Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "eea967a4aa4ad18760c5a65c275c1b3f68971f85",
    "line" : 79,
    "diffHunk" : "@@ -1,1 +2158,2162 @@  since = \"1.5.0\")\n// scalastyle:on line.size.limit\ncase class StringDecode(bin: Expression, charset: Expression)\n  extends BinaryExpression with ImplicitCastInputTypes with NullIntolerant {\n"
  },
  {
    "id" : "74bdaaef-3816-4881-b99f-4ad1219e5557",
    "prId" : 30399,
    "prUrl" : "https://github.com/apache/spark/pull/30399#pullrequestreview-532559298",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6fb45619-662c-4a56-a21d-4ebc20e24033",
        "parentId" : null,
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "To clarify, the raw exception message is something like `Illegal character in query at index 33: https://a.b.c/index.php?params1=a|b&params2=x`.",
        "createdAt" : "2020-11-17T16:34:08Z",
        "updatedAt" : "2020-11-20T02:42:53Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      }
    ],
    "commit" : "d7e437b326dc9564a9460946bdbc0856e6876322",
    "line" : 17,
    "diffHunk" : "@@ -1,1 +1407,1411 @@    } catch {\n      case e: URISyntaxException if failOnError =>\n        throw new IllegalArgumentException(s\"Find an invaild url string ${url.toString}\", e)\n      case _: URISyntaxException => null\n    }"
  },
  {
    "id" : "ef2eeeb3-b51e-4fb1-91bb-cb8759de7ebb",
    "prId" : 30297,
    "prUrl" : "https://github.com/apache/spark/pull/30297#pullrequestreview-526881857",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c315b3ad-c8ab-4997-83ef-d6cb55e0fcc1",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "The same: https://github.com/apache/spark/pull/30297/files#r520305929",
        "createdAt" : "2020-11-10T06:05:15Z",
        "updatedAt" : "2020-11-12T05:25:04Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "4b161a4ef4f3be2f1a239c0c19f8aa62b5a03706",
    "line" : 27,
    "diffHunk" : "@@ -1,1 +246,250 @@  since = \"2.0.0\")\n// scalastyle:on line.size.limit\ncase class Elt(\n    children: Seq[Expression],\n    failOnError: Boolean = SQLConf.get.ansiEnabled) extends Expression {"
  }
]