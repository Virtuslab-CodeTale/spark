[
  {
    "id" : "07a80a9e-b023-411c-a1f4-90ad69fd9384",
    "prId" : 32494,
    "prUrl" : "https://github.com/apache/spark/pull/32494#pullrequestreview-658545150",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a60e44dd-daf2-4fc0-850d-17914d2a879e",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "This fix seems fine, but is that the possible state where `distinctCount.isDefined` is false and `nullCount.isDefined` is true?",
        "createdAt" : "2021-05-13T01:21:04Z",
        "updatedAt" : "2021-05-13T01:34:56Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "9be51e03-43ef-46d3-9cf3-a137261adff0",
        "parentId" : "a60e44dd-daf2-4fc0-850d-17914d2a879e",
        "authorId" : "d0d56018-475d-4da3-93a6-5e843402b7f2",
        "body" : "Ideally this method doesn't require `distinctCount`. Union operator doesn't return `distinctCount`, but it can return `nullCount`. ",
        "createdAt" : "2021-05-13T02:54:49Z",
        "updatedAt" : "2021-05-13T02:54:49Z",
        "lastEditedBy" : "d0d56018-475d-4da3-93a6-5e843402b7f2",
        "tags" : [
        ]
      },
      {
        "id" : "08400848-d3cd-40c4-b33b-25be7473fbcd",
        "parentId" : "a60e44dd-daf2-4fc0-850d-17914d2a879e",
        "authorId" : "d0d56018-475d-4da3-93a6-5e843402b7f2",
        "body" : "Original commit which added this method was checking only first condition. After refactoring in this commit https://github.com/apache/spark/commit/8077bb04f350fd35df83ef896135c0672dc3f7b0 , the second condition also came. But logically the second condition need not check distinct as it is irrelevant in this method.",
        "createdAt" : "2021-05-13T03:02:19Z",
        "updatedAt" : "2021-05-13T03:02:20Z",
        "lastEditedBy" : "d0d56018-475d-4da3-93a6-5e843402b7f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "06fbbec02072e91cb859d5df90246dfa336a3d50",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +226,230 @@      isNull: Boolean,\n      update: Boolean): Option[Double] = {\n    if (!colStatsMap.contains(attr) || colStatsMap(attr).nullCount.isEmpty) {\n      logDebug(\"[CBO] No statistics for \" + attr)\n      return None"
  }
]