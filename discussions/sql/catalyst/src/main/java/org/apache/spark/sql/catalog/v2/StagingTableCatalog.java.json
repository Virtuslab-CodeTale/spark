[
  {
    "id" : "aa91a15e-d031-4c82-a10b-f2ca45c7d9ca",
    "prId" : 24798,
    "prUrl" : "https://github.com/apache/spark/pull/24798#pullrequestreview-250796990",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2c28c584-5a31-457f-8b79-6c4ef12e3b13",
        "parentId" : null,
        "authorId" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "body" : "Looks like this doc is unfinished.",
        "createdAt" : "2019-06-17T18:55:11Z",
        "updatedAt" : "2019-07-19T19:00:59Z",
        "lastEditedBy" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "tags" : [
        ]
      },
      {
        "id" : "db9e3639-06a8-483d-884a-2fa3b4eec3fa",
        "parentId" : "2c28c584-5a31-457f-8b79-6c4ef12e3b13",
        "authorId" : "806aa501-9ea7-4cec-b017-a84d9a1602d8",
        "body" : "It's not, the comment continues to the links in the following line.",
        "createdAt" : "2019-06-17T23:27:56Z",
        "updatedAt" : "2019-07-19T19:00:59Z",
        "lastEditedBy" : "806aa501-9ea7-4cec-b017-a84d9a1602d8",
        "tags" : [
        ]
      },
      {
        "id" : "b4562c00-6039-4f84-9dd0-f2ada2e396fc",
        "parentId" : "2c28c584-5a31-457f-8b79-6c4ef12e3b13",
        "authorId" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "body" : "Oops, I misread it. Thanks!",
        "createdAt" : "2019-06-17T23:37:27Z",
        "updatedAt" : "2019-07-19T19:00:59Z",
        "lastEditedBy" : "0fc9f1bc-0097-451e-915f-52da69a366f3",
        "tags" : [
        ]
      }
    ],
    "commit" : "05a827df7094b07a492add875c6e649df52db41f",
    "line" : 48,
    "diffHunk" : "@@ -1,1 +46,50 @@ * <p>\n * If the catalog implements this plugin, the catalog can implement the methods to \"stage\" the\n * creation and the replacement of a table. After the table's\n * {@link BatchWrite#commit(WriterCommitMessage[])} is called,\n * {@link StagedTable#commitStagedChanges()} is called, at which point the staged table can"
  },
  {
    "id" : "363d6c69-cc97-4182-a2ed-7745b144a284",
    "prId" : 24798,
    "prUrl" : "https://github.com/apache/spark/pull/24798#pullrequestreview-260927478",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2b1d5e87-5128-4e5b-8080-050f80e1bde9",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Can we move this API out to a new PR and implement atomic CTAS? I think REPLACE TABLE is not a blocker to this API and we don't have to do them together. This can also help us move forward faster, since designing a new SQL syntax (REPLACE TABLE) usually needs more time to get consensus.",
        "createdAt" : "2019-07-11T11:29:59Z",
        "updatedAt" : "2019-07-19T19:00:59Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "5d86ce1f-c622-4b9f-a7bd-90725847b594",
        "parentId" : "2b1d5e87-5128-4e5b-8080-050f80e1bde9",
        "authorId" : "806aa501-9ea7-4cec-b017-a84d9a1602d8",
        "body" : "I would think that `REPLACE TABLE` and `REPLACE TABLE AS SELECT` is about as simple as one can get for this kind of feature. Can we stick with that for now? I'd really like to see `REPLACE` get in soon, it's a blocker for some of my workflows.",
        "createdAt" : "2019-07-11T17:41:22Z",
        "updatedAt" : "2019-07-19T19:00:59Z",
        "lastEditedBy" : "806aa501-9ea7-4cec-b017-a84d9a1602d8",
        "tags" : [
        ]
      },
      {
        "id" : "ed58a138-4b54-4a1c-9b5d-6a1d5e045727",
        "parentId" : "2b1d5e87-5128-4e5b-8080-050f80e1bde9",
        "authorId" : "806aa501-9ea7-4cec-b017-a84d9a1602d8",
        "body" : "Also thinking about this a bit more, perhaps the reason why `REPLACE TABLE` isn't supported in other database systems as standard is because all those systems support transactional operations. So users typically open a transaction, run the table creation, and then commit the operation.\r\n\r\nSince we don't have support for specifically opening and closing transactions, we have to support this use case via an atomic `REPLACE` keyword.",
        "createdAt" : "2019-07-11T20:09:51Z",
        "updatedAt" : "2019-07-19T19:00:59Z",
        "lastEditedBy" : "806aa501-9ea7-4cec-b017-a84d9a1602d8",
        "tags" : [
        ]
      }
    ],
    "commit" : "05a827df7094b07a492add875c6e649df52db41f",
    "line" : 53,
    "diffHunk" : "@@ -1,1 +51,55 @@ * complete both the data write and the metadata swap operation atomically.\n */\npublic interface StagingTableCatalog extends TableCatalog {\n\n  /**"
  },
  {
    "id" : "85c38682-4546-4f53-804b-c3f5f1d8ece4",
    "prId" : 24798,
    "prUrl" : "https://github.com/apache/spark/pull/24798#pullrequestreview-264029002",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "34cc17ca-46d8-4c0b-baa6-445f5f9ebd10",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "I think the implementation should throw `TableNotFoundException` if the table to replace doesn't exist.",
        "createdAt" : "2019-07-19T06:14:30Z",
        "updatedAt" : "2019-07-19T19:00:59Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "05a827df7094b07a492add875c6e649df52db41f",
    "line" : 103,
    "diffHunk" : "@@ -1,1 +101,105 @@   * @return metadata for the new table\n   * @throws UnsupportedOperationException If a requested partition transform is not supported\n   * @throws NoSuchNamespaceException If the identifier namespace does not exist (optional)\n   * @throws NoSuchTableException If the table does not exist\n   */"
  }
]