[
  {
    "id" : "de72e0d0-9d41-4e56-95ea-659f5e8127c8",
    "prId" : 30706,
    "prUrl" : "https://github.com/apache/spark/pull/30706#pullrequestreview-728175369",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "81a66261-14b4-4940-ad62-783037e55ff6",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "We already have `org.apache.spark.sql.connector.read.partitioning.ClusteredDistribution`, shall we remove that and always use this new one? The new one is better as it's more flexible (using Expression rather than String).\r\n\r\nIt's better if we can avoid breaking existing APIs, but I can't figure out a good way. The old `ClusteredDistribution` is only used in a mixin trait and marked as `Evolving`. Seems OK to break it.  ",
        "createdAt" : "2020-12-15T05:35:48Z",
        "updatedAt" : "2020-12-15T05:35:48Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "900064ae-eff1-46f3-8564-d4fd3d7213d2",
        "parentId" : "81a66261-14b4-4940-ad62-783037e55ff6",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "cc @aokolnychyi ",
        "createdAt" : "2020-12-15T06:16:18Z",
        "updatedAt" : "2020-12-15T06:16:18Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "815a53ef-a53f-4b48-bb80-4184b62fa5f5",
        "parentId" : "81a66261-14b4-4940-ad62-783037e55ff6",
        "authorId" : "4a94765a-5775-4d88-b283-6ee68d76ecc7",
        "body" : "We have started this discussion in comments to the original PR a bit. Some background [here](https://github.com/apache/spark/pull/29066#issuecomment-735558685) and [here](https://github.com/apache/spark/pull/29066#issuecomment-736073015).\r\n\r\nOverall, there are two options: break the API now and use new interfaces instead of the old ones in other places or evolve these two separately for a while and replace the read side once we have a clear plan for bucketed joins.\r\n\r\nMy first idea was to break the API and migrate to the new interfaces like suggested by @cloud-fan as that seems inevitable at some point. However, there were a couple of good points mentioned by reviewers on the original PR and I am now inclined to evolve these separately for a while until we know what changes will be required to support bucketed tables. I would like to avoid breaking the read side twice if possible.\r\n\r\nThat said, I don't feel strongly here and each option has its own benefits and drawbacks. I'll be fine with either one.\r\n",
        "createdAt" : "2020-12-15T11:04:14Z",
        "updatedAt" : "2020-12-15T11:04:14Z",
        "lastEditedBy" : "4a94765a-5775-4d88-b283-6ee68d76ecc7",
        "tags" : [
        ]
      },
      {
        "id" : "97cfb850-87a3-4878-9e9f-20f6777a87d2",
        "parentId" : "81a66261-14b4-4940-ad62-783037e55ff6",
        "authorId" : "4a94765a-5775-4d88-b283-6ee68d76ecc7",
        "body" : "also cc @viirya @HeartSaVioR @rdblue @dongjoon-hyun @sunchao who reviewed the change",
        "createdAt" : "2020-12-15T11:05:58Z",
        "updatedAt" : "2020-12-15T11:05:58Z",
        "lastEditedBy" : "4a94765a-5775-4d88-b283-6ee68d76ecc7",
        "tags" : [
        ]
      },
      {
        "id" : "4beed981-c0d6-47b4-b456-49adae1f5444",
        "parentId" : "81a66261-14b4-4940-ad62-783037e55ff6",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "I'm OK to break it later, just don't leave the old one there forever. Shall we create a blocker ticket for Spark 3.2 to remove the old `ClusteredDistribution`? ",
        "createdAt" : "2020-12-15T14:04:08Z",
        "updatedAt" : "2020-12-15T14:04:08Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "baeecc38-7478-41fa-ae0e-e034b3210fd5",
        "parentId" : "81a66261-14b4-4940-ad62-783037e55ff6",
        "authorId" : "4a94765a-5775-4d88-b283-6ee68d76ecc7",
        "body" : "Sounds ok to me, @cloud-fan. Let's wait for others to comment.",
        "createdAt" : "2020-12-15T18:33:49Z",
        "updatedAt" : "2020-12-15T18:34:08Z",
        "lastEditedBy" : "4a94765a-5775-4d88-b283-6ee68d76ecc7",
        "tags" : [
        ]
      },
      {
        "id" : "596bbb94-d331-448b-8958-c5a6bbfa39f1",
        "parentId" : "81a66261-14b4-4940-ad62-783037e55ff6",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Yes, +1 for filing an JIRA issue to track that and move on for now. Thanks, @cloud-fan and @aokolnychyi .",
        "createdAt" : "2020-12-16T09:21:12Z",
        "updatedAt" : "2020-12-16T09:21:12Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "cb3547ab-94e8-46a3-8aab-9f031aa92267",
        "parentId" : "81a66261-14b4-4940-ad62-783037e55ff6",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "+1 for @dongjoon-hyun's too.",
        "createdAt" : "2020-12-16T09:44:18Z",
        "updatedAt" : "2020-12-16T09:44:18Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "914eda20-55bd-42c3-8bc3-c002486e38bf",
        "parentId" : "81a66261-14b4-4940-ad62-783037e55ff6",
        "authorId" : "4a94765a-5775-4d88-b283-6ee68d76ecc7",
        "body" : "I created a blocker SPARK-33807 to track this.\r\n\r\nThanks, everyone!",
        "createdAt" : "2020-12-16T10:34:44Z",
        "updatedAt" : "2020-12-16T10:34:45Z",
        "lastEditedBy" : "4a94765a-5775-4d88-b283-6ee68d76ecc7",
        "tags" : [
        ]
      },
      {
        "id" : "4372dc22-e321-42c2-ae2b-aeef0fde848a",
        "parentId" : "81a66261-14b4-4940-ad62-783037e55ff6",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Hi @aokolnychyi , do you have time to clean it up now?",
        "createdAt" : "2021-08-10T08:15:14Z",
        "updatedAt" : "2021-08-10T08:15:14Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "4a063d4c-295e-482b-a946-f0e065fd7f52",
        "parentId" : "81a66261-14b4-4940-ad62-783037e55ff6",
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "Since `Partitioning.satisfy` is still referring to the old interface I'm wondering whether we should defer this to 3.3.0 timeframe. For my storage partitioned join work I found that I need to change the `Partitioning` interface again in a backward incompatible way so that it can work for joins. It may be better to break it once instead of two times. That's my 2 cents.",
        "createdAt" : "2021-08-12T01:07:08Z",
        "updatedAt" : "2021-08-12T01:07:08Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      },
      {
        "id" : "9c2b478c-5313-4dba-98d7-039bdc9353fa",
        "parentId" : "81a66261-14b4-4940-ad62-783037e55ff6",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "OK, let's retarget it to 3.3",
        "createdAt" : "2021-08-12T04:47:18Z",
        "updatedAt" : "2021-08-12T04:47:18Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "cc19fd614d9df81d425c95ec81e4c6f34cac2a08",
    "line" : 30,
    "diffHunk" : "@@ -1,1 +28,32 @@ */\n@Experimental\npublic interface ClusteredDistribution extends Distribution {\n  /**\n   * Returns clustering expressions."
  }
]