[
  {
    "id" : "f7d668b9-d1aa-413a-9d35-ffbf0210ad71",
    "prId" : 29319,
    "prUrl" : "https://github.com/apache/spark/pull/29319#pullrequestreview-481607261",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "dd151fa7-e1f0-4cc9-baab-71d2b74e0da1",
        "parentId" : null,
        "authorId" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "body" : "I am doing this too.   this pr (such as INSERT OVERWRITE DIRECTION part ) can avoid our user write wrong  dir path that have data (such as DB's path, happened before).\r\nMove data to trash can make recovery of production data faster in the event of such a disaster.\r\nFYI @maropu ",
        "createdAt" : "2020-09-03T08:22:12Z",
        "updatedAt" : "2020-09-03T08:22:17Z",
        "lastEditedBy" : "594db420-88ec-4875-8cd3-0d8b0bec131c",
        "tags" : [
        ]
      }
    ],
    "commit" : "6be846b8e6ec61c0b496d688de18db4a2a787f9a",
    "line" : 17,
    "diffHunk" : "@@ -1,1 +114,118 @@          if (Option(existFile.getPath) != createdTempDir) {\n            Utils.moveToTrashOrDelete(fs, existFile.getPath, isTrashEnabled, hadoopConf)\n          }\n        }\n      }"
  },
  {
    "id" : "ab1a3e6a-4ceb-4ab8-a4ba-6bc1ef409471",
    "prId" : 28232,
    "prUrl" : "https://github.com/apache/spark/pull/28232#pullrequestreview-395414530",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "1e2f0eba-778e-41f4-b2d0-9fd54595e65d",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "What's the current behaivour when overwrite=false?",
        "createdAt" : "2020-04-16T23:49:21Z",
        "updatedAt" : "2020-04-18T02:12:31Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "48e1b2c9-89b8-42be-9ba5-f2ca07000d10",
        "parentId" : "1e2f0eba-778e-41f4-b2d0-9fd54595e65d",
        "authorId" : "3559d546-ec12-4270-82d2-15e7fff01a75",
        "body" : "There is currently only insert overwrite directory syntax, overwrite must be true now, the code retains this parameter, I feel that the designer for future expansion.",
        "createdAt" : "2020-04-17T08:58:48Z",
        "updatedAt" : "2020-04-18T02:12:31Z",
        "lastEditedBy" : "3559d546-ec12-4270-82d2-15e7fff01a75",
        "tags" : [
        ]
      },
      {
        "id" : "d4694b49-a053-431b-b739-1b9a7589da7d",
        "parentId" : "1e2f0eba-778e-41f4-b2d0-9fd54595e65d",
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Ah, I see. Even so, we need tests for this path.",
        "createdAt" : "2020-04-17T12:36:15Z",
        "updatedAt" : "2020-04-18T02:12:31Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      }
    ],
    "commit" : "690370b446c4e2fc82bbcaa92cbb9fff60fbc442",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +99,103 @@        fs.delete(writeToPath, true)\n      } else {\n        throw new SparkException(s\"Failed inserting overwrite directory, \" +\n          s\"the path ${writeToPath.toString} is a file and overwrite is false\")\n      }"
  },
  {
    "id" : "7ae36bd9-910c-4bc7-a3ac-5366cd8d3cc0",
    "prId" : 28232,
    "prUrl" : "https://github.com/apache/spark/pull/28232#pullrequestreview-395431744",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5b694d0b-f671-402a-9aab-46db7a83c1e9",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "Plz leave some comments about why we need to check if the path is file or not.",
        "createdAt" : "2020-04-17T12:35:35Z",
        "updatedAt" : "2020-04-18T02:12:31Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "201dae86-a002-4b8b-8d5b-d9d62eeda340",
        "parentId" : "5b694d0b-f671-402a-9aab-46db7a83c1e9",
        "authorId" : "3559d546-ec12-4270-82d2-15e7fff01a75",
        "body" : "ok",
        "createdAt" : "2020-04-17T13:01:12Z",
        "updatedAt" : "2020-04-18T02:12:31Z",
        "lastEditedBy" : "3559d546-ec12-4270-82d2-15e7fff01a75",
        "tags" : [
        ]
      }
    ],
    "commit" : "690370b446c4e2fc82bbcaa92cbb9fff60fbc442",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +91,95 @@        (qualifiedPath, dfs)\n      }\n\n    // SPARK-31459: If the target path already exists as a file,\n    // the last rename operation will cause only one result file to be moved,"
  },
  {
    "id" : "adcbbfa1-bd22-424d-95d1-c73c38950b0b",
    "prId" : 28232,
    "prUrl" : "https://github.com/apache/spark/pull/28232#pullrequestreview-395878364",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9b9187cf-ca90-416b-a2a8-a0a94afa54ba",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "`fs.delete` can fail if Apache Spark don't have enough privileges.",
        "createdAt" : "2020-04-18T03:49:55Z",
        "updatedAt" : "2020-04-18T03:49:55Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "690370b446c4e2fc82bbcaa92cbb9fff60fbc442",
    "line" : 10,
    "diffHunk" : "@@ -1,1 +97,101 @@    if (fs.isFile(writeToPath)) {\n      if (overwrite) {\n        fs.delete(writeToPath, true)\n      } else {\n        throw new SparkException(s\"Failed inserting overwrite directory, \" +"
  },
  {
    "id" : "2e5f7a16-735f-4387-a8c0-1806d7cfeb07",
    "prId" : 28232,
    "prUrl" : "https://github.com/apache/spark/pull/28232#pullrequestreview-395887934",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c40d6b9d-d2b6-46e4-948a-a67dfe48d3a6",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "You might delete the target file too early. If the path to be written is a directory, its files/sub-directories are untouched when `saveAsHiveFile` fails. But if it is a file, you delete it before actually saving the query output.  ",
        "createdAt" : "2020-04-18T06:57:54Z",
        "updatedAt" : "2020-04-18T06:58:28Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "690370b446c4e2fc82bbcaa92cbb9fff60fbc442",
    "line" : 10,
    "diffHunk" : "@@ -1,1 +97,101 @@    if (fs.isFile(writeToPath)) {\n      if (overwrite) {\n        fs.delete(writeToPath, true)\n      } else {\n        throw new SparkException(s\"Failed inserting overwrite directory, \" +"
  }
]