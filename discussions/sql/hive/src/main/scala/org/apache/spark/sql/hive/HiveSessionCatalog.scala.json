[
  {
    "id" : "efe14ef5-16ef-487e-b78b-b3fc321dde8c",
    "prId" : 30665,
    "prUrl" : "https://github.com/apache/spark/pull/30665#pullrequestreview-548185011",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8f75a395-52c4-4405-8c40-6b41b333f193",
        "parentId" : null,
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "How about?\r\n```scala\r\nval funcWrapper = new HiveFunctionWrapper(clazz.getName)\r\ntry {\r\n  udfExpr = Some(HiveGenericUDTF(name, funcWrapper, input, true))\r\n  // Force it to check data types.\r\n  udfExpr.get.asInstanceOf[HiveGenericUDTF].elementSchema\r\n} catch {\r\n  case e: IllegalStateException if e.getMessage.equals(\"Should not be called directly\") =>\r\n    logInfo(\"Fallback to use the non deprecated UDTF constructor.\")\r\n    udfExpr = Some(HiveGenericUDTF(name, funcWrapper, input, false))\r\n    // Force it to check data types.\r\n    udfExpr.get.asInstanceOf[HiveGenericUDTF].elementSchema\r\n}\r\n```",
        "createdAt" : "2020-12-09T13:33:20Z",
        "updatedAt" : "2020-12-09T13:33:21Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      }
    ],
    "commit" : "0e3dca1ea3228747a43d573075bc6162cc76d475",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +102,106 @@                udfExpr = Some(HiveGenericUDTF(name, new HiveFunctionWrapper(clazz.getName),\n                  input, false))\n                udfExpr.get.asInstanceOf[HiveGenericUDTF].elementSchema\n            }\n          }"
  },
  {
    "id" : "46f09430-c2f1-4cc7-9abd-17485eed7006",
    "prId" : 30665,
    "prUrl" : "https://github.com/apache/spark/pull/30665#pullrequestreview-560175874",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "96fb8db9-c7d2-4d03-9c62-ea96521ac1ba",
        "parentId" : null,
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "why do we need this fallback mechanism? can we just switch to the new API without the `deprecated` flag?",
        "createdAt" : "2020-12-30T19:32:55Z",
        "updatedAt" : "2020-12-30T19:33:21Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      }
    ],
    "commit" : "0e3dca1ea3228747a43d573075bc6162cc76d475",
    "line" : 11,
    "diffHunk" : "@@ -1,1 +97,101 @@              udfExpr.get.asInstanceOf[HiveGenericUDTF].elementSchema\n            } catch {\n              case exception: Exception =>\n                logInfo(s\"HiveGenericUDTF initialize(ObjectInspector[] args) is deprecated, and\" +\n                  s\" we will suit the latest version of initialize(StructObjectInspector argOIs).\")"
  }
]