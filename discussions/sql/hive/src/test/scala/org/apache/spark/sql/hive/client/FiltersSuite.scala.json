[
  {
    "id" : "52c95166-6cc0-48c4-a1e5-b497e776ed74",
    "prId" : 31646,
    "prUrl" : "https://github.com/apache/spark/pull/31646#pullrequestreview-608332435",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "938bb381-0f5c-4ec4-bfc9-fb414d84e60a",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "do we have a test to cover the bug I pointed out before?",
        "createdAt" : "2021-03-10T04:40:42Z",
        "updatedAt" : "2021-03-11T09:21:56Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "6245a98b-30b3-48ee-b69a-a1d17b20da7d",
        "parentId" : "938bb381-0f5c-4ec4-bfc9-fb414d84e60a",
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "The expected result is wrong in null test case before so it passed. Has added new test case for both with null or not.  e.g. `not-in string filter with null`.",
        "createdAt" : "2021-03-10T05:02:21Z",
        "updatedAt" : "2021-03-11T09:21:56Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      }
    ],
    "commit" : "17aea47f717827f42a12fccc7e5901403f69b323",
    "line" : 44,
    "diffHunk" : "@@ -1,1 +149,153 @@        Literal(null).eval())))) :: Nil,\n    \"\")\n\n  // Applying the predicate `x IN (NULL)` should return an empty set, but since this optimization\n  // will be applied by Catalyst, this filter converter does not need to account for this."
  },
  {
    "id" : "cac3c8fe-46e3-41b2-857f-6613bfdc7776",
    "prId" : 31646,
    "prUrl" : "https://github.com/apache/spark/pull/31646#pullrequestreview-609326595",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "02121b68-62d8-4bc4-afb7-cf1e253c5040",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "`not-in, date filter` is missed.",
        "createdAt" : "2021-03-10T12:27:54Z",
        "updatedAt" : "2021-03-11T09:21:56Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "66239551-2aae-4be8-bff6-82c4ac22d462",
        "parentId" : "02121b68-62d8-4bc4-afb7-cf1e253c5040",
        "authorId" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "body" : "Added here.",
        "createdAt" : "2021-03-11T01:41:43Z",
        "updatedAt" : "2021-03-11T09:21:56Z",
        "lastEditedBy" : "baca2fab-b749-483f-8c77-c4db14eca9d9",
        "tags" : [
        ]
      }
    ],
    "commit" : "17aea47f717827f42a12fccc7e5901403f69b323",
    "line" : 32,
    "diffHunk" : "@@ -1,1 +137,141 @@    \"\")\n\n  filterTest(\"not-inset, date filter\",\n    (Not(InSet(a(\"datecol\", DateType),\n      Set(Literal(Date.valueOf(\"2020-01-01\")).eval(),"
  },
  {
    "id" : "d18b106c-3638-4c02-92be-a84e85fb9488",
    "prId" : 30535,
    "prUrl" : "https://github.com/apache/spark/pull/30535#pullrequestreview-542579136",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2edada7a-9a37-4f9f-b637-e1b4de09eec8",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "is it really safe? Seems it assumes hive will also cast the string col to date and compare with the date literal.",
        "createdAt" : "2020-12-02T08:05:14Z",
        "updatedAt" : "2020-12-02T08:05:14Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "1e715205ef785e5b362ef003f191371603343016",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +111,115 @@  filterTest(\"string filter with date type\",\n    (a(\"strcol\", StringType).cast(DateType) > Literal(Date.valueOf(\"2019-01-01\"))) :: Nil,\n    \"strcol > 2019-01-01\")\n\n  filterTest(\"string filter with date type with In predicate\","
  },
  {
    "id" : "bb7fc59c-6096-410c-ad2c-1c07dc65be0d",
    "prId" : 30535,
    "prUrl" : "https://github.com/apache/spark/pull/30535#pullrequestreview-542579150",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5c08071d-7530-497f-b46c-6c7302029051",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "is it really safe? Seems it assumes hive will also cast the string col to date and compare with the date literal.",
        "createdAt" : "2020-12-02T08:05:15Z",
        "updatedAt" : "2020-12-02T08:05:15Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "1e715205ef785e5b362ef003f191371603343016",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +111,115 @@  filterTest(\"string filter with date type\",\n    (a(\"strcol\", StringType).cast(DateType) > Literal(Date.valueOf(\"2019-01-01\"))) :: Nil,\n    \"strcol > 2019-01-01\")\n\n  filterTest(\"string filter with date type with In predicate\","
  },
  {
    "id" : "2506bf11-bb3c-4a7a-aaa0-f5ca4b01da1d",
    "prId" : 30408,
    "prUrl" : "https://github.com/apache/spark/pull/30408#pullrequestreview-533505113",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "dd94df05-7934-4e46-86c6-506d8ee2509e",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "do we run these test with different hive versions?",
        "createdAt" : "2020-11-18T13:51:42Z",
        "updatedAt" : "2020-11-25T05:17:09Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "d85e3806-c818-4deb-95c7-3f6623c84483",
        "parentId" : "dd94df05-7934-4e46-86c6-506d8ee2509e",
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "Different hive versions tested by `HivePartitionFilteringSuite`:\r\nhttps://github.com/apache/spark/blob/ba2f5531601ff169ff0f9fab9bb60627f65082bf/sql/hive/src/test/scala/org/apache/spark/sql/hive/client/HivePartitionFilteringSuite.scala#L290-L343",
        "createdAt" : "2020-11-18T14:33:12Z",
        "updatedAt" : "2020-11-25T05:17:09Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      }
    ],
    "commit" : "29c489ad5f753aaa3551489655073c9f6fc7b0c6",
    "line" : 20,
    "diffHunk" : "@@ -1,1 +66,70 @@    \"1 = intcol and \\\"a\\\" = strcol\")\n\n  filterTest(\"date filter\",\n    (a(\"datecol\", DateType) === Literal(Date.valueOf(\"2019-01-01\"))) :: Nil,\n    \"datecol = 2019-01-01\")"
  },
  {
    "id" : "cdd01e8d-1d33-425b-843a-de39ea4a1446",
    "prId" : 30408,
    "prUrl" : "https://github.com/apache/spark/pull/30408#pullrequestreview-536564484",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "76d83c27-26f4-4840-a531-5e13dff150e8",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "not related to this PR, but we can pushdown `col is null` predicate to hive for this case.",
        "createdAt" : "2020-11-23T15:10:42Z",
        "updatedAt" : "2020-11-25T05:17:09Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "29c489ad5f753aaa3551489655073c9f6fc7b0c6",
    "line" : 35,
    "diffHunk" : "@@ -1,1 +81,85 @@\n  filterTest(\"date filter with null\",\n    (a(\"datecol\", DateType) ===  Literal(null)) :: Nil,\n    \"\")\n"
  },
  {
    "id" : "fa1d20e9-af15-4236-b24f-2b13170e1f69",
    "prId" : 30408,
    "prUrl" : "https://github.com/apache/spark/pull/30408#pullrequestreview-538154088",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9d7aaf98-3b8a-4be1-bd20-0037c4b6adcf",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "nit. This seems to be irrelevant to this PR, but it's good to have this.",
        "createdAt" : "2020-11-25T04:47:05Z",
        "updatedAt" : "2020-11-25T05:17:09Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "29c489ad5f753aaa3551489655073c9f6fc7b0c6",
    "line" : 40,
    "diffHunk" : "@@ -1,1 +86,90 @@  filterTest(\"string filter with InSet predicate\",\n    InSet(a(\"strcol\", StringType), Set(\"1\", \"2\").map(s => UTF8String.fromString(s))) :: Nil,\n    \"(strcol = \\\"1\\\" or strcol = \\\"2\\\")\")\n\n  filterTest(\"skip varchar\","
  },
  {
    "id" : "01112775-394a-4847-96b3-e8386ba443cf",
    "prId" : 30408,
    "prUrl" : "https://github.com/apache/spark/pull/30408#pullrequestreview-538162060",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2fec0d25-6fd1-4020-bf03-cd3fd3d57f46",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Oh, is this not `datecol >= 1970-01-01 and ...`?",
        "createdAt" : "2020-11-25T04:49:37Z",
        "updatedAt" : "2020-11-25T05:17:09Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "05c6c19a-e26d-479c-82a3-75c8c93e6fba",
        "parentId" : "2fec0d25-6fd1-4020-bf03-cd3fd3d57f46",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Never mind. I found the reason.",
        "createdAt" : "2020-11-25T05:06:10Z",
        "updatedAt" : "2020-11-25T05:17:09Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "49c2973f-4909-47ec-b2e2-672ca6dc097a",
        "parentId" : "2fec0d25-6fd1-4020-bf03-cd3fd3d57f46",
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "```scala\r\nscala> import org.apache.spark.sql.types._\r\nimport org.apache.spark.sql.types._\r\n\r\nscala> import org.apache.spark.sql.catalyst.expressions._\r\nimport org.apache.spark.sql.catalyst.expressions._\r\n\r\nscala> Range(1, 20).map(d => Cast(Literal(d, DateType), StringType, Some(\"America/Los_Angeles\"))).map(_.eval(EmptyRow))\r\nres13: scala.collection.immutable.IndexedSeq[Any] = Vector(1970-01-02, 1970-01-03, 1970-01-04, 1970-01-05, 1970-01-06, 1970-01-07, 1970-01-08, 1970-01-09, 1970-01-10, 1970-01-11, 1970-01-12, 1970-01-13, 1970-01-14, 1970-01-15, 1970-01-16, 1970-01-17, 1970-01-18, 1970-01-19, 1970-01-20)\r\n```",
        "createdAt" : "2020-11-25T05:12:51Z",
        "updatedAt" : "2020-11-25T05:17:09Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      }
    ],
    "commit" : "29c489ad5f753aaa3551489655073c9f6fc7b0c6",
    "line" : 80,
    "diffHunk" : "@@ -1,1 +168,172 @@        InSet(a(\"datecol\", DateType),\n          Range(1, 20).map(d => Literal(d, DateType).eval(EmptyRow)).toSet),\n        \"(datecol >= 1970-01-02 and datecol <= 1970-01-20)\")\n    }\n  }"
  }
]