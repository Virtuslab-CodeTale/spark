[
  {
    "id" : "471512d5-118d-4fa0-b808-86c89e3a47a1",
    "prId" : 31092,
    "prUrl" : "https://github.com/apache/spark/pull/31092#pullrequestreview-564210944",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8620fbd4-58e5-4805-a85e-a3a09112d86c",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "The number is the same because `ALTER TABLE .. ADD PARTITION` doesn't refresh the cache. I am going to address this issue soon.",
        "createdAt" : "2021-01-08T12:05:10Z",
        "updatedAt" : "2021-01-08T12:05:10Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "e0bd8173df013608dfe558949b6ec2900eeea321",
    "line" : 18,
    "diffHunk" : "@@ -1,1 +37,41 @@      }\n      sql(s\"CACHE TABLE $t\")\n      checkHiveClientCalls(expected = 14) {\n        sql(s\"ALTER TABLE $t ADD PARTITION (part=2)\")\n      }"
  },
  {
    "id" : "7813424a-e123-464d-aab3-98ba677ca3eb",
    "prId" : 30685,
    "prUrl" : "https://github.com/apache/spark/pull/30685#pullrequestreview-549481105",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "bcb1aaeb-ae7c-424b-a734-8055a4605d11",
        "parentId" : null,
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Here is one more difference: Hive's exception is not handled, and propagated to the upper layer. Comparing to V1 (in-memory) and V2, where `PartitionsAlreadyExistException` is thrown.",
        "createdAt" : "2020-12-09T12:23:02Z",
        "updatedAt" : "2020-12-09T21:30:23Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "7abbc123-1800-4cf7-8ea4-75a927e1fb16",
        "parentId" : "bcb1aaeb-ae7c-424b-a734-8055a4605d11",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "We should try-catch the hive exception and throw `PartitionsAlreadyExistException`",
        "createdAt" : "2020-12-09T17:24:35Z",
        "updatedAt" : "2020-12-09T21:30:23Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "cc73083f-1fa8-454f-90a2-da3e52a8a2fa",
        "parentId" : "bcb1aaeb-ae7c-424b-a734-8055a4605d11",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Sure, I will open JIRA for that, and fix separately since this PR is about test changes. ",
        "createdAt" : "2020-12-09T17:26:10Z",
        "updatedAt" : "2020-12-09T21:30:23Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "7a4567fa-d771-4f36-8ac9-b059bbcdaa06",
        "parentId" : "bcb1aaeb-ae7c-424b-a734-8055a4605d11",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Here is the fix https://github.com/apache/spark/pull/30711",
        "createdAt" : "2020-12-10T18:22:16Z",
        "updatedAt" : "2020-12-10T18:22:16Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "50c59aa821bddc447695d87e2485db3fdd2d67c0",
    "line" : 35,
    "diffHunk" : "@@ -1,1 +33,37 @@      sql(s\"ALTER TABLE $t ADD PARTITION (id=2) LOCATION 'loc1'\")\n\n      val errMsg = intercept[AnalysisException] {\n        sql(s\"ALTER TABLE $t ADD PARTITION (id=1) LOCATION 'loc'\" +\n          \" PARTITION (id=2) LOCATION 'loc1'\")"
  }
]