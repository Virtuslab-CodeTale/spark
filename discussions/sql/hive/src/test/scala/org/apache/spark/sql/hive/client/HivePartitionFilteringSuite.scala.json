[
  {
    "id" : "17bbb679-175b-4da7-b23d-af9d56c5848b",
    "prId" : 31646,
    "prUrl" : "https://github.com/apache/spark/pull/31646#pullrequestreview-609515956",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "51ca3f64-6077-4b88-b870-69e88bfea9e2",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "yea, this test can detect the correctness bug about null handling.",
        "createdAt" : "2021-03-11T08:49:27Z",
        "updatedAt" : "2021-03-11T09:21:56Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "17aea47f717827f42a12fccc7e5901403f69b323",
    "line" : 22,
    "diffHunk" : "@@ -1,1 +437,441 @@    check(\n      Not(In(attr(\"chunk\"), Seq(Literal(\"aa\"), Literal(\"ab\"), Literal(null)))),\n      chunkValue\n    )\n"
  },
  {
    "id" : "391447d6-05b9-42a2-a082-bee09ab28447",
    "prId" : 31109,
    "prUrl" : "https://github.com/apache/spark/pull/31109#pullrequestreview-564923682",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "89d2dde6-fbbc-45b3-892b-e30529366f11",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "@wangyum, why os `2019-01-01` returned here whereas we're using `=!= 2019-01-01`?",
        "createdAt" : "2021-01-11T01:03:54Z",
        "updatedAt" : "2021-01-11T01:03:55Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "7b740c1e-9045-457d-9a19-bfc8591ad457",
        "parentId" : "89d2dde6-fbbc-45b3-892b-e30529366f11",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Does it return all when null comparison is included?",
        "createdAt" : "2021-01-11T01:05:08Z",
        "updatedAt" : "2021-01-11T01:05:14Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "fceb0597-fe1e-4b2c-9607-8e1222546fbb",
        "parentId" : "89d2dde6-fbbc-45b3-892b-e30529366f11",
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "yes.",
        "createdAt" : "2021-01-11T01:21:02Z",
        "updatedAt" : "2021-01-11T01:21:02Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      },
      {
        "id" : "922ee269-1be2-41b2-b965-675ad7b4e12c",
        "parentId" : "89d2dde6-fbbc-45b3-892b-e30529366f11",
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "Because it is ||, not &&.",
        "createdAt" : "2021-01-11T01:22:10Z",
        "updatedAt" : "2021-01-11T01:22:10Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      }
    ],
    "commit" : "56cb9fb32d995c56ce7794afaa3785c686f9387b",
    "line" : 68,
    "diffHunk" : "@@ -1,1 +470,474 @@      hValue,\n      chunkValue,\n      dateValue,\n      dateStrValue)\n  }"
  },
  {
    "id" : "30dc4e81-1e87-4065-a5f0-15114b4aedab",
    "prId" : 31109,
    "prUrl" : "https://github.com/apache/spark/pull/31109#pullrequestreview-565637090",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "54f4de0d-1b43-4ede-9c8b-d885be38b851",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "If you don't mind, can we use string comparison instead? Something like, `version >= \"2.0.0\"`?",
        "createdAt" : "2021-01-11T18:41:24Z",
        "updatedAt" : "2021-01-11T18:41:24Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "56cb9fb32d995c56ce7794afaa3785c686f9387b",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +42,46 @@\n  // Support default partition in metastoredirectsql since HIVE-11898(Hive 2.0.0).\n  private val defaultPartition = if (version.toDouble >= 2) Some(DEFAULT_PARTITION_NAME) else None\n\n  private val dsValue = 20170101 to 20170103"
  },
  {
    "id" : "ed1ac1d4-19c5-47df-be67-bcc16c3d9a1f",
    "prId" : 30534,
    "prUrl" : "https://github.com/apache/spark/pull/30534#pullrequestreview-560669744",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6559bb76-def5-4e57-b908-696bc16cd5e5",
        "parentId" : null,
        "authorId" : "d19fc546-1296-40ce-befb-9eca847aeceb",
        "body" : "Could you add null and empty string as partition values into your test cases? It should include both data values and predicate values. ",
        "createdAt" : "2021-01-03T05:10:19Z",
        "updatedAt" : "2021-01-03T05:10:19Z",
        "lastEditedBy" : "d19fc546-1296-40ce-befb-9eca847aeceb",
        "tags" : [
        ]
      },
      {
        "id" : "94e18865-61ca-4b09-b0e9-e25cfc60ddec",
        "parentId" : "6559bb76-def5-4e57-b908-696bc16cd5e5",
        "authorId" : "d19fc546-1296-40ce-befb-9eca847aeceb",
        "body" : "For your reference, https://github.com/apache/spark/pull/30893 is the related PR",
        "createdAt" : "2021-01-03T05:11:11Z",
        "updatedAt" : "2021-01-03T05:11:11Z",
        "lastEditedBy" : "d19fc546-1296-40ce-befb-9eca847aeceb",
        "tags" : [
        ]
      }
    ],
    "commit" : "22e149d43729bb6efcc15391dba2ac1c9b9f223e",
    "line" : 6,
    "diffHunk" : "@@ -1,1 +355,359 @@  test(\"getPartitionsByFilter: ds<>20170101\") {\n    testMetastorePartitionFiltering(\n      attr(\"ds\") =!= 20170101,\n      20170102 to 20170103,\n      hValue,"
  },
  {
    "id" : "71b1ef00-2fb5-4d01-bd29-7f5f8622e7d9",
    "prId" : 30408,
    "prUrl" : "https://github.com/apache/spark/pull/30408#pullrequestreview-560666355",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "463bf407-450f-4936-b682-5f7612524fed",
        "parentId" : null,
        "authorId" : "d19fc546-1296-40ce-befb-9eca847aeceb",
        "body" : "How about NULL?",
        "createdAt" : "2021-01-03T03:04:28Z",
        "updatedAt" : "2021-01-03T03:04:28Z",
        "lastEditedBy" : "d19fc546-1296-40ce-befb-9eca847aeceb",
        "tags" : [
        ]
      }
    ],
    "commit" : "29c489ad5f753aaa3551489655073c9f6fc7b0c6",
    "line" : 84,
    "diffHunk" : "@@ -1,1 +306,310 @@    val partitions =\n      for {\n        date <- Seq(\"2019-01-01\", \"2019-01-02\", \"2019-01-03\", \"2019-01-04\")\n      } yield CatalogTablePartition(Map(\n        \"part\" -> date"
  },
  {
    "id" : "9f60bdd7-914a-413b-a03c-3d6dba260f22",
    "prId" : 30380,
    "prUrl" : "https://github.com/apache/spark/pull/30380#pullrequestreview-530869985",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "cd6eb34f-e922-4b6b-b74c-1595debd12a7",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "What happens for `20170102.1234`?",
        "createdAt" : "2020-11-15T19:15:52Z",
        "updatedAt" : "2020-11-16T14:25:57Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "9d863a28-e146-474d-b4b9-4b5c2403bb7f",
        "parentId" : "cd6eb34f-e922-4b6b-b74c-1595debd12a7",
        "authorId" : "813f0961-9a16-4e42-a167-961d914c472c",
        "body" : "It is the same because we didn't pruning it:\r\n```diff\r\ndiff --git a/sql/hive/src/test/scala/org/apache/spark/sql/hive/client/HivePartitionFilteringSuite.scala b/sql/hive/src/test/scala/org/apache/spark/sql/hive/client/HivePartitionFilteringSuite.scala\r\nindex 7e10d49..6b976d9 100644\r\n--- a/sql/hive/src/test/scala/org/apache/spark/sql/hive/client/HivePartitionFilteringSuite.scala\r\n+++ b/sql/hive/src/test/scala/org/apache/spark/sql/hive/client/HivePartitionFilteringSuite.scala\r\n@@ -28,7 +28,7 @@ import org.apache.spark.sql.catalyst.TableIdentifier\r\n import org.apache.spark.sql.catalyst.catalog._\r\n import org.apache.spark.sql.catalyst.dsl.expressions._\r\n import org.apache.spark.sql.catalyst.expressions._\r\n-import org.apache.spark.sql.types.{BooleanType, IntegerType, LongType, StructType}\r\n+import org.apache.spark.sql.types.{BooleanType, IntegerType, LongType, StringType, StructType}\r\n import org.apache.spark.util.Utils\r\n\r\n class HivePartitionFilteringSuite(version: String)\r\n@@ -272,6 +272,15 @@ class HivePartitionFilteringSuite(version: String)\r\n       day1 :: day2 :: Nil)\r\n   }\r\n\r\n+\r\n+  test(\"getPartitionsByFilter: chunk in ('ab', 'ba') and \" +\r\n+    \"((cast(ds as string)='20170101') or (cast(ds as string)='20170102'))\") {\r\n+    val day = (20170101 to 20170103, 0 to 4, Seq(\"ab\", \"ba\"))\r\n+    testMetastorePartitionFiltering(attr(\"chunk\").in(\"ab\", \"ba\") &&\r\n+      (attr(\"ds\").cast(StringType) > \"20170102.1234\"),\r\n+      day :: Nil)\r\n+  }\r\n+\r\n```",
        "createdAt" : "2020-11-16T01:46:41Z",
        "updatedAt" : "2020-11-16T14:25:57Z",
        "lastEditedBy" : "813f0961-9a16-4e42-a167-961d914c472c",
        "tags" : [
        ]
      }
    ],
    "commit" : "9e796abe3a3e412e3f6ea775d48af13dd6d28852",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +294,298 @@    val day = (20170101 to 20170103, 0 to 4, Seq(\"ab\", \"ba\"))\n    testMetastorePartitionFiltering(\n      attr(\"chunk\").in(\"ab\", \"ba\") && (attr(\"ds\").cast(StringType) > \"20170102\"),\n      day :: Nil)\n  }"
  }
]