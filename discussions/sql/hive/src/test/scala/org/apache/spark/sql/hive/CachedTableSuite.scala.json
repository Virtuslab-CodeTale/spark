[
  {
    "id" : "3b3e4f2d-04b8-445e-bb94-ad76b6777f47",
    "prId" : 31308,
    "prUrl" : "https://github.com/apache/spark/pull/31308#pullrequestreview-579760213",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "fc9d12a9-4388-44f4-806f-ace1ca66ac4a",
        "parentId" : null,
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "can we move this to  `org.apache.spark.sql.CachedTableSuite`? the truncate table command is not limited to Hive.",
        "createdAt" : "2021-01-26T10:23:12Z",
        "updatedAt" : "2021-01-26T10:23:20Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      },
      {
        "id" : "5f5cb192-fb05-4d25-830d-81a765d49f1e",
        "parentId" : "fc9d12a9-4388-44f4-806f-ace1ca66ac4a",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Do you mean copy-paste the test there?",
        "createdAt" : "2021-01-26T10:34:52Z",
        "updatedAt" : "2021-01-26T10:34:53Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "d88f25b8-d7a0-40e5-843c-3698fe97ba3a",
        "parentId" : "fc9d12a9-4388-44f4-806f-ace1ca66ac4a",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "BTW, I am going to write unified tests for `TRUNCATE TABLE` command, and move the test there to run it for both v1 In-Memory and Hive external catalogs.",
        "createdAt" : "2021-01-26T10:37:52Z",
        "updatedAt" : "2021-01-26T10:37:52Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "004bf9a7-266f-4ff9-916c-2c69a7277ffd",
        "parentId" : "fc9d12a9-4388-44f4-806f-ace1ca66ac4a",
        "authorId" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "body" : "OK sounds good. We can keep it for now then.",
        "createdAt" : "2021-01-26T10:45:26Z",
        "updatedAt" : "2021-01-26T10:45:27Z",
        "lastEditedBy" : "9ae00886-75a7-4f39-aed7-d47b26b67afb",
        "tags" : [
        ]
      },
      {
        "id" : "073ebe98-635a-4794-b85d-787f5c8b1017",
        "parentId" : "fc9d12a9-4388-44f4-806f-ace1ca66ac4a",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "@sunchao Here is the PR https://github.com/apache/spark/pull/31387 which unifies the `TRUNCATE TABLE` tests.",
        "createdAt" : "2021-01-30T14:12:51Z",
        "updatedAt" : "2021-01-30T14:12:51Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "25b8583d65246372f8b6ac35071ead118b1c97f2",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +503,507 @@  }\n\n  test(\"SPARK-34215: keep table cached after truncation\") {\n    withTable(\"tbl\") {\n      sql(\"CREATE TABLE tbl (c0 int)\")"
  },
  {
    "id" : "e835fcf2-6051-4ac1-bab6-2bb2bd7e3975",
    "prId" : 30403,
    "prUrl" : "https://github.com/apache/spark/pull/30403#pullrequestreview-533144878",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "91a58c26-5242-4bf0-a71d-4413ee4adc9c",
        "parentId" : null,
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "This is now consistent with Line 108 above.",
        "createdAt" : "2020-11-18T06:49:34Z",
        "updatedAt" : "2020-11-27T21:30:33Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "7e788cea5c2dd03f71ee30b0106e04d7f036f30f",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +114,118 @@      sql(\"UNCACHE TABLE nonexistentTable\")\n    }.getMessage\n    assert(e.contains(s\"$expectedErrorMsg nonexistentTable\"))\n    sql(\"UNCACHE TABLE IF EXISTS nonexistentTable\")\n  }"
  },
  {
    "id" : "c752c053-ab7c-4a9a-bac0-700c718d000c",
    "prId" : 30403,
    "prUrl" : "https://github.com/apache/spark/pull/30403#pullrequestreview-538857401",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "71ed7091-6b78-430f-baaa-a563d631983c",
        "parentId" : null,
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "~~@cloud-fan Looks like we need to resolve catalog/current namespace for this scenario?~~",
        "createdAt" : "2020-11-25T18:28:39Z",
        "updatedAt" : "2020-11-27T21:30:33Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      },
      {
        "id" : "37be5f3c-300b-47ab-9157-671d8ce751b1",
        "parentId" : "71ed7091-6b78-430f-baaa-a563d631983c",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "I guess this is OK as long as `spark.catalog.isCached` works fine since it's just a name of cache builder.",
        "createdAt" : "2020-11-25T19:43:37Z",
        "updatedAt" : "2020-11-27T21:30:33Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      },
      {
        "id" : "f372a54b-9d95-440d-a501-59bee303b00a",
        "parentId" : "71ed7091-6b78-430f-baaa-a563d631983c",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Why is `default.` gone here?",
        "createdAt" : "2020-11-25T19:49:15Z",
        "updatedAt" : "2020-11-27T21:30:33Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "0b53d4df-ed62-4c6b-bfab-54158694d00d",
        "parentId" : "71ed7091-6b78-430f-baaa-a563d631983c",
        "authorId" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "body" : "Because the cache was created with `CACHE TABLE cachedTable OPTIONS('storageLevel' 'DISK_ONLY')`. Before, `cachedTable` was resolved to `default.cachedTable` in `ResolveSessionCatalog`.\r\n\r\nNote that it's just a name of cache builder and doesn't affect `spark.catalog.isCached(tableName: String)`.",
        "createdAt" : "2020-11-25T21:30:41Z",
        "updatedAt" : "2020-11-27T21:30:33Z",
        "lastEditedBy" : "b14448be-63dd-4b59-ab38-deeb2a38de86",
        "tags" : [
        ]
      }
    ],
    "commit" : "7e788cea5c2dd03f71ee30b0106e04d7f036f30f",
    "line" : 56,
    "diffHunk" : "@@ -1,1 +422,426 @@            sql(\"REFRESH TABLE default.cachedTable\")\n            assertCached(\n              sql(\"SELECT * FROM default.cachedTable\"), \"cachedTable\", DISK_ONLY)\n            assert(spark.catalog.isCached(\"default.cachedTable\"),\n              \"Table 'cachedTable' should be cached after refreshing with its qualified name.\")"
  }
]