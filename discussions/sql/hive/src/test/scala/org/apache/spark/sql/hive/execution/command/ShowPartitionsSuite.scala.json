[
  {
    "id" : "002f1c99-f7d7-41bf-9abe-4dcc605c559d",
    "prId" : 30893,
    "prUrl" : "https://github.com/apache/spark/pull/30893#pullrequestreview-557676649",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e65892df-e03e-4931-863c-45848c5b1f66",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "this is inconsistent with the in-memory catalog. Let's fix this later.",
        "createdAt" : "2020-12-23T06:59:00Z",
        "updatedAt" : "2020-12-24T06:51:32Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      }
    ],
    "commit" : "4e0ca6c203c7624cf2f5b95c0ed88b66fa6ccd41",
    "line" : 25,
    "diffHunk" : "@@ -1,1 +38,42 @@        checkAnswer(spark.table(\"t\"),\n          Row(0, \"__HIVE_DEFAULT_PARTITION__\") ::\n          Row(1, \"__HIVE_DEFAULT_PARTITION__\") :: Nil)\n      }\n    }"
  },
  {
    "id" : "e9964849-ce5c-4946-9d27-94370246d824",
    "prId" : 30893,
    "prUrl" : "https://github.com/apache/spark/pull/30893#pullrequestreview-557714671",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "59be82c8-74eb-4962-a68e-f1cce7e8811f",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "shall we add the same test for v2?",
        "createdAt" : "2020-12-23T07:00:19Z",
        "updatedAt" : "2020-12-24T06:51:32Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "71bf116b-6009-44af-81bd-c3cf9d1f6587",
        "parentId" : "59be82c8-74eb-4962-a68e-f1cce7e8811f",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "It fails with NPE :-(\r\n\r\n```scala\r\n  test(\"null and empty string as partition values\") {\r\n    import testImplicits._\r\n    withNamespaceAndTable(\"ns\", \"tbl\") { t =>\r\n      val df = Seq((0, \"\"), (1, null)).toDF(\"a\", \"part\")\r\n      df.write\r\n        .partitionBy(\"part\")\r\n        .format(\"parquet\")\r\n        .mode(SaveMode.Overwrite)\r\n        .saveAsTable(t)\r\n\r\n      runShowPartitionsSql(s\"SHOW PARTITIONS $t\", Row(\"part=null\") :: Nil)\r\n    }\r\n  }\r\n```\r\n```\r\njava.lang.NullPointerException was thrown.\r\njava.lang.NullPointerException\r\n\tat org.apache.spark.sql.execution.datasources.v2.ShowPartitionsExec.$anonfun$run$3(ShowPartitionsExec.scala:58)\r\n\tat scala.collection.TraversableLike.$anonfun$map$1(TraversableLike.scala:238)\r\n```\r\nLet me fix this separately since this PR is about tests. ",
        "createdAt" : "2020-12-23T07:48:03Z",
        "updatedAt" : "2020-12-24T06:51:32Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "1ae2b664-99e1-4c66-aa4b-26cc3ee3769a",
        "parentId" : "59be82c8-74eb-4962-a68e-f1cce7e8811f",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Oh, shall we proceed that NPE fix PR first, @MaxGekk ?",
        "createdAt" : "2020-12-23T07:53:51Z",
        "updatedAt" : "2020-12-24T06:51:32Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "a6c230ce-387d-49c9-83bc-1c8413fb21c9",
        "parentId" : "59be82c8-74eb-4962-a68e-f1cce7e8811f",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Sure, I am doing that.",
        "createdAt" : "2020-12-23T08:06:20Z",
        "updatedAt" : "2020-12-24T06:51:32Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      },
      {
        "id" : "ece11474-8748-4b41-ae02-0bd85bc2daea",
        "parentId" : "59be82c8-74eb-4962-a68e-f1cce7e8811f",
        "authorId" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "body" : "Here is the fix: https://github.com/apache/spark/pull/30904",
        "createdAt" : "2020-12-23T08:28:30Z",
        "updatedAt" : "2020-12-24T06:51:32Z",
        "lastEditedBy" : "5c8bf89e-8bb3-4151-8b92-286da26c827e",
        "tags" : [
        ]
      }
    ],
    "commit" : "4e0ca6c203c7624cf2f5b95c0ed88b66fa6ccd41",
    "line" : 9,
    "diffHunk" : "@@ -1,1 +22,26 @@\nclass ShowPartitionsSuite extends v1.ShowPartitionsSuiteBase with CommandSuiteBase {\n  test(\"null and empty string as partition values\") {\n    import testImplicits._\n    withSQLConf(\"hive.exec.dynamic.partition.mode\" -> \"nonstrict\") {"
  }
]