[
  {
    "id" : "3fcbb356-346e-44a6-8fa0-b0793b5f3d99",
    "prId" : 33484,
    "prUrl" : "https://github.com/apache/spark/pull/33484#pullrequestreview-713616894",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "0d948abb-0128-4a88-a3ea-21dce5c34aee",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "let's put this in PySpark documentation as well https://github.com/apache/spark/blob/master/python/docs/source/reference/pyspark.sql.rst",
        "createdAt" : "2021-07-23T10:24:21Z",
        "updatedAt" : "2021-07-23T10:24:22Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "18ec8259-6164-468c-a5aa-fbdfd36274b0",
        "parentId" : "0d948abb-0128-4a88-a3ea-21dce5c34aee",
        "authorId" : "c4ecf4e4-1fda-4fed-9980-aed6c3b3e8e4",
        "body" : "so many magic places... done",
        "createdAt" : "2021-07-23T10:58:51Z",
        "updatedAt" : "2021-07-23T10:58:51Z",
        "lastEditedBy" : "c4ecf4e4-1fda-4fed-9980-aed6c3b3e8e4",
        "tags" : [
        ]
      }
    ],
    "commit" : "90675b0d300a299a047f97274e9d0814b2366a37",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +438,442 @@        \"pyspark.sql.pandas.typehints\",\n        \"pyspark.sql.pandas.utils\",\n        \"pyspark.sql.observation\",\n        # unittests\n        \"pyspark.sql.tests.test_arrow\","
  },
  {
    "id" : "217be488-0053-4199-bb4f-e31c5b310bd6",
    "prId" : 33125,
    "prUrl" : "https://github.com/apache/spark/pull/33125#pullrequestreview-694610519",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5dbfe0e9-6c8c-4d57-b41b-b7cc8ece3b9f",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "hm, the problem is that the tests will still be skipped because `ENABLE_DOCKER_INTEGRATION_TESTS` is set only when explicitly there are some changes in `docker_integration_tests` module alone. (e.g., when `sql` module is picked alone, `ENABLE_DOCKER_INTEGRATION_TESTS` is not set, and the related tests are skipped).\r\n\r\nThis logic was followed from the Kinesis one but maybe we should just remove `ENABLE_DOCKER_INTEGRATION_TESTS` away and treat it like other test cases.\r\n\r\nThis env approach was used because of the concern of flakiness IIRC but actually the test seems pretty stable (?).",
        "createdAt" : "2021-06-29T05:38:45Z",
        "updatedAt" : "2021-06-29T05:38:46Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "2b7b2c07-c471-4b02-8272-bd8e970ff1e0",
        "parentId" : "5dbfe0e9-6c8c-4d57-b41b-b7cc8ece3b9f",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "alternatively we can copy:\r\n\r\n```\r\n    environ=None if \"GITHUB_ACTIONS\" not in os.environ else {\r\n        \"ENABLE_DOCKER_INTEGRATION_TESTS\": \"1\"\r\n    },\r\n```\r\n\r\nto `sql` module too to be extra conservative.",
        "createdAt" : "2021-06-29T05:39:48Z",
        "updatedAt" : "2021-06-29T05:39:48Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "78948284-8952-4953-ab1e-d7f7919dacaa",
        "parentId" : "5dbfe0e9-6c8c-4d57-b41b-b7cc8ece3b9f",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Got it.",
        "createdAt" : "2021-06-29T05:43:11Z",
        "updatedAt" : "2021-06-29T05:43:20Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "241b6b30-c047-4bca-8f5d-00f3c9ac3ff9",
        "parentId" : "5dbfe0e9-6c8c-4d57-b41b-b7cc8ece3b9f",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Then, it will happen at `catalyst` module change, too. I'll put it to both `catalyst` and `sql` module.",
        "createdAt" : "2021-06-29T05:44:21Z",
        "updatedAt" : "2021-06-29T05:44:21Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "06ff73f0-c6f5-45c5-bf2c-906e2453c501",
        "parentId" : "5dbfe0e9-6c8c-4d57-b41b-b7cc8ece3b9f",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Yeah, that should be fine for now ðŸ‘ ",
        "createdAt" : "2021-06-29T05:44:49Z",
        "updatedAt" : "2021-06-29T05:44:49Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "3bd4962c8fe0f2ad4dc02f74613ea874d1862ad9",
    "line" : 25,
    "diffHunk" : "@@ -1,1 +776,780 @@docker_integration_tests = Module(\n    name=\"docker-integration-tests\",\n    dependencies=[sql],\n    build_profile_flags=[\"-Pdocker-integration-tests\"],\n    source_file_regexes=[\"external/docker-integration-tests\"],"
  },
  {
    "id" : "50053fe7-e78b-40a4-806d-00e38f79c0d6",
    "prId" : 32867,
    "prUrl" : "https://github.com/apache/spark/pull/32867#pullrequestreview-687542735",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "89e82358-38f8-4396-8b11-cbce601ce43b",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "BTW, do you plan to do it for doctests later? Doing it in a separate PR is fine. I'm just curious about your plan.",
        "createdAt" : "2021-06-18T11:27:38Z",
        "updatedAt" : "2021-06-18T11:27:38Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "11a1a255-2d17-48df-baae-9d906ae2e86f",
        "parentId" : "89e82358-38f8-4396-8b11-cbce601ce43b",
        "authorId" : "c13f1277-0254-494b-8e7a-bd7c261b2e9f",
        "body" : "Frankly, not yet, but I'd like to start to do some investigation. This unittestPR is started when I forgot many times to add the unittests in module. ^_^\r\n\r\nAnd the `doctests` discover is a bit special, it's not subclass of doctest (just like the unitest), so looks like there are 2 potential solution:\r\n\r\n1. Flag based. Add some flag like `_doc_test = True` in every test we want to test.\r\n2. Special name based. Discover which module contains `_doctest` method (we should rename _test to _doctest to make doc test name unique).",
        "createdAt" : "2021-06-18T15:41:04Z",
        "updatedAt" : "2021-06-18T15:41:05Z",
        "lastEditedBy" : "c13f1277-0254-494b-8e7a-bd7c261b2e9f",
        "tags" : [
        ]
      },
      {
        "id" : "64f69ddf-5f61-4365-a1a6-d03c4d77434a",
        "parentId" : "89e82358-38f8-4396-8b11-cbce601ce43b",
        "authorId" : "c13f1277-0254-494b-8e7a-bd7c261b2e9f",
        "body" : "BTW, I'm not sure here is the good place to discussion. : )\r\n\r\nDo you think the footer method (excute doctest or unitests in __main__ with repeat code in many files) in python code is a good way enough? Do we consider do some re-arch (or to say, already have some work) on testing framework?",
        "createdAt" : "2021-06-18T15:45:18Z",
        "updatedAt" : "2021-06-18T15:46:47Z",
        "lastEditedBy" : "c13f1277-0254-494b-8e7a-bd7c261b2e9f",
        "tags" : [
        ]
      }
    ],
    "commit" : "9f6b08f3d9ddaf1087c74d4a9f808697063922db",
    "line" : 148,
    "diffHunk" : "@@ -1,1 +507,511 @@    python_test_goals=[\n        # doctests\n        \"pyspark.streaming.util\",\n    ] + _discover_python_unittests(\"pyspark/streaming/tests\"),\n)"
  },
  {
    "id" : "f3c7aeeb-9724-4c2e-a192-76676aea037c",
    "prId" : 32867,
    "prUrl" : "https://github.com/apache/spark/pull/32867#pullrequestreview-694556739",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4593b721-2644-4bb4-998b-be64f9ee1f88",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "It is possible to add a simple doctests at https://github.com/apache/spark/blob/master/dev/run-tests.py? The doctests there are ran before running the script.",
        "createdAt" : "2021-06-28T02:22:44Z",
        "updatedAt" : "2021-06-28T02:22:44Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "b3f94044-77ab-4aaf-abf3-a252d23425bf",
        "parentId" : "4593b721-2644-4bb4-998b-be64f9ee1f88",
        "authorId" : "c13f1277-0254-494b-8e7a-bd7c261b2e9f",
        "body" : "Emm, looks like it a diffcult to add this doctest, the doctest requires real import of pyspark, so it would be failed when running the testcase in run-test.py.",
        "createdAt" : "2021-06-28T13:43:54Z",
        "updatedAt" : "2021-06-28T13:58:17Z",
        "lastEditedBy" : "c13f1277-0254-494b-8e7a-bd7c261b2e9f",
        "tags" : [
        ]
      },
      {
        "id" : "47ec49aa-c821-43e0-b9e3-53dd786de170",
        "parentId" : "4593b721-2644-4bb4-998b-be64f9ee1f88",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "kk that's fine",
        "createdAt" : "2021-06-29T03:23:08Z",
        "updatedAt" : "2021-06-29T03:23:08Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "9f6b08f3d9ddaf1087c74d4a9f808697063922db",
    "line" : 39,
    "diffHunk" : "@@ -1,1 +51,55 @@    Returns\n    -------\n    A set of complete test module name discovered under specified paths\n    \"\"\"\n"
  },
  {
    "id" : "05ae7019-d5ff-43b7-8ca9-51379a8bf102",
    "prId" : 32631,
    "prUrl" : "https://github.com/apache/spark/pull/32631#pullrequestreview-666163063",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "f258e780-e25a-4a16-a86c-8b99aa89a424",
        "parentId" : null,
        "authorId" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "body" : "I thought this test (& the k8s integration one) was intentionally excluded from this file because it is heavy. So, I tried to simply run the docker integration tests via `sbt` in my PR.",
        "createdAt" : "2021-05-22T08:09:00Z",
        "updatedAt" : "2021-05-22T08:09:00Z",
        "lastEditedBy" : "044062b3-9d96-4ec3-a1e2-3a2f595bbc02",
        "tags" : [
        ]
      },
      {
        "id" : "03b9fd4c-8a1d-4de2-8d6a-0afeb2524f7b",
        "parentId" : "f258e780-e25a-4a16-a86c-8b99aa89a424",
        "authorId" : "3a227965-84e0-47cf-9974-11293764f028",
        "body" : ">I thought this test (& the k8s integration one) was intentionally excluded from this file because it is heavy. \r\n\r\nI think so. So I changed `run-tests.py` not to run the integration tests by default.",
        "createdAt" : "2021-05-22T08:11:15Z",
        "updatedAt" : "2021-05-22T08:11:15Z",
        "lastEditedBy" : "3a227965-84e0-47cf-9974-11293764f028",
        "tags" : [
        ]
      }
    ],
    "commit" : "692d95d1458993cbb9cbd47014202e84cd6aa328",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +745,749 @@)\n\ndocker_integration_tests = Module(\n    name=\"docker-integration-tests\",\n    dependencies=[],"
  }
]