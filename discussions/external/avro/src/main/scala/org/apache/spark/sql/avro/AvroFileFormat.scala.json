[
  {
    "id" : "76569945-cb2a-47df-bcfd-e2d504e6e96c",
    "prId" : 30869,
    "prUrl" : "https://github.com/apache/spark/pull/30869#pullrequestreview-706417000",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "cc2c9177-1ede-465e-8b48-93b96ca87972",
        "parentId" : null,
        "authorId" : "ddb80038-2da6-4937-8c45-4d52fbe0300f",
        "body" : "Looks like this code is directly copied from `Schema.validateName`. At minimum, we need to provide a copyright attribution here. It's a shame that the function isn't exposed publicly.\r\n\r\nRather than duplicating the validation logic here, I'm wondering if we should work around it by creating a placeholder schema with the fields from `checkFieldNames` (the types can be arbitrary) and asking Avro to parse it, and treating the field names as valid if Avro doesn't throw a `SchemaParseException`, e.g.:\r\n```\r\n        val emptyBuilder = SchemaBuilder.record(\"foo\").fields()\r\n        val fullBuilder = names.foldLeft(emptyBuilder)((builder, name) => builder.requiredInt(name))\r\n        fullBuilder.endRecord()\r\n```",
        "createdAt" : "2021-07-14T15:26:42Z",
        "updatedAt" : "2021-07-14T15:29:37Z",
        "lastEditedBy" : "ddb80038-2da6-4937-8c45-4d52fbe0300f",
        "tags" : [
        ]
      }
    ],
    "commit" : "706938c3c970225dfbfcd673d1e58faca4c344d0",
    "line" : 34,
    "diffHunk" : "@@ -1,1 +177,181 @@          i += 1\n        }\n      }\n    }\n  }"
  }
]