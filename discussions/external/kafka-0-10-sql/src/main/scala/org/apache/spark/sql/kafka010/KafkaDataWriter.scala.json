[
  {
    "id" : "c45c2fab-7559-45d6-939e-7b4a7f3efed6",
    "prId" : 26855,
    "prUrl" : "https://github.com/apache/spark/pull/26855#pullrequestreview-331265431",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b69c0c59-50de-4608-bbeb-9ebb222bb3f5",
        "parentId" : null,
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "This is safe; previous implementation cleans up the instance from the cache immediately so it actually helps a bit, but no big deal even we don't do it.",
        "createdAt" : "2019-12-12T01:54:32Z",
        "updatedAt" : "2019-12-12T14:15:55Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      },
      {
        "id" : "e17a5c46-48e7-4b46-b778-b638fdf93d1b",
        "parentId" : "b69c0c59-50de-4608-bbeb-9ebb222bb3f5",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "is this related to adding the `close` API?",
        "createdAt" : "2019-12-12T08:37:55Z",
        "updatedAt" : "2019-12-12T14:15:55Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "6f9e5035-07ef-416a-b4e7-76b2a998c085",
        "parentId" : "b69c0c59-50de-4608-bbeb-9ebb222bb3f5",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "So there's conflict on naming; test code calls it as `close()`. If we would like to keep the code as it is, I can rename previous method as `invalidateProducer()` and leave it as it is.",
        "createdAt" : "2019-12-12T08:43:51Z",
        "updatedAt" : "2019-12-12T14:15:55Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      },
      {
        "id" : "353e770c-a790-430f-86dd-2ba7fb796b30",
        "parentId" : "b69c0c59-50de-4608-bbeb-9ebb222bb3f5",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "what's the life cycle of kafka producers? IIRC they were cached before, but that patch gets reverted.",
        "createdAt" : "2019-12-12T08:59:18Z",
        "updatedAt" : "2019-12-12T14:15:55Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "a8a55bb9-cb3b-4354-a39b-aa9abde5e832",
        "parentId" : "b69c0c59-50de-4608-bbeb-9ebb222bb3f5",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "So there's no \"return\" in current Kafka producer cache and the cache evicts the expired producer on policy. Previously we force invalidating the Kafka producer when close() is explicitly called as callers of `close()` are temporarily using the producer (instead of running some query), and current code just let cache expire the producer on policy for all cases.",
        "createdAt" : "2019-12-12T09:04:28Z",
        "updatedAt" : "2019-12-12T14:15:55Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      },
      {
        "id" : "c99df278-fe88-433e-9802-4e3040d63610",
        "parentId" : "b69c0c59-50de-4608-bbeb-9ebb222bb3f5",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "SGTM then, if the life cycle of producers are controled by the cache policy.",
        "createdAt" : "2019-12-12T09:22:52Z",
        "updatedAt" : "2019-12-12T14:15:55Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "adeb2625-10a4-4434-a632-2225fde76fc3",
        "parentId" : "b69c0c59-50de-4608-bbeb-9ebb222bb3f5",
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "Btw, I just renamed origin `close()` method to `invalidateProducer()` to avoid the effect on Kafka side.",
        "createdAt" : "2019-12-12T14:24:47Z",
        "updatedAt" : "2019-12-12T14:24:47Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      }
    ],
    "commit" : "21d03e75f9b669ac2cbb42af3315944fb780b2c8",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +64,68 @@  def abort(): Unit = {}\n\n  def close(): Unit = {}\n\n  /** explicitly invalidate producer from pool. only for testing. */"
  }
]