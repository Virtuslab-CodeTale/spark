[
  {
    "id" : "a10452d3-83b4-446c-856d-dba5c91b9e92",
    "prId" : 29729,
    "prUrl" : "https://github.com/apache/spark/pull/29729#pullrequestreview-487461906",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5e21854a-3ed8-4fb6-a381-4951292dabcd",
        "parentId" : null,
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "Looks like we can extract the duplicated code among Strategies, which does retrieving all topic partitions via AdminClient.\r\n\r\n```suggestion\r\nprotected def retrieveAllPartitions(admin: Admin, topics: Set[String]): Set[TopicPartition] = {\r\n    admin.describeTopics(topics.asJava).all().get().asScala.filterNot(_._2.isInternal).flatMap {\r\n      case (topic, topicDescription) =>\r\n        topicDescription.partitions().asScala.map { topicPartitionInfo =>\r\n          val partition = topicPartitionInfo.partition()\r\n          logDebug(s\"Partition added: $topic:$partition\")\r\n          new TopicPartition(topic, partition)\r\n        }\r\n    }.toSet\r\n  }\r\n}\r\n```",
        "createdAt" : "2020-09-14T05:00:22Z",
        "updatedAt" : "2020-12-01T07:55:03Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      },
      {
        "id" : "4232bc8e-4ca1-438f-9217-9977feb452e5",
        "parentId" : "5e21854a-3ed8-4fb6-a381-4951292dabcd",
        "authorId" : "e6f86365-3ac2-48b4-94f9-21ce737cf1ac",
        "body" : "Good point, merged.",
        "createdAt" : "2020-09-14T06:55:35Z",
        "updatedAt" : "2020-12-01T07:55:04Z",
        "lastEditedBy" : "e6f86365-3ac2-48b4-94f9-21ce737cf1ac",
        "tags" : [
        ]
      }
    ],
    "commit" : "203e60c9b7abeac0464ad3acc256121a5f900e40",
    "line" : 54,
    "diffHunk" : "@@ -1,1 +73,77 @@    }.toSet\n  }\n}\n\n/**"
  }
]