[
  {
    "id" : "3f7e7314-5e88-4565-ac74-007ab8e2a3cb",
    "prId" : 24828,
    "prUrl" : "https://github.com/apache/spark/pull/24828#pullrequestreview-247404750",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "793a3490-4104-46ef-aef6-e96a6545b333",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Could you make a case where `execute` is called and `sendRow` is not called?",
        "createdAt" : "2019-06-09T15:41:06Z",
        "updatedAt" : "2019-06-09T15:41:07Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      }
    ],
    "commit" : "60d978f02027bbaa2dc79348c18a24930fd13232",
    "line" : 14,
    "diffHunk" : "@@ -1,1 +44,48 @@    while (iterator.hasNext && failedWrite == null) {\n      val currentRow = iterator.next()\n      sendRow(currentRow, producer)\n    }\n  }"
  },
  {
    "id" : "586242fd-cd8d-4286-ae2d-f6a5a96474d1",
    "prId" : 24828,
    "prUrl" : "https://github.com/apache/spark/pull/24828#pullrequestreview-247420620",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "6e15f885-7d20-4394-9f22-04a4a3709617",
        "parentId" : null,
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "Even it is defined as `lazy`, here it will be initialized if `producer` is not referenced (and initialized) in `send` - so if close() is guaranteed to be called, it doesn't seem to be noticeable difference.",
        "createdAt" : "2019-06-10T00:01:40Z",
        "updatedAt" : "2019-06-10T00:04:15Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      }
    ],
    "commit" : "60d978f02027bbaa2dc79348c18a24930fd13232",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +50,54 @@  def close(): Unit = {\n    checkForErrors()\n    if (producer != null) {\n      producer.flush()\n      checkForErrors()"
  },
  {
    "id" : "a2751ffe-d2ca-4319-bc94-a89f07134127",
    "prId" : 24828,
    "prUrl" : "https://github.com/apache/spark/pull/24828#pullrequestreview-247420620",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "02ffe2be-009e-41bb-aa09-6656a48330a4",
        "parentId" : null,
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "`CachedKafkaProducer.close` \"closes\" the producer instead of returning it to pool. Current cache pool doesn't have explicit method to return the producer to pool, so that's why we make producer being `null`.",
        "createdAt" : "2019-06-10T00:04:09Z",
        "updatedAt" : "2019-06-10T00:04:15Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      }
    ],
    "commit" : "60d978f02027bbaa2dc79348c18a24930fd13232",
    "line" : 20,
    "diffHunk" : "@@ -1,1 +53,57 @@      producer.flush()\n      checkForErrors()\n      CachedKafkaProducer.close(producerConfiguration)\n    }\n  }"
  }
]