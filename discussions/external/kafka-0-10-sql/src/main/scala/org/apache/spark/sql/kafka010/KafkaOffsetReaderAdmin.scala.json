[
  {
    "id" : "4ba21ac0-05f6-41ca-a471-cc564589d370",
    "prId" : 32747,
    "prUrl" : "https://github.com/apache/spark/pull/32747#pullrequestreview-688106759",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3b682e5d-747d-428b-b32a-711ff805a6ed",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Hmm, but the `isStartingOffsets` here is actually the starting offset of batch?",
        "createdAt" : "2021-06-21T07:07:09Z",
        "updatedAt" : "2021-06-21T07:07:09Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "a3b52edc-196f-45be-8b43-85a99d9d20cc",
        "parentId" : "3b682e5d-747d-428b-b32a-711ff805a6ed",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Oh, I see. `fetchPartitionOffsets` is only called for batch query.",
        "createdAt" : "2021-06-21T07:25:25Z",
        "updatedAt" : "2021-06-21T07:25:25Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "962778544ad79b3ded45ed2f510ad5cda544088a",
    "line" : 32,
    "diffHunk" : "@@ -1,1 +142,146 @@      case GlobalTimestampRangeLimit(timestamp, strategyOnNoMatchingStartingOffset) =>\n        fetchGlobalTimestampBasedOffsets(timestamp, isStartingOffsets,\n          strategyOnNoMatchingStartingOffset).partitionToOffsets\n    }\n  }"
  },
  {
    "id" : "5cd132b4-e113-4698-bb2d-d7532f6f25bd",
    "prId" : 32747,
    "prUrl" : "https://github.com/apache/spark/pull/32747#pullrequestreview-688109387",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "82cd909a-e9b3-46fb-80f4-dde1d800cf65",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Looks like this checks the strategy for each start offsets per batch? I'm a bit confused. Isn't the `startingOffsetsByTimestamp` only for `The start point of timestamp when a query is started ...`?",
        "createdAt" : "2021-06-21T07:10:54Z",
        "updatedAt" : "2021-06-21T07:10:54Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "1ec5dfd5-4705-4b70-9ea2-81e09b99b119",
        "parentId" : "82cd909a-e9b3-46fb-80f4-dde1d800cf65",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "This is the same. nvm. Although `fetchSpecificTimestampBasedOffsets` is called in batch, and streaming batch queries, for streaming batch it is only called for initial partition offsets.",
        "createdAt" : "2021-06-21T07:28:49Z",
        "updatedAt" : "2021-06-21T07:28:49Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "962778544ad79b3ded45ed2f510ad5cda544088a",
    "line" : 142,
    "diffHunk" : "@@ -1,1 +235,239 @@            case StrategyOnNoMatchStartingOffset.LATEST =>\n              KafkaOffsetRangeLimit.LATEST\n          }\n        } else {\n          KafkaOffsetRangeLimit.LATEST"
  }
]