[
  {
    "id" : "4ba21ac0-05f6-41ca-a471-cc564589d370",
    "prId" : 32747,
    "prUrl" : "https://github.com/apache/spark/pull/32747#pullrequestreview-688106759",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3b682e5d-747d-428b-b32a-711ff805a6ed",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Hmm, but the `isStartingOffsets` here is actually the starting offset of batch?",
        "createdAt" : "2021-06-21T07:07:09Z",
        "updatedAt" : "2021-06-21T07:07:09Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "a3b52edc-196f-45be-8b43-85a99d9d20cc",
        "parentId" : "3b682e5d-747d-428b-b32a-711ff805a6ed",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Oh, I see. `fetchPartitionOffsets` is only called for batch query.",
        "createdAt" : "2021-06-21T07:25:25Z",
        "updatedAt" : "2021-06-21T07:25:25Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "962778544ad79b3ded45ed2f510ad5cda544088a",
    "line" : 32,
    "diffHunk" : "@@ -1,1 +142,146 @@      case GlobalTimestampRangeLimit(timestamp, strategyOnNoMatchingStartingOffset) =>\n        fetchGlobalTimestampBasedOffsets(timestamp, isStartingOffsets,\n          strategyOnNoMatchingStartingOffset).partitionToOffsets\n    }\n  }"
  },
  {
    "id" : "5cd132b4-e113-4698-bb2d-d7532f6f25bd",
    "prId" : 32747,
    "prUrl" : "https://github.com/apache/spark/pull/32747#pullrequestreview-688109387",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "82cd909a-e9b3-46fb-80f4-dde1d800cf65",
        "parentId" : null,
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "Looks like this checks the strategy for each start offsets per batch? I'm a bit confused. Isn't the `startingOffsetsByTimestamp` only for `The start point of timestamp when a query is started ...`?",
        "createdAt" : "2021-06-21T07:10:54Z",
        "updatedAt" : "2021-06-21T07:10:54Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      },
      {
        "id" : "1ec5dfd5-4705-4b70-9ea2-81e09b99b119",
        "parentId" : "82cd909a-e9b3-46fb-80f4-dde1d800cf65",
        "authorId" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "body" : "This is the same. nvm. Although `fetchSpecificTimestampBasedOffsets` is called in batch, and streaming batch queries, for streaming batch it is only called for initial partition offsets.",
        "createdAt" : "2021-06-21T07:28:49Z",
        "updatedAt" : "2021-06-21T07:28:49Z",
        "lastEditedBy" : "5e28de51-305c-4276-b3a0-78bcc74eb6f2",
        "tags" : [
        ]
      }
    ],
    "commit" : "962778544ad79b3ded45ed2f510ad5cda544088a",
    "line" : 142,
    "diffHunk" : "@@ -1,1 +235,239 @@            case StrategyOnNoMatchStartingOffset.LATEST =>\n              KafkaOffsetRangeLimit.LATEST\n          }\n        } else {\n          KafkaOffsetRangeLimit.LATEST"
  },
  {
    "id" : "b511846b-9fff-420a-b657-b049312d4233",
    "prId" : 29729,
    "prUrl" : "https://github.com/apache/spark/pull/29729#pullrequestreview-539918867",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c74da1be-bd7b-44e3-9e18-82010846cec1",
        "parentId" : null,
        "authorId" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "body" : "NOTE to reviewers:\r\n\r\nThis file is identical with the commit which is just before the huge change, except the diff which is due to the new introduction of `KafkaOffsetReaderBase`.\r\n\r\nhttps://github.com/gaborgsomogyi/spark/blob/d0e4c63018beb4e0d36bfea1753c3e5d8f13659e/external/kafka-0-10-sql/src/main/scala/org/apache/spark/sql/kafka010/KafkaOffsetReader.scala",
        "createdAt" : "2020-11-27T11:46:36Z",
        "updatedAt" : "2020-12-01T07:55:04Z",
        "lastEditedBy" : "0c28e5da-df9b-4076-bb67-3b6878f1f4ce",
        "tags" : [
        ]
      }
    ],
    "commit" : "203e60c9b7abeac0464ad3acc256121a5f900e40",
    "line" : 1,
    "diffHunk" : "@@ -1,1 +-1,3 @@/*\n * Licensed to the Apache Software Foundation (ASF) under one or more\n * contributor license agreements.  See the NOTICE file distributed with"
  },
  {
    "id" : "5c395c98-6310-4132-9538-2a4a4f58a2c8",
    "prId" : 29729,
    "prUrl" : "https://github.com/apache/spark/pull/29729#pullrequestreview-540897900",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "5c19feef-b31a-45c7-93b7-d000059d0f69",
        "parentId" : null,
        "authorId" : "e6f86365-3ac2-48b4-94f9-21ce737cf1ac",
        "body" : "This is not related but found a bug in the original commit.",
        "createdAt" : "2020-11-30T13:17:35Z",
        "updatedAt" : "2020-12-01T07:55:04Z",
        "lastEditedBy" : "e6f86365-3ac2-48b4-94f9-21ce737cf1ac",
        "tags" : [
        ]
      }
    ],
    "commit" : "203e60c9b7abeac0464ad3acc256121a5f900e40",
    "line" : 62,
    "diffHunk" : "@@ -1,1 +60,64 @@\n  /**\n   * [[UninterruptibleThreadRunner]] ensures that all [[Admin]] communication called in an\n   * [[UninterruptibleThread]]. In the case of streaming queries, we are already running in an\n   * [[UninterruptibleThread]], however for batch mode this is not the case."
  }
]