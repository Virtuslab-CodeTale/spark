[
  {
    "id" : "64915c03-87ef-4c15-a7d9-3cf8b95744d5",
    "prId" : 30352,
    "prUrl" : "https://github.com/apache/spark/pull/30352#pullrequestreview-531202255",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "bda56a4f-0bb5-478d-a96e-756f555b0eba",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Can we avoid this change?",
        "createdAt" : "2020-11-15T19:06:15Z",
        "updatedAt" : "2020-11-16T22:47:41Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "c08681b0-77c5-4811-84c0-8b9dfc108a20",
        "parentId" : "bda56a4f-0bb5-478d-a96e-756f555b0eba",
        "authorId" : "205932d6-0a11-458f-aa30-d2268a8961f7",
        "body" : "No. This is due to the `queuedDrivers` collection whose type has changed from `ArrayBuffer` to `mutable.TreeSet` (with an `Ordering` for sorting the drivers following their priority).",
        "createdAt" : "2020-11-15T23:34:03Z",
        "updatedAt" : "2020-11-16T22:47:41Z",
        "lastEditedBy" : "205932d6-0a11-458f-aa30-d2268a8961f7",
        "tags" : [
        ]
      },
      {
        "id" : "22034877-c9af-408e-a761-bddc876678fd",
        "parentId" : "bda56a4f-0bb5-478d-a96e-756f555b0eba",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Hi, @pgillet . Usually, you had better keep the comment open for the review. The commenters will check your reply and resolve by themselves.",
        "createdAt" : "2020-11-16T01:09:50Z",
        "updatedAt" : "2020-11-16T22:47:41Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "d4ddf0b0-ab33-43d2-8a4c-33062825a8ba",
        "parentId" : "bda56a4f-0bb5-478d-a96e-756f555b0eba",
        "authorId" : "205932d6-0a11-458f-aa30-d2268a8961f7",
        "body" : "Sorry about that.",
        "createdAt" : "2020-11-16T10:41:01Z",
        "updatedAt" : "2020-11-16T22:47:41Z",
        "lastEditedBy" : "205932d6-0a11-458f-aa30-d2268a8961f7",
        "tags" : [
        ]
      }
    ],
    "commit" : "72e396692c4018571330eee3ecdfd7ee28cc57df",
    "line" : 60,
    "diffHunk" : "@@ -1,1 +736,740 @@\n  private def copyBuffer(\n      buffer: TraversableOnce[MesosDriverDescription]): ArrayBuffer[MesosDriverDescription] = {\n    val newBuffer = new ArrayBuffer[MesosDriverDescription](buffer.size)\n    buffer.copyToBuffer(newBuffer)"
  },
  {
    "id" : "f494278d-ee01-4c44-810d-cb81bfecccd8",
    "prId" : 30352,
    "prUrl" : "https://github.com/apache/spark/pull/30352#pullrequestreview-530849380",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "825f1fef-0758-494e-93c7-7bf2df92610a",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Could you describe a little bit more about the reason why you change this function? The old logic looks identical to me.",
        "createdAt" : "2020-11-15T19:08:10Z",
        "updatedAt" : "2020-11-16T22:47:41Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "2dac2602-5bb1-4e4e-984a-098b8b462f46",
        "parentId" : "825f1fef-0758-494e-93c7-7bf2df92610a",
        "authorId" : "205932d6-0a11-458f-aa30-d2268a8961f7",
        "body" : "You are right: this is exactly the same logic! But the old implementation could not be kept that way due to the `queuedDrivers` collection whose type has changed from `ArrayBuffer` to `mutable.TreeSet`. In a `mutable.TreeSet`, you can remove an element by specifying the actual element, but you can't remove an element by its index.",
        "createdAt" : "2020-11-15T23:40:47Z",
        "updatedAt" : "2020-11-16T22:47:41Z",
        "lastEditedBy" : "205932d6-0a11-458f-aa30-d2268a8961f7",
        "tags" : [
        ]
      }
    ],
    "commit" : "72e396692c4018571330eee3ecdfd7ee28cc57df",
    "line" : 67,
    "diffHunk" : "@@ -1,1 +852,856 @@      status: Int): Unit = {}\n\n  private def removeFromQueuedDrivers(subId: String): Boolean = {\n    val matchOption = queuedDrivers.find(_.submissionId == subId)\n    if (matchOption.isEmpty) {"
  },
  {
    "id" : "7ff36aae-b3dc-444e-9090-43eaa89bc9f1",
    "prId" : 30352,
    "prUrl" : "https://github.com/apache/spark/pull/30352#pullrequestreview-531855231",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d0734d42-49bf-48d4-9b42-58e94f693c5d",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "What happens for the users' misconfiguration like non-numeric value? I'm wondering about the failure case for `toFloat`.",
        "createdAt" : "2020-11-16T18:24:55Z",
        "updatedAt" : "2020-11-16T22:47:41Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "3b5a5f06-834b-4466-90d0-b608e61174d6",
        "parentId" : "d0734d42-49bf-48d4-9b42-58e94f693c5d",
        "authorId" : "205932d6-0a11-458f-aa30-d2268a8961f7",
        "body" : "A `NumberFormatException` is thrown like following:\r\n\r\n```\r\njava.lang.NumberFormatException: For input string: \"abc\"\r\n\tat sun.misc.FloatingDecimal.readJavaFormatString(FloatingDecimal.java:2043)\r\n\tat sun.misc.FloatingDecimal.parseFloat(FloatingDecimal.java:122)\r\n\tat java.lang.Float.parseFloat(Float.java:451)\r\n\tat scala.collection.immutable.StringLike.toFloat(StringLike.scala:315)\r\n...\r\n```\r\n\r\nI added a test case that ensures that a `NumberFormatException` is well thrown.",
        "createdAt" : "2020-11-16T22:51:23Z",
        "updatedAt" : "2020-11-16T22:51:23Z",
        "lastEditedBy" : "205932d6-0a11-458f-aa30-d2268a8961f7",
        "tags" : [
        ]
      }
    ],
    "commit" : "72e396692c4018571330eee3ecdfd7ee28cc57df",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +134,138 @@  private val maxRetryWaitTime = conf.get(config.CLUSTER_RETRY_WAIT_MAX_SECONDS)\n  private val queues: immutable.Map[String, Float] =\n    conf.getAllWithPrefix(\"spark.mesos.dispatcher.queue.\").map(t => (t._1, t._2.toFloat)).toMap\n  private val schedulerState = engineFactory.createEngine(\"scheduler\")\n  private val stateLock = new Object()"
  },
  {
    "id" : "2b4b6645-95e6-4321-ac7f-d34a02bbb9eb",
    "prId" : 30352,
    "prUrl" : "https://github.com/apache/spark/pull/30352#pullrequestreview-531850323",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "acade9a2-4a7a-4743-87c5-ae5ba922fdb0",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "~Do we have a test case for this `NoSuchElementException`?~\r\nNever mind. I found here, https://github.com/apache/spark/pull/30352/files#diff-4cacb8999398615a7e9fe82d96fabc3764ee69168dbf98e148fbd91818eb9a99R623 .",
        "createdAt" : "2020-11-16T18:27:37Z",
        "updatedAt" : "2020-11-16T22:47:41Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "3d3794f8-a01a-4a7f-a372-3fac592671b5",
        "parentId" : "acade9a2-4a7a-4743-87c5-ae5ba922fdb0",
        "authorId" : "205932d6-0a11-458f-aa30-d2268a8961f7",
        "body" : ":+1: ",
        "createdAt" : "2020-11-16T22:48:46Z",
        "updatedAt" : "2020-11-16T22:48:46Z",
        "lastEditedBy" : "205932d6-0a11-458f-aa30-d2268a8961f7",
        "tags" : [
        ]
      }
    ],
    "commit" : "72e396692c4018571330eee3ecdfd7ee28cc57df",
    "line" : 46,
    "diffHunk" : "@@ -1,1 +394,398 @@    val queueName = desc.conf.get(\"spark.mesos.dispatcher.queue\", defaultQueueName)\n    if (queueName != defaultQueueName) {\n      queues.getOrElse(queueName, throw new NoSuchElementException(queueName))\n    } else {\n      0.0f"
  }
]