[
  {
    "id" : "144d81cf-0da6-4b77-a7e3-92bb2e1c163f",
    "prId" : 30282,
    "prUrl" : "https://github.com/apache/spark/pull/30282#pullrequestreview-525876156",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c2e13ae1-12eb-4cb4-a4fa-0237c1a6bdab",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "You can provide zip files in pyFiles or via `spark.submit.pyFiles` configuration.",
        "createdAt" : "2020-11-08T11:39:47Z",
        "updatedAt" : "2020-11-08T11:39:47Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "5a1a31cf-298b-432c-b109-aced3fe7e991",
        "parentId" : "c2e13ae1-12eb-4cb4-a4fa-0237c1a6bdab",
        "authorId" : "cf8c9534-0cf3-4aad-8ead-54c363cfa86e",
        "body" : "I tried to use --py-files, but it has path and resources like below:\r\n```\r\nPYTHONPATH -> {{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.7-src.zip<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip\r\n\r\nresources:\r\n    __spark_conf__ -> resource { scheme: \"hdfs\" host: \"MTPrime-CO4-fed\" port: -1 file: \"/user/zhonzh/.sparkStaging/application_1604622164128_7216/__spark_conf__.zip\" } size: 536359 timestamp: 1604858318432 type: ARCHIVE visibility: PRIVATE\r\n    pyspark.zip -> resource { scheme: \"hdfs\" host: \"MTPrime-CO4-fed\" port: -1 file: \"/user/zhonzh/.sparkStaging/application_1604622164128_7216/pyspark.zip\" } size: 595809 timestamp: 1604858311600 type: FILE visibility: PUBLIC\r\n    py4j-0.10.9-src.zip -> resource { scheme: \"hdfs\" host: \"MTPrime-CO4-fed\" port: -1 file: \"/user/zhonzh/.sparkStaging/application_1604622164128_7216/py4j-0.10.9-src.zip\" } size: 41587 timestamp: 1604858316398 type: FILE visibility: PUBLIC\r\n    __spark_libs__ -> resource { scheme: \"hdfs\" host: \"MTPrime-CO4-fed\" port: -1 file: \"/user/zhonzh/.sparkStaging/application_1604622164128_7216/spark-3.0.1-mt-jars.zip\" } size: 197891674 timestamp: 1604858291631 type: ARCHIVE visibility: PUBLIC\r\n    py4j-0.10.7-src.zip -> resource { scheme: \"hdfs\" host: \"MTPrime-CO4-fed\" port: -1 file: \"/user/zhonzh/.sparkStaging/application_1604622164128_7216/py4j-0.10.7-src.zip\" } size: 42437 timestamp: 1604858314170 type: FILE visibility: PUBLIC\r\n```\r\n\r\nI used `--py-files \"hdfs://MTPrime-CO4-0/user/zhonzh/pyspark.zip,hdfs://MTPrime-CO4-0/user/zhonzh/py4j-0.10.9-src.zip\"`. This is from spark3 while local python lib is spark 2.4.\r\n\r\nWe have 2 issues here:\r\n\r\n1. Local pyspark.zip is added first, it take precedence. This cause passed by pyFiles not working.\r\n2. If I use same name as pyspark.zip, the upload will be skipped as both have same name.\r\n\r\nWhat's your suggestions to handle this?\r\n",
        "createdAt" : "2020-11-08T18:20:06Z",
        "updatedAt" : "2020-11-08T18:20:07Z",
        "lastEditedBy" : "cf8c9534-0cf3-4aad-8ead-54c363cfa86e",
        "tags" : [
        ]
      },
      {
        "id" : "2462abe3-6656-469d-906a-efd838925018",
        "parentId" : "c2e13ae1-12eb-4cb4-a4fa-0237c1a6bdab",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "I don't think Spark is supposed to work with other py4j and pyspark.zip. They are built-in for each release.",
        "createdAt" : "2020-11-09T01:38:17Z",
        "updatedAt" : "2020-11-09T01:38:18Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "545dab707de0138d216f812ef4eaa9925de4c573",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +132,136 @@\n  private[spark] val SPARK_PYSPARK_ARCHIVE = ConfigBuilder(\"spark.yarn.pyspark.archives\")\n    .doc(\"Location of pyspark.zip and py4j.zip.\")\n    .version(\"3.0.1\")\n    .stringConf"
  }
]