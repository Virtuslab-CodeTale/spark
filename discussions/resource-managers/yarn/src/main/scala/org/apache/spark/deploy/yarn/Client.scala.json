[
  {
    "id" : "913ffe8f-6847-4f01-9869-a737549ed9bd",
    "prId" : 31591,
    "prUrl" : "https://github.com/apache/spark/pull/31591#pullrequestreview-636017642",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "33289098-ea5b-4e7f-84c0-7a3176a8e8fa",
        "parentId" : null,
        "authorId" : "ddb80038-2da6-4937-8c45-4d52fbe0300f",
        "body" : " This block of code (and the IllegalArgumentException below) -- convert to URI, check scheme, throw if bad scheme, assert on file existence -- is duplicated between `SparkSubmit` and `Client`. Can we put a method like `getIvySettingsFile` into `SparkSubmit` which is leveraged in both places?\n \n Not too big of a duplication so if it can't be done cleanly no worries from my end.",
        "createdAt" : "2021-04-14T15:22:32Z",
        "updatedAt" : "2021-04-14T19:33:26Z",
        "lastEditedBy" : "ddb80038-2da6-4937-8c45-4d52fbe0300f",
        "tags" : [
        ]
      },
      {
        "id" : "b5629ae5-3c14-4522-acea-879ebdabccd7",
        "parentId" : "33289098-ea5b-4e7f-84c0-7a3176a8e8fa",
        "authorId" : "a9818936-8272-4717-aeaf-31025433b84d",
        "body" : "The assertions of file existence are slightly different in both places. In YarnClient we would want to make this assertion only for the `file` scheme before we process it, however in `SparkSubmit` we would make to make the assertion for all schemes after the appropriate download steps. E.g. for `local` scheme too we would want to validate that the final file that `loadIvySettings` will process does exist.\r\nOnce we add handling for `local` and `hdfs` schemes, the functions in both classes will differ even more. So I think it is okay to have duplication here.",
        "createdAt" : "2021-04-14T19:41:58Z",
        "updatedAt" : "2021-04-14T21:35:10Z",
        "lastEditedBy" : "a9818936-8272-4717-aeaf-31025433b84d",
        "tags" : [
        ]
      },
      {
        "id" : "79e6bdf5-9636-42b3-9452-ef03b38fdbea",
        "parentId" : "33289098-ea5b-4e7f-84c0-7a3176a8e8fa",
        "authorId" : "ddb80038-2da6-4937-8c45-4d52fbe0300f",
        "body" : "SGTM thanks!",
        "createdAt" : "2021-04-14T19:44:20Z",
        "updatedAt" : "2021-04-14T19:44:21Z",
        "lastEditedBy" : "ddb80038-2da6-4937-8c45-4d52fbe0300f",
        "tags" : [
        ]
      }
    ],
    "commit" : "fd3ddb2bd60fd34e605479eb07c2d7021f3c44e0",
    "line" : 32,
    "diffHunk" : "@@ -1,1 +531,535 @@            require(ivySettingsFile.isFile(), s\"Ivy settings file $ivySettingsFile is not a\" +\n              \"normal file\")\n            // Generate a file name that can be used for the ivySettings file, that does not\n            // conflict with any user file.\n            val localizedFileName = Some(ivySettingsFile.getName() + \"-\" +"
  }
]