[
  {
    "id" : "25839e1b-dd1f-41a9-97f7-82e897b1f0e6",
    "prId" : 28972,
    "prUrl" : "https://github.com/apache/spark/pull/28972#pullrequestreview-444765170",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "79122496-f90f-401b-add1-89c2b294144c",
        "parentId" : null,
        "authorId" : "bea80117-7be3-4703-8d54-02b7bf73632c",
        "body" : "these functions are almost identical. Lets create a helper function checkOffHeapEnabled that has the core logic and just pass in size we want...\r\n\r\ndef executorOffHeapMemorySizeAsMb(sparkConf: SparkConf,  execRequest: ExecutorResourceRequest): Long = {\r\n   checkOffHeapEnabled(sparkConf, execRequest.amount).toLong\r\n\r\nThe version above would call with checkOffHeapEnabled(sparkConf, Utils.memoryStringToMb(sparkConf.get(MEMORY_OFFHEAP_SIZE).toString))",
        "createdAt" : "2020-07-08T13:46:01Z",
        "updatedAt" : "2020-07-23T21:54:32Z",
        "lastEditedBy" : "bea80117-7be3-4703-8d54-02b7bf73632c",
        "tags" : [
        ]
      }
    ],
    "commit" : "e25dafbac32534eaa998b00da98d4e90114a2c64",
    "line" : 20,
    "diffHunk" : "@@ -1,1 +197,201 @@   * return 0 if MEMORY_OFFHEAP_ENABLED is false.\n   */\n  def executorOffHeapMemorySizeAsMb(sparkConf: SparkConf,\n    execRequest: ExecutorResourceRequest): Long = {\n    checkOffHeapEnabled(sparkConf, execRequest.amount)"
  }
]