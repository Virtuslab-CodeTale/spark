[
  {
    "id" : "b283bf03-8742-47f2-bb31-02005b473f08",
    "prId" : 25007,
    "prUrl" : "https://github.com/apache/spark/pull/25007#pullrequestreview-267990555",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "e44565a6-f79a-4c76-8051-e00ddfce7b7c",
        "parentId" : null,
        "authorId" : "c52c39ef-2b7f-4855-a2f1-2a2e50a719ae",
        "body" : "Feel a little uncomfortable to return internal field \"partStream\" to outside of this class. Is it possible to modify the design here to avoid returning internal field?",
        "createdAt" : "2019-07-29T18:30:15Z",
        "updatedAt" : "2019-07-30T18:18:02Z",
        "lastEditedBy" : "c52c39ef-2b7f-4855-a2f1-2a2e50a719ae",
        "tags" : [
        ]
      },
      {
        "id" : "4e47221c-d206-4141-8df0-d341b9f0dace",
        "parentId" : "e44565a6-f79a-4c76-8051-e00ddfce7b7c",
        "authorId" : "806aa501-9ea7-4cec-b017-a84d9a1602d8",
        "body" : "The idea is that we want to share the stream across all partition writes in this implementation. I think returning the internal field represents that paradigm properly.",
        "createdAt" : "2019-07-29T19:26:33Z",
        "updatedAt" : "2019-07-30T18:18:02Z",
        "lastEditedBy" : "806aa501-9ea7-4cec-b017-a84d9a1602d8",
        "tags" : [
        ]
      }
    ],
    "commit" : "7dceec971784049442ec3d4cb71ddaa225e1e21f",
    "line" : 164,
    "diffHunk" : "@@ -1,1 +162,166 @@        partStream = new PartitionWriterStream(partitionId);\n      }\n      return partStream;\n    }\n"
  },
  {
    "id" : "e7c64a9f-9963-4c32-82c4-49951fc8761a",
    "prId" : 25007,
    "prUrl" : "https://github.com/apache/spark/pull/25007#pullrequestreview-267994358",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b88779cf-5c89-4a19-826c-46f1c8b587af",
        "parentId" : null,
        "authorId" : "c52c39ef-2b7f-4855-a2f1-2a2e50a719ae",
        "body" : "This method looks a little risky. Its name is called getPartitionWriter, but it actually modifies this class's internal state. People need to call getPartitionWriter and finish writing for that partition before call getPartitionWriter again. This may cause confusion to user and may be misused as well.",
        "createdAt" : "2019-07-29T18:44:14Z",
        "updatedAt" : "2019-07-30T18:18:02Z",
        "lastEditedBy" : "c52c39ef-2b7f-4855-a2f1-2a2e50a719ae",
        "tags" : [
        ]
      },
      {
        "id" : "2a659961-6643-4780-a1bf-f6d46fa6869e",
        "parentId" : "b88779cf-5c89-4a19-826c-46f1c8b587af",
        "authorId" : "806aa501-9ea7-4cec-b017-a84d9a1602d8",
        "body" : "I think we can clarify the documentation here, but that behavior is supposed to be part of the contract for these APIs, to remain consistent with the sort shuffle algorithm.",
        "createdAt" : "2019-07-29T19:33:56Z",
        "updatedAt" : "2019-07-30T18:18:02Z",
        "lastEditedBy" : "806aa501-9ea7-4cec-b017-a84d9a1602d8",
        "tags" : [
        ]
      }
    ],
    "commit" : "7dceec971784049442ec3d4cb71ddaa225e1e21f",
    "line" : 82,
    "diffHunk" : "@@ -1,1 +80,84 @@\n  @Override\n  public ShufflePartitionWriter getPartitionWriter(int reducePartitionId) throws IOException {\n    if (reducePartitionId <= lastPartitionId) {\n      throw new IllegalArgumentException(\"Partitions should be requested in increasing order.\");"
  }
]