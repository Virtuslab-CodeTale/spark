[
  {
    "id" : "e991fd2d-5d69-482a-97d1-b9e5d47be6cc",
    "prId" : 28618,
    "prUrl" : "https://github.com/apache/spark/pull/28618#pullrequestreview-435427477",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "50ce9f05-6a1e-4f39-9d8b-568bc1b531d0",
        "parentId" : null,
        "authorId" : "123cc67f-f678-49be-8742-95bc35d8c5c4",
        "body" : "As these lines are repeating you could extract them into a new `def`, like:\r\n\r\n```scala\r\n  protected void setTaskResult(MapOutputCommitMessage mapOutputCommitMessage) {\r\n    taskResult = new MapTaskResult(\r\n        MapStatus$.MODULE$.apply(\r\n            blockManager.shuffleServerId(),\r\n            mapOutputCommitMessage.getPartitionLengths(),\r\n            mapId),\r\n        OptionConverters.toScala(mapOutputCommitMessage.getMapOutputMetadata()));\r\n  }\r\n```\r\n\r\nWith the help of this new `def` and Mockito's spy you can even get rid of the  storing the `mapOutputCommitMessage` for testing purposes only but it has a price (this class cannot be final) for details you can check:\r\nhttps://github.com/attilapiros/spark/commit/f4578a31beccca58e8b55120847db014a30159d6\r\n",
        "createdAt" : "2020-06-15T19:55:31Z",
        "updatedAt" : "2020-10-17T18:44:19Z",
        "lastEditedBy" : "123cc67f-f678-49be-8742-95bc35d8c5c4",
        "tags" : [
        ]
      },
      {
        "id" : "1d1adc67-8850-43c0-ae11-4d88eca631bd",
        "parentId" : "50ce9f05-6a1e-4f39-9d8b-568bc1b531d0",
        "authorId" : "806aa501-9ea7-4cec-b017-a84d9a1602d8",
        "body" : "Ack - didn't address this in my latest patch but will get around to this",
        "createdAt" : "2020-06-23T04:16:11Z",
        "updatedAt" : "2020-10-17T18:44:19Z",
        "lastEditedBy" : "806aa501-9ea7-4cec-b017-a84d9a1602d8",
        "tags" : [
        ]
      }
    ],
    "commit" : "f69cba7d0632e7b260e38a0aa16cf560bd0d94cc",
    "line" : 47,
    "diffHunk" : "@@ -1,1 +134,138 @@      if (!records.hasNext()) {\n        mapOutputCommitMessage = mapOutputWriter.commitAllPartitions();\n        taskResult = new MapTaskResult(\n            MapStatus$.MODULE$.apply(\n                blockManager.shuffleServerId(),"
  }
]