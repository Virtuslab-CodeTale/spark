[
  {
    "id" : "ebc403a3-a1fa-421e-a25b-081996cebf84",
    "prId" : 30552,
    "prUrl" : "https://github.com/apache/spark/pull/30552#pullrequestreview-541987898",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "fb973356-f7b0-4502-8585-7a3ccbcd0cfb",
        "parentId" : null,
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "toString() is unnecesary here BTW.\r\nSo this relies on query already being escaped. That may be fine for the logic of this code, although in another world it would have been better to let this method take unescaped query strings and manage it here.",
        "createdAt" : "2020-12-01T14:42:40Z",
        "updatedAt" : "2020-12-01T14:42:41Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "d829c104-3922-4be4-93d0-f6049deee700",
        "parentId" : "fb973356-f7b0-4502-8585-7a3ccbcd0cfb",
        "authorId" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "body" : "Thanks for the suggestion, Sean.\r\n> toString() is unnecesary here BTW.\r\n\r\n`uri` is `StringBuilder` here. The original code also use toString().\r\n\r\n> So this relies on query already being escaped. That may be fine for the logic of this code, although in another world it would have been better to let this method take unescaped query strings and manage it here.\r\n\r\nThe query string here should be encoded already.  I am not very familiar with this topic. Is there any better solution to handle both escaped/unescaped query string?",
        "createdAt" : "2020-12-01T14:56:45Z",
        "updatedAt" : "2020-12-01T14:56:45Z",
        "lastEditedBy" : "15acce7d-132b-48c9-894b-9bc3f4c2b09d",
        "tags" : [
        ]
      },
      {
        "id" : "fcff36e7-a1b9-4aff-a29b-bd84cdd2f305",
        "parentId" : "fb973356-f7b0-4502-8585-7a3ccbcd0cfb",
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "Oh right, OK, ignore the toString() comment.\r\nI just mean that semantically, encoding is a URI detail. The program should probably not worry about it except when going to and from URIs. But that's not how this code is structured. It clearly already expects and escaped string as argument, which then means callers have to deal with it. But, I don't think it's necessary to change. If it is escaped then yes this is a fix.",
        "createdAt" : "2020-12-01T15:01:32Z",
        "updatedAt" : "2020-12-01T15:01:32Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      }
    ],
    "commit" : "b34c0a5f1d18581ab71d38ac023a79fcc7378583",
    "line" : 20,
    "diffHunk" : "@@ -1,1 +408,412 @@    }\n    // SPARK-33611: use method `URI.create` to avoid percent-encoding twice on the query string.\n    URI.create(uri.toString() + queryString).normalize()\n  }\n"
  }
]