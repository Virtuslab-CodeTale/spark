[
  {
    "id" : "c59bff0f-07ab-4ae4-a1ef-748ebce20498",
    "prId" : 33731,
    "prUrl" : "https://github.com/apache/spark/pull/33731#pullrequestreview-729186523",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3c4d3e18-e4b9-49e8-a8f2-374af19273a6",
        "parentId" : null,
        "authorId" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "body" : "Ideally, we should handle this in `closeResources` - but it is fine here as well, given this is not `close` but `manualClose` and we control the semantics of it :-)",
        "createdAt" : "2021-08-13T01:04:45Z",
        "updatedAt" : "2021-08-13T01:04:45Z",
        "lastEditedBy" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "tags" : [
        ]
      }
    ],
    "commit" : "49216a2262ddff76252fed56d094478b64305633",
    "line" : 12,
    "diffHunk" : "@@ -1,1 +65,69 @@    }\n\n    def manualClose(): Unit = {\n      try {\n        super.close()"
  },
  {
    "id" : "b37887de-6996-4453-8ce1-105144d2cb4c",
    "prId" : 33267,
    "prUrl" : "https://github.com/apache/spark/pull/33267#pullrequestreview-708016503",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "9bf2ee0a-f7bb-4a30-8a53-ddab856ac387",
        "parentId" : null,
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "Why not keep it as a member function of `DiskBlockObjectWriter` ?",
        "createdAt" : "2021-07-08T14:05:43Z",
        "updatedAt" : "2021-07-08T14:05:43Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      },
      {
        "id" : "e9a11e52-7268-4857-9ee8-9b894a142091",
        "parentId" : "9bf2ee0a-f7bb-4a30-8a53-ddab856ac387",
        "authorId" : "c7afbd1a-ab9f-4878-b837-32685ae783b0",
        "body" : "@Ngone51 That's a good question, but I think it's a little strange for an `OutputStream( DiskBlockObjectWriter extends OutputStream)` to delete itself. \r\n\r\nFor example, `o.a.h.fs.FileSystem` can `create` a `FSDataOutputStream`,  although the `FSDataOutputStream` has the capabilities of `write data` and `close itself`, but we still need to use the `o.a.h.fs.FileSystem` to delete the file.\r\n\r\nOf course, The `java.io.File` API has the ability to delete itself, the `java.io.File` can `createNewFile` and the `File` instance can `delete` itself, but it still needs to be wrap as `FileOutputStream` to write data, and `FileOutputStream` cannot delete itself too.\r\n\r\nAt present, I choose the former because `DiskBlockObjectWriter` is an `OutputStream` rather than a `File` ,  but I also accept it as a member function of `DiskBlockObjectWriter`.\r\n\r\nDo you think `keep it as a member function of DiskBlockObjectWriter` is better?\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
        "createdAt" : "2021-07-09T02:34:55Z",
        "updatedAt" : "2021-07-09T02:47:04Z",
        "lastEditedBy" : "c7afbd1a-ab9f-4878-b837-32685ae783b0",
        "tags" : [
        ]
      },
      {
        "id" : "6d7f3fd8-e28e-418c-940f-cfafa2d9be68",
        "parentId" : "9bf2ee0a-f7bb-4a30-8a53-ddab856ac387",
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "Ok, I got your point. Make sense to me.\r\n\r\nBut, to be honest, I think the usage of the helper method `deleteAbnormalDiskBlockObjectFile` is less straightforward compares to the current one.\r\n\r\n",
        "createdAt" : "2021-07-15T15:22:49Z",
        "updatedAt" : "2021-07-15T15:22:50Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      },
      {
        "id" : "3720cfa3-18db-4b4d-b88b-5fe4b0a0d223",
        "parentId" : "9bf2ee0a-f7bb-4a30-8a53-ddab856ac387",
        "authorId" : "c7afbd1a-ab9f-4878-b837-32685ae783b0",
        "body" : "Got it ~  I will close this pr",
        "createdAt" : "2021-07-16T05:23:28Z",
        "updatedAt" : "2021-07-16T05:23:28Z",
        "lastEditedBy" : "c7afbd1a-ab9f-4878-b837-32685ae783b0",
        "tags" : [
        ]
      }
    ],
    "commit" : "fc14fb8b3b9ae0d2a6aa8cdc89ac611f6e3f922d",
    "line" : 11,
    "diffHunk" : "@@ -1,1 +296,300 @@   * DiskBlockObjectWriter.\n   */\n  def deleteAbnormalDiskBlockObjectFile(writer: DiskBlockObjectWriter): Unit = {\n    val file = writer.revertPartialWritesAndClose()\n    if (file.exists()) {"
  }
]