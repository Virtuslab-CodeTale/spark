[
  {
    "id" : "2183d6d9-1793-46c9-ac00-fb7e83abe255",
    "prId" : 33020,
    "prUrl" : "https://github.com/apache/spark/pull/33020#pullrequestreview-690541966",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7ccaac81-41b7-4fb8-b6e9-ce479404b367",
        "parentId" : null,
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "Seems like we never clear the key after this change. Could you add some comments (maybe here) to explain?",
        "createdAt" : "2021-06-23T04:12:46Z",
        "updatedAt" : "2021-06-23T04:12:46Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      },
      {
        "id" : "5f3c65fa-9403-4b69-926e-78bf8103fca5",
        "parentId" : "7ccaac81-41b7-4fb8-b6e9-ce479404b367",
        "authorId" : "123cc67f-f678-49be-8742-95bc35d8c5c4",
        "body" : "done",
        "createdAt" : "2021-06-23T11:44:45Z",
        "updatedAt" : "2021-06-23T11:44:45Z",
        "lastEditedBy" : "123cc67f-f678-49be-8742-95bc35d8c5c4",
        "tags" : [
        ]
      }
    ],
    "commit" : "9d8d35712228e886ea27d72da4139f5c18285f0b",
    "line" : 31,
    "diffHunk" : "@@ -1,1 +570,574 @@          // BlockStatusPerBlockId releases the backing HashMap.\n          val externalShuffleServiceBlocks = blockStatusByShuffleService\n            .getOrElseUpdate(externalShuffleServiceIdOnHost(id), new BlockStatusPerBlockId)\n          Some(externalShuffleServiceBlocks)\n        } else {"
  },
  {
    "id" : "59916ba8-6057-4ab8-a4cf-f1a4c30a0c72",
    "prId" : 32790,
    "prUrl" : "https://github.com/apache/spark/pull/32790#pullrequestreview-676765544",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "b23e83c7-6d8f-4b67-99b2-eb5d2b017cdb",
        "parentId" : null,
        "authorId" : "123cc67f-f678-49be-8742-95bc35d8c5c4",
        "body" : "After this PR `blockStatusByShuffleService.get(bmId)` can be `None` and even when it has some value for the key then even `m.get(blockId)` can be `null` as `m` is a Java `HashMap`. ",
        "createdAt" : "2021-06-05T09:22:42Z",
        "updatedAt" : "2021-06-05T09:22:55Z",
        "lastEditedBy" : "123cc67f-f678-49be-8742-95bc35d8c5c4",
        "tags" : [
        ]
      }
    ],
    "commit" : "6de20f10ca60c778db25ba3d5975f85e5c23aedb",
    "line" : 29,
    "diffHunk" : "@@ -1,1 +672,676 @@    val status = locations.headOption.flatMap { bmId =>\n      if (externalShuffleServiceRddFetchEnabled && bmId.port == externalShuffleServicePort) {\n        blockStatusByShuffleService.get(bmId).flatMap(m => Option(m.get(blockId)))\n      } else {\n        aliveBlockManagerInfo(bmId).flatMap(_.getStatus(blockId))"
  },
  {
    "id" : "e0aa7dc4-a407-4e7e-b030-6716e8d90266",
    "prId" : 32790,
    "prUrl" : "https://github.com/apache/spark/pull/32790#pullrequestreview-676899781",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "c6babb4d-0755-4b8d-aef7-ba45dc2f8817",
        "parentId" : null,
        "authorId" : "ae55b635-dd0e-41aa-9272-372de9a35f38",
        "body" : "nit: can we add a comment about why we remove it here? (e.g the memory leak) because just reading the code through it might not be super obvious.",
        "createdAt" : "2021-06-06T20:18:53Z",
        "updatedAt" : "2021-06-06T20:21:26Z",
        "lastEditedBy" : "ae55b635-dd0e-41aa-9272-372de9a35f38",
        "tags" : [
        ]
      }
    ],
    "commit" : "6de20f10ca60c778db25ba3d5975f85e5c23aedb",
    "line" : 10,
    "diffHunk" : "@@ -1,1 +281,285 @@            // when all blocks are removed from the block statuses then for this BM Id the whole\n            // blockStatusByShuffleService entry can be removed to avoid leaking memory\n            if (blockStatusForId.isEmpty) {\n              blockStatusByShuffleService.remove(bmIdForShuffleService)\n            }"
  }
]