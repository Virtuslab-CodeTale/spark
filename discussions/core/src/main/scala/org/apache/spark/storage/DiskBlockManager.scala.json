[
  {
    "id" : "0514f17b-54f4-4484-8ffb-aa175d101732",
    "prId" : 32007,
    "prUrl" : "https://github.com/apache/spark/pull/32007#pullrequestreview-624852562",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "8550a836-1b0d-4a7c-910d-b173e1f399fb",
        "parentId" : null,
        "authorId" : "9953a478-bdd8-4f15-be59-f6f654ff85ae",
        "body" : "Nit: extra line",
        "createdAt" : "2021-03-31T03:11:01Z",
        "updatedAt" : "2021-04-17T07:21:32Z",
        "lastEditedBy" : "9953a478-bdd8-4f15-be59-f6f654ff85ae",
        "tags" : [
        ]
      }
    ],
    "commit" : "e630725ca5c161cea62a2afcc7668a67a3e6d72e",
    "line" : 93,
    "diffHunk" : "@@ -1,1 +225,229 @@    }\n  }\n\n  /**\n   * Create a directory that is writable by the group."
  },
  {
    "id" : "b344a3f6-bddd-498c-af80-6ac33a5a8926",
    "prId" : 32007,
    "prUrl" : "https://github.com/apache/spark/pull/32007#pullrequestreview-670483609",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "a53a7b55-c447-4877-95aa-0f15d6937e54",
        "parentId" : null,
        "authorId" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "body" : "Why not populate this as result of `createLocalDirsForMergedShuffleBlocks` ?",
        "createdAt" : "2021-04-06T05:23:38Z",
        "updatedAt" : "2021-04-17T07:21:32Z",
        "lastEditedBy" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "tags" : [
        ]
      },
      {
        "id" : "c63bf6b6-7779-4844-a9b7-4dc75a6f9f18",
        "parentId" : "a53a7b55-c447-4877-95aa-0f15d6937e54",
        "authorId" : "9953a478-bdd8-4f15-be59-f6f654ff85ae",
        "body" : "If this executor is not creating the merged directory, then currently it seems that activeMergedShuffleDirs will be empty. Check line 216. ",
        "createdAt" : "2021-05-27T18:18:56Z",
        "updatedAt" : "2021-05-27T18:54:16Z",
        "lastEditedBy" : "9953a478-bdd8-4f15-be59-f6f654ff85ae",
        "tags" : [
        ]
      },
      {
        "id" : "ec1617ba-e270-4fcb-95ff-bc16d030ccd3",
        "parentId" : "a53a7b55-c447-4877-95aa-0f15d6937e54",
        "authorId" : "9953a478-bdd8-4f15-be59-f6f654ff85ae",
        "body" : "BTW this is no longer needed. The dirs are passed to the getMerged... APIs.",
        "createdAt" : "2021-05-27T18:29:12Z",
        "updatedAt" : "2021-05-27T18:54:16Z",
        "lastEditedBy" : "9953a478-bdd8-4f15-be59-f6f654ff85ae",
        "tags" : [
        ]
      }
    ],
    "commit" : "e630725ca5c161cea62a2afcc7668a67a3e6d72e",
    "line" : 15,
    "diffHunk" : "@@ -1,1 +60,64 @@  // Create merge directories\n  createLocalDirsForMergedShuffleBlocks()\n\n  private val shutdownHook = addShutdownHook()\n"
  },
  {
    "id" : "850e6dbf-5ffd-4423-a10f-e7635aacbcd6",
    "prId" : 32007,
    "prUrl" : "https://github.com/apache/spark/pull/32007#pullrequestreview-628573126",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "72a1f2c8-8e3c-4b2b-880a-8dcc5ebd65d0",
        "parentId" : null,
        "authorId" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "body" : "Some and None are not required after change to `foreach`",
        "createdAt" : "2021-04-06T05:27:18Z",
        "updatedAt" : "2021-04-17T07:21:32Z",
        "lastEditedBy" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "tags" : [
        ]
      }
    ],
    "commit" : "e630725ca5c161cea62a2afcc7668a67a3e6d72e",
    "line" : 89,
    "diffHunk" : "@@ -1,1 +221,225 @@            logError(\n              s\"Failed to create $MERGE_MANAGER_DIR dir in $rootDir. Ignoring this directory.\", e)\n        }\n      }\n    }"
  },
  {
    "id" : "6292eca8-5b82-4ea2-ad3a-20c3565e177c",
    "prId" : 29378,
    "prUrl" : "https://github.com/apache/spark/pull/29378#pullrequestreview-463944430",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "472629e5-767d-4eb0-90e0-4249c428a9d9",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "@LantaoJin . This comment reminds me that we need to handle `ExecutorDiskUtils` properly. Do we need to update `ExecutorDiskUtils.getFile`? Or, do we need to remove this comment?",
        "createdAt" : "2020-08-10T02:52:38Z",
        "updatedAt" : "2020-08-14T06:59:24Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "ab828200-59ea-465a-8bb5-cc4550f7de3c",
        "parentId" : "472629e5-767d-4eb0-90e0-4249c428a9d9",
        "authorId" : "0223d15f-93d2-46b2-bee2-7f40fcd0335a",
        "body" : "No. I didn't change any behaviour for non-temp files. This `ExecutorDiskUtils.getFile` is handing the non-temp files such as start with \"shuffle_\", \"rdd_\". So it should still be kept in sync with `DiskBlockManager.getFile`.",
        "createdAt" : "2020-08-10T03:09:25Z",
        "updatedAt" : "2020-08-14T06:59:24Z",
        "lastEditedBy" : "0223d15f-93d2-46b2-bee2-7f40fcd0335a",
        "tags" : [
        ]
      },
      {
        "id" : "283b58af-2826-4bf1-ac5f-e102c95faaab",
        "parentId" : "472629e5-767d-4eb0-90e0-4249c428a9d9",
        "authorId" : "0223d15f-93d2-46b2-bee2-7f40fcd0335a",
        "body" : "You can see the method body is not changed. Just change the signature from `def getFile(filename: String): File` to `private def getFile(localDirs: Array[File], subDirs: Array[Array[File]], subDirsPerLocalDir: Int, filename: String): File`",
        "createdAt" : "2020-08-10T03:12:23Z",
        "updatedAt" : "2020-08-14T06:59:24Z",
        "lastEditedBy" : "0223d15f-93d2-46b2-bee2-7f40fcd0335a",
        "tags" : [
        ]
      },
      {
        "id" : "77be7a7a-d613-4ccb-a43b-94c56e01001a",
        "parentId" : "472629e5-767d-4eb0-90e0-4249c428a9d9",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Why does this function need to have unused parameters? Maybe, I'm still confused with this frame change.",
        "createdAt" : "2020-08-10T03:19:08Z",
        "updatedAt" : "2020-08-14T06:59:24Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "b90157ca-5da1-4e22-918a-fb1b0178bb34",
        "parentId" : "472629e5-767d-4eb0-90e0-4249c428a9d9",
        "authorId" : "0223d15f-93d2-46b2-bee2-7f40fcd0335a",
        "body" : "```scala\r\n  def getFile(blockId: BlockId): File = {\r\n    if (containerDirEnabled && blockId.isTemp) {\r\n      getFile(containerDirs, subContainerDirs, subDirsPerLocalDir, blockId.name)\r\n    } else {\r\n      getFile(localDirs, subDirs, subDirsPerLocalDir, blockId.name)\r\n    }\r\n  }\r\n```\r\nNow we just storage temp files and non-temp files to different root paths. The algorithm how to find a file doesn't change.",
        "createdAt" : "2020-08-10T03:21:45Z",
        "updatedAt" : "2020-08-14T06:59:24Z",
        "lastEditedBy" : "0223d15f-93d2-46b2-bee2-7f40fcd0335a",
        "tags" : [
        ]
      },
      {
        "id" : "c19c9278-ce8f-4433-8f16-ad79bea6d451",
        "parentId" : "472629e5-767d-4eb0-90e0-4249c428a9d9",
        "authorId" : "0223d15f-93d2-46b2-bee2-7f40fcd0335a",
        "body" : "> Why does this function need to have unused parameters?\r\n\r\nWhich parameters?",
        "createdAt" : "2020-08-10T03:23:33Z",
        "updatedAt" : "2020-08-14T06:59:24Z",
        "lastEditedBy" : "0223d15f-93d2-46b2-bee2-7f40fcd0335a",
        "tags" : [
        ]
      },
      {
        "id" : "af5891a8-83ab-45a3-aa62-6700a60518e9",
        "parentId" : "472629e5-767d-4eb0-90e0-4249c428a9d9",
        "authorId" : "0223d15f-93d2-46b2-bee2-7f40fcd0335a",
        "body" : "> Why does this function need to have unused parameters?\r\n\r\nAh, you must mean the `getFile` in `DiskBlockManager` has 4 parameters and `getFile` in `ExecutorDiskUtils` has 3 parameters. ExecutorDiskUtils is a utility, so 3 parameters can define a file path structure. The parameter `subDirs` in `DiskBlockManager` only is a local variable which used in other parts. It does not impact the finding algorithm result. I can use 3 parameters in `DiskBlockManager.getFile` as well. But I need to use different array by a condition, Like:\r\n```scala\r\nprivate def getFile(localDirs: Array[File],  subDirsPerLocalDir: Int, filename: String): File = {\r\n...\r\n    val properSubDirs = if (someConditions) {\r\n      subDirs\r\n    } else {\r\n      subContainerDirs\r\n    }\r\n    val old = properSubDirs(dirId)(subDirId)\r\n...\r\n```\r\nBut the `someConditions` is a little hard to determine in this method.\r\n",
        "createdAt" : "2020-08-10T03:34:39Z",
        "updatedAt" : "2020-08-14T06:59:24Z",
        "lastEditedBy" : "0223d15f-93d2-46b2-bee2-7f40fcd0335a",
        "tags" : [
        ]
      },
      {
        "id" : "b2598b48-eda3-4dea-a079-cda54f1635ea",
        "parentId" : "472629e5-767d-4eb0-90e0-4249c428a9d9",
        "authorId" : "0223d15f-93d2-46b2-bee2-7f40fcd0335a",
        "body" : "So the `getFile` in `DiskBlockManager` has 4 parameters:\r\n```scala\r\nprivate def getFile(localDirs: Array[File], subDirs: Array[Array[File]],\r\n      subDirsPerLocalDir: Int, filename: String): File\r\n```",
        "createdAt" : "2020-08-10T03:42:33Z",
        "updatedAt" : "2020-08-14T06:59:24Z",
        "lastEditedBy" : "0223d15f-93d2-46b2-bee2-7f40fcd0335a",
        "tags" : [
        ]
      },
      {
        "id" : "835a2765-8971-45ff-8b99-6ada1440eb36",
        "parentId" : "472629e5-767d-4eb0-90e0-4249c428a9d9",
        "authorId" : "0223d15f-93d2-46b2-bee2-7f40fcd0335a",
        "body" : "I think we don't need to pay more attention on how parameters in `getFile`. Before this PR. There was only 1 parameter `filename: String` in DiskBlockManager and 3 parameters in `ExecutorDiskUtils`.",
        "createdAt" : "2020-08-10T03:45:20Z",
        "updatedAt" : "2020-08-14T06:59:24Z",
        "lastEditedBy" : "0223d15f-93d2-46b2-bee2-7f40fcd0335a",
        "tags" : [
        ]
      }
    ],
    "commit" : "3520e339e2a9a8daf256ab1396fef9cf85a16354",
    "line" : 46,
    "diffHunk" : "@@ -1,1 +73,77 @@\n  // This method should be kept in sync with\n  // org.apache.spark.network.shuffle.ExecutorDiskUtils#getFile().\n  private def getFile(localDirs: Array[File], subDirs: Array[Array[File]],\n      subDirsPerLocalDir: Int, filename: String): File = {"
  }
]