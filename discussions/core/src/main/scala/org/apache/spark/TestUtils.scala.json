[
  {
    "id" : "ea909968-eb0f-480d-b4a5-52a4bd24ebd8",
    "prId" : 31935,
    "prUrl" : "https://github.com/apache/spark/pull/31935#pullrequestreview-632186087",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "d9f3e984-84e8-43c6-853a-5e9bea15a43a",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Shall we move this to `org.apache.spark.deploy.k8s.integrationtest.Utils` since this aims for `integration tests` and we don't use it in other module? Last time, did you have another use case?",
        "createdAt" : "2021-04-09T04:34:08Z",
        "updatedAt" : "2021-04-09T04:34:08Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "5216900f-f99c-4189-a8c0-ca330ef6809b",
        "parentId" : "d9f3e984-84e8-43c6-853a-5e9bea15a43a",
        "authorId" : "123cc67f-f678-49be-8742-95bc35d8c5c4",
        "body" : "I think this a very useful structure and we could use it even for testing Spark submits better.\r\nSo I would like to leave this here, if it is OK for you.",
        "createdAt" : "2021-04-09T08:47:46Z",
        "updatedAt" : "2021-04-09T08:47:46Z",
        "lastEditedBy" : "123cc67f-f678-49be-8742-95bc35d8c5c4",
        "tags" : [
        ]
      }
    ],
    "commit" : "e6454b007679c0ef9152ae98a7fdabbf07860526",
    "line" : 25,
    "diffHunk" : "@@ -1,1 +370,374 @@  }\n\n  def withHttpServer(resBaseDir: String = \".\")(body: URL => Unit): Unit = {\n    // 0 as port means choosing randomly from the available ports\n    val server = new Server(new InetSocketAddress(Utils.localCanonicalHostName, 0))"
  },
  {
    "id" : "f67d8148-94b8-468e-ab67-e48f63961b93",
    "prId" : 30044,
    "prUrl" : "https://github.com/apache/spark/pull/30044#pullrequestreview-508911426",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "cb7f8303-aca8-4359-add5-985a8c2c271e",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Although this is in `src/main`, this is `TestUtils.isPythonVersionAtLeast38`.",
        "createdAt" : "2020-10-15T03:05:45Z",
        "updatedAt" : "2020-10-15T03:34:33Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "6173980b-fd10-4ac0-9e33-5ef162546368",
        "parentId" : "cb7f8303-aca8-4359-add5-985a8c2c271e",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Quick question: which test in `HiveExternalCatalogVersionsSuite` is related to the PySpark?",
        "createdAt" : "2020-10-15T03:24:11Z",
        "updatedAt" : "2020-10-15T03:34:33Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "1d0cee79-6168-4ba6-854e-f72a4fcfed1c",
        "parentId" : "cb7f8303-aca8-4359-add5-985a8c2c271e",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "It generates `Python script` and submit.",
        "createdAt" : "2020-10-15T03:25:39Z",
        "updatedAt" : "2020-10-15T03:34:33Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "18ca845d-7ea5-4814-9674-6f36e3512ae6",
        "parentId" : "cb7f8303-aca8-4359-add5-985a8c2c271e",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "```scala\r\n  private def prepare(): Unit = {\r\n    val tempPyFile = File.createTempFile(\"test\", \".py\")\r\n    // scalastyle:off line.size.limit\r\n    Files.write(tempPyFile.toPath,\r\n      s\"\"\"\r\n        |from pyspark.sql import SparkSession\r\n        |import os\r\n        |\r\n        |spark = SparkSession.builder.enableHiveSupport().getOrCreate()\r\n        |version_index = spark.conf.get(\"spark.sql.test.version.index\", None)\r\n        |\r\n        |spark.sql(\"create table data_source_tbl_{} using json as select 1 i\".format(version_index))\r\n        |\r\n        |spark.sql(\"create table hive_compatible_data_source_tbl_{} using parquet as select 1 i\".format(version_index))\r\n        |\r\n        |json_file = \"${genDataDir(\"json_\")}\" + str(version_index)\r\n        |spark.range(1, 2).selectExpr(\"cast(id as int) as i\").write.json(json_file)\r\n        |spark.sql(\"create table external_data_source_tbl_{}(i int) using json options (path '{}')\".format(version_index, json_file))\r\n        |\r\n        |parquet_file = \"${genDataDir(\"parquet_\")}\" + str(version_index)\r\n        |spark.range(1, 2).selectExpr(\"cast(id as int) as i\").write.parquet(parquet_file)\r\n        |spark.sql(\"create table hive_compatible_external_data_source_tbl_{}(i int) using parquet options (path '{}')\".format(version_index, parquet_file))\r\n        |\r\n        |json_file2 = \"${genDataDir(\"json2_\")}\" + str(version_index)\r\n        |spark.range(1, 2).selectExpr(\"cast(id as int) as i\").write.json(json_file2)\r\n        |spark.sql(\"create table external_table_without_schema_{} using json options (path '{}')\".format(version_index, json_file2))\r\n        |\r\n        |parquet_file2 = \"${genDataDir(\"parquet2_\")}\" + str(version_index)\r\n        |spark.range(1, 3).selectExpr(\"1 as i\", \"cast(id as int) as p\", \"1 as j\").write.parquet(os.path.join(parquet_file2, \"p=1\"))\r\n        |spark.sql(\"create table tbl_with_col_overlap_{} using parquet options(path '{}')\".format(version_index, parquet_file2))\r\n        |\r\n        |spark.sql(\"create view v_{} as select 1 i\".format(version_index))\r\n      \"\"\".stripMargin.getBytes(\"utf8\"))\r\n    // scalastyle:on line.size.limit\r\n\r\n```",
        "createdAt" : "2020-10-15T03:26:46Z",
        "updatedAt" : "2020-10-15T03:34:33Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "78bc8b3c-b90a-4be0-a34b-188a86ae8e6c",
        "parentId" : "cb7f8303-aca8-4359-add5-985a8c2c271e",
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "Oops, sure",
        "createdAt" : "2020-10-15T03:27:25Z",
        "updatedAt" : "2020-10-15T03:34:33Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      }
    ],
    "commit" : "0fc12dad880d3429b35772198a5e008507ddd5e2",
    "line" : 4,
    "diffHunk" : "@@ -1,1 +256,260 @@  }\n\n  def isPythonVersionAtLeast38(): Boolean = {\n    val attempt = if (Utils.isWindows) {\n      Try(Process(Seq(\"cmd.exe\", \"/C\", \"python3 --version\"))"
  }
]