[
  {
    "id" : "e217f07f-1709-4ba5-b64a-3a7255c1dfc1",
    "prId" : 31871,
    "prUrl" : "https://github.com/apache/spark/pull/31871#pullrequestreview-618901590",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "007252ae-b77e-4dc7-a604-cb372b6f0cc4",
        "parentId" : null,
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "Shall we add `assert(countValue >= 0)` here to ensure the task count doesn't go wrong? And then in `removeIfInactive`, we could use `v.count.get == 0`.",
        "createdAt" : "2021-03-23T01:44:24Z",
        "updatedAt" : "2021-03-24T15:52:35Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      },
      {
        "id" : "df96dee7-50bf-4178-b003-9ee479794036",
        "parentId" : "007252ae-b77e-4dc7-a604-cb372b6f0cc4",
        "authorId" : "788d6907-ae49-42f5-95b7-ef69c1460937",
        "body" : "Yeah that sounds good, I added it.",
        "createdAt" : "2021-03-23T17:51:54Z",
        "updatedAt" : "2021-03-24T15:52:35Z",
        "lastEditedBy" : "788d6907-ae49-42f5-95b7-ef69c1460937",
        "tags" : [
        ]
      }
    ],
    "commit" : "2751c75f594429a0d90c27d784c030a5fa847eed",
    "line" : 20,
    "diffHunk" : "@@ -1,1 +127,131 @@\n    def decrementCount(stage: StageKey, countAndPeaks: TCMP): TCMP = {\n      val countValue = countAndPeaks.count.decrementAndGet()\n      assert(countValue >= 0, \"task count shouldn't below 0\")\n      logDebug(s\"stageTCMP: (${stage._1}, ${stage._2}) -> \" + countValue)"
  }
]