[
  {
    "id" : "6cb59c51-abd4-4040-8737-cfb1bf2f0922",
    "prId" : 33263,
    "prUrl" : "https://github.com/apache/spark/pull/33263#pullrequestreview-716533101",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "7d6ee35c-4654-4691-ad5e-67c08e42f771",
        "parentId" : null,
        "authorId" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "body" : "shall we name it `closeInputStream`?",
        "createdAt" : "2021-07-16T02:38:06Z",
        "updatedAt" : "2021-07-16T02:38:06Z",
        "lastEditedBy" : "5e07d5ab-b4b3-41e4-beca-fefd635980c6",
        "tags" : [
        ]
      },
      {
        "id" : "fddb6ef3-d5e3-4ed1-b4f7-2771a6b8bf0c",
        "parentId" : "7d6ee35c-4654-4691-ad5e-67c08e42f771",
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "Look at this again. When will we explicitly set `closeStreams` to `false`? cc @jhu-chang ",
        "createdAt" : "2021-07-28T02:42:48Z",
        "updatedAt" : "2021-07-28T02:42:48Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      }
    ],
    "commit" : "955d24651aa0af33bc317526411cf2a3f5116f0e",
    "line" : 10,
    "diffHunk" : "@@ -1,1 +31,35 @@  file: File,\n  bufferSize: Int = 8192,\n  closeStreams: Boolean = false\n) extends Logging {\n  @volatile private var outputStream: FileOutputStream = null"
  },
  {
    "id" : "054eb816-62bb-4731-b3f3-0328e705c311",
    "prId" : 33263,
    "prUrl" : "https://github.com/apache/spark/pull/33263#pullrequestreview-710497122",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "00390286-9862-4784-b824-96be1a1d2a3a",
        "parentId" : null,
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "This's the normal exit path. So, ideally, the executor would stop logging afterward, right? But, of course, it's safer to close it.\r\n\r\nAnd I think we should also handle the error path below. That one looks more critical.",
        "createdAt" : "2021-07-16T06:20:35Z",
        "updatedAt" : "2021-07-16T06:21:35Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      },
      {
        "id" : "6cedd556-713e-4231-a58e-8561c564eb71",
        "parentId" : "00390286-9862-4784-b824-96be1a1d2a3a",
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "@jhu-chang what do you think of this last comment?",
        "createdAt" : "2021-07-19T12:04:37Z",
        "updatedAt" : "2021-07-19T12:04:37Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "1909ba9e-2bbf-4562-aba4-a77abe9eca9c",
        "parentId" : "00390286-9862-4784-b824-96be1a1d2a3a",
        "authorId" : "2e76a6ea-a54e-4828-a8af-dee876682473",
        "body" : "@Ngone51 @srowen \r\nIt's for both normal exit and exception.\r\nSorry, i don't quite understand the last comment: do you mean handling the error from \"inputStream.close()\"?",
        "createdAt" : "2021-07-20T05:22:12Z",
        "updatedAt" : "2021-07-20T05:22:12Z",
        "lastEditedBy" : "2e76a6ea-a54e-4828-a8af-dee876682473",
        "tags" : [
        ]
      },
      {
        "id" : "9e0451cc-96a6-4ae2-b71e-a96aad2aa2e0",
        "parentId" : "00390286-9862-4784-b824-96be1a1d2a3a",
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "Oh, I see. It's inside the finally block so should work for both normal exit and exception.",
        "createdAt" : "2021-07-20T12:04:39Z",
        "updatedAt" : "2021-07-20T12:04:40Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      }
    ],
    "commit" : "955d24651aa0af33bc317526411cf2a3f5116f0e",
    "line" : 23,
    "diffHunk" : "@@ -1,1 +84,88 @@          if (closeStreams) {\n            inputStream.close()\n          }\n        } finally {\n          closeFile()"
  }
]