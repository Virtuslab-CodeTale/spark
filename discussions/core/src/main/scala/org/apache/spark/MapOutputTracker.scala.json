[
  {
    "id" : "9c851137-56a5-41e5-8586-232ce2889b04",
    "prId" : 32730,
    "prUrl" : "https://github.com/apache/spark/pull/32730#pullrequestreview-675429736",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "69a331c5-e4d4-440c-907e-1585cc5a4b6d",
        "parentId" : null,
        "authorId" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "body" : "This has potential for interacting badly with correctness changes, right ?\r\nSee `DAGScheduler.submitMissingTasks` when stage is Indeterminate",
        "createdAt" : "2021-06-02T04:09:28Z",
        "updatedAt" : "2021-06-02T04:09:28Z",
        "lastEditedBy" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "tags" : [
        ]
      },
      {
        "id" : "ca8eb4e2-d9fe-4ec5-a4e4-7a7bfa3baad4",
        "parentId" : "69a331c5-e4d4-440c-907e-1585cc5a4b6d",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "Thank you for review. In that case, `mapId` is not the same, isn't it? We are reusing with `mapId` at [line 170](https://github.com/apache/spark/pull/32730/files#diff-a3b15298f97577c1fadcc2d76d015eebd6343e246c6717417d33f3c458847f46R170), @mridulm .\r\n```\r\nval index = mapStatusesDeleted.indexWhere(x => x != null && x.mapId == mapId)\r\n```",
        "createdAt" : "2021-06-02T05:48:40Z",
        "updatedAt" : "2021-06-02T05:51:10Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "46bd8d36-2a0b-4421-b7f0-77d9dc7cf739",
        "parentId" : "69a331c5-e4d4-440c-907e-1585cc5a4b6d",
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "BTW, I agree with you that we don't have a test coverage for the indeterministic stage case. Let me try to add some.",
        "createdAt" : "2021-06-02T05:50:37Z",
        "updatedAt" : "2021-06-02T05:51:40Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "7ef50fd7-cc24-4c22-b63e-f64fbbc2cd67",
        "parentId" : "69a331c5-e4d4-440c-907e-1585cc5a4b6d",
        "authorId" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "body" : "You are right, the check on mapId and mapIndex ensure correctness. Thanks for clarifying !",
        "createdAt" : "2021-06-03T15:39:10Z",
        "updatedAt" : "2021-06-03T15:39:10Z",
        "lastEditedBy" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "tags" : [
        ]
      }
    ],
    "commit" : "a9bf099c653ccd485e3409dc20f9d067974deb53",
    "line" : 52,
    "diffHunk" : "@@ -1,1 +252,256 @@      if (mapStatuses(mapIndex) != null && f(mapStatuses(mapIndex).location)) {\n        _numAvailableMapOutputs -= 1\n        mapStatusesDeleted(mapIndex) = mapStatuses(mapIndex)\n        mapStatuses(mapIndex) = null\n        invalidateSerializedMapOutputStatusCache()"
  }
]