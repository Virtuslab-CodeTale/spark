[
  {
    "id" : "335ddc4b-b23b-4a3d-a214-543f90c7f098",
    "prId" : 28094,
    "prUrl" : "https://github.com/apache/spark/pull/28094#pullrequestreview-399227469",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "fde40ec5-b88d-42ff-b29a-d3bd3a9a0fcd",
        "parentId" : null,
        "authorId" : "123cc67f-f678-49be-8742-95bc35d8c5c4",
        "body" : "Nit: I know it is not within this PR but still as I found it: \"Its expected this number if small\" => \"Its expected this number is small\"\r\n",
        "createdAt" : "2020-04-23T15:39:35Z",
        "updatedAt" : "2020-05-18T14:54:12Z",
        "lastEditedBy" : "123cc67f-f678-49be-8742-95bc35d8c5c4",
        "tags" : [
        ]
      }
    ],
    "commit" : "11a8e04a535b89ca68918c6e3f29ab0f8aa1e2f5",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +34,38 @@ * and everywhere else we can use the ResourceProfile Id to save on space.\n * Note we never remove a resource profile at this point. Its expected this number is small\n * so this shouldn't be much overhead.\n */\n@Evolving"
  },
  {
    "id" : "8e0291e8-8cac-4d9b-8114-2ba7d04e5e92",
    "prId" : 28053,
    "prUrl" : "https://github.com/apache/spark/pull/28053#pullrequestreview-383183146",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "efd972c9-622d-4263-a9b4-ae167cfd3cc7",
        "parentId" : null,
        "authorId" : "7694af3d-5af2-4788-8413-c0558915c452",
        "body" : "~Is there a reason to change like this?~ Never mind. I saw `synchronized` in the below.",
        "createdAt" : "2020-03-27T18:31:32Z",
        "updatedAt" : "2020-04-01T19:28:46Z",
        "lastEditedBy" : "7694af3d-5af2-4788-8413-c0558915c452",
        "tags" : [
        ]
      },
      {
        "id" : "c467fb7b-d01a-40f7-aa4e-7436179e3497",
        "parentId" : "efd972c9-622d-4263-a9b4-ae167cfd3cc7",
        "authorId" : "bea80117-7be3-4703-8d54-02b7bf73632c",
        "body" : "yep changed the synchronization due to concurrentHashMap not being friendly for the new function to find existing profiles.",
        "createdAt" : "2020-03-27T20:36:14Z",
        "updatedAt" : "2020-04-01T19:28:46Z",
        "lastEditedBy" : "bea80117-7be3-4703-8d54-02b7bf73632c",
        "tags" : [
        ]
      }
    ],
    "commit" : "452378be77b5371feb7d974776ad411b9e2bc232",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +37,41 @@@Evolving\nprivate[spark] class ResourceProfileManager(sparkConf: SparkConf) extends Logging {\n  private val resourceProfileIdToResourceProfile = new HashMap[Int, ResourceProfile]()\n\n  private val (readLock, writeLock) = {"
  },
  {
    "id" : "4ec8802b-b254-4beb-9b9c-35374b501052",
    "prId" : 27773,
    "prUrl" : "https://github.com/apache/spark/pull/27773#pullrequestreview-371640880",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4784a646-c811-436e-862c-b4ced8f0e875",
        "parentId" : null,
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "Is there'a way to clean old resource profile in case of a RDD calls `withResources` for multiple times?",
        "createdAt" : "2020-03-09T07:41:05Z",
        "updatedAt" : "2020-03-19T20:03:38Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      },
      {
        "id" : "a031e8af-0cff-452b-bfd4-7fbd23e33442",
        "parentId" : "4784a646-c811-436e-862c-b4ced8f0e875",
        "authorId" : "bea80117-7be3-4703-8d54-02b7bf73632c",
        "body" : "currently I'm not removing the old resource profiles as they could be used elsewhere and its a bit hard to know when you are done using them. I don't expect people to use many of them (but as we know lots of people use things unexpectedly). But I have a follow up jira to go figure out a way to remove unused ones. https://issues.apache.org/jira/browse/SPARK-30749",
        "createdAt" : "2020-03-09T15:44:46Z",
        "updatedAt" : "2020-03-19T20:03:38Z",
        "lastEditedBy" : "bea80117-7be3-4703-8d54-02b7bf73632c",
        "tags" : [
        ]
      },
      {
        "id" : "153e83c0-a406-4c79-971f-60fa204eacba",
        "parentId" : "4784a646-c811-436e-862c-b4ced8f0e875",
        "authorId" : "bea80117-7be3-4703-8d54-02b7bf73632c",
        "body" : "also note that adding a resourceprofile multiple times (rdd.withResources) doesn't leave around old resource profiles, its when they actually create the resourceProfile that it gets a separate id.\r\nThis pr has the RDD.withResources in now for testing purposes, so we can leave this conversation til the Pr that opens it up but I was trying to decide whether we only allow setting it once per RDD , left it out here as I was still thinking about that.",
        "createdAt" : "2020-03-09T15:51:41Z",
        "updatedAt" : "2020-03-19T20:03:38Z",
        "lastEditedBy" : "bea80117-7be3-4703-8d54-02b7bf73632c",
        "tags" : [
        ]
      },
      {
        "id" : "f7ff4933-6bee-47d1-a443-992fb0e3b06c",
        "parentId" : "4784a646-c811-436e-862c-b4ced8f0e875",
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "We may could record `RDD.id` to preserve only one `ResourceProfile` and allow override with warning.",
        "createdAt" : "2020-03-10T02:16:46Z",
        "updatedAt" : "2020-03-19T20:03:38Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      }
    ],
    "commit" : "2a4a73385ee948d81e51091990a37ebbc8010f61",
    "line" : 16,
    "diffHunk" : "@@ -1,1 +66,70 @@    val res = resourceProfileIdToResourceProfile.putIfAbsent(rp.id, rp)\n    if (res == null) {\n      logInfo(s\"Added ResourceProfile id: ${rp.id}\")\n    }\n  }"
  },
  {
    "id" : "8d233523-eb87-4c69-8b4d-6cc3887322f2",
    "prId" : 27313,
    "prUrl" : "https://github.com/apache/spark/pull/27313#pullrequestreview-556044266",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2952a85c-9b85-4f11-bff7-02ba2de23997",
        "parentId" : null,
        "authorId" : "2d6b46ba-4100-4c4d-9341-fff5e39647ec",
        "body" : "nit: Is `@Evolving` needed since this is a private class?",
        "createdAt" : "2020-12-20T19:27:47Z",
        "updatedAt" : "2020-12-20T19:27:47Z",
        "lastEditedBy" : "2d6b46ba-4100-4c4d-9341-fff5e39647ec",
        "tags" : [
        ]
      }
    ],
    "commit" : "15f4c96b06e887913dc3c8ede8d385bfae514db9",
    "line" : 35,
    "diffHunk" : "@@ -1,1 +33,37 @@ * so this shouldn't be much overhead.\n */\n@Evolving\nprivate[spark] class ResourceProfileManager(sparkConf: SparkConf) extends Logging {\n  private val resourceProfileIdToResourceProfile = new ConcurrentHashMap[Int, ResourceProfile]()"
  }
]