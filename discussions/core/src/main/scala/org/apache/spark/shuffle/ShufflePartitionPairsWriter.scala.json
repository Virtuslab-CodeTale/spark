[
  {
    "id" : "a7371274-4686-4715-acb1-4fcf63ef7719",
    "prId" : 25342,
    "prUrl" : "https://github.com/apache/spark/pull/25342#pullrequestreview-279885289",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "175547cd-7a43-467a-998d-73847e94f19c",
        "parentId" : null,
        "authorId" : "0b3111e2-9584-4813-8cb5-8f40e119f71c",
        "body" : "So this still has the problem I mentioned of leaving this class half-initialized and unable to clean itself up.\r\n\r\nIf you call `write()` and the `open()` call fails when initializing `wrappedStream`, for example, there is no code path that will close `partitionStream`. `close()` should handle that sort of thing.",
        "createdAt" : "2019-08-26T17:44:33Z",
        "updatedAt" : "2019-08-28T21:40:35Z",
        "lastEditedBy" : "0b3111e2-9584-4813-8cb5-8f40e119f71c",
        "tags" : [
        ]
      },
      {
        "id" : "b09bf893-7e5d-4ae4-ba14-9a12200a98f0",
        "parentId" : "175547cd-7a43-467a-998d-73847e94f19c",
        "authorId" : "806aa501-9ea7-4cec-b017-a84d9a1602d8",
        "body" : "I tried to fix this in `close()`. Let me know if that's done correctly. Also wanted some adjustments in `ExternalSorter` to manage exception propagation.",
        "createdAt" : "2019-08-26T23:18:21Z",
        "updatedAt" : "2019-08-28T21:40:35Z",
        "lastEditedBy" : "806aa501-9ea7-4cec-b017-a84d9a1602d8",
        "tags" : [
        ]
      }
    ],
    "commit" : "d4831577120f73b6bfe20ca887659566abcabb31",
    "line" : 52,
    "diffHunk" : "@@ -1,1 +50,54 @@    }\n    if (objOut == null) {\n      open()\n    }\n    objOut.writeKey(key)"
  }
]