[
  {
    "id" : "15c8a658-dea0-4955-a3f3-6a4d3fb4b62e",
    "prId" : 33251,
    "prUrl" : "https://github.com/apache/spark/pull/33251#pullrequestreview-703342839",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "594199f1-aafa-4ada-9731-d93569c82cd0",
        "parentId" : null,
        "authorId" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "body" : "I wasn't clear why this had to change?",
        "createdAt" : "2021-07-09T18:13:49Z",
        "updatedAt" : "2021-07-09T18:15:27Z",
        "lastEditedBy" : "707cf6e1-750c-4aea-8774-f79c13fb7add",
        "tags" : [
        ]
      },
      {
        "id" : "81bd8e32-04f0-4161-9167-aa3de0aa7532",
        "parentId" : "594199f1-aafa-4ada-9731-d93569c82cd0",
        "authorId" : "3f417633-f870-4fee-b580-ac9ce146075f",
        "body" : "The test was failing with `NullPointerException` cause the `SparkEnv.get` wasn't initialized.\r\nConsidering that the `RemoteBlockDownloadFileManager` accepts an instance of `BlockManager` which already has `SecurityManager` it seemed logical to just pass the `encryptionKey` too so it didn't rely on the static env in the lazy val.\r\n\r\nAs I understand the alternative would be to construct a mock environment and call the static `SparkEnv.set` and I see that this approach is taken in other places, but I do not understand how it works reliably without removing it after use - it's just left there. Hence I decided to remove the reliance on the static env so it's easier to test.",
        "createdAt" : "2021-07-09T19:38:11Z",
        "updatedAt" : "2021-07-09T19:55:52Z",
        "lastEditedBy" : "3f417633-f870-4fee-b580-ac9ce146075f",
        "tags" : [
        ]
      }
    ],
    "commit" : "74c374fc45279f378d965d421298864b2ca6794d",
    "line" : 5,
    "diffHunk" : "@@ -1,1 +256,260 @@  // Exposed for test\n  private[storage] val remoteBlockTempFileManager =\n    new BlockManager.RemoteBlockDownloadFileManager(\n      this,\n      securityManager.getIOEncryptionKey())"
  }
]