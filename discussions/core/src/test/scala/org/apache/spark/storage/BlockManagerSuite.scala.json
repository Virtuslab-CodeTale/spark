[
  {
    "id" : "218febca-9f6e-459c-a6a3-489546066a07",
    "prId" : 33425,
    "prUrl" : "https://github.com/apache/spark/pull/33425#pullrequestreview-714234740",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "4eb2a971-ee01-4982-b4b0-c307ea60a7da",
        "parentId" : null,
        "authorId" : "9953a478-bdd8-4f15-be59-f6f654ff85ae",
        "body" : "Can we extend this UT to verify the driver host is excluded? It will ensure that any future changes will not change this.",
        "createdAt" : "2021-07-20T05:43:51Z",
        "updatedAt" : "2021-07-20T05:44:25Z",
        "lastEditedBy" : "9953a478-bdd8-4f15-be59-f6f654ff85ae",
        "tags" : [
        ]
      },
      {
        "id" : "5e6a4310-29d6-42b4-b080-910f472ac731",
        "parentId" : "4eb2a971-ee01-4982-b4b0-c307ea60a7da",
        "authorId" : "4da55a4a-8a34-454a-9445-fb8101f62652",
        "body" : "I tried doing that, currently the BlockManagerMaster is mocked, therefore it doesn't register due to which it won't be added as part of `blockManagerIdByExecutor`. If not the test should have failed in the first place itself, as we are explicitly having tests checking for the hosts. But I will see if there is any other way add tests for this thing.",
        "createdAt" : "2021-07-20T17:33:46Z",
        "updatedAt" : "2021-07-20T17:33:46Z",
        "lastEditedBy" : "4da55a4a-8a34-454a-9445-fb8101f62652",
        "tags" : [
        ]
      },
      {
        "id" : "17186400-f978-404c-bc04-f32147f0ef31",
        "parentId" : "4eb2a971-ee01-4982-b4b0-c307ea60a7da",
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "Sounds fine.",
        "createdAt" : "2021-07-21T01:58:59Z",
        "updatedAt" : "2021-07-21T01:58:59Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      },
      {
        "id" : "6a6c86c0-fc8f-4835-82a4-4e694c28ec66",
        "parentId" : "4eb2a971-ee01-4982-b4b0-c307ea60a7da",
        "authorId" : "4da55a4a-8a34-454a-9445-fb8101f62652",
        "body" : "@Ngone51 Any suggestions? or is this fine as it is? I don't think there is any other way if not we need to significantly refactor the tests or something.",
        "createdAt" : "2021-07-21T17:16:38Z",
        "updatedAt" : "2021-07-21T17:16:38Z",
        "lastEditedBy" : "4da55a4a-8a34-454a-9445-fb8101f62652",
        "tags" : [
        ]
      },
      {
        "id" : "e898593e-326c-4bf3-a32d-9101eb498668",
        "parentId" : "4eb2a971-ee01-4982-b4b0-c307ea60a7da",
        "authorId" : "171fe41b-96df-4362-a600-2d1f030de577",
        "body" : "It's fine as it is.",
        "createdAt" : "2021-07-24T13:32:35Z",
        "updatedAt" : "2021-07-24T13:32:35Z",
        "lastEditedBy" : "171fe41b-96df-4362-a600-2d1f030de577",
        "tags" : [
        ]
      }
    ],
    "commit" : "e3ef56393e612e6803b88fbce5c87178743528bc",
    "line" : 18,
    "diffHunk" : "@@ -1,1 +2099,2103 @@    master.removeShufflePushMergerLocation(\"hostA\")\n    assert(master.getShufflePushMergerLocations(4, Set.empty).map(_.host).sorted ===\n      Seq(\"hostB\", \"hostC\", \"hostD\").sorted)\n  }\n"
  },
  {
    "id" : "322affbe-09da-4824-b656-f344e0034e7d",
    "prId" : 33425,
    "prUrl" : "https://github.com/apache/spark/pull/33425#pullrequestreview-715176315",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "3cd610a7-2649-4376-ab14-644ea97e1255",
        "parentId" : null,
        "authorId" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "body" : "Add a driver block manager to this test ? It will catch the issue being fixed in `BlockManagerMasterEndpoint`, right ?\r\n",
        "createdAt" : "2021-07-25T06:28:08Z",
        "updatedAt" : "2021-07-25T06:28:08Z",
        "lastEditedBy" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "tags" : [
        ]
      },
      {
        "id" : "8c3de49b-a6aa-48d9-aab6-87355d49421b",
        "parentId" : "3cd610a7-2649-4376-ab14-644ea97e1255",
        "authorId" : "4da55a4a-8a34-454a-9445-fb8101f62652",
        "body" : "I tried adding test but like I mentioned in this [comment](https://github.com/apache/spark/pull/33425#discussion_r673340152) currently `BlockManagerMaster` is mocked due to which it doesn't registered and won't be in `blockManagerIdByExecutor`. That is why I didn't add the test.",
        "createdAt" : "2021-07-25T15:01:10Z",
        "updatedAt" : "2021-07-25T15:01:10Z",
        "lastEditedBy" : "4da55a4a-8a34-454a-9445-fb8101f62652",
        "tags" : [
        ]
      },
      {
        "id" : "57a4b686-b142-4fce-82ba-a127861f06f5",
        "parentId" : "3cd610a7-2649-4376-ab14-644ea97e1255",
        "authorId" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "body" : "Why would this not work ?\r\n\r\n```\r\n    assert(master.getExecutorEndpointRef(SparkContext.DRIVER_IDENTIFIER).isEmpty)\r\n    makeBlockManager(100, SparkContext.DRIVER_IDENTIFIER,\r\n      transferService = Some(new MockBlockTransferService(10, \"host0\")))\r\n    assert(master.getExecutorEndpointRef(SparkContext.DRIVER_IDENTIFIER).isDefined)\r\n```",
        "createdAt" : "2021-07-26T18:50:33Z",
        "updatedAt" : "2021-07-26T18:50:33Z",
        "lastEditedBy" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "tags" : [
        ]
      }
    ],
    "commit" : "e3ef56393e612e6803b88fbce5c87178743528bc",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +2094,2098 @@    assert(master.getShufflePushMergerLocations(3, Set.empty).size == 3)\n    assert(master.getShufflePushMergerLocations(3, Set.empty).map(_.host).sorted ===\n      Seq(\"hostC\", \"hostB\", \"hostD\").sorted)\n    assert(master.getShufflePushMergerLocations(4, Set.empty).map(_.host).sorted ===\n      Seq(\"hostB\", \"hostA\", \"hostC\", \"hostD\").sorted)"
  },
  {
    "id" : "b8bcc321-b5cb-4e72-91df-64fa9a39125d",
    "prId" : 33425,
    "prUrl" : "https://github.com/apache/spark/pull/33425#pullrequestreview-715340506",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "2ea17467-6c01-4c2f-8393-513480390019",
        "parentId" : null,
        "authorId" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "body" : "This does not look right; we cant have it both empty and defined :-)\r\nIt will be defined only after we add the driver.",
        "createdAt" : "2021-07-26T22:43:44Z",
        "updatedAt" : "2021-07-26T22:44:02Z",
        "lastEditedBy" : "d35df420-57a9-43e8-b8d5-cad0f4002681",
        "tags" : [
        ]
      }
    ],
    "commit" : "e3ef56393e612e6803b88fbce5c87178743528bc",
    "line" : 7,
    "diffHunk" : "@@ -1,1 +2087,2091 @@    assert(master.getExecutorEndpointRef(SparkContext.DRIVER_IDENTIFIER).isEmpty)\n    makeBlockManager(100, SparkContext.DRIVER_IDENTIFIER,\n      transferService = Some(new MockBlockTransferService(10, \"host-driver\")))\n    assert(master.getExecutorEndpointRef(SparkContext.DRIVER_IDENTIFIER).isDefined)\n    master.removeExecutor(\"execA\")"
  }
]