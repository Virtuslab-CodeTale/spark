[
  {
    "id" : "3da2c000-eab1-44b5-8ddd-b684a7bafd2e",
    "prId" : 25470,
    "prUrl" : "https://github.com/apache/spark/pull/25470#pullrequestreview-275795078",
    "prSource" : "GitHub",
    "comments" : [
      {
        "id" : "ad985e9f-443b-4427-97d8-a8ac5d494763",
        "parentId" : null,
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "Do you mean the java serializer in Spark calls `Class.forName` every time when it serializes an object?",
        "createdAt" : "2019-08-16T02:40:29Z",
        "updatedAt" : "2019-08-27T13:12:08Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "e36b9fae-7387-4119-8c0e-3c487e78947e",
        "parentId" : "ad985e9f-443b-4427-97d8-a8ac5d494763",
        "authorId" : "28d581bb-a398-46f0-861f-a016fdb56186",
        "body" : "I'm not sure. This is what I saw from the profiling tool.",
        "createdAt" : "2019-08-16T02:45:25Z",
        "updatedAt" : "2019-08-27T13:12:08Z",
        "lastEditedBy" : "28d581bb-a398-46f0-861f-a016fdb56186",
        "tags" : [
        ]
      },
      {
        "id" : "559ffd0b-198b-4eab-88bc-d80b0fdfce8c",
        "parentId" : "ad985e9f-443b-4427-97d8-a8ac5d494763",
        "authorId" : "28d581bb-a398-46f0-861f-a016fdb56186",
        "body" : "From the `resolveClass` doc\r\n```\r\nThis method will be invoked only once for each unique class in the stream. ..\r\n```",
        "createdAt" : "2019-08-16T02:55:19Z",
        "updatedAt" : "2019-08-27T13:12:08Z",
        "lastEditedBy" : "28d581bb-a398-46f0-861f-a016fdb56186",
        "tags" : [
        ]
      },
      {
        "id" : "b3dece84-1d10-438a-be36-cc3e1922dd73",
        "parentId" : "ad985e9f-443b-4427-97d8-a8ac5d494763",
        "authorId" : "28d581bb-a398-46f0-861f-a016fdb56186",
        "body" : "We need to create a new `ObjectInputStream` for each `deserialize` call.",
        "createdAt" : "2019-08-16T02:56:12Z",
        "updatedAt" : "2019-08-27T13:12:08Z",
        "lastEditedBy" : "28d581bb-a398-46f0-861f-a016fdb56186",
        "tags" : [
        ]
      },
      {
        "id" : "d6df58d9-cf09-4e4d-8d4c-fc9471c5244d",
        "parentId" : "ad985e9f-443b-4427-97d8-a8ac5d494763",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "is it possible to reuse the `InputStream` instance?",
        "createdAt" : "2019-08-16T03:10:04Z",
        "updatedAt" : "2019-08-27T13:12:08Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "1f2033f6-22b4-4808-a995-7349bf8557ee",
        "parentId" : "ad985e9f-443b-4427-97d8-a8ac5d494763",
        "authorId" : "28d581bb-a398-46f0-861f-a016fdb56186",
        "body" : "The `JavaSerializer` can provide threadsafe. I think that's why we use it in closure, RPC, and others. To reuse `InputStream` may need to do some threadsafe protection, such as `ThreadLocal`.",
        "createdAt" : "2019-08-16T03:17:50Z",
        "updatedAt" : "2019-08-27T13:12:08Z",
        "lastEditedBy" : "28d581bb-a398-46f0-861f-a016fdb56186",
        "tags" : [
        ]
      },
      {
        "id" : "f53d3dc4-b8d2-4584-88c7-1c24146fcf98",
        "parentId" : "ad985e9f-443b-4427-97d8-a8ac5d494763",
        "authorId" : "28d581bb-a398-46f0-861f-a016fdb56186",
        "body" : "Maybe we can do something like `KryoPool`?",
        "createdAt" : "2019-08-16T04:14:33Z",
        "updatedAt" : "2019-08-27T13:12:08Z",
        "lastEditedBy" : "28d581bb-a398-46f0-861f-a016fdb56186",
        "tags" : [
        ]
      },
      {
        "id" : "7f961cc3-dbcb-43f9-b224-453dfe94dbd5",
        "parentId" : "ad985e9f-443b-4427-97d8-a8ac5d494763",
        "authorId" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "body" : "`JavaSerializer` is thread-safe, does `JavaSerializerInstance` also need to be?",
        "createdAt" : "2019-08-16T06:17:13Z",
        "updatedAt" : "2019-08-27T13:12:08Z",
        "lastEditedBy" : "b1f2cebb-db23-4759-b446-886279d07e99",
        "tags" : [
        ]
      },
      {
        "id" : "c09a5f25-0836-4960-b261-dc235dd9fdd0",
        "parentId" : "ad985e9f-443b-4427-97d8-a8ac5d494763",
        "authorId" : "28d581bb-a398-46f0-861f-a016fdb56186",
        "body" : "Yes, it needs to be. You can refer to the `NettyRpcEnv.javaSerializerInstance` which could be used with multithread.",
        "createdAt" : "2019-08-16T06:41:30Z",
        "updatedAt" : "2019-08-27T13:12:08Z",
        "lastEditedBy" : "28d581bb-a398-46f0-861f-a016fdb56186",
        "tags" : [
        ]
      }
    ],
    "commit" : "0a15c24a4c689b06028c51d52afade9b7b9559ba",
    "line" : 64,
    "diffHunk" : "@@ -1,1 +62,66 @@          s = data(i)\n          s.rewind()\n          ser.deserialize(s)\n          i += 1\n        }"
  }
]